metric_id,base_metric_id,metric_name,business_description,gcp_project_name,dataset_name,table_name,sql_logic,governance_issue,dashboard_id,prompt_version,primary_data_sources,complexity_score,consolidation_score,score_reasoning,total_metrics_identified,date_grain,governance_issue_description
t0_qt_c3emuiymrd,total_gross_revenue,"Total Gross Revenue Amount (Digital, Filtered)","The sum of gross revenue amounts for digital revenue types, excluding specific admin/internal publications, certain source systems, and booking number -1, for the financial year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.gross_revenue_amount) AS t0_qt_c3emuiymrd FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.revenue_type = 'Digital' AND t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Punters.com.au', 'odds.com.au', 'RACENET', 'Racenet App', 'SKYNEWS.ADMIN', 'SUDDENLY.CW', 'SUDDENLY.OTHER', 'SUDDENLY.TGG', 'SUPERCOACH', 'Sky News', 'Stellar.Admin', 'Stockhead', 'TAUS.ADMIN', 'Taste.Admin', 'Vogue.Admin', 'Vogueliving.Admin') AND t0.publication_name NOT IN ('Vogueliving.Admin', 'Vogue.Admin', 'ADMIN.ADV', 'ADMIN.DTM', 'ADMIN.HWT', 'ADMIN.SALES', 'ADMIN.SPORT', 'VOGUELIVING.ADMIN', 'VOGUE.ADMIN', 'Taste.Admin', 'TAUS.ADMIN', 'TASTE.ADMIN', 'STELLAR.ADMIN', 'ADMIN.TCM', 'NEWS.ADMIN', 'SKYNEWS.ADMIN', 'National Tabloid Preprint', 'News.Admin', 'Admin.DTM', 'Admin.International', 'BODYANDSOUL.ADMIN', 'Bestrecipes.Admin', 'ESCAPE.ADMIN', 'Admin.Sales', 'Admin.TCM', 'Kidspot.Admin', 'BESTRECIPES.ADMIN', 'Bodyandsoul.Admin', 'Delicious.admin', 'KIDSPOT.ADMIN', 'DELICIOUS.ADMIN', 'GQ.Admin', 'GQ.ADMIN', 'Escape.Admin', 'CODE', 'CODEBET', 'punters.com.au', 'odds.com.au', 'ODDS', 'RACENET', 'RACENET_FORMGUIDE', 'Racenet App', 'racenet.com.au', 'Sky News', 'Sky News App', 'SkyNews', 'Stockhead', 'SUDDENLY.TGG', 'SUDDENLY.SOUTH', 'SUDDENLY.QLD', 'SUDDENLY.OTHER', 'SUDDENLY.NSW', 'SUDDENLY.NORTH', 'SUDDENLY.CW', 'TABOOLA', 'Taboola', 'EdMedia', 'EDMEDIA', 'eCommerce', 'ECOMMERCEPARTNERS', 'ECOMMERCE.VOGUELIVING', 'ECOMMERCE.VOGUE', 'ECOMMERCE', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.TCM', 'ECOMMERCE.TASTE', 'ECOMMERCE.NEWS', 'ECOMMERCE.KIDSPOT', 'ECOMMERCE.GQ', 'ECOMMERCE.ESCAPE', 'ECOMMERCE.DELICIOUS') AND t0.source_system_code NOT IN ('LGBSS', 'LGBPUB') AND t0.booking_number NOT IN ('-1') AND t0.financial_year IN ('2025')",hardcoded_logic,f65a9149-93b4-4aa9-aef6-d12002853222,1.1,ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client,4,2,"SQL complexity is low with simple aggregations and no joins/window functions. Consolidation benefit for metrics is low as only one aggregate metric was identified. However, extensive hardcoded filters across queries suggest a high benefit from consolidating filter logic.",1,mixed,
t0_qt_dxojlcsfxc,daily_subscription_target,Daily Target by Publication Group,The daily subscription target set for a specific publication group.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_publication_group) AS t0_qt_dxojlcsfxc FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-05-05' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-05-11' GROUP BY t0.publication_group, t0.website",,c9529742-6e47-4644-ae3e-87ace36730cc,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,8,"The query involves basic aggregations and simple data type conversions across multiple subqueries, indicating low complexity. Both identified metrics represent variations of 'daily subscription targets' from the same source, suggesting high consolidation potential.",2,weekly,
t0_qt_y7qal64alc,daily_subscription_target,Daily Target by Website,The daily subscription target set for a specific website.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) AS t0_qt_y7qal64alc FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-05-05' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-05-11' GROUP BY t0.publication_group, t0.website",,c9529742-6e47-4644-ae3e-87ace36730cc,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,8,"The query involves basic aggregations and simple data type conversions across multiple subqueries, indicating low complexity. Both identified metrics represent variations of 'daily subscription targets' from the same source, suggesting high consolidation potential.",2,weekly,
clmn0_,financial_ad_type_name,Financial Ad Type Name,"Represents the name of the financial ad type, excluding product groups classified as 'Unknown' or NULL.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.fin_adtype_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (t0.product_group NOT IN ('Unknown') OR t0.product_group IS NULL),hardcoded_logic,d3bcf796-2396-4a6f-b0a3-da0b7f299a58,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,3,1,"Complexity is low due to simple SELECTs, no joins, and basic filtering/CASE statements. Consolidation is low as identified metrics represent distinct business concepts.",3,mixed,
clmn1_,revenue_type_level2,Revenue Type Level 2,"Represents the second level of revenue type classification, specifically filtered for financial month '1'.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.revenue_type_Level2 FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.financial_month IN ('1'),hardcoded_logic,d3bcf796-2396-4a6f-b0a3-da0b7f299a58,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,3,1,"Complexity is low due to simple SELECTs, no joins, and basic filtering/CASE statements. Consolidation is low as identified metrics represent distinct business concepts.",3,mixed,
t0_qt_jsson7x7td,current_financial_week,Current Financial Week,"Represents the financial week number for the current fiscal year, identified by a relative fiscal year week offset of 0.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT CASE WHEN (t0.relative_fy_week_offset = 0) THEN SAFE_CAST(t0.financial_week AS INT64) ELSE NULL END FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,hardcoded_logic,d3bcf796-2396-4a6f-b0a3-da0b7f299a58,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,3,1,"Complexity is low due to simple SELECTs, no joins, and basic filtering/CASE statements. Consolidation is low as identified metrics represent distinct business concepts.",3,mixed,
t0c1d0_qt_dapzsbb9jd_1,total_video_media_starts,Total Video Media Starts (Specific Brands & Date Range 1),"Total count of video media starts for specific brands ('the australian', 'daily telegraph') within a defined date range (2025-04-22 to 2025-04-28), aggregated from daily interaction data.",ncau-data-newsquery-prd,prstn_verity,content_video_interactions_daily_agg_fct,"SELECT SUM(t.video_media_starts) FROM ( SELECT visit_date, brand, DeviceType, sum(video_media_starts) AS video_media_starts FROM `ncau-data-newsquery-prd.prstn_verity.content_video_interactions_daily_agg_fct` WHERE brand IN ('the australian', 'newscomau', 'daily telegraph', 'the courier mail', 'gold coast bulletin', 'escape', 'townsville bulletin', 'the chronicle', 'kids news', 'the mercury', 'code sports', 'geelong advertiser', 'the advertiser', 'the cairns post', 'nt news', 'herald sun') GROUP BY visit_date, brand, DeviceType ) AS t WHERE t.visit_date >= DATE '2025-04-22' AND t.visit_date <= DATE '2025-04-28' AND LTRIM(RTRIM(SAFE_CAST(t.brand AS STRING))) IN ('the australian', 'daily telegraph');",hardcoded_logic,45bc0813-2c47-4f36-bcac-ed638ce69ce2,1.1,ncau-data-newsquery-prd.prstn_verity.content_video_interactions_daily_agg_fct,3,9,"Complexity is low due to simple aggregations and no joins/window functions, but nesting adds minor complexity. Consolidation is high as all metrics derive from the same base 'video_media_starts' with varying hardcoded filters.",3,daily,
t0c1d0_qt_dapzsbb9jd_2,total_video_media_starts,Total Video Media Starts (Specific Brand & Date Range 2),"Total count of video media starts for specific brand ('code sports') within a defined date range (2025-02-26 to 2025-03-04), aggregated from daily interaction data.",ncau-data-newsquery-prd,prstn_verity,content_video_interactions_daily_agg_fct,"SELECT SUM(t.video_media_starts) FROM ( SELECT visit_date, brand, DeviceType, sum(video_media_starts) AS video_media_starts FROM `ncau-data-newsquery-prd.prstn_verity.content_video_interactions_daily_agg_fct` WHERE brand IN ('the australian', 'newscomau', 'daily telegraph', 'the courier mail', 'gold coast bulletin', 'escape', 'townsville bulletin', 'the chronicle', 'kids news', 'the mercury', 'code sports', 'geelong advertiser', 'the advertiser', 'the cairns post', 'nt news', 'herald sun') GROUP BY visit_date, brand, DeviceType ) AS t WHERE t.visit_date >= DATE '2025-02-26' AND t.visit_date <= DATE '2025-03-04' AND LTRIM(RTRIM(SAFE_CAST(t.brand AS STRING))) IN ('code sports');",hardcoded_logic,45bc0813-2c47-4f36-bcac-ed638ce69ce2,1.1,ncau-data-newsquery-prd.prstn_verity.content_video_interactions_daily_agg_fct,3,9,"Complexity is low due to simple aggregations and no joins/window functions, but nesting adds minor complexity. Consolidation is high as all metrics derive from the same base 'video_media_starts' with varying hardcoded filters.",3,daily,
t0c1d0_qt_dapzsbb9jd_3,total_video_media_starts,Total Video Media Starts (Date Range Only),"Total count of video media starts within a defined date range (2025-08-08 to 2025-08-14), aggregated from daily interaction data across all specified brands.",ncau-data-newsquery-prd,prstn_verity,content_video_interactions_daily_agg_fct,"SELECT SUM(t.video_media_starts) FROM ( SELECT visit_date, brand, DeviceType, sum(video_media_starts) AS video_media_starts FROM `ncau-data-newsquery-prd.prstn_verity.content_video_interactions_daily_agg_fct` WHERE brand IN ('the australian', 'newscomau', 'daily telegraph', 'the courier mail', 'gold coast bulletin', 'escape', 'townsville bulletin', 'the chronicle', 'kids news', 'the mercury', 'code sports', 'geelong advertiser', 'the advertiser', 'the cairns post', 'nt news', 'herald sun') GROUP BY visit_date, brand, DeviceType ) AS t WHERE t.visit_date >= DATE '2025-08-08' AND t.visit_date <= DATE '2025-08-14';",hardcoded_logic,45bc0813-2c47-4f36-bcac-ed638ce69ce2,1.1,ncau-data-newsquery-prd.prstn_verity.content_video_interactions_daily_agg_fct,3,9,"Complexity is low due to simple aggregations and no joins/window functions, but nesting adds minor complexity. Consolidation is high as all metrics derive from the same base 'video_media_starts' with varying hardcoded filters.",3,daily,
t0c1d0_qt_24290k691c,event_count,Event Count for Page Views by User Name,"Counts the number of events, filtered for 'page' related events and 'user_name' parameters, within a specific hardcoded date range.",ncau-data-newsquery-prd,analytics_309894138,events_intraday_*,"SELECT COUNT(1) AS t0c1d0_qt_24290k691c FROM `ncau-data-newsquery-prd.analytics_309894138.events_intraday_*` AS t0c1d0 LEFT JOIN UNNEST(t0c1d0.event_params) AS t0c1d0_event_params WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0c1d0.event_date AS STRING)) >= DATE '2025-05-12' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0c1d0.event_date AS STRING)) <= DATE '2025-05-18' AND t0c1d0_event_params.key = 'user_name' AND SAFE.REGEXP_CONTAINS(t0c1d0.event_name, 'page');",hardcoded_logic,6596264e-ca48-4ca6-8871-77d1e0d29b28,1.1,ncau-data-newsquery-prd.analytics_309894138.events_intraday_*;ncau-data-newsquery-prd.sdm_reference_data.verity2_user_test,6,7,"Complexity is moderate due to nested subqueries, UNNEST, and multiple data transformations/filters in one query type; consolidation is high as two distinct metric aliases represent the same core 'user record count' concept from the same source.",3,weekly,
t0c1d1_qt_u1kz1l691c,user_record_count,User Record Count,"Counts the number of records in the verity2_user_test reference table, representing user-related entries.",ncau-data-newsquery-prd,sdm_reference_data,verity2_user_test,SELECT COUNT(1) AS t0c1d1_qt_u1kz1l691c FROM `ncau-data-newsquery-prd.sdm_reference_data.verity2_user_test`;,none,6596264e-ca48-4ca6-8871-77d1e0d29b28,1.1,ncau-data-newsquery-prd.analytics_309894138.events_intraday_*;ncau-data-newsquery-prd.sdm_reference_data.verity2_user_test,6,7,"Complexity is moderate due to nested subqueries, UNNEST, and multiple data transformations/filters in one query type; consolidation is high as two distinct metric aliases represent the same core 'user record count' concept from the same source.",3,weekly,
t0c0d1_qt_u1kz1l691c,user_record_count,User Record Count,"Counts the number of records in the verity2_user_test reference table, representing user-related entries.",ncau-data-newsquery-prd,sdm_reference_data,verity2_user_test,SELECT COUNT(1) AS t0c0d1_qt_u1kz1l691c FROM `ncau-data-newsquery-prd.sdm_reference_data.verity2_user_test`;,none,6596264e-ca48-4ca6-8871-77d1e0d29b28,1.1,ncau-data-newsquery-prd.analytics_309894138.events_intraday_*;ncau-data-newsquery-prd.sdm_reference_data.verity2_user_test,6,7,"Complexity is moderate due to nested subqueries, UNNEST, and multiple data transformations/filters in one query type; consolidation is high as two distinct metric aliases represent the same core 'user record count' concept from the same source.",3,weekly,
total_incident,total_incidents,Total Incidents,"The total count of unique incidents for the given month, filtered by specific criteria.",ncau-data-newsquery-prd,sdm_snow,servicenow,"WITH
  INC_RES AS (
    SELECT DISTINCT
      number,
      sla,
      start_time,
      stage,
      assignment_group,
      has_breached
    FROM
      `ncau-data-newsquery-prd.sdm_snow.servicenow`
    WHERE
      assignment_group = ""News Corp Australia - NewsQuery"" AND task_type = ""incident"" AND sla NOT LIKE '%Trial%' AND
      stage = ""Completed""
  )
SELECT
  EXTRACT(MONTH FROM DATE(start_time)) AS INC_MONTH,
  COUNT(DISTINCT(number)) AS total_incident
FROM
  INC_RES
GROUP BY INC_MONTH",hardcoded_logic,bedebbe4-3e46-47d5-bc36-6d867544ba66,1.1,ncau-data-newsquery-prd.sdm_snow.servicenow,6,7,"The query uses multiple CTEs and joins to calculate various incident SLA metrics, indicating moderate complexity. There's a good opportunity to consolidate related SLA achievement and breach metrics under common base identifiers.",5,monthly,
Responce_Achived,incident_response_status,Response Achieved Incidents,The count of incidents where the response SLA was achieved for the given month.,ncau-data-newsquery-prd,sdm_snow,servicenow,"WITH
  INC_RES AS (
    SELECT DISTINCT
      number,
      sla,
      start_time,
      stage,
      assignment_group,
      has_breached
    FROM
      `ncau-data-newsquery-prd.sdm_snow.servicenow`
    WHERE
      assignment_group = ""News Corp Australia - NewsQuery"" AND task_type = ""incident"" AND sla NOT LIKE '%Trial%' AND
      stage = ""Completed""
  )
SELECT
  EXTRACT(MONTH FROM DATE(start_time)) AS INC_MONTH,
  COUNT(number) AS Responce_Achived
FROM
  INC_RES
WHERE
  sla LIKE '%Response%' AND has_breached = ""false""
GROUP BY INC_MONTH",hardcoded_logic,bedebbe4-3e46-47d5-bc36-6d867544ba66,1.1,ncau-data-newsquery-prd.sdm_snow.servicenow,6,7,"The query uses multiple CTEs and joins to calculate various incident SLA metrics, indicating moderate complexity. There's a good opportunity to consolidate related SLA achievement and breach metrics under common base identifiers.",5,monthly,
Responce_Breached,incident_response_status,Response Breached Incidents,The count of incidents where the response SLA was breached for the given month.,ncau-data-newsquery-prd,sdm_snow,servicenow,"WITH
  INC_RES AS (
    SELECT DISTINCT
      number,
      sla,
      start_time,
      stage,
      assignment_group,
      has_breached
    FROM
      `ncau-data-newsquery-prd.sdm_snow.servicenow`
    WHERE
      assignment_group = ""News Corp Australia - NewsQuery"" AND task_type = ""incident"" AND sla NOT LIKE '%Trial%' AND
      stage = ""Completed""
  )
SELECT
  EXTRACT(MONTH FROM DATE(start_time)) AS INC_MONTH,
  COUNT(number) AS Responce_Breached
FROM
  INC_RES
WHERE
  sla LIKE '%Response%' AND has_breached = ""true""
GROUP BY INC_MONTH",hardcoded_logic,bedebbe4-3e46-47d5-bc36-6d867544ba66,1.1,ncau-data-newsquery-prd.sdm_snow.servicenow,6,7,"The query uses multiple CTEs and joins to calculate various incident SLA metrics, indicating moderate complexity. There's a good opportunity to consolidate related SLA achievement and breach metrics under common base identifiers.",5,monthly,
Resolution_Achived,incident_resolution_status,Resolution Achieved Incidents,The count of incidents where the resolution SLA was achieved for the given month.,ncau-data-newsquery-prd,sdm_snow,servicenow,"WITH
  INC_RES AS (
    SELECT DISTINCT
      number,
      sla,
      start_time,
      stage,
      assignment_group,
      has_breached
    FROM
      `ncau-data-newsquery-prd.sdm_snow.servicenow`
    WHERE
      assignment_group = ""News Corp Australia - NewsQuery"" AND task_type = ""incident"" AND sla NOT LIKE '%Trial%' AND
      stage = ""Completed""
  )
SELECT
  EXTRACT(MONTH FROM DATE(start_time)) AS INC_MONTH,
  COUNT(number) AS Resolution_Achived
FROM
  INC_RES
WHERE
  sla LIKE '%Resolve%' AND has_breached = ""false""
GROUP BY INC_MONTH",hardcoded_logic,bedebbe4-3e46-47d5-bc36-6d867544ba66,1.1,ncau-data-newsquery-prd.sdm_snow.servicenow,6,7,"The query uses multiple CTEs and joins to calculate various incident SLA metrics, indicating moderate complexity. There's a good opportunity to consolidate related SLA achievement and breach metrics under common base identifiers.",5,monthly,
Resolution_Breached,incident_resolution_status,Resolution Breached Incidents,The count of incidents where the resolution SLA was breached for the given month.,ncau-data-newsquery-prd,sdm_snow,servicenow,"WITH
  INC_RES AS (
    SELECT DISTINCT
      number,
      sla,
      start_time,
      stage,
      assignment_group,
      has_breached
    FROM
      `ncau-data-newsquery-prd.sdm_snow.servicenow`
    WHERE
      assignment_group = ""News Corp Australia - NewsQuery"" AND task_type = ""incident"" AND sla NOT LIKE '%Trial%' AND
      stage = ""Completed""
  )
SELECT
  EXTRACT(MONTH FROM DATE(start_time)) AS INC_MONTH,
  COUNT(number) AS Resolution_Breached
FROM
  INC_RES
WHERE
  sla LIKE '%Resolve%' AND has_breached = ""true""
GROUP BY INC_MONTH",hardcoded_logic,bedebbe4-3e46-47d5-bc36-6d867544ba66,1.1,ncau-data-newsquery-prd.sdm_snow.servicenow,6,7,"The query uses multiple CTEs and joins to calculate various incident SLA metrics, indicating moderate complexity. There's a good opportunity to consolidate related SLA achievement and breach metrics under common base identifiers.",5,monthly,
t0_qt_d0afk4jpwc,c_score_target_sum,Total C-Score Target,"The sum of c-score targets for a given week or period, used to track publication performance.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) AS t0_qt_d0afk4jpwc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0,,f60ad8ef-829d-4363-b705-c60a305ec777,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,2,9,"Low complexity due to simple aggregation (SUM) and single table usage. High consolidation potential as all queries calculate the same metric from the same table, differing only by hardcoded weekly date filters, which is a hardcoded_logic governance issue.",1,weekly,
t0_qt_1lzqww65bd,transaction_datetime_truncated,Transaction Datetime (Second Truncated),"The transaction date and time from the plus_rewards table, processed through multiple transformations and truncated to the nearest second.",ncau-data-newsquery-prd,sdm_rewards,plus_rewards,"SELECT DATETIME_TRUNC(PARSE_DATETIME('%Y-%m-%dT%H:%M:%S', FORMAT_TIMESTAMP('%Y-%m-%dT%H:%M:%S', SAFE_CAST(LOOKER_STUDIO.AUTO_DETECT_TO_DATETIME(SAFE_CAST(t0.transaction_date AS STRING)) AS TIMESTAMP))), SECOND) AS t0_qt_1lzqww65bd FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0 WHERE t0.dw_partition_date IN (SELECT MAX(dw_partition_date) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards`)",hardcoded_logic,a934f5eb-3b42-46f4-bd22-815444731247,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,7,8,"Complexity is high due to deeply nested subqueries and convoluted date/time transformations; consolidation potential is high as multiple metrics represent the same core count, differing only in grouping dimensions.",3,mixed,
t0_qt_yp617u65bd,total_records,"Total Records (Grouped by Member, Offer, and Truncated Datetime)","The count of records from the plus_rewards table, typically representing individual reward redemptions, grouped by newscorp member ID, offer details, and second-truncated transaction datetime.",ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(1) AS t0_qt_yp617u65bd FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` WHERE dw_partition_date IN (SELECT MAX(dw_partition_date) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards`),anti_pattern,a934f5eb-3b42-46f4-bd22-815444731247,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,7,8,"Complexity is high due to deeply nested subqueries and convoluted date/time transformations; consolidation potential is high as multiple metrics represent the same core count, differing only in grouping dimensions.",3,mixed,
t0_qt_nydh4y65bd,total_records,Total Records (Grouped by Offer),"The count of records from the plus_rewards table, typically representing individual reward redemptions, grouped by offer category, code, sub-category, and title.",ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(1) AS t0_qt_nydh4y65bd FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` WHERE dw_partition_date IN (SELECT MAX(dw_partition_date) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards`),anti_pattern,a934f5eb-3b42-46f4-bd22-815444731247,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,7,8,"Complexity is high due to deeply nested subqueries and convoluted date/time transformations; consolidation potential is high as multiple metrics represent the same core count, differing only in grouping dimensions.",3,mixed,
t0_qt_vos0o31xad,total_adjusted_weekly_price,Total Adjusted Weekly Price,"The sum of the adjusted weekly price for active, paying subscribers.",ncau-data-newsquery-prd,prstn_consumer,subscription_base,SELECT SUM(SAFE_CAST(t0.adjusted_weekly_price AS FLOAT64)) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_base` AS t0 WHERE t0.is_paying_flag = 'Y' AND t0.subscription_status_code = 'active',hardcoded_logic,d3723d73-7698-4fc2-b998-157308d5353f,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_base,5,2,Complexity is moderate due to nested subqueries and Looker Studio's generated SQL structure. Consolidation is low as each identified metric represents a distinct business concept.,5,none,
t0_qt_wos0o31xad,distinct_active_subscriptions,Distinct Active Subscriptions,"The count of unique subscription IDs for active, paying subscribers.",ncau-data-newsquery-prd,prstn_consumer,subscription_base,SELECT COUNT(DISTINCT SAFE_CAST(t0.subscription_id_src AS STRING)) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_base` AS t0 WHERE t0.is_paying_flag = 'Y' AND t0.subscription_status_code = 'active',hardcoded_logic,d3723d73-7698-4fc2-b998-157308d5353f,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_base,5,2,Complexity is moderate due to nested subqueries and Looker Studio's generated SQL structure. Consolidation is low as each identified metric represents a distinct business concept.,5,none,
t0_qt_xos0o31xad,max_subscriber_tenure_days,Max Subscriber Tenure Days,The maximum number of days a subscriber has been active and paying.,ncau-data-newsquery-prd,prstn_consumer,subscription_base,SELECT MAX(t0.subscriber_tenure_days) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_base` AS t0 WHERE t0.is_paying_flag = 'Y' AND t0.subscription_status_code = 'active',hardcoded_logic,d3723d73-7698-4fc2-b998-157308d5353f,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_base,5,2,Complexity is moderate due to nested subqueries and Looker Studio's generated SQL structure. Consolidation is low as each identified metric represents a distinct business concept.,5,none,
t0_qt_yos0o31xad,max_subscription_tenure_days,Max Subscription Tenure Days,The maximum number of days a subscription has been active and paying.,ncau-data-newsquery-prd,prstn_consumer,subscription_base,SELECT MAX(t0.subscription_tenure_days) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_base` AS t0 WHERE t0.is_paying_flag = 'Y' AND t0.subscription_status_code = 'active',hardcoded_logic,d3723d73-7698-4fc2-b998-157308d5353f,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_base,5,2,Complexity is moderate due to nested subqueries and Looker Studio's generated SQL structure. Consolidation is low as each identified metric represents a distinct business concept.,5,none,
t0_qt_2os0o31xad,total_subscription_tenure_days,Total Subscription Tenure Days,The sum of subscription tenure days across all subscriptions.,ncau-data-newsquery-prd,prstn_consumer,subscription_base,SELECT SUM(t0.subscription_tenure_days) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_base` AS t0,anti_pattern,d3723d73-7698-4fc2-b998-157308d5353f,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_base,5,2,Complexity is moderate due to nested subqueries and Looker Studio's generated SQL structure. Consolidation is low as each identified metric represents a distinct business concept.,5,none,
followers,followers,Followers,"The number of followers for an audio program, derived from Spotify demographic data.",ncau-data-newsquery-prd,prstn_content_audio_view,v_spotify_demographic,"SELECT
  t.followers
FROM
  (
    SELECT
      month,
      show,
      value,
      factor,
      level,
      url
    FROM
      `ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic` AS v
      LEFT JOIN
      (
        SELECT
          p.program_name,
          p.program_artwork_url AS url
        FROM
          `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
        WHERE
          p.dw_partition_date = (
            SELECT
              max(dw_partition_date)
            FROM
              `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
          )
      ) AS o
      ON v.show = o.program_name
    WHERE
      factor NOT IN ('age', 'gender')
  ) PIVOT(max(CAST(value AS decimal)) FOR factor IN ('followers', 'listeners', 'streams', 'starts')) AS t",hardcoded_logic,6a9da673-c8cd-4bd5-8743-77da4afcfa78,1.1,ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic;ncau-data-newsquery-prd.bdm_content_audio.program_dim,7,7,"The complexity is moderate due to nested subqueries, a LEFT JOIN, and a PIVOT function. The consolidation score is high because all identified metrics are derived from the same PIVOT operation on a single source table, indicating a centralized definition.",4,monthly,
listeners,listeners,Listeners,"The number of unique listeners for an audio program, derived from Spotify demographic data.",ncau-data-newsquery-prd,prstn_content_audio_view,v_spotify_demographic,"SELECT
  t.listeners
FROM
  (
    SELECT
      month,
      show,
      value,
      factor,
      level,
      url
    FROM
      `ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic` AS v
      LEFT JOIN
      (
        SELECT
          p.program_name,
          p.program_artwork_url AS url
        FROM
          `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
        WHERE
          p.dw_partition_date = (
            SELECT
              max(dw_partition_date)
            FROM
              `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
          )
      ) AS o
      ON v.show = o.program_name
    WHERE
      factor NOT IN ('age', 'gender')
  ) PIVOT(max(CAST(value AS decimal)) FOR factor IN ('followers', 'listeners', 'streams', 'starts')) AS t",hardcoded_logic,6a9da673-c8cd-4bd5-8743-77da4afcfa78,1.1,ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic;ncau-data-newsquery-prd.bdm_content_audio.program_dim,7,7,"The complexity is moderate due to nested subqueries, a LEFT JOIN, and a PIVOT function. The consolidation score is high because all identified metrics are derived from the same PIVOT operation on a single source table, indicating a centralized definition.",4,monthly,
streams,streams,Streams,"The total number of streams for an audio program, derived from Spotify demographic data.",ncau-data-newsquery-prd,prstn_content_audio_view,v_spotify_demographic,"SELECT
  t.streams
FROM
  (
    SELECT
      month,
      show,
      value,
      factor,
      level,
      url
    FROM
      `ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic` AS v
      LEFT JOIN
      (
        SELECT
          p.program_name,
          p.program_artwork_url AS url
        FROM
          `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
        WHERE
          p.dw_partition_date = (
            SELECT
              max(dw_partition_date)
            FROM
              `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
          )
      ) AS o
      ON v.show = o.program_name
    WHERE
      factor NOT IN ('age', 'gender')
  ) PIVOT(max(CAST(value AS decimal)) FOR factor IN ('followers', 'listeners', 'streams', 'starts')) AS t",hardcoded_logic,6a9da673-c8cd-4bd5-8743-77da4afcfa78,1.1,ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic;ncau-data-newsquery-prd.bdm_content_audio.program_dim,7,7,"The complexity is moderate due to nested subqueries, a LEFT JOIN, and a PIVOT function. The consolidation score is high because all identified metrics are derived from the same PIVOT operation on a single source table, indicating a centralized definition.",4,monthly,
starts,starts,Starts,"The number of times an audio program was started, derived from Spotify demographic data.",ncau-data-newsquery-prd,prstn_content_audio_view,v_spotify_demographic,"SELECT
  t.starts
FROM
  (
    SELECT
      month,
      show,
      value,
      factor,
      level,
      url
    FROM
      `ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic` AS v
      LEFT JOIN
      (
        SELECT
          p.program_name,
          p.program_artwork_url AS url
        FROM
          `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
        WHERE
          p.dw_partition_date = (
            SELECT
              max(dw_partition_date)
            FROM
              `ncau-data-newsquery-prd`.bdm_content_audio.program_dim AS p
          )
      ) AS o
      ON v.show = o.program_name
    WHERE
      factor NOT IN ('age', 'gender')
  ) PIVOT(max(CAST(value AS decimal)) FOR factor IN ('followers', 'listeners', 'streams', 'starts')) AS t",hardcoded_logic,6a9da673-c8cd-4bd5-8743-77da4afcfa78,1.1,ncau-data-newsquery-prd.prstn_content_audio_view.v_spotify_demographic;ncau-data-newsquery-prd.bdm_content_audio.program_dim,7,7,"The complexity is moderate due to nested subqueries, a LEFT JOIN, and a PIVOT function. The consolidation score is high because all identified metrics are derived from the same PIVOT operation on a single source table, indicating a centralized definition.",4,monthly,
t0_qt_73ldtxh0lc,total_c_score_target,Total C-Score Target,The sum of the c-score target for a given publication group and week.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-05-26' AND t0.week_ending <= DATE '2025-06-01'),hardcoded_logic,8531208f-5b20-40d0-8b57-2d15ac1fca33,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,1,"Low complexity due to simple aggregation and no joins. Low consolidation score as only one unique metric definition was identified, limiting opportunities for consolidation across different metric IDs.",1,weekly,
t0c0d1_qt_0iwgc1soqd,total_article_words,Total Article Body Words Count,The sum of words in the article body for a given content ID.,ncau-data-newsquery-prd,bdm_verity,content_dim,SELECT SUM(t0c0d1.article_body_words_count) FROM `ncau-data-newsquery-prd.bdm_verity.content_dim` AS t0c0d1 WHERE NOT(t0c0d1.article_body_words_count IS NULL),anti_pattern,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_D15136277849920501192,total_video_time_spent_instances,Total Video Time Spent Instances (Alias 1),"The sum of instances where video time was spent, filtered by date and publication group.",ncau-data-newsquery-prd,prstn_verity,content_video_summary,"SELECT SUM(t0.video_time_spent_instance_count) FROM `ncau-data-newsquery-prd.prstn_verity.content_video_summary` AS t0 WHERE FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) >= '20250101' AND FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) <= '20250317' AND t0.PublicationGroup = 'The Australian'",hardcoded_logic,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_D2689994529155322464,total_video_time_spent,Total Video Time Spent (Alias 1),"The sum of total time spent watching videos, filtered by date and publication group.",ncau-data-newsquery-prd,prstn_verity,content_video_summary,"SELECT SUM(t0.video_time_spent_count) FROM `ncau-data-newsquery-prd.prstn_verity.content_video_summary` AS t0 WHERE FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) >= '20250101' AND FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) <= '20250317' AND t0.PublicationGroup = 'The Australian'",hardcoded_logic,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_qt_jhrfpw1oqd,total_video_time_spent_instances,Total Video Time Spent Instances (Alias 2),"The sum of instances where video time was spent, filtered by date and publication group. This is a redundant alias for the same underlying metric.",ncau-data-newsquery-prd,prstn_verity,content_video_summary,"SELECT SUM(t0.video_time_spent_instance_count) FROM `ncau-data-newsquery-prd.prstn_verity.content_video_summary` AS t0 WHERE FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) >= '20250101' AND FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) <= '20250317' AND t0.PublicationGroup = 'The Australian'",hardcoded_logic,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_qt_k3y4rhupqd,total_video_time_spent,Total Video Time Spent (Alias 2),"The sum of total time spent watching videos, filtered by date and publication group. This is a redundant alias for the same underlying metric.",ncau-data-newsquery-prd,prstn_verity,content_video_summary,"SELECT SUM(t0.video_time_spent_count) FROM `ncau-data-newsquery-prd.prstn_verity.content_video_summary` AS t0 WHERE FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) >= '20250101' AND FORMAT_TIMESTAMP('%Y%m%d', t0.content_updated_date) <= '20250317' AND t0.PublicationGroup = 'The Australian'",hardcoded_logic,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_qt_3m0r54roqd,distinct_author_count,Distinct Author Count,"The count of unique authors associated with articles, derived by unnesting the contentauthors array.",ncau-data-newsquery-prd,bdm_verity,content_dim,SELECT COUNT(DISTINCT t0_contentauthors.name) FROM `ncau-data-newsquery-prd.bdm_verity.content_dim` AS t0 LEFT JOIN UNNEST(t0.contentauthors) AS t0_contentauthors,anti_pattern,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_qt_gn0r54roqd,total_article_words,Total Article Body Words Count (Aggregated),"The sum of words in the article body across all articles, potentially overcounted if articles have multiple authors due to UNNEST.",ncau-data-newsquery-prd,bdm_verity,content_dim,SELECT SUM(t0.article_body_words_count) FROM `ncau-data-newsquery-prd.bdm_verity.content_dim` AS t0 LEFT JOIN UNNEST(t0.contentauthors) AS t0_contentauthors,anti_pattern,d5fd8b83-22d8-478f-8e22-b9e83bda01f2,1.1,ncau-data-newsquery-prd.bdm_verity.content_dim;ncau-data-newsquery-prd.prstn_verity.content_video_summary,4,8,"The queries are relatively simple, primarily using SUM and COUNT, with one LEFT JOIN UNNEST. There is high potential for metric consolidation as several metrics represent the same underlying data aggregated differently or aliased redundantly.",7,daily,
t0_qt_qcox8aj6qd,content_starts,Content Starts,The total number of content starts across all platforms.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_daily_traffic,SELECT SUM(t0.hv_content_starts) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic` AS t0,,1f134ccb-ed11-45d8-ac05-916f31640357,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic,2,6,"The queries are simple, involving basic aggregations on single tables with no joins or complex logic, indicating low complexity. There is moderate consolidation potential as two distinct metrics share a common base concept of 'content starts'.",3,daily,
t0_qt_fp5np5y4zc,page_views_per_visit,Page Views Per Visit,"The average number of page views per visit, calculated as total page views divided by total visits across web and AMP.",ncau-data-newsquery-prd,prstn_content_interaction,newscomau_daily_traffic,"SELECT SUM(SAFE_DIVIDE((t0.web_page_views + t0.amp_page_views), (t0.web_visits + t0.amp_visits))) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic` AS t0",,1f134ccb-ed11-45d8-ac05-916f31640357,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic,2,6,"The queries are simple, involving basic aggregations on single tables with no joins or complex logic, indicating low complexity. There is moderate consolidation potential as two distinct metrics share a common base concept of 'content starts'.",3,daily,
t0_qt_pv1ffbj6qd,content_starts,Mobile Content Starts,The total number of content starts specifically from mobile devices.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_daily_traffic,SELECT SUM(t0.hv_mobile_content_starts) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic` AS t0,,1f134ccb-ed11-45d8-ac05-916f31640357,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic,2,6,"The queries are simple, involving basic aggregations on single tables with no joins or complex logic, indicating low complexity. There is moderate consolidation potential as two distinct metrics share a common base concept of 'content starts'.",3,daily,
t0_qt_nhw2hzzgvd,traffic_count,Total Traffic Count by Channel and Date,"The sum of traffic counts, typically grouped by channel and visit start date, representing website or application visits.",nau-data-nprod-dataservices,auyeunga_sandbox,traffic_by_channel,SELECT SUM(t0.traffic_count) AS t0_qt_nhw2hzzgvd FROM `nau-data-nprod-dataservices.auyeunga_sandbox.traffic_by_channel` AS t0,hardcoded_logic,83a1c0b2-67b2-4d3e-8bc4-98a9f3683ad1,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.traffic_by_channel,2,8,Complexity is low due to simple aggregations and no joins/window functions. Consolidation is high as multiple metric aliases point to the same underlying 'traffic_count' base metric.,2,daily,
t0_qt_4jqphriavd,traffic_count,Total Traffic Count by Masthead,"The sum of traffic counts, typically grouped by masthead, representing website or application visits.",nau-data-nprod-dataservices,auyeunga_sandbox,traffic_by_channel,SELECT SUM(t0.traffic_count) AS t0_qt_4jqphriavd FROM `nau-data-nprod-dataservices.auyeunga_sandbox.traffic_by_channel` AS t0,none,83a1c0b2-67b2-4d3e-8bc4-98a9f3683ad1,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.traffic_by_channel,2,8,Complexity is low due to simple aggregations and no joins/window functions. Consolidation is high as multiple metric aliases point to the same underlying 'traffic_count' base metric.,2,daily,
t0_qt_j2b9jbhclc,c_score_target,Total C-Score Target by Publication Group (2025-06-02 to 2025-06-08),"The sum of c-score targets for the week of 2025-06-02 to 2025-06-08, broken down by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-06-02' AND t0.week_ending <= DATE '2025-06-08' GROUP BY t0.publication_group",,19891283-911c-4528-b830-c99e4cb76155,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Complexity is low due to simple aggregation and single table queries; consolidation is high as all metrics are the same base metric differing only by hardcoded date ranges.,6,weekly,
t0_qt_j2b9jbhclc,c_score_target,Total C-Score Target by Publication Group (2025-03-24 to 2025-03-30),"The sum of c-score targets for the week of 2025-03-24 to 2025-03-30, broken down by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-03-24' AND t0.week_ending <= DATE '2025-03-30' GROUP BY t0.publication_group",,19891283-911c-4528-b830-c99e4cb76155,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Complexity is low due to simple aggregation and single table queries; consolidation is high as all metrics are the same base metric differing only by hardcoded date ranges.,6,weekly,
t0_qt_j2b9jbhclc,c_score_target,Total C-Score Target by Publication Group (2025-06-16 to 2025-06-22),"The sum of c-score targets for the week of 2025-06-16 to 2025-06-22, broken down by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-06-16' AND t0.week_ending <= DATE '2025-06-22' GROUP BY t0.publication_group",,19891283-911c-4528-b830-c99e4cb76155,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Complexity is low due to simple aggregation and single table queries; consolidation is high as all metrics are the same base metric differing only by hardcoded date ranges.,6,weekly,
t0_qt_j2b9jbhclc,c_score_target,Total C-Score Target by Publication Group (2025-03-17 to 2025-03-23),"The sum of c-score targets for the week of 2025-03-17 to 2025-03-23, broken down by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-03-17' AND t0.week_ending <= DATE '2025-03-23' GROUP BY t0.publication_group",,19891283-911c-4528-b830-c99e4cb76155,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Complexity is low due to simple aggregation and single table queries; consolidation is high as all metrics are the same base metric differing only by hardcoded date ranges.,6,weekly,
t0_qt_j2b9jbhclc,c_score_target,Total C-Score Target by Publication Group (2025-04-28 to 2025-05-04),"The sum of c-score targets for the week of 2025-04-28 to 2025-05-04, broken down by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-04-28' AND t0.week_ending <= DATE '2025-05-04' GROUP BY t0.publication_group",,19891283-911c-4528-b830-c99e4cb76155,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Complexity is low due to simple aggregation and single table queries; consolidation is high as all metrics are the same base metric differing only by hardcoded date ranges.,6,weekly,
t0_qt_j2b9jbhclc,c_score_target,Total C-Score Target by Publication Group (2025-04-07 to 2025-04-13),"The sum of c-score targets for the week of 2025-04-07 to 2025-04-13, broken down by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-04-07' AND t0.week_ending <= DATE '2025-04-13' GROUP BY t0.publication_group",,19891283-911c-4528-b830-c99e4cb76155,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Complexity is low due to simple aggregation and single table queries; consolidation is high as all metrics are the same base metric differing only by hardcoded date ranges.,6,weekly,
t0_qt_dkkp0cmsrd,sum_financial_week,Sum of Financial Week,"The sum of financial week numbers for ad sales performance records, filtered by specific criteria including financial years 2024-2025 and digital revenue, excluding certain publication types and specific financial weeks.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_CAST(t0.financial_week AS INT64)) AS t0_qt_dkkp0cmsrd FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.style_name != 'PRODUCTION' AND t0.unified_publication_name NOT IN ('Admin.Sales', 'Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Qantas Travel Insider', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'Stockhead', 'TAUS.ADMIN', 'Taste.Admin', 'Vogue.Admin', 'Vogueliving.Admin', 'TOOWOOMBACUSTOM', 'odds.com.au', 'Shortlyster Managed Service NWN', 'Shortlyster Managed Service', 'Shortlyster Managed Service NQN', 'Shortlyster Managed Service GAD', 'SUDDENLY.TGG', 'SUDDENLY.CW', 'SUDDENLY.NORTH') AND t0.financial_year IN ('2025', '2024') AND t0.revenue_group_subtype IN ('DIGITAL') AND (SAFE_CAST(t0.financial_week AS INT64) NOT IN (47, 48, 49, 50, 51, 52) OR SAFE_CAST(t0.financial_week AS INT64) IS NULL)",hardcoded_logic,3ee20092-1897-49b7-8bcd-4157d5f816eb,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,4,2,"The queries involve nested subqueries and multiple hardcoded filters, indicating moderate complexity. Low consolidation potential as identified metrics are distinct.",2,weekly,
t0_qt_p7jcoqptod,total_gross_revenue,Total Gross Revenue Amount,"The sum of gross revenue amounts for ad sales performance records, filtered by specific criteria including financial years 2024-2025 and digital revenue, excluding certain publication types and specific financial weeks.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(t0.gross_revenue_amount) AS t0_qt_p7jcoqptod FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.style_name != 'PRODUCTION' AND t0.unified_publication_name NOT IN ('Admin.Sales', 'Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Qantas Travel Insider', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'Stockhead', 'TAUS.ADMIN', 'Taste.Admin', 'Vogue.Admin', 'Vogueliving.Admin', 'TOOWOOMBACUSTOM', 'odds.com.au', 'Shortlyster Managed Service NWN', 'Shortlyster Managed Service', 'Shortlyster Managed Service NQN', 'Shortlyster Managed Service GAD', 'SUDDENLY.TGG', 'SUDDENLY.CW', 'SUDDENLY.NORTH') AND t0.financial_year IN ('2025', '2024') AND t0.revenue_group_subtype IN ('DIGITAL') AND (SAFE_CAST(t0.financial_week AS INT64) NOT IN (47, 48, 49, 50, 51, 52) OR SAFE_CAST(t0.financial_week AS INT64) IS NULL)",hardcoded_logic,3ee20092-1897-49b7-8bcd-4157d5f816eb,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,4,2,"The queries involve nested subqueries and multiple hardcoded filters, indicating moderate complexity. Low consolidation potential as identified metrics are distinct.",2,weekly,
t0_qt_r93oq36xmd,record_count,Record Count - Health/Wellness (Non-Aus/Global Pubs),"Counts the total number of content records related to health or wellness topics, excluding content from 'The Australian' and 'Global syndication' publication groups, within a specific subscription date range.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT COUNT(1) AS t0_qt_r93oq36xmd FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0 WHERE (t0.SubscriptionDateTime >= TIMESTAMP '2025-07-10' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-07-16', INTERVAL 1 DAY) AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'Health|health|Wellness|wellness') OR t0.ArticleDominantSection1 = 'health') AND t0.PublicationGroup != 'The Australian' AND t0.PublicationGroup != 'Global syndication')",hardcoded_logic,89140d65-10c7-4de8-9dfa-f5585b101519,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,2,9,"Low complexity due to simple COUNT(1) aggregation and no joins or window functions. High consolidation potential as both metrics are variations of a record count from the same base table, differing only by hardcoded filter conditions.",2,daily,
t0_qt_2uiercfxmd,record_count,Record Count - Health (Aus/Global Syn/Dow Jones Pubs),"Counts the total number of content records related to health topics, originating from 'Australian' or 'Global syn' publication groups or 'Dow Jones' article rights source, within a specific subscription date range.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT COUNT(1) AS t0_qt_2uiercfxmd FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0 WHERE (t0.SubscriptionDateTime >= TIMESTAMP '2025-03-31' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-04-06', INTERVAL 1 DAY) AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.PublicationGroup AS STRING), 'Australian|Global syn') OR t0.ArticleRightsSource = 'Dow Jones') AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'Health|health') OR t0.ArticleDominantSection1 = 'health'))",hardcoded_logic,89140d65-10c7-4de8-9dfa-f5585b101519,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,2,9,"Low complexity due to simple COUNT(1) aggregation and no joins or window functions. High consolidation potential as both metrics are variations of a record count from the same base table, differing only by hardcoded filter conditions.",2,daily,
t0_qt_8nll1rxk6c_20250614_20250616,record_count,"Record Count (June 14-16, 2025)","Counts the total number of records from the subscription targets table for the date range June 14, 2025 to June 16, 2025.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT COUNT(1) AS t0_qt_8nll1rxk6c FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-06-14' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-06-16'","hardcoded_logic, anti_pattern",0823e425-5885-4fd6-b89e-5c9508f3cf1d,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,9,"Complexity is low due to simple functions and no joins, but excessive subquery nesting for simple transformations adds minor complexity. Consolidation is high as all metrics are variations of a simple record count, differing only by hardcoded date filters.",3,daily,
t0_qt_8nll1rxk6c_20250615_20250621,record_count,"Record Count (June 15-21, 2025)","Counts the total number of records from the subscription targets table for the date range June 15, 2025 to June 21, 2025.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT COUNT(1) AS t0_qt_8nll1rxk6c FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-06-15' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-06-21'","hardcoded_logic, anti_pattern",0823e425-5885-4fd6-b89e-5c9508f3cf1d,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,9,"Complexity is low due to simple functions and no joins, but excessive subquery nesting for simple transformations adds minor complexity. Consolidation is high as all metrics are variations of a simple record count, differing only by hardcoded date filters.",3,daily,
t0_qt_8nll1rxk6c_20250408_20250414,record_count,"Record Count (April 08-14, 2025)","Counts the total number of records from the subscription targets table for the date range April 08, 2025 to April 14, 2025.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT COUNT(1) AS t0_qt_8nll1rxk6c FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-04-08' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-04-14'","hardcoded_logic, anti_pattern",0823e425-5885-4fd6-b89e-5c9508f3cf1d,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,9,"Complexity is low due to simple functions and no joins, but excessive subquery nesting for simple transformations adds minor complexity. Consolidation is high as all metrics are variations of a simple record count, differing only by hardcoded date filters.",3,daily,
t0_qt_rk9umdgnud,social_page_views,Total Social Page Views,The total number of page views attributed to social media sources.,ncau-data-newsquery-prd,prstn_content_interaction,nca_daily_update_traffic,SELECT SUM(social_page_views) FROM `ncau-data-newsquery-prd.prstn_content_interaction.nca_daily_update_traffic`,none,ed91d3f4-4175-4293-a648-e8dbca4cea93,1.1,ncau-data-newsquery-prd.prstn_content_interaction.nca_daily_update_traffic,3,3,"The queries are simple, involving basic aggregations and no joins or complex functions, leading to low complexity; consolidation is limited as the identified metrics represent distinct types of page views.",2,daily,
t0_qt_x1h05l6mud,web_page_views,Total Web Page Views,The total number of page views attributed to web browser sources.,ncau-data-newsquery-prd,prstn_content_interaction,nca_daily_update_traffic,SELECT SUM(web_page_views) FROM `ncau-data-newsquery-prd.prstn_content_interaction.nca_daily_update_traffic`,none,ed91d3f4-4175-4293-a648-e8dbca4cea93,1.1,ncau-data-newsquery-prd.prstn_content_interaction.nca_daily_update_traffic,3,3,"The queries are simple, involving basic aggregations and no joins or complex functions, leading to low complexity; consolidation is limited as the identified metrics represent distinct types of page views.",2,daily,
t0_qt_u22hcf8klc,c_score_target,Total C-Score Target for Messenger,The total sum of the c-score target specifically for the 'Messenger' publication group within a hardcoded annual date range.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2023-07-03' AND t0.week_ending <= DATE '2024-06-30' AND t0.publication_group = 'Messenger',hardcoded_logic,0546f07c-bb7b-4ec0-aba8-06c738dd12ec,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,"Queries are simple aggregations on a single table with no joins or complex functions, and all metrics derive from the same base column, indicating high consolidation potential.",2,weekly,
t0_qt_j2b9jbhclc,c_score_target,C-Score Target by Publication Group,"The sum of the c-score target, grouped by publication group, for a specific hardcoded weekly period.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2025-03-31' AND t0.week_ending <= DATE '2025-04-06' GROUP BY t0.publication_group,hardcoded_logic,0546f07c-bb7b-4ec0-aba8-06c738dd12ec,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,"Queries are simple aggregations on a single table with no joins or complex functions, and all metrics derive from the same base column, indicating high consolidation potential.",2,weekly,
clmn1_,content_reference_id,Content Reference ID,A unique identifier for a content reference associated with a CAPI collection entry.,ncau-data-newsquery-prd,cdm_capi,capi_collection,SELECT t0_contentreferences.id FROM `ncau-data-newsquery-prd.cdm_capi.capi_collection` AS t0 LEFT JOIN UNNEST(t0.contentreferences) AS t0_contentreferences,none,ae3044ce-064d-4d74-90fc-2cf45afa04ee,1.1,ncau-data-newsquery-prd.cdm_capi.capi_collection,4,8,"The complexity is moderate due to nested date transformations and unnesting. Consolidation benefit is high as multiple metrics are aliases for the same calculated date field, and a common filter value ('content_id') is hardcoded across all queries.",4,daily,
t0_qt_pq57p9l8hd,ingest_date_adjusted,Ingest Date (Adjusted),"The date of data ingestion, adjusted by a 10-hour offset, derived from dw_src_ingest_time.",ncau-data-newsquery-prd,cdm_capi,capi_collection,"SELECT SAFE_CAST(DATETIME_ADD(DATETIME_TRUNC(SAFE_CAST(t0.dw_src_ingest_time AS DATETIME), SECOND), INTERVAL 10 HOUR) AS DATE) FROM `ncau-data-newsquery-prd.cdm_capi.capi_collection` AS t0",hardcoded_logic,ae3044ce-064d-4d74-90fc-2cf45afa04ee,1.1,ncau-data-newsquery-prd.cdm_capi.capi_collection,4,8,"The complexity is moderate due to nested date transformations and unnesting. Consolidation benefit is high as multiple metrics are aliases for the same calculated date field, and a common filter value ('content_id') is hardcoded across all queries.",4,daily,
clmn0_,content_id,Content ID,The unique identifier for the content within the CAPI collection.,ncau-data-newsquery-prd,cdm_capi,capi_collection,SELECT t0.content_id FROM `ncau-data-newsquery-prd.cdm_capi.capi_collection` AS t0,none,ae3044ce-064d-4d74-90fc-2cf45afa04ee,1.1,ncau-data-newsquery-prd.cdm_capi.capi_collection,4,8,"The complexity is moderate due to nested date transformations and unnesting. Consolidation benefit is high as multiple metrics are aliases for the same calculated date field, and a common filter value ('content_id') is hardcoded across all queries.",4,daily,
t0_qt_nr7ouhp8hd,ingest_date_adjusted,Ingest Date (Adjusted),"The date of data ingestion, adjusted by a 10-hour offset, derived from dw_src_ingest_time.",ncau-data-newsquery-prd,cdm_capi,capi_collection,"SELECT SAFE_CAST(DATETIME_ADD(DATETIME_TRUNC(SAFE_CAST(t0.dw_src_ingest_time AS DATETIME), SECOND), INTERVAL 10 HOUR) AS DATE) FROM `ncau-data-newsquery-prd.cdm_capi.capi_collection` AS t0",hardcoded_logic,ae3044ce-064d-4d74-90fc-2cf45afa04ee,1.1,ncau-data-newsquery-prd.cdm_capi.capi_collection,4,8,"The complexity is moderate due to nested date transformations and unnesting. Consolidation benefit is high as multiple metrics are aliases for the same calculated date field, and a common filter value ('content_id') is hardcoded across all queries.",4,daily,
t0_qt_73ldtxh0lc,c_score_target,C-Score Target Sum,"Represents the aggregated target score for content or audience engagement, used for performance tracking.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-06-16' AND t0.week_ending <= DATE '2025-06-22'),"hardcoded_logic, anti_pattern",bb705701-76b0-40eb-bc6f-0159956fda7a,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,2,9,"Complexity is low due to simple aggregation and no joins. Consolidation benefit is high as all queries use the same metric alias and source table, differing only by date filters.",1,weekly,
t0_qt_73ldtxh0lc,c_score_target_sum,Sum of C-Score Target (Week of 2025-05-12),The sum of the c-score target for the week ending 2025-05-18.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-05-12' AND t0.week_ending <= DATE '2025-05-18'),hardcoded_logic,57a6a6b6-710d-4258-968d-35ab9a7704e5,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"The queries are simple, involving a single aggregation on a single table, but all identified metrics are variations of the same base metric, differing only by hardcoded date filters, indicating high consolidation potential.",3,weekly,
t0_qt_73ldtxh0lc,c_score_target_sum,Sum of C-Score Target (Week of 2025-03-03),The sum of the c-score target for the week ending 2025-03-09.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-03-03' AND t0.week_ending <= DATE '2025-03-09'),hardcoded_logic,57a6a6b6-710d-4258-968d-35ab9a7704e5,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"The queries are simple, involving a single aggregation on a single table, but all identified metrics are variations of the same base metric, differing only by hardcoded date filters, indicating high consolidation potential.",3,weekly,
t0_qt_73ldtxh0lc,c_score_target_sum,Sum of C-Score Target (Week of 2025-04-21),The sum of the c-score target for the week ending 2025-04-27.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-04-21' AND t0.week_ending <= DATE '2025-04-27'),hardcoded_logic,57a6a6b6-710d-4258-968d-35ab9a7704e5,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"The queries are simple, involving a single aggregation on a single table, but all identified metrics are variations of the same base metric, differing only by hardcoded date filters, indicating high consolidation potential.",3,weekly,
t0_qt_j2b9jbhclc_2025_07_21_to_27,sum_c_score_target,Sum of C-Score Target (Week 2025-07-21 to 2025-07-27),"The sum of the c-score target for the week ending 2025-07-27, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_j2b9jbhclc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-07-21' AND clmn2_ <= DATE '2025-07-27') GROUP BY clmn1_ LIMIT 2000001;",,1147dd47-ccea-49cb-bff0-6019f3249bc9,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics are variations of the same sum from the same table, differing only by hardcoded date filters, indicating a need for a parameterized date dimension.",5,weekly,
t0_qt_j2b9jbhclc_2023_07_03_to_2024_06_30,sum_c_score_target,Sum of C-Score Target (FY 2023-2024),"The sum of the c-score target for the fiscal year 2023-2024, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_j2b9jbhclc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2023-07-03' AND clmn2_ <= DATE '2024-06-30') GROUP BY clmn1_ LIMIT 2000001;",,1147dd47-ccea-49cb-bff0-6019f3249bc9,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics are variations of the same sum from the same table, differing only by hardcoded date filters, indicating a need for a parameterized date dimension.",5,weekly,
t0_qt_j2b9jbhclc_2025_06_23_to_29,sum_c_score_target,Sum of C-Score Target (Week 2025-06-23 to 2025-06-29),"The sum of the c-score target for the week ending 2025-06-29, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_j2b9jbhclc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-06-23' AND clmn2_ <= DATE '2025-06-29') GROUP BY clmn1_ LIMIT 2000001;",,1147dd47-ccea-49cb-bff0-6019f3249bc9,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics are variations of the same sum from the same table, differing only by hardcoded date filters, indicating a need for a parameterized date dimension.",5,weekly,
t0_qt_j2b9jbhclc_2025_04_28_to_05_04,sum_c_score_target,Sum of C-Score Target (Week 2025-04-28 to 2025-05-04),"The sum of the c-score target for the week ending 2025-05-04, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_j2b9jbhclc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-04-28' AND clmn2_ <= DATE '2025-05-04') GROUP BY clmn1_ LIMIT 2000001;",,1147dd47-ccea-49cb-bff0-6019f3249bc9,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics are variations of the same sum from the same table, differing only by hardcoded date filters, indicating a need for a parameterized date dimension.",5,weekly,
t0_qt_j2b9jbhclc_2025_04_21_to_27,sum_c_score_target,Sum of C-Score Target (Week 2025-04-21 to 2025-04-27),"The sum of the c-score target for the week ending 2025-04-27, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_j2b9jbhclc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-04-21' AND clmn2_ <= DATE '2025-04-27') GROUP BY clmn1_ LIMIT 2000001;",,1147dd47-ccea-49cb-bff0-6019f3249bc9,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics are variations of the same sum from the same table, differing only by hardcoded date filters, indicating a need for a parameterized date dimension.",5,weekly,
t0_qt_j2yebv3ivd,total_sales_volume,Total Sales Volume,The aggregated sales volume across various channels or periods.,ncau-data-newsquery-prd,sbx_fda_noncorefin,dt_regression_data,SELECT SUM(Sales_volume) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data`,none,b3eace25-3ec3-427a-839f-0639faf377ea,1.1,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,1,8,"Complexity is low due to simple aggregation functions and no joins. Consolidation is high as multiple metrics represent the same underlying business concept (Sales Volume, Sum of Year) with different aliases.",6,mixed,
t0_qt_h0yxkz2ivd,sum_of_year,Sum of Year,"The sum of the 'Year' column, likely representing a count of records or a misconfigured metric.",ncau-data-newsquery-prd,sbx_fda_noncorefin,dt_regression_data,SELECT SUM(Year) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data`,anti_pattern,b3eace25-3ec3-427a-839f-0639faf377ea,1.1,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,1,8,"Complexity is low due to simple aggregation functions and no joins. Consolidation is high as multiple metrics represent the same underlying business concept (Sales Volume, Sum of Year) with different aliases.",6,mixed,
t0_qt_vxf15k3ivd,total_sales_volume,Total Sales Volume,The aggregated sales volume across various channels or periods.,ncau-data-newsquery-prd,sbx_fda_noncorefin,dt_regression_data,SELECT SUM(Sales_volume) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data`,none,b3eace25-3ec3-427a-839f-0639faf377ea,1.1,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,1,8,"Complexity is low due to simple aggregation functions and no joins. Consolidation is high as multiple metrics represent the same underlying business concept (Sales Volume, Sum of Year) with different aliases.",6,mixed,
t0_qt_b1b61v5hvd,total_sales_volume,Total Sales Volume,The aggregated sales volume across various channels or periods.,ncau-data-newsquery-prd,sbx_fda_noncorefin,dt_regression_data,SELECT SUM(Sales_volume) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data`,none,b3eace25-3ec3-427a-839f-0639faf377ea,1.1,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,1,8,"Complexity is low due to simple aggregation functions and no joins. Consolidation is high as multiple metrics represent the same underlying business concept (Sales Volume, Sum of Year) with different aliases.",6,mixed,
t0_qt_xqk79j3ivd,sum_of_year,Sum of Year,"The sum of the 'Year' column, likely representing a count of records or a misconfigured metric.",ncau-data-newsquery-prd,sbx_fda_noncorefin,dt_regression_data,SELECT SUM(Year) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data`,anti_pattern,b3eace25-3ec3-427a-839f-0639faf377ea,1.1,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,1,8,"Complexity is low due to simple aggregation functions and no joins. Consolidation is high as multiple metrics represent the same underlying business concept (Sales Volume, Sum of Year) with different aliases.",6,mixed,
t0_qt_yqk79j3ivd,sum_of_week,Sum of Week,"The sum of the 'Week' column, likely representing a count of records or a misconfigured metric.",ncau-data-newsquery-prd,sbx_fda_noncorefin,dt_regression_data,SELECT SUM(Week) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data`,anti_pattern,b3eace25-3ec3-427a-839f-0639faf377ea,1.1,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,1,8,"Complexity is low due to simple aggregation functions and no joins. Consolidation is high as multiple metrics represent the same underlying business concept (Sales Volume, Sum of Year) with different aliases.",6,mixed,
t0_qt_7lgxwt0qld,unique_contacts,Unique Contacts,Counts the number of distinct contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,4b158218-2a09-443c-929a-a7f5dae09979,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation is high as all identified metrics are identical calculations, differing only by alias, indicating a strong opportunity for consolidation.",6,none,
t0_qt_9i4hvt0qld,unique_contacts,Unique Contacts,Counts the number of distinct contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,4b158218-2a09-443c-929a-a7f5dae09979,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation is high as all identified metrics are identical calculations, differing only by alias, indicating a strong opportunity for consolidation.",6,none,
t0_qt_i16fxt0qld,unique_contacts,Unique Contacts,Counts the number of distinct contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,4b158218-2a09-443c-929a-a7f5dae09979,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation is high as all identified metrics are identical calculations, differing only by alias, indicating a strong opportunity for consolidation.",6,none,
t0_qt_wxh9vs0qld,unique_contacts,Unique Contacts,Counts the number of distinct contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,4b158218-2a09-443c-929a-a7f5dae09979,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation is high as all identified metrics are identical calculations, differing only by alias, indicating a strong opportunity for consolidation.",6,none,
t0_qt_yx08vt0qld,unique_contacts,Unique Contacts,Counts the number of distinct contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,4b158218-2a09-443c-929a-a7f5dae09979,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation is high as all identified metrics are identical calculations, differing only by alias, indicating a strong opportunity for consolidation.",6,none,
t0_qt_e9w8mhvbkd,unique_contacts,Unique Contacts,Counts the number of distinct contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,4b158218-2a09-443c-929a-a7f5dae09979,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation is high as all identified metrics are identical calculations, differing only by alias, indicating a strong opportunity for consolidation.",6,none,
clmn1_,vendor,Vendor,"The name of the vendor associated with the RCTI file, filtered by a specific draw date range.",ncau-data-newsquery-prd,finance_monthend_checks,v_rcti_files_check,SELECT t0.vendor FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_rcti_files_check` AS t0 WHERE t0.draw_date >= DATE '2025-03-23' AND t0.draw_date <= DATE '2025-03-29',hardcoded_logic,712ca6fe-b491-4a01-af6e-1495fb3c7d12,1.1,ncau-data-newsquery-prd.finance_monthend_checks.v_rcti_files_check;ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check;ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check,1,1,The complexity is low due to simple SELECTs without joins or advanced SQL features; consolidation is low as each identified metric is unique in its base concept and source.,3,weekly,
t0_qt_hxtf6xr3od,total_revenue,Total Revenue (Persisted OS Nulls Check),The sum of revenue values from the persisted OS nulls check.,ncau-data-newsquery-prd,finance_monthend_checks,v_persisted_os_nulls_Check,SELECT SUM(t0.rev) FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check` AS t0,anti_pattern,712ca6fe-b491-4a01-af6e-1495fb3c7d12,1.1,ncau-data-newsquery-prd.finance_monthend_checks.v_rcti_files_check;ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check;ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check,1,1,The complexity is low due to simple SELECTs without joins or advanced SQL features; consolidation is low as each identified metric is unique in its base concept and source.,3,weekly,
clmn0_,fiscal_month_id,Fiscal Month ID,"The identifier for the fiscal month, used in the missing business check.",ncau-data-newsquery-prd,finance_monthend_checks,v_missing_Bus_check,SELECT t0.fiscal_month_id FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check` AS t0,anti_pattern,712ca6fe-b491-4a01-af6e-1495fb3c7d12,1.1,ncau-data-newsquery-prd.finance_monthend_checks.v_rcti_files_check;ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check;ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check,1,1,The complexity is low due to simple SELECTs without joins or advanced SQL features; consolidation is low as each identified metric is unique in its base concept and source.,3,weekly,
t0_qt_ynvcbtp3gd,total_subscription_target,Total Subscription Target for National Sports Newsroom,"The sum of daily subscription targets specifically for the 'National Sports Newsroom' publication group, including variations like 'Code' and 'CODE'.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_publication_group) AS t0_qt_ynvcbtp3gd FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.publication_group AS STRING), 'National Sports Newsroom|Code|CODE')",hardcoded_logic,4d233abb-3d9b-4942-98b0-3989e8986970,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,10,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation is high as all queries represent the same core metric, only differing by date filters.",1,daily,
t0_qt_z3dx6n7w8c,total_spv_target,Total SPV Target,The sum of the Sales Performance Value (SPV) target from the weekly website target data.,ncau-data-newsquery-prd,cdm_reference_data,spv_weekly_website_tgt,SELECT SUM(t0.spv_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.spv_weekly_website_tgt` AS t0,"['hardcoded_logic', 'anti_pattern']",9ecab5db-180b-480c-a819-d10e5b8d263e,1.1,ncau-data-newsquery-prd.cdm_reference_data.spv_weekly_website_tgt,3,9,"Complexity is low due to simple aggregation and no joins/window functions. Consolidation is high as all queries compute the same metric from the same source, differing only by date filters.",1,weekly,
t0_qt_77oldvfmrd,total_revenue_net,Total Net Revenue (Deals & Direct),"The sum of net revenue for transactions categorized as 'DEAL', 'UFR', 'PG - CPD', 'PG - CPM', or 'DIRECT'.",ncau-data-newsquery-prd,prstn_advertising,programmatic_weekly_master,"SELECT SUM(t0.revenuenet) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0 WHERE UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')",hardcoded_logic,783f341c-8660-4e90-bab8-9bc860119cf5,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master,2,1,"Complexity is low due to simple queries, single table, and basic aggregations. Consolidation is low as only one distinct metric type was found.",1,weekly,
t0c1d0_D14765840309495278047,total_subscriber_count,"Total Subscriber Count (CM, Consumer, Non-Print-only)","The total count of subscribers for a specific date, filtered by 'CM' masthead, 'Consumer' customer type, and excluding 'Print-only' classification.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT SUM(t0c1d0.subscriber_count) FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0c1d0 WHERE (t0c1d0.report_date = DATE '2025-07-14' AND t0c1d0.member_type = 'subscriber' AND STRPOS(t0c1d0.combined_customer_type, 'Consumer') > 0 AND STRPOS(t0c1d0.combined_masthead, 'CM') > 0 AND t0c1d0.combined_classification_level_2 != 'Print-only')",,63f9fc08-acd1-4d1b-866e-5b2050b5093f,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg,6,7,"Queries involve nested subqueries, CASE statements, and string manipulations, indicating moderate complexity. All metrics are derived from the same base table and relate to subscriber data, suggesting good potential for consolidation around subscriber-related concepts.",3,daily,
t0c1d0_D2790704265089056990,active_subscriber_count,"Active Subscriber Count (CM, Consumer, Non-Print-only)","The total count of subscribers who had at least one active day in the last 28 days, for a specific date, filtered by 'CM' masthead, 'Consumer' customer type, and excluding 'Print-only' classification.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT SUM(CASE WHEN (t0c1d0.subscriber_last_28_days_active_days_count = 0) THEN 0 WHEN (t0c1d0.subscriber_last_28_days_active_days_count > 0) THEN 1 ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0c1d0 WHERE (t0c1d0.report_date = DATE '2025-07-14' AND t0c1d0.member_type = 'subscriber' AND STRPOS(t0c1d0.combined_customer_type, 'Consumer') > 0 AND STRPOS(t0c1d0.combined_masthead, 'CM') > 0 AND t0c1d0.combined_classification_level_2 != 'Print-only')",,63f9fc08-acd1-4d1b-866e-5b2050b5093f,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg,6,7,"Queries involve nested subqueries, CASE statements, and string manipulations, indicating moderate complexity. All metrics are derived from the same base table and relate to subscriber data, suggesting good potential for consolidation around subscriber-related concepts.",3,daily,
t0_qt_xgk5rdcbad,count_of_active_subscribers_by_active_days,"Count of Active Subscribers by 28-Day Active Days Count (DT, Consumer)","The count of active subscribers, grouped by their 28-day active days count, for a specific date, filtered by 'DT' masthead and 'Consumer' customer type.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT COUNT(1) AS t0_qt_xgk5rdcbad, t0.subscriber_last_28_days_active_days_count FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0 WHERE (t0.report_date = DATE '2025-05-11' AND t0.member_type = 'subscriber' AND STRPOS(t0.combined_customer_type, 'Consumer') > 0 AND t0.subscriber_last_28_days_active_days_count != 0 AND STRPOS(t0.combined_masthead, 'DT') > 0) GROUP BY t0.subscriber_last_28_days_active_days_count ORDER BY t0.subscriber_last_28_days_active_days_count ASC",,63f9fc08-acd1-4d1b-866e-5b2050b5093f,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg,6,7,"Queries involve nested subqueries, CASE statements, and string manipulations, indicating moderate complexity. All metrics are derived from the same base table and relate to subscriber data, suggesting good potential for consolidation around subscriber-related concepts.",3,daily,
t0_qt_0t7lclm19b,session_target_variance_percentage,Session Target Variance Percentage,Calculates the percentage variance of total visits (web + AMP) against the sessions target for a specific week.,ncau-data-newsquery-prd,prstn_content_interaction,kidspot_weekly_traffic,"SELECT SUM(SAFE_DIVIDE(((t0.web_visits + t0.amp_visits) - t0.sessions_target), t0.sessions_target)) AS t0_qt_0t7lclm19b FROM `ncau-data-newsquery-prd.prstn_content_interaction.kidspot_weekly_traffic` AS t0 WHERE t0.week_starting >= DATE '2025-07-21' AND t0.week_starting <= DATE '2025-07-27'",hardcoded_logic,3f48ba44-14ba-4a43-b02c-7700d0f49c0b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.kidspot_weekly_traffic;ncau-data-newsquery-prd.prstn_content_interaction.kidspot_weekly_content,3,2,Complexity is low due to simple aggregations and arithmetic; consolidation is low as only two distinct base metrics were identified.,2,weekly,
t0_qt_dbgz3aiqtd,total_page_views,Total Social Page Views,Aggregated sum of page views for content with 'Social' data type for a specific week.,ncau-data-newsquery-prd,prstn_content_interaction,kidspot_weekly_content,SELECT SUM(t0.page_views) AS t0_qt_dbgz3aiqtd FROM `ncau-data-newsquery-prd.prstn_content_interaction.kidspot_weekly_content` AS t0 WHERE t0.week_starting >= DATE '2025-07-14' AND t0.week_starting <= DATE '2025-07-20' AND t0.data_type = 'Social',hardcoded_logic,3f48ba44-14ba-4a43-b02c-7700d0f49c0b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.kidspot_weekly_traffic;ncau-data-newsquery-prd.prstn_content_interaction.kidspot_weekly_content,3,2,Complexity is low due to simple aggregations and arithmetic; consolidation is low as only two distinct base metrics were identified.,2,weekly,
clmn4_,sort_caption,Sort Caption,"A descriptive caption used for ordering or categorization, derived from the details dashboard.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT t0.sort_caption FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,,d4d68a71-2b12-4caf-bc6b-96fc2d18a025,1.1,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,3,2,"The queries are simple, involving single table selections with basic aliasing. The presence of hardcoded CASE WHEN logic for dimension selection, while not adding significant computational complexity, indicates a lack of dynamic parameterization in the generated SQL. Consolidation benefit is low as identified metrics are distinct dimensions without complex transformations.",2,mixed,
clmn8_,publication_date,Publication Date,"The specific date on which an item was published, as recorded in the details dashboard.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT t0.publication_date FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,,d4d68a71-2b12-4caf-bc6b-96fc2d18a025,1.1,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,3,2,"The queries are simple, involving single table selections with basic aliasing. The presence of hardcoded CASE WHEN logic for dimension selection, while not adding significant computational complexity, indicates a lack of dynamic parameterization in the generated SQL. Consolidation benefit is low as identified metrics are distinct dimensions without complex transformations.",2,mixed,
t0_qt_u1omb3bqpc,total_daily_website_target,Total Daily Website Target,"The aggregated daily target value for a specific website, used for performance tracking.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(clmn0_) AS t0_qt_u1omb3bqpc FROM (
SELECT PARSE_DATE('%Y%m%d', clmn3_) AS clmn4_, clmn0_, clmn1_, clmn2_ FROM (
SELECT SAFE_CAST(clmn1_ AS STRING) AS clmn3_, clmn0_, clmn1_, clmn2_ FROM (
SELECT t0.day_target_website AS clmn0_, t0.targetdate AS clmn1_, t0.website AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0
)
)
) WHERE (clmn4_ >= DATE '2025-06-03' AND clmn4_ <= DATE '2025-06-03' AND clmn2_ = 'The Weekly Times') LIMIT 2000001;",hardcoded_logic,abe67573-53fb-4cc2-a622-5cb9aa20166,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,10,"Complexity is low due to simple aggregation and no joins or window functions, despite verbose Looker Studio generated SQL. Consolidation is high as all queries target the exact same metric definition from the same source.",1,daily,
t0_qt_6mn9l1i0lc,c_score_target,C-Score Target Sum,The sum of C-score targets for a given period and publication group.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending >= DATE '2022-07-04' AND t0.week_ending <= DATE '2025-03-31',"hardcoded_logic, anti_pattern",ee06d96e-a079-4304-ad4a-2c9a13d20ddf,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets;ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,2,8,Complexity is low due to simple aggregations and no joins or window functions. Consolidation is high as the same base metric (`c_score_target`) is repeatedly queried with only date filter variations.,2,mixed,
t0_qt_y7qal64alc,day_target_website,Daily Website Target Sum,The sum of daily website subscription targets for a given period and website.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2022-07-04' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-03-31'","hardcoded_logic, anti_pattern",ee06d96e-a079-4304-ad4a-2c9a13d20ddf,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets;ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,2,8,Complexity is low due to simple aggregations and no joins or window functions. Consolidation is high as the same base metric (`c_score_target`) is repeatedly queried with only date filter variations.,2,mixed,
t0_qt_kqmrj88sid,total_spv_target,Total SPV Target,"The sum of the weekly SPV (Sessions Per Visit or Site Page Views) target, representing the desired number of sessions or page views for a website.",ncau-data-newsquery-prd,cdm_reference_data,spv_weekly_website_tgt,SELECT SUM(t0.spv_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.spv_weekly_website_tgt` AS t0,none,cbed6cf2-50c3-494c-a4be-4d21d6ad9dac,1.1,ncau-data-newsquery-prd.cdm_reference_data.spv_weekly_website_tgt,3,10,Complexity is low due to simple subquery and aggregation without joins or window functions. Consolidation is high as only one core metric (`total_spv_target`) is identified and consistently used across all queries.,1,weekly,
t0_qt_12285ghsfd,distinct_project_count,Count of Distinct Production Projects,"The number of unique GCP projects classified as 'Production' based on their project ID naming convention, within the last 6 months, for a specific list of AI-related projects.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  COUNT(DISTINCT metadata.projectId) AS t0_qt_12285ghsfd
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` AS bill
  FULL JOIN
  `ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata` AS metadata
  ON metadata.projectId = bill.project.id
WHERE
  DATE(bill._PARTITIONTIME) >= DATE_SUB(`current_date`(), INTERVAL 6 MONTH)
  AND bill.project.id IN ('nca-datapl-dev-genai', 'nca-datapl-dev-finaipoc', 'nca-data-prod-aisummarize', 'nca-datapl-prod-genai', 'nca-taiste-prod-taiste', 'nca-ola-prod-data', 'nca-datapl-prod-conintai', 'nca-cts-prod-tddxai', 'nca-datapl-nonprod-tasteaiconc', 'nca-datapl-prod-tasteaiconc', 'ncau-data-nprod-aitrain', 'nca-cts-nonprod-tddxai', 'ncau-data-nprod-taiste', 'nca-datapl-dev-contentsearch')
  AND (CASE WHEN metadata.projectId LIKE ""%dev%"" OR metadata.projectId LIKE ""%nprod%"" OR metadata.projectId LIKE ""%poc%"" OR metadata.projectId LIKE ""%nonprod%"" THEN ""NonProduction"" ELSE ""Production"" END) = 'Production'",hardcoded_logic,2a7796ef-1ee1-46d5-ab21-dee8ec3ac155,1.1,ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2;ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata,6,9,"Complexity is moderate due to nested subqueries, a full join, and a multi-condition CASE statement. Consolidation is high as two distinct metrics share the same base calculation and only differ by a single filter condition on an environment classification.",2,none,
t0_qt_9afrdihsfd,distinct_project_count,Count of Distinct NonProduction Projects,"The number of unique GCP projects classified as 'NonProduction' based on their project ID naming convention, within the last 6 months, for a specific list of AI-related projects.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  COUNT(DISTINCT metadata.projectId) AS t0_qt_9afrdihsfd
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` AS bill
  FULL JOIN
  `ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata` AS metadata
  ON metadata.projectId = bill.project.id
WHERE
  DATE(bill._PARTITIONTIME) >= DATE_SUB(`current_date`(), INTERVAL 6 MONTH)
  AND bill.project.id IN ('nca-datapl-dev-genai', 'nca-datapl-dev-finaipoc', 'nca-data-prod-aisummarize', 'nca-datapl-prod-genai', 'nca-taiste-prod-taiste', 'nca-ola-prod-data', 'nca-datapl-prod-conintai', 'nca-cts-prod-tddxai', 'nca-datapl-nonprod-tasteaiconc', 'nca-datapl-prod-tasteaiconc', 'ncau-data-nprod-aitrain', 'nca-cts-nonprod-tddxai', 'ncau-data-nprod-taiste', 'nca-datapl-dev-contentsearch')
  AND (CASE WHEN metadata.projectId LIKE ""%dev%"" OR metadata.projectId LIKE ""%nprod%"" OR metadata.projectId LIKE ""%poc%"" OR metadata.projectId LIKE ""%nonprod%"" THEN ""NonProduction"" ELSE ""Production"" END) = 'NonProduction'",hardcoded_logic,2a7796ef-1ee1-46d5-ab21-dee8ec3ac155,1.1,ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2;ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata,6,9,"Complexity is moderate due to nested subqueries, a full join, and a multi-condition CASE statement. Consolidation is high as two distinct metrics share the same base calculation and only differ by a single filter condition on an environment classification.",2,none,
t0_qt_s97jakgtqd,hardcoded_empty_string,Hardcoded Empty String Placeholder,"A placeholder dimension representing an empty string, likely used internally by Looker Studio for grouping or display purposes when no other dimension is selected.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT '' AS t0_qt_s97jakgtqd FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`,hardcoded_logic,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,1.1,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,1,8,Complexity is low due to simple SELECTs and COUNTs with no joins or complex functions. Consolidation is high as `COUNT(1)` and `scenario` are repeatedly queried with different aliases.,5,none,
clmn1_,scenario_dimension,Scenario,Represents the scenario type for digital subscriptions.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT t0.scenario AS clmn1_ FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0,none,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,1.1,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,1,8,Complexity is low due to simple SELECTs and COUNTs with no joins or complex functions. Consolidation is high as `COUNT(1)` and `scenario` are repeatedly queried with different aliases.,5,none,
t0_qt_l6xvcjgtqd,record_count,Total Record Count,The total number of records in the digital subscriptions table.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(1) AS t0_qt_l6xvcjgtqd FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`,none,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,1.1,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,1,8,Complexity is low due to simple SELECTs and COUNTs with no joins or complex functions. Consolidation is high as `COUNT(1)` and `scenario` are repeatedly queried with different aliases.,5,none,
t0_qt_07yailftqd,record_count,Record Count by Scenario,"The number of records in the digital subscriptions table, typically grouped by scenario.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(1) AS t0_qt_07yailftqd FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`,none,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,1.1,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,1,8,Complexity is low due to simple SELECTs and COUNTs with no joins or complex functions. Consolidation is high as `COUNT(1)` and `scenario` are repeatedly queried with different aliases.,5,none,
clmn0_,scenario_dimension,Scenario Dimension,"Represents the scenario type for digital subscriptions, used as a grouping dimension.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT t0.scenario AS clmn0_ FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0,none,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,1.1,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,1,8,Complexity is low due to simple SELECTs and COUNTs with no joins or complex functions. Consolidation is high as `COUNT(1)` and `scenario` are repeatedly queried with different aliases.,5,none,
t0_qt_5m78n97ukd,total_revenue,Total Revenue (Gross + Adjustment),"The sum of gross revenue excluding adjustments and the adjustment amount, representing total revenue, filtered for specific publication, year, and other criteria.",ncau-data-newsquery-prd,asl_advertising,v_adpoint_detail,"SELECT SUM(t0.gross_revenue_ex_adj_amount + t0.adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adpoint_detail` AS t0 WHERE (t0.financial_year >= '2022' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.record_type_code = 'STD' AND t0.source_system_code = 'ADPT' AND t0.revenue_type = 'Digital' AND t0.publishing_division != 'Medium Rare Content Agency' AND t0.publication_name = 'SKYNEWS' AND t0.calendar_year IN ('2025'))",anti_pattern,d768f28d-cc4a-4314-b972-cffd680d1bb8,1.1,ncau-data-newsquery-prd.asl_advertising.v_adpoint_detail,3,2,Complexity is low due to simple aggregations and no joins or window functions. Consolidation benefit is low as identified metrics are distinct concepts.,2,mixed,
t0_qt_a11r6fs1sd,min_calendar_month_numeric,Minimum Calendar Month (Numeric),"The minimum numeric representation of the calendar month for the filtered data, specifically for a given advertiser and year.",ncau-data-newsquery-prd,asl_advertising,v_adpoint_detail,"SELECT MIN(SAFE_CAST(t0.calendar_month AS FLOAT64)) FROM `ncau-data-newsquery-prd.asl_advertising.v_adpoint_detail` AS t0 WHERE (t0.financial_year >= '2022' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.record_type_code = 'STD' AND t0.source_system_code = 'ADPT' AND t0.revenue_type = 'Digital' AND t0.advertiser_name IN ('Nova Entertainment Pty Ltd') AND t0.calendar_year IN ('2024'))",anti_pattern,d768f28d-cc4a-4314-b972-cffd680d1bb8,1.1,ncau-data-newsquery-prd.asl_advertising.v_adpoint_detail,3,2,Complexity is low due to simple aggregations and no joins or window functions. Consolidation benefit is low as identified metrics are distinct concepts.,2,mixed,
t0_qt_e960udr7qd,distinct_subscriptions,"Distinct Subscriptions (Federal Election, Specific Websites)","Counts the number of unique subscriptions associated with articles related to the federal election, filtered by specific news websites for a defined period.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT
    t0.Website,
    COUNT(DISTINCT t0.SubscriptionID) AS t0_qt_e960udr7qd
FROM
    `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0
WHERE
    (t0.SubscriptionDateTime >= TIMESTAMP '2025-01-01' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-04-03', INTERVAL 1 DAY)
    AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection1 AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection2 AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection3 AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'federal-election'))
    AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury'))
GROUP BY
    t0.Website",,c4355ac4-14e3-42a0-ae17-f706fa774b3b,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,6,8,"Complexity is moderate due to nested subqueries, data type casting (SAFE_CAST, DATETIME_TRUNC), and extensive regular expression filtering. Consolidation score is high as all identified metrics share the same base concept of distinct subscriptions, differing only by filtering conditions. Governance issues include hardcoded logic for date ranges, specific topics ('federal-election'), article IDs, and lists of websites, as well as the anti-pattern of using obfuscated 'clmnX_' aliases generated by Looker Studio.",2,daily,
t0_qt_e960udr7qd,distinct_subscriptions,"Distinct Subscriptions (Federal Election or Specific Article, Specific Websites)","Counts the number of unique subscriptions associated with articles related to the federal election or a specific article ID, filtered by specific news websites for a defined period.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT
    t0.Website,
    COUNT(DISTINCT t0.SubscriptionID) AS t0_qt_e960udr7qd
FROM
    `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0
WHERE
    (t0.SubscriptionDateTime >= TIMESTAMP '2025-01-01' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-04-11', INTERVAL 1 DAY)
    AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection1 AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection2 AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection3 AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'federal-election')
        OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleID AS STRING), '91cd5d859a97c0b2a3b3da2771bcadf4'))
    AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury'))
GROUP BY
    t0.Website",,c4355ac4-14e3-42a0-ae17-f706fa774b3b,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,6,8,"Complexity is moderate due to nested subqueries, data type casting (SAFE_CAST, DATETIME_TRUNC), and extensive regular expression filtering. Consolidation score is high as all identified metrics share the same base concept of distinct subscriptions, differing only by filtering conditions. Governance issues include hardcoded logic for date ranges, specific topics ('federal-election'), article IDs, and lists of websites, as well as the anti-pattern of using obfuscated 'clmnX_' aliases generated by Looker Studio.",2,daily,
t0_qt_jaaylgv3md,active_subscriber_count,"Total Active Subscribers (Code App, Consumer, Subscriber, Print-Excl)","The total count of active subscribers for 'Code' mastheads, excluding print-only, for consumer-type members classified as 'subscriber' on a specific date.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT SUM(active_subscriber_count) FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` WHERE (report_date = DATE '2025-04-27' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(combined_masthead AS STRING), 'Code|CODE|cs|CS') AND combined_classification_level_2 != 'Print-only' AND STRPOS(combined_customer_type, 'Consumer') > 0 AND member_type = 'subscriber')",hardcoded_logic,a96a5942-b538-4aba-83cb-d4f16db9a59d,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg,2,1,Low complexity due to single aggregation and no joins; low consolidation score as only one metric is present in this query.,1,daily,"Hardcoded date '2025-04-27' and hardcoded filter values ('Code|CODE|cs|CS', 'Print-only', 'Consumer', 'subscriber') are present in the WHERE clause, making the query less dynamic and prone to errors if these values change."
t0_D12637089672011322096,active_subscribers_28_days,Active Subscribers (Last 28 Days),"The total count of subscribers who had at least one active day in the last 28 days, filtered by specific customer type, masthead, and classification.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT SUM(CASE WHEN (t0.subscriber_last_28_days_active_days_count = 0) THEN 0 WHEN (t0.subscriber_last_28_days_active_days_count > 0) THEN 1 ELSE 0 END) AS t0_D12637089672011322096 FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0 WHERE t0.report_date = DATE '2025-03-12' AND t0.member_type = 'subscriber' AND STRPOS(t0.combined_customer_type, 'Consumer') > 0 AND STRPOS(t0.combined_masthead, 'HS') > 0 AND t0.combined_classification_level_2 != 'Print-only'",hardcoded_logic,1b9efa96-31e0-4a43-9f74-c5d0da8c5e42,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,6,"Complexity is moderate due to nested subqueries, CASE statements, and UNNEST joins. Consolidation potential is moderate as two metrics share a common source and filtering logic.",3,daily,
t0_D8256333745715940895,total_subscriber_count,Total Subscriber Count,"The total count of subscribers for a specific report date, filtered by customer type, masthead, and classification.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT SUM(t0.subscriber_count) AS t0_D8256333745715940895 FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0 WHERE t0.report_date = DATE '2025-03-12' AND t0.member_type = 'subscriber' AND STRPOS(t0.combined_customer_type, 'Consumer') > 0 AND STRPOS(t0.combined_masthead, 'HS') > 0 AND t0.combined_classification_level_2 != 'Print-only'",hardcoded_logic,1b9efa96-31e0-4a43-9f74-c5d0da8c5e42,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,6,"Complexity is moderate due to nested subqueries, CASE statements, and UNNEST joins. Consolidation potential is moderate as two metrics share a common source and filtering logic.",3,daily,
t0_qt_gra0flp98c,subscription_acquisition_count,Subscription Acquisition Count,"The total count of new subscription acquisitions for a specific report date, filtered by masthead and member type.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_daily_base_movement,"SELECT SUM(t0_subscription_detail.subscription_acquisition_count) AS t0_qt_gra0flp98c FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement` AS t0 LEFT JOIN UNNEST(t0.subscription_detail) AS t0_subscription_detail WHERE t0.report_date = DATE '2025-04-23' AND t0.member_type = 'subscriber' AND STRPOS(t0.combined_masthead, 'AA') > 0",hardcoded_logic,1b9efa96-31e0-4a43-9f74-c5d0da8c5e42,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,6,"Complexity is moderate due to nested subqueries, CASE statements, and UNNEST joins. Consolidation potential is moderate as two metrics share a common source and filtering logic.",3,daily,
t0_qt_hugyaygj4c,subscription_target_daily,Daily Subscription Target for National News Network,The sum of daily subscription targets for the 'National News Network' publication group within a specified date range.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_publication_group) AS t0_qt_hugyaygj4c FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-06-16' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-06-22' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.publication_group AS STRING), 'National News Network')","hardcoded_logic, anti_pattern",f5afdb43-bb70-48be-a049-79cf77f7c6a6,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,4,"The complexity score of 6 is due to nested subqueries (up to 3 levels), conditional logic (CASE WHEN), date parsing, and string manipulation functions; however, there are no complex joins or window functions. The consolidation score of 4 reflects that the metrics represent distinct core business concepts (subscription targets, c-score targets, subscriber counts) originating from different tables, limiting consolidation potential for base metrics.",4,mixed,
t0c1d0_qt_j2b9jbhclc,c_score_target,Weekly C-Score Target by Publication Group,The sum of weekly c-score targets for each publication group within a specified date range.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0c1d0.c_score_target) AS t0c1d0_qt_j2b9jbhclc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0c1d0 WHERE t0c1d0.week_ending >= DATE '2025-07-07' AND t0c1d0.week_ending <= DATE '2025-07-13' GROUP BY t0c1d0.publication_group,hardcoded_logic,f5afdb43-bb70-48be-a049-79cf77f7c6a6,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,4,"The complexity score of 6 is due to nested subqueries (up to 3 levels), conditional logic (CASE WHEN), date parsing, and string manipulation functions; however, there are no complex joins or window functions. The consolidation score of 4 reflects that the metrics represent distinct core business concepts (subscription targets, c-score targets, subscriber counts) originating from different tables, limiting consolidation potential for base metrics.",4,mixed,
t0_D13713971724926243625,subscriber_count,Active Daily Subscriber Count (28 days),"The count of subscribers who were active every day for the last 28 days, filtered by specific criteria, aggregated by report date.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_daily_base_movement,"SELECT SUM(CASE WHEN t0.subscriber_last_28_days_active_days = 28 THEN t0.subscriber_count ELSE 0 END) AS t0_D13713971724926243625 FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement` AS t0 WHERE t0.report_date >= DATE '2024-07-01' AND t0.report_date <= DATE '2025-07-12' AND t0.member_type = 'subscriber' AND STRPOS(t0.combined_customer_type, 'Consumer') > 0 AND t0.combined_classification_level_2 != 'Print-only' AND STRPOS(t0.combined_masthead, 'AA') > 0 GROUP BY t0.report_date","hardcoded_logic, anti_pattern",f5afdb43-bb70-48be-a049-79cf77f7c6a6,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,4,"The complexity score of 6 is due to nested subqueries (up to 3 levels), conditional logic (CASE WHEN), date parsing, and string manipulation functions; however, there are no complex joins or window functions. The consolidation score of 4 reflects that the metrics represent distinct core business concepts (subscription targets, c-score targets, subscriber counts) originating from different tables, limiting consolidation potential for base metrics.",4,mixed,
t0_D18148823726537076701,subscriber_count,Total Subscriber Count,"The total count of subscribers, filtered by specific criteria, aggregated by report date.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_daily_base_movement,"SELECT SUM(t0.subscriber_count) AS t0_D18148823726537076701 FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement` AS t0 WHERE t0.report_date >= DATE '2024-07-01' AND t0.report_date <= DATE '2025-07-12' AND t0.member_type = 'subscriber' AND STRPOS(t0.combined_customer_type, 'Consumer') > 0 AND t0.combined_classification_level_2 != 'Print-only' AND STRPOS(t0.combined_masthead, 'AA') > 0 GROUP BY t0.report_date","hardcoded_logic, anti_pattern",f5afdb43-bb70-48be-a049-79cf77f7c6a6,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,6,4,"The complexity score of 6 is due to nested subqueries (up to 3 levels), conditional logic (CASE WHEN), date parsing, and string manipulation functions; however, there are no complex joins or window functions. The consolidation score of 4 reflects that the metrics represent distinct core business concepts (subscription targets, c-score targets, subscriber counts) originating from different tables, limiting consolidation potential for base metrics.",4,mixed,
t0c0d1_qt_5acixz47wc,day_target_by_section_team,Day Target by Section Team,The daily subscription target assigned to a specific section team.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(day_target_by_section_team) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets`,none,70dc50c7-72fe-4268-8e22-6de00e463d20,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,5,8,"The complexity is moderate due to nested subqueries and type casting, while consolidation is highly beneficial as the same core metric is represented by multiple Looker Studio generated aliases.",3,daily,
t0c0d1_qt_dbs6ow47wc,day_target_by_publication_group,Day Target by Publication Group,The daily subscription target assigned to a specific publication group.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(day_target_by_publication_group) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets`,anti_pattern,70dc50c7-72fe-4268-8e22-6de00e463d20,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,5,8,"The complexity is moderate due to nested subqueries and type casting, while consolidation is highly beneficial as the same core metric is represented by multiple Looker Studio generated aliases.",3,daily,
t0_qt_jrxn4ddclc,day_target_by_publication_group,Day Target by Publication Group,The daily subscription target assigned to a specific publication group.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(day_target_by_publication_group) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets`,anti_pattern,70dc50c7-72fe-4268-8e22-6de00e463d20,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,5,8,"The complexity is moderate due to nested subqueries and type casting, while consolidation is highly beneficial as the same core metric is represented by multiple Looker Studio generated aliases.",3,daily,
t0_qt_nczzqawhwc,total_day_target_by_section_team,Total Day Target by Section Team,The sum of daily targets assigned to each section team for subscriptions.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(day_target_by_section_team) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets`,anti_pattern,f04cf01a-a59d-4d08-a6a5-1f4a8a3540a9,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,6,9,"Queries exhibit moderate complexity due to nesting and type casting, but high consolidation potential as all metrics derive from the same base column and aggregation.",1,daily,
t0_qt_j2b9jbhclc,c_score_target_sum,Total C-Score Target,"The sum of the c-score target, representing the desired c-score value for a given period.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets`,hardcoded_logic,830018a3-2d7c-4496-bd33-5471d610b39d,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,2,9,Complexity is low due to simple aggregations and no joins. Consolidation is high as most queries retrieve the same core metric with varying date filters.,2,weekly,
t0_qt_c01ys2dytc,week_ending_iso_week,Week Ending (ISO Week),"The week ending date, truncated to the start of its ISO week, used as a dimension.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(week_ending AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets`",hardcoded_logic,830018a3-2d7c-4496-bd33-5471d610b39d,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,2,9,Complexity is low due to simple aggregations and no joins. Consolidation is high as most queries retrieve the same core metric with varying date filters.,2,weekly,
t0_qt_pj7pdyu3rd,unified_publication_group,Unified Publication Grouping,"A categorical dimension that groups specific unified publication names into 'Sundry Pubs' or 'Non Sundry Pubs', filtered for 'The Australian & Prestige' product group, 'PRINT' revenue type, and 'GQ Mag' publication.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT
    CASE
        WHEN t0.unified_publication_name IN (
            'Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM',
            'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin',
            'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin', 'odds.com.au', 'Punters.com.au',
            'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News', 'SKYNEWS.ADMIN', 'Stellar.Admin',
            'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin', 'TAUS.ADMIN', 'The Sunday Times',
            'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin'
        ) THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
    END AS t0_qt_pj7pdyu3rd
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
WHERE t0.product_group IN ('The Australian & Prestige')
  AND t0.revenue_type IN ('PRINT')
  AND t0.unified_publication_name IN ('GQ Mag')","hardcoded_logic, anti_pattern",4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,5,2,Complexity is moderate due to hardcoded business logic in CASE statements and unnecessary query nesting. Consolidation is low as only two distinct base metrics were identified from the provided queries.,2,none,
t0_qt_gunftikosd,min_load_timestamp,Minimum Data Load Timestamp,"The earliest timestamp, truncated to the second, indicating when the ad sales performance data was loaded into the system.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT
    MIN(DATETIME_TRUNC(t0.dw_asl_load_timestamp, SECOND)) AS t0_qt_gunftikosd
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",anti_pattern,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,5,2,Complexity is moderate due to hardcoded business logic in CASE statements and unnecessary query nesting. Consolidation is low as only two distinct base metrics were identified from the provided queries.,2,none,
t0_qt_d6zu6xlsud,total_content_starts,Total Video Content Starts,The total number of content starts for videos within the specified date range.,ncau-data-newsquery-prd,prstn_content_interaction,ktv_video_views,SELECT SUM(content_starts) FROM `ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views` WHERE date >= DATE '2025-01-01' AND date <= DATE '2025-08-24',hardcoded_logic,40ca2397-e61c-42bd-874c-ea7be0681a4b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views;ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary,3,4,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as 'content_starts' appears in two different source tables, but from distinct business contexts (videos vs. articles).",6,daily,
t0_qt_5eedf0msud,total_content_starts,Total Article Content Starts,The total number of content starts for articles within the specified date range.,ncau-data-newsquery-prd,prstn_content_interaction,ktv_articles_traffic_summary,SELECT SUM(content_starts) FROM `ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary` WHERE visit_date >= DATE '2025-05-07' AND visit_date <= DATE '2025-08-04',hardcoded_logic,40ca2397-e61c-42bd-874c-ea7be0681a4b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views;ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary,3,4,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as 'content_starts' appears in two different source tables, but from distinct business contexts (videos vs. articles).",6,daily,
t0_qt_gdcvi0msud,total_content_time_spent,Total Content Time Spent,The total time spent by users on articles within the specified date range.,ncau-data-newsquery-prd,prstn_content_interaction,ktv_articles_traffic_summary,SELECT SUM(content_time_spent) FROM `ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary` WHERE visit_date >= DATE '2025-05-07' AND visit_date <= DATE '2025-08-04',hardcoded_logic,40ca2397-e61c-42bd-874c-ea7be0681a4b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views;ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary,3,4,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as 'content_starts' appears in two different source tables, but from distinct business contexts (videos vs. articles).",6,daily,
t0_qt_k56o10msud,total_page_views,Total Page Views,The total number of page views for articles within the specified date range.,ncau-data-newsquery-prd,prstn_content_interaction,ktv_articles_traffic_summary,SELECT SUM(total_pvs) FROM `ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary` WHERE visit_date >= DATE '2025-05-07' AND visit_date <= DATE '2025-08-04',hardcoded_logic,40ca2397-e61c-42bd-874c-ea7be0681a4b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views;ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary,3,4,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as 'content_starts' appears in two different source tables, but from distinct business contexts (videos vs. articles).",6,daily,
t0_qt_ljqi50msud,subscriber_page_views,Subscriber Page Views,The total number of page views from subscribers for articles within the specified date range.,ncau-data-newsquery-prd,prstn_content_interaction,ktv_articles_traffic_summary,SELECT SUM(subs_pvs) FROM `ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary` WHERE visit_date >= DATE '2025-05-07' AND visit_date <= DATE '2025-08-04',hardcoded_logic,40ca2397-e61c-42bd-874c-ea7be0681a4b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views;ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary,3,4,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as 'content_starts' appears in two different source tables, but from distinct business contexts (videos vs. articles).",6,daily,
t0_qt_m9ada1msud,unique_subscriber_page_views,Unique Subscriber Page Views,The total number of unique page views from subscribers for articles within the specified date range.,ncau-data-newsquery-prd,prstn_content_interaction,ktv_articles_traffic_summary,SELECT SUM(unique_subs_pvs) FROM `ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary` WHERE visit_date >= DATE '2025-05-07' AND visit_date <= DATE '2025-08-04',hardcoded_logic,40ca2397-e61c-42bd-874c-ea7be0681a4b,1.1,ncau-data-newsquery-prd.prstn_content_interaction.ktv_video_views;ncau-data-newsquery-prd.prstn_content_interaction.ktv_articles_traffic_summary,3,4,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as 'content_starts' appears in two different source tables, but from distinct business contexts (videos vs. articles).",6,daily,
t0_qt_nbgk4hcdud,total_day_target_by_section_team,Total Day Target by Section Team,"The sum of daily subscription targets specific to a section team, filtered for 'Health' and excluding 'The Australian' website for a specific week.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_section_team) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-07-28' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-08-03' AND t0.website != 'The Australian' AND t0.section_team = 'Health'",,b456ee91-66d6-4bcb-b3a7-c752a3e02170,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,4,7,"Complexity is moderate due to nested subqueries and various data type conversions and string manipulations, but lacks joins or advanced functions; consolidation potential is high as two out of three unique metric IDs represent variations of 'total registrations' from the same source table.",3,weekly,
t0_qt_w6get0czmd,total_registrations,"Total Registrations (Health, Specific Websites, Week 2025-04-21)","The total count of registration records for a specific week, filtered for 'Health' related content and a predefined list of major news websites.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT COUNT(1) FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0 WHERE t0.SubscriptionDateTime >= TIMESTAMP '2025-04-21' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-04-27', INTERVAL 1 DAY) AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'Health|health') OR t0.ArticleDominantSection1 = 'health') AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury')",,b456ee91-66d6-4bcb-b3a7-c752a3e02170,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,4,7,"Complexity is moderate due to nested subqueries and various data type conversions and string manipulations, but lacks joins or advanced functions; consolidation potential is high as two out of three unique metric IDs represent variations of 'total registrations' from the same source table.",3,weekly,
t0_qt_r93oq36xmd,total_registrations,"Total Registrations (Health, Specific Websites, Week 2025-03-10)","The total count of registration records for a different specific week, filtered for 'Health' related content and a predefined list of major news websites.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT COUNT(1) FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0 WHERE t0.SubscriptionDateTime >= TIMESTAMP '2025-03-10' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-03-16', INTERVAL 1 DAY) AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'Health|health') OR t0.ArticleDominantSection1 = 'health') AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury')",,b456ee91-66d6-4bcb-b3a7-c752a3e02170,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,4,7,"Complexity is moderate due to nested subqueries and various data type conversions and string manipulations, but lacks joins or advanced functions; consolidation potential is high as two out of three unique metric IDs represent variations of 'total registrations' from the same source table.",3,weekly,
t0_qt_6rhew8ftxc,sum_day_target_website,Sum of Daily Website Target,Calculates the sum of the daily subscription target for a specific website on a given date.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) = DATE '2025-07-02' AND t0.website = 'Code Sports'",hardcoded_logic,5645b0e9-2850-4984-b808-b90bcb74ed92,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,2,9,Low complexity due to simple aggregation and filtering; high consolidation potential as all metrics are the same sum from the same table with varying date filters.,1,daily,
t0_qt_j2b9jbhclc,c_score_target,C-Score Target,"The target C-score value, representing a performance goal for content or publication groups.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets`,hardcoded_logic,41f3dfc4-db10-4e4a-9627-1261e9286fd0,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,2,9,Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics derive from the same base column.,2,weekly,
t0_qt_329dzg9ilc,c_score_target,C-Score Target,"The target C-score value, representing a performance goal for content or publication groups.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets`,hardcoded_logic,41f3dfc4-db10-4e4a-9627-1261e9286fd0,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,2,9,Low complexity due to simple aggregation and no joins. High consolidation potential as all metrics derive from the same base column.,2,weekly,
t0c0d1_qt_1irzgf2rnd,total_click,Total Clicks,The total number of clicks recorded for newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.total_click) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,1091b278-b70b-40d5-af7b-5750a63c662d,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,3,9,"Simple aggregations from a single table with repeated hardcoded dimension transformations, indicating high potential for data model consolidation.",5,weekly,
t0c0d1_qt_610dlf2rnd,total_send,Total Sends,The total number of newsletters sent.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.total_send) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,1091b278-b70b-40d5-af7b-5750a63c662d,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,3,9,"Simple aggregations from a single table with repeated hardcoded dimension transformations, indicating high potential for data model consolidation.",5,weekly,
t0c0d1_qt_8hn3g12rnd,total_unsubscribe,Total Unsubscribes,The total number of users who unsubscribed from newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.total_unsubscribe) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,1091b278-b70b-40d5-af7b-5750a63c662d,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,3,9,"Simple aggregations from a single table with repeated hardcoded dimension transformations, indicating high potential for data model consolidation.",5,weekly,
t0c0d1_qt_kfnxuf2rnd,unique_open,Unique Opens,The number of unique users who opened newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.unique_open) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,1091b278-b70b-40d5-af7b-5750a63c662d,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,3,9,"Simple aggregations from a single table with repeated hardcoded dimension transformations, indicating high potential for data model consolidation.",5,weekly,
t0c0d1_qt_ttsv4z1fvd,unique_click,Unique Clicks,The number of unique users who clicked on newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.unique_click) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,1091b278-b70b-40d5-af7b-5750a63c662d,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,3,9,"Simple aggregations from a single table with repeated hardcoded dimension transformations, indicating high potential for data model consolidation.",5,weekly,
t0_qt_h2rnp2zqqd,total_gcp_cost,Total Real GCP Cost for Contentlake Projects,"The aggregated real cost incurred for specific GCP projects related to 'contentlake', calculated by summing the base cost and any associated credits, rounded to three decimal places, for the last 6 months, grouped by month.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  SUM(t0.real_cost) AS t0_qt_h2rnp2zqqd
FROM
  (
    SELECT
      metadata.projectId,
      ROUND(cost + IFNULL((
            SELECT
              c.amount
            FROM
              UNNEST(credits) AS c
          ), 0), 3) AS real_cost,
      bill._PARTITIONTIME
    FROM
      `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` AS bill
      FULL JOIN
      `ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata` AS metadata
      ON metadata.projectId = bill.project.id
    WHERE
      DATE(bill._PARTITIONTIME) >= DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH)
      AND bill.project.id IN ('nca-datapl-dev-genai', 'nca-datapl-dev-finaipoc', 'nca-data-prod-aisummarize', 'nca-datapl-prod-genai', 'nca-taiste-prod-taiste', 'nca-ola-prod-data', 'nca-datapl-prod-conintai', 'nca-cts-prod-tddxai', 'nca-datapl-nonprod-tasteaiconc', 'nca-datapl-prod-tasteaiconc', 'ncau-data-nprod-aitrain', 'nca-cts-nonprod-tddxai', 'ncau-data-nprod-taiste', 'nca-datapl-dev-contentsearch')
  ) AS t0
WHERE
  STRPOS(t0.projectId, 'contentlake') > 0
GROUP BY
  SAFE_CAST(DATETIME_TRUNC(t0._PARTITIONTIME, MONTH) AS DATE)
ORDER BY
  SAFE_CAST(DATETIME_TRUNC(t0._PARTITIONTIME, MONTH) AS DATE) ASC
LIMIT 2000001;",hardcoded_logic,a6b35c09-d774-4509-95d0-4e3c05417e57,1.1,ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2;ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata,7,1,"The query involves multiple nested subqueries, a full join, and several string, date, and aggregation functions, indicating moderate complexity. Only one primary metric is identified, resulting in a low consolidation score.",1,monthly,
t0_qt_73ldtxh0lc,c_score_target_sum,Sum of C-Score Target,"The aggregated sum of the c-score target value, likely representing a key performance indicator related to content or audience engagement for a news publication.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets`,,9b27e204-fd9a-4032-8669-58b6f23bf3ef,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,"Complexity is low due to simple aggregation on a single table with no joins or complex functions. Consolidation is high as all queries use the exact same metric calculation and alias, differing only by hardcoded date filters, which is a hardcoded_logic governance issue. The LIMIT 2000001 is also an anti_pattern.",1,weekly,
t0_qt_bgqqczb5sd,distinct_subscribers,Distinct Subscribers,Counts the total number of unique subscriber IDs.,nau-data-nprod-dataservices,auyeunga_sandbox,supercoach_engagement_test,SELECT COUNT(DISTINCT subscriber_id_src) FROM `nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test`,anti_pattern,6640a246-777a-4fcf-a692-85e02e7f7a8e,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test,2,8,Low complexity due to simple aggregations and no joins; high consolidation potential as multiple metrics are variations of 'distinct subscribers' with different hardcoded filters.,5,weekly,
t0_qt_ofs8qfb5sd,total_rule_group_number,Total Rule Group Number,Calculates the sum of rule group numbers.,nau-data-nprod-dataservices,auyeunga_sandbox,supercoach_engagement_test,SELECT SUM(rule_group_number) FROM `nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test`,anti_pattern,6640a246-777a-4fcf-a692-85e02e7f7a8e,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test,2,8,Low complexity due to simple aggregations and no joins; high consolidation potential as multiple metrics are variations of 'distinct subscribers' with different hardcoded filters.,5,weekly,
t0_qt_bgqqczb5sd_afl_2025,distinct_subscribers,Distinct Subscribers - AFL Only 2025 Audience,Counts unique subscriber IDs for the '2025 Total SuperCoach Audience' and 'AFL only' registration group.,nau-data-nprod-dataservices,auyeunga_sandbox,supercoach_engagement_test,SELECT COUNT(DISTINCT subscriber_id_src) FROM `nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test` WHERE rule_group_definition IN (' 2025 Total SuperCoach Audience') AND sc_registration_group IN ('1) afl_only'),"hardcoded_logic,anti_pattern",6640a246-777a-4fcf-a692-85e02e7f7a8e,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test,2,8,Low complexity due to simple aggregations and no joins; high consolidation potential as multiple metrics are variations of 'distinct subscribers' with different hardcoded filters.,5,weekly,
t0_qt_bgqqczb5sd_moderately_engaged_2025,distinct_subscribers,Distinct Subscribers - Moderately Engaged 2025 Audience,Counts unique subscriber IDs for the '2025 Total SuperCoach Audience' and 'Moderately engaged' cohort.,nau-data-nprod-dataservices,auyeunga_sandbox,supercoach_engagement_test,SELECT COUNT(DISTINCT subscriber_id_src) FROM `nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test` WHERE rule_group_definition IN (' 2025 Total SuperCoach Audience') AND supercoach_engagement_cohort IN ('Moderately engaged'),"hardcoded_logic,anti_pattern",6640a246-777a-4fcf-a692-85e02e7f7a8e,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test,2,8,Low complexity due to simple aggregations and no joins; high consolidation potential as multiple metrics are variations of 'distinct subscribers' with different hardcoded filters.,5,weekly,
t0_qt_ls8568b5sd,total_records,Total Records,Counts the total number of records in the table.,nau-data-nprod-dataservices,auyeunga_sandbox,supercoach_engagement_test,SELECT COUNT(1) FROM `nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test`,anti_pattern,6640a246-777a-4fcf-a692-85e02e7f7a8e,1.1,nau-data-nprod-dataservices.auyeunga_sandbox.supercoach_engagement_test,2,8,Low complexity due to simple aggregations and no joins; high consolidation potential as multiple metrics are variations of 'distinct subscribers' with different hardcoded filters.,5,weekly,
t0_qt_73ldtxh0lc_20250317_20250323,c_score_target_sum,Sum of C-Score Target (Week Ending 2025-03-23),The sum of the c-score target for the week ending 2025-03-23.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_73ldtxh0lc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-03-17' AND clmn2_ <= DATE '2025-03-23') GROUP BY clmn1_ LIMIT 2000001;",hardcoded_logic,ec783355-ff58-423e-a8df-83c75e9f77b3,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"The queries are very simple, involving only basic aggregation and date filtering, hence low complexity. All identified metrics are variations of the same base metric, differing only by hardcoded date ranges, indicating a high benefit from consolidation through parameterized date filters.",3,weekly,
t0_qt_73ldtxh0lc_20250630_20250706,c_score_target_sum,Sum of C-Score Target (Week Ending 2025-07-06),The sum of the c-score target for the week ending 2025-07-06.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_73ldtxh0lc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-06-30' AND clmn2_ <= DATE '2025-07-06') GROUP BY clmn1_ LIMIT 2000001;",hardcoded_logic,ec783355-ff58-423e-a8df-83c75e9f77b3,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"The queries are very simple, involving only basic aggregation and date filtering, hence low complexity. All identified metrics are variations of the same base metric, differing only by hardcoded date ranges, indicating a high benefit from consolidation through parameterized date filters.",3,weekly,
t0_qt_73ldtxh0lc_20250825_20250831,c_score_target_sum,Sum of C-Score Target (Week Ending 2025-08-31),The sum of the c-score target for the week ending 2025-08-31.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_73ldtxh0lc FROM (
SELECT t0.c_score_target AS clmn0_, t0.publication_group AS clmn1_, t0.week_ending AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0
) WHERE (clmn2_ >= DATE '2025-08-25' AND clmn2_ <= DATE '2025-08-31') GROUP BY clmn1_ LIMIT 2000001;",hardcoded_logic,ec783355-ff58-423e-a8df-83c75e9f77b3,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"The queries are very simple, involving only basic aggregation and date filtering, hence low complexity. All identified metrics are variations of the same base metric, differing only by hardcoded date ranges, indicating a high benefit from consolidation through parameterized date filters.",3,weekly,
t0_qt_h643zaum7c,total_cost,Total BigQuery Dev Cost,The total cost incurred for BigQuery services specifically for the 'ncau-data-newsquery-dev' ID.,ncau-data-newsquery-prd,operations,newsquery_6mnt_cost,"SELECT SUM(cost) FROM `ncau-data-newsquery-prd.operations.newsquery_6mnt_cost` WHERE id = ""ncau-data-newsquery-dev"" AND service_description = ""BigQuery""",hardcoded_logic,d8104888-c324-42d8-a9b1-c065ba1c8622,1.1,ncau-data-newsquery-prd.operations.newsquery_6mnt_cost,1,10,Complexity is low due to simple aggregation and no joins. Consolidation is high as only one unique metric definition was found across all queries.,1,none,
t0_qt_t0lu7ncdud,day_target_by_section_team_sum,"Total Day Target for Metro Business (July 1-27, 2025)","The aggregated sum of daily targets for the 'Metro Business' section team for the period of July 1st to July 27th, 2025.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_section_team) AS t0_qt_t0lu7ncdud FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-07-01' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-07-27' AND t0.section_team = 'Metro Business'","hardcoded_logic, anti_pattern",0071d646-565a-46be-b47c-e78a85d5cee7,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,4,10,"Complexity is moderate due to nested subqueries and type casting. Consolidation potential is very high as all metrics are sums of the same base column, differing only by date range and grouping.",2,daily,
t0_qt_ayg6woddud,day_target_by_section_team_sum,"Daily Day Target for Metro Business (July 1-15, 2025)","The daily aggregated sum of targets for the 'Metro Business' section team for the period of July 1st to July 15th, 2025, broken down by date.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_section_team) AS t0_qt_ayg6woddud FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-07-01' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-07-15' AND t0.section_team = 'Metro Business' GROUP BY PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)), t0.section_team","hardcoded_logic, anti_pattern",0071d646-565a-46be-b47c-e78a85d5cee7,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,4,10,"Complexity is moderate due to nested subqueries and type casting. Consolidation potential is very high as all metrics are sums of the same base column, differing only by date range and grouping.",2,daily,
t0_qt_73ldtxh0lc,c_score_target_sum,C-Score Target Sum by Publication Group,"The sum of the c-score target, aggregated by publication group, representing a key performance indicator for content or advertising performance.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT publication_group, SUM(c_score_target) AS c_score_target_sum FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` GROUP BY publication_group",hardcoded_logic,3516a531-3188-4e5d-b49c-3150298ebdc7,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Low complexity due to simple aggregation and filtering; high consolidation potential as all queries use the same metric definition.,1,weekly,
t0_qt_27qhatajvd,cancellation_count,Total Cancellation Count,The sum of cancellation counts for subscriptions.,ncau-data-newsquery-prd,prstn_consumer,subscription_cancels_w_engagement,SELECT SUM(cancellation_count) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement`,none,0c50ad01-a1a6-49a6-895f-4c2002a12173,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement;ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels,3,6,Complexity is low due to simple aggregations and no joins or complex functions. Consolidation benefit is moderate as some core metrics appear under different aliases across queries.,6,daily,
t0_qt_fg9mzkmmud,cancellation_count,Total Cancellation Count (by Reason),"The sum of cancellation counts for subscriptions, grouped by reason.",ncau-data-newsquery-prd,prstn_consumer,subscription_cancels_w_engagement,SELECT SUM(cancellation_count) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement`,none,0c50ad01-a1a6-49a6-895f-4c2002a12173,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement;ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels,3,6,Complexity is low due to simple aggregations and no joins or complex functions. Consolidation benefit is moderate as some core metrics appear under different aliases across queries.,6,daily,
t0_qt_hgo1zgmmud,switch_cancellation_count,Total Switch Cancellation Count,The sum of cancellations due to switching subscriptions.,ncau-data-newsquery-prd,prstn_consumer,subscription_cancels_w_engagement,SELECT SUM(switch_cancellation_count) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement`,none,0c50ad01-a1a6-49a6-895f-4c2002a12173,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement;ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels,3,6,Complexity is low due to simple aggregations and no joins or complex functions. Consolidation benefit is moderate as some core metrics appear under different aliases across queries.,6,daily,
t0_qt_km8ulgmmud,net_cancellation_count,Total Net Cancellation Count,The sum of net cancellations (cancellations minus reactivations).,ncau-data-newsquery-prd,prstn_consumer,subscription_cancels_w_engagement,SELECT SUM(net_cancellation_count) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement`,none,0c50ad01-a1a6-49a6-895f-4c2002a12173,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement;ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels,3,6,Complexity is low due to simple aggregations and no joins or complex functions. Consolidation benefit is moderate as some core metrics appear under different aliases across queries.,6,daily,
t0_qt_ykkp7gmmud,reactivation_cancellation_count,Total Reactivation Cancellation Count,The sum of cancellations that were reactivated.,ncau-data-newsquery-prd,prstn_consumer,subscription_cancels_w_engagement,SELECT SUM(reactivation_cancellation_count) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement`,none,0c50ad01-a1a6-49a6-895f-4c2002a12173,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement;ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels,3,6,Complexity is low due to simple aggregations and no joins or complex functions. Consolidation benefit is moderate as some core metrics appear under different aliases across queries.,6,daily,
t0_qt_b9g27gdivd,subscriber_count,Total Subscriber ID Source Sum,"The sum of subscriber source IDs, likely intended to be a count of subscribers.",ncau-data-newsquery-prd,prstn_consumer,subscription_closing_base_and_cancels,SELECT SUM(subscriber_id_src) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels`,anti_pattern,0c50ad01-a1a6-49a6-895f-4c2002a12173,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_cancels_w_engagement;ncau-data-newsquery-prd.prstn_consumer.subscription_closing_base_and_cancels,3,6,Complexity is low due to simple aggregations and no joins or complex functions. Consolidation benefit is moderate as some core metrics appear under different aliases across queries.,6,daily,
t0_qt_sjzyg8ejfd,website_day_target,Website Day Target,Represents the daily target for website performance for specific publication groups within a given date range.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE (PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-06-23' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-06-29' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.publication_group AS STRING), 'National Sports Newsroom|Code'))",hardcoded_logic,63911575-4b9d-45c4-830c-8726e98adb93,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,3,7,"Complexity is low due to simple aggregations and no joins/window functions, but nested subqueries add minor parsing overhead. Consolidation potential is high as two metric variations share the same base concept, differing only by hardcoded date filters.",3,mixed,
t0_qt_j2b9jbhclc_week_2025_06_23,c_score_target,C-Score Target (Current Week),Represents the target C-score for publications for the current week.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-06-23' AND t0.week_ending <= DATE '2025-06-29'),hardcoded_logic,63911575-4b9d-45c4-830c-8726e98adb93,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,3,7,"Complexity is low due to simple aggregations and no joins/window functions, but nested subqueries add minor parsing overhead. Consolidation potential is high as two metric variations share the same base concept, differing only by hardcoded date filters.",3,mixed,
t0_qt_j2b9jbhclc_week_2023_07_03,c_score_target,C-Score Target (Historical),Represents the target C-score for publications over a historical period.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2023-07-03' AND t0.week_ending <= DATE '2025-07-06'),hardcoded_logic,63911575-4b9d-45c4-830c-8726e98adb93,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,3,7,"Complexity is low due to simple aggregations and no joins/window functions, but nested subqueries add minor parsing overhead. Consolidation potential is high as two metric variations share the same base concept, differing only by hardcoded date filters.",3,mixed,
t0_qt_u7v1bj0ktd,total_visits,Total Visits for news.com.au REA Traffic (August 2025),Total visits from news.com.au for REA traffic data type in August 2025.,ncau-data-newsquery-prd,asl_rearca,rea_rca_monthly,SELECT SUM(t0.visits) AS t0_qt_u7v1bj0ktd FROM `ncau-data-newsquery-prd.asl_rearca.rea_rca_monthly` AS t0 WHERE t0.visit_month >= DATE '2025-08-01' AND t0.visit_month <= DATE '2025-08-31' AND t0.data_type = 'traffic' AND t0.rea_rca_brand = 'rea' AND t0.ncau_brand = 'news.com.au',hardcoded_logic,858161fd-9f14-4882-b218-2190b7325229,1.1,ncau-data-newsquery-prd.asl_rearca.rea_rca_monthly,4,8,Complexity is moderate due to nested subqueries and basic functions; consolidation is high as both metrics are variations of 'visits' with different hardcoded filters.,2,monthly,
t0_qt_lsmvl9ljtd,total_visits,Total Visits for NCA Total RCA Web/App Traffic (June 2025),Total visits for News Corp Australia - Total brand for RCA web or app traffic data type in June 2025.,ncau-data-newsquery-prd,asl_rearca,rea_rca_monthly,SELECT SUM(t0.visits) AS t0_qt_lsmvl9ljtd FROM `ncau-data-newsquery-prd.asl_rearca.rea_rca_monthly` AS t0 WHERE t0.visit_month >= DATE '2025-06-01' AND t0.visit_month <= DATE '2025-06-30' AND t0.ncau_brand = 'News Corp Australia - Total' AND t0.data_type = 'traffic' AND (t0.rea_rca_brand = 'rca_web' OR t0.rea_rca_brand = 'rca_app'),hardcoded_logic,858161fd-9f14-4882-b218-2190b7325229,1.1,ncau-data-newsquery-prd.asl_rearca.rea_rca_monthly,4,8,Complexity is moderate due to nested subqueries and basic functions; consolidation is high as both metrics are variations of 'visits' with different hardcoded filters.,2,monthly,
t0_qt_2fj5dv84pd,total_absolute_difference_tableau_tm1,Total Absolute Difference (Tableau vs TM1),"The sum of the absolute differences between Tableau Actual Amount and TM1 Amount, specifically for fiscal year 2026, month July, and where publication code is numeric.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT SUM(ABS(t0.Tableau_Actual_Amount - t0.TM1_Amount)) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') AND t0.fiscal_year IN (2026) AND t0.month_short_name IN ('Jul')",hardcoded_logic,f353b933-30eb-4853-9976-0d35371db7d7,1.1,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses,4,8,"Complexity is low due to simple aggregations and no joins, but nested subqueries add a minor layer. Consolidation is high as all metrics derive from the same base table and are related to financial reconciliation.",3,monthly,
t0_qt_6o8fyp74pd,total_tm1_amount,Total TM1 Amount,"The sum of amounts from the TM1 system, specifically for fiscal year 2026, month July, and where publication code is numeric.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT SUM(t0.TM1_Amount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') AND t0.fiscal_year IN (2026) AND t0.month_short_name IN ('Jul')",hardcoded_logic,f353b933-30eb-4853-9976-0d35371db7d7,1.1,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses,4,8,"Complexity is low due to simple aggregations and no joins, but nested subqueries add a minor layer. Consolidation is high as all metrics derive from the same base table and are related to financial reconciliation.",3,monthly,
t0_qt_yu8hcm84pd,total_tableau_actual_amount,Total Tableau Actual Amount,"The sum of actual amounts reported in Tableau, specifically for fiscal year 2026, month July, and where publication code is numeric.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT SUM(t0.Tableau_Actual_Amount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') AND t0.fiscal_year IN (2026) AND t0.month_short_name IN ('Jul')",hardcoded_logic,f353b933-30eb-4853-9976-0d35371db7d7,1.1,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses,4,8,"Complexity is low due to simple aggregations and no joins, but nested subqueries add a minor layer. Consolidation is high as all metrics derive from the same base table and are related to financial reconciliation.",3,monthly,
t0_qt_87ke4vuavd,homepage_instances,Homepage Instances,Total instances specifically attributed to the 'Homepage' data type.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_checkout_content,SELECT SUM(CASE WHEN t0.data_type = 'Homepage' THEN t0.instances ELSE NULL END) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content` AS t0,hardcoded_logic,8a7be976-10d2-4657-aa8a-8bcbcb4c4cd7,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content,3,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as some metrics are specific filtered versions of base measures, indicating hardcoded logic.",4,daily,
t0_qt_e7zcx8uztd,total_instances,Total Instances,Total number of instances recorded across all data types.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_checkout_content,SELECT SUM(t0.instances) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content` AS t0,none,8a7be976-10d2-4657-aa8a-8bcbcb4c4cd7,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content,3,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as some metrics are specific filtered versions of base measures, indicating hardcoded logic.",4,daily,
t0_qt_6gjhhwxytd,search_visits,Search Visits,Total visits specifically attributed to the 'Search' data type.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_checkout_content,SELECT SUM(t0.visits) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content` AS t0 WHERE t0.data_type = 'Search',hardcoded_logic,8a7be976-10d2-4657-aa8a-8bcbcb4c4cd7,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content,3,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as some metrics are specific filtered versions of base measures, indicating hardcoded logic.",4,daily,
t0_qt_8ql9dxxytd,unique_search_visit_dates,Unique Search Visit Dates,Number of unique visit dates specifically attributed to the 'Search' data type.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_checkout_content,SELECT COUNT(DISTINCT t0.visit_date) FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content` AS t0 WHERE t0.data_type = 'Search',hardcoded_logic,8a7be976-10d2-4657-aa8a-8bcbcb4c4cd7,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_checkout_content,3,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as some metrics are specific filtered versions of base measures, indicating hardcoded logic.",4,daily,
t0_qt_t5qy4mdhqd,total_gross_revenue,Total Gross Revenue,The sum of gross revenue amounts from advertising sales.,ncau-data-newsquery-prd,asl_advertising,adsales_revenue_pricing,SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing`,none,5506c033-2f12-4464-b45b-4a12b7849ed6,1.1,ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing,1,8,"Complexity is low due to simple aggregations and no joins. Consolidation is high because a single Looker Studio alias (`t0_qt_t5qy4mdhqd`) is used for multiple distinct metrics, requiring clear base metric identification.",3,none,
t0_qt_t5qy4mdhqd,record_count,Record Count,The total number of records in the advertising sales revenue pricing table.,ncau-data-newsquery-prd,asl_advertising,adsales_revenue_pricing,SELECT COUNT(1) FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing`,none,5506c033-2f12-4464-b45b-4a12b7849ed6,1.1,ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing,1,8,"Complexity is low due to simple aggregations and no joins. Consolidation is high because a single Looker Studio alias (`t0_qt_t5qy4mdhqd`) is used for multiple distinct metrics, requiring clear base metric identification.",3,none,
t0_qt_t5qy4mdhqd,unique_fiscal_years,Unique Fiscal Years,The count of distinct fiscal years present in the advertising sales revenue pricing data.,ncau-data-newsquery-prd,asl_advertising,adsales_revenue_pricing,SELECT COUNT(DISTINCT fy_year) FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing`,none,5506c033-2f12-4464-b45b-4a12b7849ed6,1.1,ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing,1,8,"Complexity is low due to simple aggregations and no joins. Consolidation is high because a single Looker Studio alias (`t0_qt_t5qy4mdhqd`) is used for multiple distinct metrics, requiring clear base metric identification.",3,none,
t0_qt_70j1ocqbkd_unfiltered,acquisition_count_sum,Total Acquisition Count,The total number of acquisitions recorded across all product descriptions.,ncau-data-newsquery-prd,consumer_sandbox,t_newspass_crm_coversion_myaccount_fct,SELECT SUM(t0.acquisition_count) AS t0_qt_70j1ocqbkd_unfiltered FROM `ncau-data-newsquery-prd.consumer_sandbox.t_newspass_crm_coversion_myaccount_fct` AS t0,anti_pattern,7888a780-7777-411b-b07b-398b87d2cfd0,1.1,ncau-data-newsquery-prd.consumer_sandbox.t_newspass_crm_coversion_myaccount_fct,2,9,Low complexity due to simple aggregations and no joins. High consolidation potential as all identified metrics are variations of `SUM(acquisition_count)`.,2,none,
t0_qt_70j1ocqbkd_filtered_australian,acquisition_count_sum,Acquisition Count Excluding The Australian,"The total number of acquisitions, excluding those related to 'The Australian' product description.",ncau-data-newsquery-prd,consumer_sandbox,t_newspass_crm_coversion_myaccount_fct,"SELECT SUM(t0.acquisition_count) AS t0_qt_70j1ocqbkd_filtered_australian FROM `ncau-data-newsquery-prd.consumer_sandbox.t_newspass_crm_coversion_myaccount_fct` AS t0 WHERE STRPOS(t0.acquired_on_product_description, 'The Australian') <= 0","hardcoded_logic,anti_pattern",7888a780-7777-411b-b07b-398b87d2cfd0,1.1,ncau-data-newsquery-prd.consumer_sandbox.t_newspass_crm_coversion_myaccount_fct,2,9,Low complexity due to simple aggregations and no joins. High consolidation potential as all identified metrics are variations of `SUM(acquisition_count)`.,2,none,
t0_qt_1oxz9bj6qd,vv_content_starts,Total Video Content Starts,The total count of video content starts recorded for a given period.,ncau-data-newsquery-prd,prstn_content_interaction,newscomau_daily_traffic,SELECT SUM(t0.vv_content_starts) AS t0_qt_1oxz9bj6qd FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic` AS t0 WHERE t0.visit_date = DATE '2025-06-04',hardcoded_logic,41dda2e0-7935-4eca-9a86-1b0e763c2657,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic,2,8,Complexity is low due to simple SUM aggregations; consolidation is high as multiple queries derive from only two core metrics.,2,daily,
t0_qt_t0uv16f3yc,total_page_views,Total Page Views,"The sum of page views across AMP, app, and web platforms for a given period.",ncau-data-newsquery-prd,prstn_content_interaction,newscomau_daily_traffic,SELECT SUM(t0.web_page_views + t0.amp_page_views + t0.app_page_views) AS t0_qt_t0uv16f3yc FROM `ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic` AS t0 WHERE t0.visit_date = DATE '2025-06-12',hardcoded_logic,41dda2e0-7935-4eca-9a86-1b0e763c2657,1.1,ncau-data-newsquery-prd.prstn_content_interaction.newscomau_daily_traffic,2,8,Complexity is low due to simple SUM aggregations; consolidation is high as multiple queries derive from only two core metrics.,2,daily,
clmn0_,source,Source,Identifies the data source for programmatic advertising records.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT Source FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month`,,87651b69-c43e-471f-9c4b-98df1208a844,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month,4,2,Complexity is moderate due to nested subqueries and date functions; consolidation benefit is low as only one metric is aliased differently.,6,monthly,
clmn0_,advertiser,Advertiser,The name of the advertiser associated with the programmatic sales.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT Advertiser FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month`,,87651b69-c43e-471f-9c4b-98df1208a844,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month,4,2,Complexity is moderate due to nested subqueries and date functions; consolidation benefit is low as only one metric is aliased differently.,6,monthly,
t0_D12257624719428327799,sum_paid_impressions,Sum of Paid Impressions,The total sum of paid impressions for programmatic advertising.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT SUM(PaidImpressions) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month`,,87651b69-c43e-471f-9c4b-98df1208a844,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month,4,2,Complexity is moderate due to nested subqueries and date functions; consolidation benefit is low as only one metric is aliased differently.,6,monthly,
t0_D9596681579258349039,sum_revenue_gross,Sum of Gross Revenue,The total sum of gross revenue generated from programmatic advertising.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT SUM(RevenueGross) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month`,,87651b69-c43e-471f-9c4b-98df1208a844,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month,4,2,Complexity is moderate due to nested subqueries and date functions; consolidation benefit is low as only one metric is aliased differently.,6,monthly,
t0_qt_3uqj2k5ird,calendar_month_start_date,Calendar Month Start Date,The calculated start date of the calendar month for programmatic sales data.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month`",,87651b69-c43e-471f-9c4b-98df1208a844,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month,4,2,Complexity is moderate due to nested subqueries and date functions; consolidation benefit is low as only one metric is aliased differently.,6,monthly,
t0_qt_kjoj2k5ird,sum_revenue_gross,Sum of Gross Revenue (Alternative Alias),The total sum of gross revenue generated from programmatic advertising (alternative alias).,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT SUM(RevenueGross) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month`,,87651b69-c43e-471f-9c4b-98df1208a844,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month,4,2,Complexity is moderate due to nested subqueries and date functions; consolidation benefit is low as only one metric is aliased differently.,6,monthly,
t0_qt_cxviq9ijhd,unique_contacts,Unique Plus Rewards Contacts (Alias 1),Counts the number of unique contact IDs from the 'plus_rewards' program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,52b2e0a6-fd53-4788-94da-101037302104,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation score is high because two distinct metric aliases represent the exact same underlying calculation, indicating significant redundancy.",2,none,
t0_qt_u50cxdhmgd,unique_contacts,Unique Plus Rewards Contacts (Alias 2),Counts the number of unique contact IDs from the 'plus_rewards' program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT t0.contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards` AS t0,anti_pattern,52b2e0a6-fd53-4788-94da-101037302104,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Complexity is low due to simple aggregate functions on a single table. Consolidation score is high because two distinct metric aliases represent the exact same underlying calculation, indicating significant redundancy.",2,none,
clmn0_,agreement_id_src,Agreement ID Source,"Unique identifier for the source of an agreement, typically used for tracking and analysis of ad sales revenue and pricing.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_pricing,SELECT t0.agreement_id_src AS clmn0_ FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing` AS t0,anti_pattern,36c94aef-cf82-466b-9b8f-6a3a6580e059,1.1,ncau-data-newsquery-prd.asl_advertising.adsales_revenue_pricing,1,1,"Queries are very simple, selecting a single dimension with no complex logic or aggregations. Only one unique metric concept was identified.",1,none,
t0_qt_35zfjo6r3c,collection_ingest_date_adjusted,Collection Ingest Date (Adjusted),"The date of collection ingestion, adjusted by 11 hours, likely for timezone correction, derived from IngestTime.",ncau-data-newsquery-prd,cdm_content,collections_dimension_hist,"SELECT SAFE_CAST(DATETIME_ADD(DATETIME_TRUNC(SAFE_CAST(t0.IngestTime AS DATETIME), SECOND), INTERVAL 11 HOUR) AS DATE) AS t0_qt_35zfjo6r3c FROM `ncau-data-newsquery-prd.cdm_content.collections_dimension_hist` AS t0 LEFT JOIN UNNEST(t0.RefArticleID) AS t0_RefArticleID LEFT JOIN UNNEST(t0.RefType) AS t0_RefType",,9060d6e1-ee05-438a-9bae-b80814a5e065,1.1,ncau-data-newsquery-prd.cdm_content.collections_dimension_hist,4,8,Complexity is moderate due to nested subqueries and UNNEST operations; consolidation is high as multiple metric IDs refer to the same calculated date field.,4,daily,
t0_qt_zuagcreq4c,collection_ingest_date_adjusted,Collection Ingest Date (Adjusted),"The date of collection ingestion, adjusted by 11 hours, likely for timezone correction, derived from IngestTime.",ncau-data-newsquery-prd,cdm_content,collections_dimension_hist,"SELECT SAFE_CAST(DATETIME_ADD(DATETIME_TRUNC(SAFE_CAST(t0.IngestTime AS DATETIME), SECOND), INTERVAL 11 HOUR) AS DATE) AS t0_qt_zuagcreq4c FROM `ncau-data-newsquery-prd.cdm_content.collections_dimension_hist` AS t0 LEFT JOIN UNNEST(t0.RefArticleID) AS t0_RefArticleID LEFT JOIN UNNEST(t0.RefType) AS t0_RefType",,9060d6e1-ee05-438a-9bae-b80814a5e065,1.1,ncau-data-newsquery-prd.cdm_content.collections_dimension_hist,4,8,Complexity is moderate due to nested subqueries and UNNEST operations; consolidation is high as multiple metric IDs refer to the same calculated date field.,4,daily,
clmn2_,reference_article_id,Reference Article ID,"The ID of the referenced article, derived from unnesting the RefArticleID array.",ncau-data-newsquery-prd,cdm_content,collections_dimension_hist,SELECT t0_RefArticleID AS clmn2_ FROM `ncau-data-newsquery-prd.cdm_content.collections_dimension_hist` AS t0 LEFT JOIN UNNEST(t0.RefArticleID) AS t0_RefArticleID LEFT JOIN UNNEST(t0.RefType) AS t0_RefType,,9060d6e1-ee05-438a-9bae-b80814a5e065,1.1,ncau-data-newsquery-prd.cdm_content.collections_dimension_hist,4,8,Complexity is moderate due to nested subqueries and UNNEST operations; consolidation is high as multiple metric IDs refer to the same calculated date field.,4,daily,
clmn3_,reference_type,Reference Type,"The type of the reference, derived from unnesting the RefType array.",ncau-data-newsquery-prd,cdm_content,collections_dimension_hist,SELECT t0_RefType AS clmn3_ FROM `ncau-data-newsquery-prd.cdm_content.collections_dimension_hist` AS t0 LEFT JOIN UNNEST(t0.RefArticleID) AS t0_RefArticleID LEFT JOIN UNNEST(t0.RefType) AS t0_RefType,,9060d6e1-ee05-438a-9bae-b80814a5e065,1.1,ncau-data-newsquery-prd.cdm_content.collections_dimension_hist,4,8,Complexity is moderate due to nested subqueries and UNNEST operations; consolidation is high as multiple metric IDs refer to the same calculated date field.,4,daily,
t0_qt_jrxn4ddclc,day_target_by_publication_group_sum,Sum of Day Target by Publication Group,Represents the aggregated daily target value for a specific publication group.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_by_publication_group) AS t0_qt_jrxn4ddclc FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0,hardcoded_logic,127587ca-3bf2-4367-809c-ce91aca8fb52,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,10,"Low SQL complexity with simple aggregations and no joins. All identified metrics share the same base concept, indicating high consolidation.",1,daily,
t0_qt_ayg6woddud,sum_day_target_by_section_team,Sum of Day Target by Section Team (Generic),"Calculates the sum of daily targets for a specific section team within a given date range, without specific content filters.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_by_section_team) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE t0.targetdate >= '2025-07-28' AND t0.targetdate <= '2025-08-03',hardcoded_logic,246977b9-22df-4780-b0ad-f575607cd32d,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,7,"Queries are simple, single-table aggregations with hardcoded date and filter values. High consolidation potential as multiple metrics derive from the same base column with varying filters.",2,daily,
t0_qt_nbgk4hcdud,sum_day_target_by_section_team,Sum of Day Target by Section Team (Health Filtered),"Calculates the sum of daily targets for a specific section team, specifically for 'Health' content and excluding 'The Australian' website, within a given date range.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_by_section_team) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE t0.targetdate >= '2025-07-29' AND t0.targetdate <= '2025-08-04' AND t0.website != 'The Australian' AND t0.section_team = 'Health',hardcoded_logic,246977b9-22df-4780-b0ad-f575607cd32d,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,3,7,"Queries are simple, single-table aggregations with hardcoded date and filter values. High consolidation potential as multiple metrics derive from the same base column with varying filters.",2,daily,
t0_qt_7k2lipm79c,unique_users_per_table,Unique Users Per Table,"Counts the number of distinct users who have interacted with a specific table, providing insights into table usage patterns.",ncau-data-newsquery-prd,operations,newsquery_table_audit,"SELECT tableId, COUNT(DISTINCT User_Name) AS t0_qt_7k2lipm79c FROM `ncau-data-newsquery-prd.operations.newsquery_table_audit` GROUP BY tableId",anti_pattern,8ae7916a-45c9-4713-8d46-e3470805c7f6,1.1,ncau-data-newsquery-prd.operations.newsquery_table_audit;ncau-data-newsquery-prd.operations.pii_data;ncau-data-newsquery-prd.ops_prd_bq_logs.cloudaudit_googleapis_com_data_access_*,6,1,"The complexity score is moderate due to nested subqueries, a join, and various string/datetime functions in some queries, while others are simpler. The consolidation score is low as only one aggregated metric was identified across all provided queries.",1,daily,
t0_qt_7a34mgnv9c,distinct_sdm_sources,Count of Distinct SDM System Sources,"The total count of unique SDM system sources, excluding null, 'ops' related, and 'other' categories, representing active data origins.",ncau-data-newsquery-prd,operations,newsquery-metadata,"SELECT COUNT(DISTINCT sdm_sys_source) FROM `ncau-data-newsquery-prd.operations.newsquery-metadata` WHERE sdm_sys_source IS NOT null AND sdm_sys_source NOT LIKE ""%ops%"" AND sdm_sys_source != ""other""",hardcoded_logic,18ab97b7-4915-4422-bcb4-ceda8d436b25,1.1,ncau-data-newsquery-prd.operations.newsquery-metadata,6,3,Complexity is moderate due to nested subqueries and a window function. Consolidation potential is low as only three distinct base metrics were identified.,3,daily,
t0_qt_e2yh97dbzc,total_rows,Total Rows,"The sum of total rows for a specific date, representing the volume of data ingested.",ncau-data-newsquery-prd,operations,newsquery-metadata,SELECT SUM(total_rows) FROM `ncau-data-newsquery-prd.operations.newsquery-metadata` WHERE load_date >= DATE '2025-05-01' AND load_date <= DATE '2025-05-01',hardcoded_logic,18ab97b7-4915-4422-bcb4-ceda8d436b25,1.1,ncau-data-newsquery-prd.operations.newsquery-metadata,6,3,Complexity is moderate due to nested subqueries and a window function. Consolidation potential is low as only three distinct base metrics were identified.,3,daily,
t0_qt_z034ntcbzc,total_logical_gb,Total Logical GB (Converted to TB),"The sum of total logical gigabytes, converted to terabytes, representing storage consumption.",ncau-data-newsquery-prd,operations,newsquery-metadata,"SELECT SUM(SAFE_DIVIDE(total_logical_gb, 1000000)) FROM `ncau-data-newsquery-prd.operations.newsquery-metadata`",none,18ab97b7-4915-4422-bcb4-ceda8d436b25,1.1,ncau-data-newsquery-prd.operations.newsquery-metadata,6,3,Complexity is moderate due to nested subqueries and a window function. Consolidation potential is low as only three distinct base metrics were identified.,3,daily,
t0_qt_s9c0mo3dyc,total_records,Total Records (Alias 1),"The total number of records or rows in the dataset, often used to count occurrences for a given dimension.",ncau-data-newsquery-prd,asl_alteryx,consumer_churn_model_daily,SELECT COUNT(1) AS t0_qt_s9c0mo3dyc FROM `ncau-data-newsquery-prd.asl_alteryx.consumer_churn_model_daily`,,2cdcf36b-a99b-4beb-88a6-a28d238f6c1f,1.1,ncau-data-newsquery-prd.asl_alteryx.consumer_churn_model_daily,1,6,"The queries are very simple, primarily using COUNT and GROUP BY without joins or complex functions. There is some consolidation potential as different aliases are used for the same COUNT(1) metric.",3,none,
t0_qt_agwst4tcuc,total_records,Total Records (Alias 2),"The total number of records or rows in the dataset, often used to count occurrences for a given dimension.",ncau-data-newsquery-prd,asl_alteryx,consumer_churn_model_daily,SELECT COUNT(1) AS t0_qt_agwst4tcuc FROM `ncau-data-newsquery-prd.asl_alteryx.consumer_churn_model_daily`,,2cdcf36b-a99b-4beb-88a6-a28d238f6c1f,1.1,ncau-data-newsquery-prd.asl_alteryx.consumer_churn_model_daily,1,6,"The queries are very simple, primarily using COUNT and GROUP BY without joins or complex functions. There is some consolidation potential as different aliases are used for the same COUNT(1) metric.",3,none,
t0_qt_auvx74tcuc,count_pcsid,Count of PCSID,"The count of non-null PCSID values, representing the number of customer IDs in the dataset.",ncau-data-newsquery-prd,asl_alteryx,consumer_churn_model_daily,SELECT COUNT(t0.pcsid) AS t0_qt_auvx74tcuc FROM `ncau-data-newsquery-prd.asl_alteryx.consumer_churn_model_daily` AS t0,,2cdcf36b-a99b-4beb-88a6-a28d238f6c1f,1.1,ncau-data-newsquery-prd.asl_alteryx.consumer_churn_model_daily,1,6,"The queries are very simple, primarily using COUNT and GROUP BY without joins or complex functions. There is some consolidation potential as different aliases are used for the same COUNT(1) metric.",3,none,
t0_qt_qth1ib2h8c,total_interactions,Total Interactions (Float),"The sum of actual total interactions, cast as a float, from the social summary table.",ncau-data-newsquery-prd,prstn_verity,t_social_summary,SELECT SUM(SAFE_CAST(statistics_actual_total_interactions AS FLOAT64)) FROM `ncau-data-newsquery-prd.prstn_verity.t_social_summary`,none,eef984c7-b528-4716-a506-e8e8bcb7861f,1.1,ncau-data-newsquery-prd.prstn_verity.t_social_summary;ncau-data-newsquery-prd.PRSTN.t_subscription_details_snapshot_summary;ncau-data-newsquery-prd.prstn_verity.t_social_interactions_summary,4,7,"Complexity is moderate due to nested subqueries and date/time manipulations; consolidation potential is high as similar metrics (record counts, interactions) are derived from different tables within the same dataset.",4,daily,
t0_qt_sni9ql2h8c,record_count,Record Count (Social Summary),The count of records from the social summary table.,ncau-data-newsquery-prd,prstn_verity,t_social_summary,SELECT COUNT(1) FROM `ncau-data-newsquery-prd.prstn_verity.t_social_summary`,none,eef984c7-b528-4716-a506-e8e8bcb7861f,1.1,ncau-data-newsquery-prd.prstn_verity.t_social_summary;ncau-data-newsquery-prd.PRSTN.t_subscription_details_snapshot_summary;ncau-data-newsquery-prd.prstn_verity.t_social_interactions_summary,4,7,"Complexity is moderate due to nested subqueries and date/time manipulations; consolidation potential is high as similar metrics (record counts, interactions) are derived from different tables within the same dataset.",4,daily,
t0_qt_evim6t6cud,record_count,Record Count (Social Interactions Summary),The count of records from the social interactions summary table.,ncau-data-newsquery-prd,prstn_verity,t_social_interactions_summary,SELECT COUNT(1) FROM `ncau-data-newsquery-prd.prstn_verity.t_social_interactions_summary`,none,eef984c7-b528-4716-a506-e8e8bcb7861f,1.1,ncau-data-newsquery-prd.prstn_verity.t_social_summary;ncau-data-newsquery-prd.PRSTN.t_subscription_details_snapshot_summary;ncau-data-newsquery-prd.prstn_verity.t_social_interactions_summary,4,7,"Complexity is moderate due to nested subqueries and date/time manipulations; consolidation potential is high as similar metrics (record counts, interactions) are derived from different tables within the same dataset.",4,daily,
t0_qt_rina9t6cud,total_post_interactions,Total Post Interactions,The sum of post interactions count from the social interactions summary table.,ncau-data-newsquery-prd,prstn_verity,t_social_interactions_summary,SELECT SUM(post_interactions_count) FROM `ncau-data-newsquery-prd.prstn_verity.t_social_interactions_summary`,none,eef984c7-b528-4716-a506-e8e8bcb7861f,1.1,ncau-data-newsquery-prd.prstn_verity.t_social_summary;ncau-data-newsquery-prd.PRSTN.t_subscription_details_snapshot_summary;ncau-data-newsquery-prd.prstn_verity.t_social_interactions_summary,4,7,"Complexity is moderate due to nested subqueries and date/time manipulations; consolidation potential is high as similar metrics (record counts, interactions) are derived from different tables within the same dataset.",4,daily,
t0_qt_aubsvrczmd,total_records,"Total Records (Federal Election, March 24-30, Specific Websites)","Counts the total number of records from t_registration_details_snapshot_summary related to 'federal-election' in article sections/category paths, from specific news websites, within the date range 2025-03-24 to 2025-03-30.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT
  COUNT(1) AS t0_qt_aubsvrczmd
FROM
  `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0
WHERE
  t0.SubscriptionDateTime >= TIMESTAMP '2025-03-24'
  AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-03-30', INTERVAL 1 DAY)
  AND (
    SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection1 AS STRING), 'federal-election')
    OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection2 AS STRING), 'federal-election')
    OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection3 AS STRING), 'federal-election')
    OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'federal-election')
  )
  AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury')
LIMIT 2000001",hardcoded_logic,d3b51d1f-8b66-440f-9bc3-cc96429075bd,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,8,"The complexity is moderate due to nested subqueries and regex filtering, but lacks advanced SQL features. Consolidation potential is high as multiple count metrics differ only by hardcoded date ranges.",3,daily,
clmn0_,article_dominant_section_1,Distinct Article Dominant Section 1,Retrieves distinct values of ArticleDominantSection1 from t_registration_details_snapshot_summary.,ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT
  t0.ArticleDominantSection1 AS clmn0_
FROM
  `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0
GROUP BY
  t0.ArticleDominantSection1
ORDER BY
  t0.ArticleDominantSection1 DESC
LIMIT 2000001",anti_pattern,d3b51d1f-8b66-440f-9bc3-cc96429075bd,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,8,"The complexity is moderate due to nested subqueries and regex filtering, but lacks advanced SQL features. Consolidation potential is high as multiple count metrics differ only by hardcoded date ranges.",3,daily,
t0_qt_r93oq36xmd,total_records,"Total Records (Federal Election, April 1, Specific Websites)","Counts the total number of records from t_registration_details_snapshot_summary related to 'federal-election' in article sections/category paths, from specific news websites, for the date 2025-04-01.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT
  COUNT(1) AS t0_qt_r93oq36xmd
FROM
  `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0
WHERE
  t0.SubscriptionDateTime >= TIMESTAMP '2025-04-01'
  AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-04-01', INTERVAL 1 DAY)
  AND (
    SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection1 AS STRING), 'federal-election')
    OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection2 AS STRING), 'federal-election')
    OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection3 AS STRING), 'federal-election')
    OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'federal-election')
  )
  AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury')
LIMIT 2000001",hardcoded_logic,d3b51d1f-8b66-440f-9bc3-cc96429075bd,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,8,"The complexity is moderate due to nested subqueries and regex filtering, but lacks advanced SQL features. Consolidation potential is high as multiple count metrics differ only by hardcoded date ranges.",3,daily,
t0_qt_4aus30f4qd,actual_amount,Actual Amount,The actual financial amount recorded for a given period.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(Actual_Amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`,hardcoded_logic,cbab66df-64cb-4ec0-a112-088557684b7e,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,6,8,"The queries involve multiple CTEs and joins, with some hardcoded filter values. There is a high potential for metric consolidation as the same base metrics are queried under different aliases.",4,mixed,
t0_qt_5ra8oluwtd,last_year_actual_amount,Last Year Actual Amount,The actual financial amount recorded for the previous fiscal year.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(Last_Year_Actual_Amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`,hardcoded_logic,cbab66df-64cb-4ec0-a112-088557684b7e,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,6,8,"The queries involve multiple CTEs and joins, with some hardcoded filter values. There is a high potential for metric consolidation as the same base metrics are queried under different aliases.",4,mixed,
t0_qt_5391x1r1sd,actual_amount,Actual Amount,The actual financial amount recorded for a given period.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(Actual_Amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`,anti_pattern,cbab66df-64cb-4ec0-a112-088557684b7e,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,6,8,"The queries involve multiple CTEs and joins, with some hardcoded filter values. There is a high potential for metric consolidation as the same base metrics are queried under different aliases.",4,mixed,
t0_qt_cbx5oquwtd,last_year_actual_amount,Last Year Actual Amount,The actual financial amount recorded for the previous fiscal year.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(Last_Year_Actual_Amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`,hardcoded_logic,cbab66df-64cb-4ec0-a112-088557684b7e,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,6,8,"The queries involve multiple CTEs and joins, with some hardcoded filter values. There is a high potential for metric consolidation as the same base metrics are queried under different aliases.",4,mixed,
t0_qt_me8rmu2ctd,gross_revenue_amount,Gross Revenue Amount,"The total gross revenue amount for sales transactions, filtered by specific financial and calendar years, transaction statuses, record types, source systems, revenue types, and cost models.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(gross_revenue_amount)
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  financial_year BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
  AND source_publishing_division != 'Medium Rare Content Agency'
  AND calendar_year IN ('2024')
  AND cost_model_type IN ('Guaranteed')",,38809f41-7138-4b94-94d1-ae919b2d9517,1.1,ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client,3,1,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation is low as only two distinct quantitative metrics were identified, with no variations of the same base metric.",2,mixed,
t0_qt_ne8rmu2ctd,agency_commission_amount,Agency Commission Amount,"The total amount of commission paid to agencies, filtered by specific financial and calendar years, transaction statuses, record types, source systems, revenue types, and cost models.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(agency_commission_amount)
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  financial_year BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
  AND source_publishing_division != 'Medium Rare Content Agency'
  AND calendar_year IN ('2024')
  AND cost_model_type IN ('Guaranteed')",,38809f41-7138-4b94-94d1-ae919b2d9517,1.1,ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client,3,1,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation is low as only two distinct quantitative metrics were identified, with no variations of the same base metric.",2,mixed,
t0_qt_keo42k6alc,total_day_target_website,Weekly Website Subscription Target (The Australian),"The sum of the daily target for website subscriptions for 'The Australian' website, aggregated weekly within a specific date range.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT
    t0.week,
    SUM(t0.day_target_website) AS t0_qt_keo42k6alc
FROM
    `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0
WHERE
    PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2022-11-28'
    AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2023-04-23'
    AND t0.website = 'The Australian'
GROUP BY
    t0.week
ORDER BY
    t0.week ASC","hardcoded_logic,anti_pattern",e6db873d-657f-40e8-87a0-007d41f68a55,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,5,8,"Complexity is moderate due to nested subqueries and type casting, but lacks joins or advanced functions. Consolidation is high as only one unique metric type is extracted across identical queries.",1,weekly,
t0_qt_v1gbzkzz0c,day_target_by_publication_group,Day Target by Publication Group,"The daily subscription target for a publication group, filtered for 'Chronicle' website.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_by_publication_group) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE t0.targetdate >= DATE '2025-04-21' AND t0.targetdate <= DATE '2025-04-27' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.website AS STRING), 'Chronicle')",hardcoded_logic,6ee6cea9-d444-437d-96c9-cf93a94aad6b,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,1,5,"Low complexity due to simple SUM aggregations and basic filtering. Medium consolidation potential as two related metrics are sourced from the same table, suggesting a unified data model could serve both.",2,mixed,
t0_qt_h343ogzz0c,day_target_website,Day Target Website,"The daily subscription target for a specific website, filtered for 'Chronicle' website.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE t0.targetdate >= DATE '2025-08-19' AND t0.targetdate <= DATE '2025-08-19' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.website AS STRING), 'Chronicle')",hardcoded_logic,6ee6cea9-d444-437d-96c9-cf93a94aad6b,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,1,5,"Low complexity due to simple SUM aggregations and basic filtering. Medium consolidation potential as two related metrics are sourced from the same table, suggesting a unified data model could serve both.",2,mixed,
t0_qt_mpekech8ed_20250501,total_active_subscribers,"Total Active Subscribers (Consumer, Paying, Subscriber Type, May 1st 2025)","The sum of active subscriber counts for consumer, paying members of type 'subscriber' on May 1st, 2025, grouped by combined classification level 1.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_mpekech8ed FROM (
SELECT t0.active_subscriber_count AS clmn0_, t0.combined_classification_level_1 AS clmn1_, t0.combined_customer_type AS clmn2_, t0.combined_is_paying_flag AS clmn3_, t0.member_type AS clmn4_, t0.report_date AS clmn5_ FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0
) WHERE (clmn5_ >= DATE '2025-05-01' AND clmn5_ <= DATE '2025-05-01' AND clmn4_ = 'subscriber' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(clmn2_ AS STRING), 'Consumer') AND SAFE.REGEXP_CONTAINS(SAFE_CAST(clmn3_ AS STRING), 'Y')) GROUP BY clmn1_ ORDER BY t0_qt_mpekech8ed DESC LIMIT 2000001;",,76614538-e13f-4fd7-b6f2-f23a1ce65e1b,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,3,6,Queries involve simple aggregations on single tables with subqueries for column aliasing and basic filtering. Consolidation potential exists as the same core metric is filtered by different dates.,3,daily,
t0_qt_tl8edj5vjd,record_count,Total Records by Member Type,"The total count of records, grouped by member type, from the subscriber daily base movement table.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_daily_base_movement,"SELECT clmn0_, COUNT(1) AS t0_qt_tl8edj5vjd FROM (
SELECT t0.member_type AS clmn0_ FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement` AS t0
) GROUP BY clmn0_ ORDER BY t0_qt_tl8edj5vjd DESC LIMIT 2000001;",,76614538-e13f-4fd7-b6f2-f23a1ce65e1b,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,3,6,Queries involve simple aggregations on single tables with subqueries for column aliasing and basic filtering. Consolidation potential exists as the same core metric is filtered by different dates.,3,daily,
t0_qt_mpekech8ed_20250505,total_active_subscribers,"Total Active Subscribers (Consumer, Paying, Subscriber Type, May 5th 2025)","The sum of active subscriber counts for consumer, paying members of type 'subscriber' on May 5th, 2025, grouped by combined classification level 1.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_base_agg,"SELECT clmn1_, SUM(clmn0_) AS t0_qt_mpekech8ed FROM (
SELECT t0.active_subscriber_count AS clmn0_, t0.combined_classification_level_1 AS clmn1_, t0.combined_customer_type AS clmn2_, t0.combined_is_paying_flag AS clmn3_, t0.member_type AS clmn4_, t0.report_date AS clmn5_ FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg` AS t0
) WHERE (clmn5_ >= DATE '2025-05-05' AND clmn5_ <= DATE '2025-05-05' AND clmn4_ = 'subscriber' AND SAFE.REGEXP_CONTAINS(SAFE_CAST(clmn2_ AS STRING), 'Consumer') AND SAFE.REGEXP_CONTAINS(SAFE_CAST(clmn3_ AS STRING), 'Y')) GROUP BY clmn1_ ORDER BY t0_qt_mpekech8ed DESC LIMIT 2000001;",,76614538-e13f-4fd7-b6f2-f23a1ce65e1b,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_base_agg;ncau-data-newsquery-prd.asl_audience_insights.subscriber_daily_base_movement,3,6,Queries involve simple aggregations on single tables with subqueries for column aliasing and basic filtering. Consolidation potential exists as the same core metric is filtered by different dates.,3,daily,
t0_qt_9ghr4otgsd,total_newsletter_sends,Total Newsletter Sends,The sum of all newsletter sends recorded in the activity log.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(total_send) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity`,none,c902dea7-7c03-4995-a4f5-56ff4f6f5635,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity;ncau-data-newsquery-prd.cdm_sfmc.smsdetailsummary,2,3,Complexity is low due to simple aggregations and lack of joins or advanced SQL functions. Consolidation is low as the identified metrics represent distinct business concepts from different source tables.,2,monthly,
t0_qt_uoo4y9t1pd,total_sms_sent,Total SMS Sent,The sum of all SMS messages marked as 'sent' in the SMS detail summary.,ncau-data-newsquery-prd,cdm_sfmc,smsdetailsummary,SELECT SUM(sent) FROM `ncau-data-newsquery-prd.cdm_sfmc.smsdetailsummary`,none,c902dea7-7c03-4995-a4f5-56ff4f6f5635,1.1,ncau-data-newsquery-prd.prstn_consumer.newsletter_activity;ncau-data-newsquery-prd.cdm_sfmc.smsdetailsummary,2,3,Complexity is low due to simple aggregations and lack of joins or advanced SQL functions. Consolidation is low as the identified metrics represent distinct business concepts from different source tables.,2,monthly,
t0_qt_aypxwpxlrd,unique_pcsids,Unique PCSIDs (Monthly Trend),"Counts the number of unique PCSIDs (Publisher Content System IDs) from the swg_consent_subscribers table, grouped by month.",ncau-data-newsquery-prd,prstn_content_interaction,swg_consent_subscribers,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(month AS DATETIME), MONTH) AS DATE) AS month_start, COUNT(DISTINCT pcsids) AS t0_qt_aypxwpxlrd FROM `ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers` WHERE month >= DATE '2024-11-01' AND month <= DATE '2025-05-31' GROUP BY month_start",,3d387428-38ed-4de6-81a0-f75f3e904118,1.1,ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers;ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers_engagement,2,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as two metrics share the same base concept, differing only by date range. A governance issue identified is 'hardcoded_logic' due to specific date ranges embedded in WHERE clauses.",3,monthly,
t0_qt_5t2154vkrd,unique_pcsids,Unique PCSIDs (Specific Month),Counts the total number of unique PCSIDs (Publisher Content System IDs) from the swg_consent_subscribers table for a specific month.,ncau-data-newsquery-prd,prstn_content_interaction,swg_consent_subscribers,SELECT COUNT(DISTINCT pcsids) AS t0_qt_5t2154vkrd FROM `ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers` WHERE month >= DATE '2025-05-01' AND month <= DATE '2025-05-31',,3d387428-38ed-4de6-81a0-f75f3e904118,1.1,ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers;ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers_engagement,2,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as two metrics share the same base concept, differing only by date range. A governance issue identified is 'hardcoded_logic' due to specific date ranges embedded in WHERE clauses.",3,monthly,
t0_qt_3tvyx9xkrd,unique_subscriber_ids,Unique Subscriber IDs (Specific Month),Counts the total number of unique subscriber IDs from the swg_consent_subscribers_engagement table for a specific month.,ncau-data-newsquery-prd,prstn_content_interaction,swg_consent_subscribers_engagement,SELECT COUNT(DISTINCT subscriber_id) AS t0_qt_3tvyx9xkrd FROM `ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers_engagement` WHERE month >= DATE '2025-04-01' AND month <= DATE '2025-04-30',,3d387428-38ed-4de6-81a0-f75f3e904118,1.1,ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers;ncau-data-newsquery-prd.prstn_content_interaction.swg_consent_subscribers_engagement,2,6,"Complexity is low due to simple aggregations and no joins or window functions. Consolidation potential is moderate as two metrics share the same base concept, differing only by date range. A governance issue identified is 'hardcoded_logic' due to specific date ranges embedded in WHERE clauses.",3,monthly,
t0_qt_f627akddrd,revenue_gross,Programmatic Gross Revenue by Advertiser (Filtered),"The total gross revenue from programmatic advertising transactions, grouped by Advertiser, specifically for 'INDEPENDENT AGENCIES NSW' and excluding 'Guaranteed' transaction types.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT t0.Advertiser, SUM(t0.RevenueGross) AS t0_qt_f627akddrd FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE (t0.PortfolioParentGroup IN ('INDEPENDENT AGENCIES NSW') AND (t0.TransactionType NOT IN ('Guaranteed') OR t0.TransactionType IS NULL)) GROUP BY t0.Advertiser",hardcoded_logic,6f1c8731-02da-464f-b146-bf2947860735,1.1,ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month,2,8,"Complexity is low due to simple aggregation and lack of advanced SQL features. Consolidation potential is high as the same base metric is filtered by hardcoded values, and display logic is embedded in SQL.",1,monthly,
t0_qt_5cy3qg8snd,total_agency_commission_amount,Total Agency Commission Amount,"The sum of agency commission amounts for transactions related to Adpoint, with a 'STD' record type, 'Billed' or 'Booked' status, and 'Digital' revenue type, specifically for financial year 2025 and calendar years 2024 or 2025.",,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(agency_commission_amount) AS t0_qt_5cy3qg8snd
FROM
  `asl_advertising.v_adsales_revenue_client`
WHERE
  reporting_date >= '2022-01-01'
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND revenue_type = 'Digital'
  AND financial_year = '2025'
  AND calendar_year IN ('2024', '2025')","hardcoded_logic, anti_pattern",5515c1c6-18fe-449d-b621-d47631023320,1.1,asl_advertising.v_adsales_revenue_client,3,1,Low complexity due to simple aggregations and no complex SQL features; low consolidation benefit as only two distinct metrics were found.,2,mixed,
t0_qt_5m78n97ukd,total_gross_revenue_plus_adjustment,Total Gross Revenue (Excl. Adj.) Plus Adjustment,"The sum of gross revenue excluding adjustments plus adjustment amounts for transactions related to Adpoint, with a 'STD' record type, 'Billed' or 'Booked' status, and 'Digital' revenue type, specifically for financial year 2025 and calendar years 2024 or 2025.",,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(gross_revenue_ex_adj_amount + adjustment_amount) AS t0_qt_5m78n97ukd
FROM
  `asl_advertising.v_adsales_revenue_client`
WHERE
  reporting_date >= '2022-01-01'
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND revenue_type = 'Digital'
  AND financial_year = '2025'
  AND calendar_year IN ('2024', '2025')","hardcoded_logic, anti_pattern",5515c1c6-18fe-449d-b621-d47631023320,1.1,asl_advertising.v_adsales_revenue_client,3,1,Low complexity due to simple aggregations and no complex SQL features; low consolidation benefit as only two distinct metrics were found.,2,mixed,
t0_qt_m6jzjhydqd,total_amount,Total Amount (Filtered by Year 2025 and Revenue Type '01'),"The sum of the amount column, specifically for revenue types starting with '01' and for the year 2025.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS t0_qt_m6jzjhydqd FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 WHERE SAFE.LEFT(t0.revenue_type, 2) = '01' AND FLOOR(SAFE_DIVIDE(t0.fy_year_week_number, 100)) = 2025",hardcoded_logic,c32d96e5-38f4-48a8-9b70-3d89a83f03aa,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check,4,9,Complexity is moderate due to nested subqueries and basic transformations. Consolidation is high as all metrics are variations of SUM(amount) with different hardcoded filters.,3,weekly,
t0_qt_wcwi6vydqd,total_amount,Total Amount (Filtered by Specific FY Weeks and Revenue Types starting with '02'),"The sum of the amount column, specifically for revenue types starting with '02' and a predefined list of FY year-week numbers and revenue types.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS t0_qt_wcwi6vydqd FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 WHERE SAFE.LEFT(t0.revenue_type, 2) = '02' AND t0.fy_year_week_number IN (202511, 202512, 202513, 202514, 202515, 202516, 202517, 202518, 202519, 202520, 202521, 202522, 202523, 202524, 202525, 202526, 202527, 202528, 202529, 202530, 202531, 202532, 202533, 202534, 202535, 202536, 202537) AND t0.revenue_type IN ('02 - snapshot - DTI Charges & Volume', '02 - snapshot - THINK - print subs revenue', '02 - snapshot - RCTI Charges & Volume', '02 - snapshot - RCTI - rev rec charge', '02 - snapshot - DTI - rev rec charge', '02 - snapshot - DTI - unmigrated print subs revenue')",hardcoded_logic,c32d96e5-38f4-48a8-9b70-3d89a83f03aa,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check,4,9,Complexity is moderate due to nested subqueries and basic transformations. Consolidation is high as all metrics are variations of SUM(amount) with different hardcoded filters.,3,weekly,
t0_qt_wcwi6vydqd,total_amount,Total Amount (Filtered by Revenue Types starting with '02'),"The sum of the amount column, specifically for revenue types starting with '02'.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS t0_qt_wcwi6vydqd FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 WHERE SAFE.LEFT(t0.revenue_type, 2) = '02'",hardcoded_logic,c32d96e5-38f4-48a8-9b70-3d89a83f03aa,1.1,ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check,4,9,Complexity is moderate due to nested subqueries and basic transformations. Consolidation is high as all metrics are variations of SUM(amount) with different hardcoded filters.,3,weekly,
clmn0_,article_dominant_section_1,Article Dominant Section 1,The primary dominant section associated with an article.,ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,SELECT t0.ArticleDominantSection1 AS clmn0_ FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0,none,35de2eed-9c03-48a7-8cef-50e2ea1e1235,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,7,"Complexity is moderate due to nested subqueries and advanced string/date functions in filters. Consolidation benefit is high as core dimensions are repeatedly selected and a key metric uses complex, hardcoded filters on the same base table.",4,none,
clmn1_,article_id,Article ID,The unique identifier for an article.,ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,SELECT t0.ArticleID AS clmn1_ FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0,none,35de2eed-9c03-48a7-8cef-50e2ea1e1235,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,7,"Complexity is moderate due to nested subqueries and advanced string/date functions in filters. Consolidation benefit is high as core dimensions are repeatedly selected and a key metric uses complex, hardcoded filters on the same base table.",4,none,
clmn2_,category_topic_path,Category Topic Path,The hierarchical path describing the category and topic of an article.,ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,SELECT t0.categorytopic_path AS clmn2_ FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0,none,35de2eed-9c03-48a7-8cef-50e2ea1e1235,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,7,"Complexity is moderate due to nested subqueries and advanced string/date functions in filters. Consolidation benefit is high as core dimensions are repeatedly selected and a key metric uses complex, hardcoded filters on the same base table.",4,none,
t0_qt_ypg3fyegrd,record_count,Filtered Record Count,"The total number of records matching specific hardcoded criteria related to subscription dates, article sections, and websites.",ncau-data-newsquery-prd,prstn_verity,t_registration_details_snapshot_summary,"SELECT COUNT(1) AS t0_qt_ypg3fyegrd FROM `ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary` AS t0 WHERE (t0.SubscriptionDateTime >= TIMESTAMP '2025-01-01' AND t0.SubscriptionDateTime < TIMESTAMP_ADD(TIMESTAMP '2025-04-11', INTERVAL 1 DAY) AND (SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection1 AS STRING), 'federal-election') OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection2 AS STRING), 'federal-election') OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.ArticleDominantSection3 AS STRING), 'federal-election') OR SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.categorytopic_path AS STRING), 'federal-election')) AND SAFE.REGEXP_CONTAINS(SAFE_CAST(t0.Website AS STRING), 'Courier|Telegraph|Herald|Advertiser|Bulletin|Cairns|NTNews|Chronicle|Mercury'))",hardcoded_logic,35de2eed-9c03-48a7-8cef-50e2ea1e1235,1.1,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary,5,7,"Complexity is moderate due to nested subqueries and advanced string/date functions in filters. Consolidation benefit is high as core dimensions are repeatedly selected and a key metric uses complex, hardcoded filters on the same base table.",4,none,
t0_qt_73ldtxh0lc_20250421_20250427,c_score_target_sum,Sum of C-Score Target (Week 2025-04-21 to 2025-04-27),"The sum of the c-score target for the week ending 2025-04-27, grouped by publication.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-04-21' AND t0.week_ending <= DATE '2025-04-27') GROUP BY t0.publication_group",,e2102eb1-8bdb-4df7-b3ea-e72481f1bb55,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Complexity is low due to simple aggregation and single table usage. Consolidation is high as all metrics are the same base calculation with only date filters varying, indicating a strong candidate for a parameterized or templated metric.",3,weekly,
t0_qt_73ldtxh0lc_20250428_20250504,c_score_target_sum,Sum of C-Score Target (Week 2025-04-28 to 2025-05-04),"The sum of the c-score target for the week ending 2025-05-04, grouped by publication.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-04-28' AND t0.week_ending <= DATE '2025-05-04') GROUP BY t0.publication_group",,e2102eb1-8bdb-4df7-b3ea-e72481f1bb55,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Complexity is low due to simple aggregation and single table usage. Consolidation is high as all metrics are the same base calculation with only date filters varying, indicating a strong candidate for a parameterized or templated metric.",3,weekly,
t0_qt_73ldtxh0lc_20250310_20250316,c_score_target_sum,Sum of C-Score Target (Week 2025-03-10 to 2025-03-16),"The sum of the c-score target for the week ending 2025-03-16, grouped by publication.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE (t0.week_ending >= DATE '2025-03-10' AND t0.week_ending <= DATE '2025-03-16') GROUP BY t0.publication_group",,e2102eb1-8bdb-4df7-b3ea-e72481f1bb55,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,9,"Complexity is low due to simple aggregation and single table usage. Consolidation is high as all metrics are the same base calculation with only date filters varying, indicating a strong candidate for a parameterized or templated metric.",3,weekly,
t0_qt_nbgk4hcdud,total_day_target_by_section_team,Total Day Target by Section Team,"The sum of daily subscription targets for specific content sections or teams, filtered for non-Australian publications and health/wellness sections.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT
    SUM(t0.day_target_by_section_team) AS t0_qt_nbgk4hcdud
FROM
    `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0
WHERE
    (PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-08-27'
    AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-09-02'
    AND t0.publication_group != 'The Australian'
    AND (t0.section_team = 'Health' OR STRPOS(t0.section_team, 'wellness') > 0))
GROUP BY
    t0.day_target_by_publication_group,
    t0.day_target_by_section_team,
    PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)),
    t0.section_team,
    t0.website,
    t0.week",,0cbe9a87-5f64-4e05-b993-a508e98ecdcd,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,5,8,"Complexity is moderate due to excessive nesting and obscure aliasing for a simple aggregation. Consolidation is high as all queries use the same core metric, differing only by date filters.",1,daily,
t0_qt_cfq6p00gbd,day_target_website,"Sum of Daily Website Target (April 28 - May 4, 2025)","Aggregated daily website subscription targets for the period April 28 to May 4, 2025.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-04-28' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-05-04'",hardcoded_logic,eda51dbb-3cc6-46c2-b1f7-8189b682760a,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,2,9,Low complexity due to simple aggregations and no joins. High consolidation potential as all metrics are the same aggregation with only different hardcoded date filters.,2,weekly,
t0_qt_cfq6p00gbd,day_target_website,"Sum of Daily Website Target (June 23 - June 29, 2025)","Aggregated daily website subscription targets for the period June 23 to June 29, 2025.",ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,"SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) >= DATE '2025-06-23' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.targetdate AS STRING)) <= DATE '2025-06-29'",hardcoded_logic,eda51dbb-3cc6-46c2-b1f7-8189b682760a,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,2,9,Low complexity due to simple aggregations and no joins. High consolidation potential as all metrics are the same aggregation with only different hardcoded date filters.,2,weekly,
t0c0d1_qt_0pkoql7vjd,distinct_subscription_orders,Distinct Acquisition Orders,Counts the number of unique subscription order IDs specifically for acquisition movements.,ncau-data-newsquery-prd,prstn_consumer,subscription_movement,SELECT COUNT(DISTINCT SAFE_CAST(t0c0d1.subscription_order_id_src AS STRING)) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_movement` AS t0c0d1 WHERE t0c0d1.subscription_movement_count_type = 'acquisition',hardcoded_logic,db85d1ac-5987-469f-978a-5334af29f7aa,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_movement;ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,4,7,"Complexity is moderate due to nested subqueries and a lengthy CASE statement for a dimension, but lacks advanced SQL features. Consolidation potential is high within each data source, especially for newsletter metrics, and if the 'acquisition' filter for subscription metrics were parameterized.",6,weekly,
t0c0d1_qt_z9zogl7vjd,total_subscription_movements,Total Acquisition Movements,Sums the total count of subscription movements specifically for acquisition movements.,ncau-data-newsquery-prd,prstn_consumer,subscription_movement,SELECT SUM(t0c0d1.subscription_movement_count) FROM `ncau-data-newsquery-prd.prstn_consumer.subscription_movement` AS t0c0d1 WHERE t0c0d1.subscription_movement_count_type = 'acquisition',hardcoded_logic,db85d1ac-5987-469f-978a-5334af29f7aa,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_movement;ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,4,7,"Complexity is moderate due to nested subqueries and a lengthy CASE statement for a dimension, but lacks advanced SQL features. Consolidation potential is high within each data source, especially for newsletter metrics, and if the 'acquisition' filter for subscription metrics were parameterized.",6,weekly,
t0c0d1_qt_ccjb4pu4pd,total_unique_opens,Total Unique Newsletter Opens,Sums the total count of unique opens for newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.unique_open) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,db85d1ac-5987-469f-978a-5334af29f7aa,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_movement;ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,4,7,"Complexity is moderate due to nested subqueries and a lengthy CASE statement for a dimension, but lacks advanced SQL features. Consolidation potential is high within each data source, especially for newsletter metrics, and if the 'acquisition' filter for subscription metrics were parameterized.",6,weekly,
t0c0d1_qt_qozitpu4pd,total_sends,Total Newsletter Sends,Sums the total count of newsletters sent.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.total_send) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,db85d1ac-5987-469f-978a-5334af29f7aa,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_movement;ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,4,7,"Complexity is moderate due to nested subqueries and a lengthy CASE statement for a dimension, but lacks advanced SQL features. Consolidation potential is high within each data source, especially for newsletter metrics, and if the 'acquisition' filter for subscription metrics were parameterized.",6,weekly,
t0c0d1_qt_tkkmhru4pd,total_unsubscribes,Total Newsletter Unsubscribes,Sums the total count of unsubscribes from newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.total_unsubscribe) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,db85d1ac-5987-469f-978a-5334af29f7aa,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_movement;ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,4,7,"Complexity is moderate due to nested subqueries and a lengthy CASE statement for a dimension, but lacks advanced SQL features. Consolidation potential is high within each data source, especially for newsletter metrics, and if the 'acquisition' filter for subscription metrics were parameterized.",6,weekly,
t0c0d1_qt_wrek8tu4pd,total_clicks,Total Newsletter Clicks,Sums the total count of clicks on newsletters.,ncau-data-newsquery-prd,prstn_consumer,newsletter_activity,SELECT SUM(t0c0d1.total_click) FROM `ncau-data-newsquery-prd.prstn_consumer.newsletter_activity` AS t0c0d1,none,db85d1ac-5987-469f-978a-5334af29f7aa,1.1,ncau-data-newsquery-prd.prstn_consumer.subscription_movement;ncau-data-newsquery-prd.prstn_consumer.newsletter_activity,4,7,"Complexity is moderate due to nested subqueries and a lengthy CASE statement for a dimension, but lacks advanced SQL features. Consolidation potential is high within each data source, especially for newsletter metrics, and if the 'acquisition' filter for subscription metrics were parameterized.",6,weekly,
t0_qt_yzud6iuzud,total_audience,Total Audience,The sum of the audience measure for the specified period.,ncau-data-newsquery-prd,prstn_content_interaction,monthly_exec_summary,SELECT SUM(SAFE_CAST(t0.Audience AS FLOAT64)) AS t0_qt_yzud6iuzud FROM `ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary` AS t0,none,73153654-dd99-4f67-839d-a986a52ca1e2,1.1,ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary,3,7,"The queries are straightforward aggregations without joins or complex functions, leading to low complexity. The presence of two distinct metric IDs for the same underlying calculation indicates a good opportunity for metric consolidation.",4,monthly,
t0_D15899193207419793048,total_audience,Total Audience,The sum of the audience measure for the specified period.,ncau-data-newsquery-prd,prstn_content_interaction,monthly_exec_summary,SELECT SUM(SAFE_CAST(t0.Audience AS FLOAT64)) AS t0_D15899193207419793048 FROM `ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary` AS t0,none,73153654-dd99-4f67-839d-a986a52ca1e2,1.1,ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary,3,7,"The queries are straightforward aggregations without joins or complex functions, leading to low complexity. The presence of two distinct metric IDs for the same underlying calculation indicates a good opportunity for metric consolidation.",4,monthly,
t0_qt_7yzv87dq7c,audience_change_percentage,Audience Change Percentage,The percentage change in audience from the previous month.,ncau-data-newsquery-prd,prstn_content_interaction,monthly_exec_summary,"SELECT SUM(SAFE_DIVIDE((SAFE_CAST(t0.Audience AS FLOAT64) - SAFE_CAST(t0.Audience_Previous_Month AS FLOAT64)), SAFE_CAST(t0.Audience_Previous_Month AS FLOAT64))) AS t0_qt_7yzv87dq7c FROM `ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary` AS t0",none,73153654-dd99-4f67-839d-a986a52ca1e2,1.1,ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary,3,7,"The queries are straightforward aggregations without joins or complex functions, leading to low complexity. The presence of two distinct metric IDs for the same underlying calculation indicates a good opportunity for metric consolidation.",4,monthly,
t0_qt_le5xaalzud,scaled_previous_month_audience,Scaled Previous Month Audience,"The audience from the previous month, scaled by a factor of 1000.",ncau-data-newsquery-prd,prstn_content_interaction,monthly_exec_summary,SELECT SUM((SAFE_CAST(t0.Audience_Previous_Month AS FLOAT64) * 1000)) AS t0_qt_le5xaalzud FROM `ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary` AS t0,hardcoded_logic,73153654-dd99-4f67-839d-a986a52ca1e2,1.1,ncau-data-newsquery-prd.prstn_content_interaction.monthly_exec_summary,3,7,"The queries are straightforward aggregations without joins or complex functions, leading to low complexity. The presence of two distinct metric IDs for the same underlying calculation indicates a good opportunity for metric consolidation.",4,monthly,
t0_D13373905595285714644,total_clicks,Total Clicks,"The total number of clicks for 'Vogue Austraila' in February 2025, excluding queries containing 'vogue'.",ncau-data-newsquery-prd,prstn_content_interaction,search_console_publication_url_summary,"SELECT SUM(t0.clicks) FROM `ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary` AS t0 WHERE (t0.visit_date >= DATE '2025-02-01' AND t0.visit_date <= DATE '2025-02-28' AND t0.brand = 'Vogue Austraila' AND STRPOS(t0.query, 'vogue') <= 0)","hardcoded_logic,anti_pattern",4e74297f-bdb0-426c-9c82-d42067eef9ee,1.1,ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary,2,8,"Low SQL complexity with simple aggregations and no joins. High consolidation potential due to repeated metric aliases with varying hardcoded filters (brand, date, query exclusion) that could be parameterized.",4,monthly,
t0_D17296606414479937006,total_impressions,Total Impressions,"The total number of impressions for 'Vogue Austraila' in February 2025, excluding queries containing 'vogue'.",ncau-data-newsquery-prd,prstn_content_interaction,search_console_publication_url_summary,"SELECT SUM(t0.impressions) FROM `ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary` AS t0 WHERE (t0.visit_date >= DATE '2025-02-01' AND t0.visit_date <= DATE '2025-02-28' AND t0.brand = 'Vogue Austraila' AND STRPOS(t0.query, 'vogue') <= 0)","hardcoded_logic,anti_pattern",4e74297f-bdb0-426c-9c82-d42067eef9ee,1.1,ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary,2,8,"Low SQL complexity with simple aggregations and no joins. High consolidation potential due to repeated metric aliases with varying hardcoded filters (brand, date, query exclusion) that could be parameterized.",4,monthly,
t0_D13373905595285714644,total_clicks,Total Clicks,"The total number of clicks for 'Kidspot' in August 2025, excluding queries containing 'kidspot'.",ncau-data-newsquery-prd,prstn_content_interaction,search_console_publication_url_summary,"SELECT SUM(t0.clicks) FROM `ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary` AS t0 WHERE (t0.visit_date >= DATE '2025-08-01' AND t0.visit_date <= DATE '2025-08-31' AND t0.brand = 'Kidspot' AND STRPOS(t0.query, 'kidspot') <= 0)","hardcoded_logic,anti_pattern",4e74297f-bdb0-426c-9c82-d42067eef9ee,1.1,ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary,2,8,"Low SQL complexity with simple aggregations and no joins. High consolidation potential due to repeated metric aliases with varying hardcoded filters (brand, date, query exclusion) that could be parameterized.",4,monthly,
t0_D17296606414479937006,total_impressions,Total Impressions,"The total number of impressions for 'Kidspot' in August 2025, excluding queries containing 'kidspot'.",ncau-data-newsquery-prd,prstn_content_interaction,search_console_publication_url_summary,"SELECT SUM(t0.impressions) FROM `ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary` AS t0 WHERE (t0.visit_date >= DATE '2025-08-01' AND t0.visit_date <= DATE '2025-08-31' AND t0.brand = 'Kidspot' AND STRPOS(t0.query, 'kidspot') <= 0)","hardcoded_logic,anti_pattern",4e74297f-bdb0-426c-9c82-d42067eef9ee,1.1,ncau-data-newsquery-prd.prstn_content_interaction.search_console_publication_url_summary,2,8,"Low SQL complexity with simple aggregations and no joins. High consolidation potential due to repeated metric aliases with varying hardcoded filters (brand, date, query exclusion) that could be parameterized.",4,monthly,
t0_qt_iplasz2lad,day_target_by_publication_group,Daily Target by Publication Group,The daily subscription target for a specific publication group.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_by_publication_group) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0,hardcoded_logic,b8ff9b19-a3c3-4b05-a4a1-d6626d5783da,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,4,7,"Complexity is moderate due to nested subqueries and date parsing/truncation, but lacks joins or advanced functions. Consolidation benefit is high as multiple Looker Studio generated aliases point to the same underlying base metrics.",5,weekly,
t0_qt_xf3kjz2lad,day_target_website,Daily Target by Website,The daily subscription target for a specific website.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0,hardcoded_logic,b8ff9b19-a3c3-4b05-a4a1-d6626d5783da,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,4,7,"Complexity is moderate due to nested subqueries and date parsing/truncation, but lacks joins or advanced functions. Consolidation benefit is high as multiple Looker Studio generated aliases point to the same underlying base metrics.",5,weekly,
t0_qt_dxojlcsfxc,day_target_by_publication_group,Daily Target by Publication Group (Alternate Alias),The daily subscription target for a specific publication group.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_by_publication_group) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0,hardcoded_logic,b8ff9b19-a3c3-4b05-a4a1-d6626d5783da,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,4,7,"Complexity is moderate due to nested subqueries and date parsing/truncation, but lacks joins or advanced functions. Consolidation benefit is high as multiple Looker Studio generated aliases point to the same underlying base metrics.",5,weekly,
t0_qt_y7qal64alc,day_target_website,Daily Target by Website (Alternate Alias),The daily subscription target for a specific website.,ncau-data-newsquery-prd,cdm_reference_data,subscription_targets,SELECT SUM(t0.day_target_website) FROM `ncau-data-newsquery-prd.cdm_reference_data.subscription_targets` AS t0,hardcoded_logic,b8ff9b19-a3c3-4b05-a4a1-d6626d5783da,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,4,7,"Complexity is moderate due to nested subqueries and date parsing/truncation, but lacks joins or advanced functions. Consolidation benefit is high as multiple Looker Studio generated aliases point to the same underlying base metrics.",5,weekly,
t0_qt_j2b9jbhclc,c_score_target,C-Score Target,The target C-score for a given period.,ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,SELECT SUM(t0.c_score_target) FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0,hardcoded_logic,b8ff9b19-a3c3-4b05-a4a1-d6626d5783da,1.1,ncau-data-newsquery-prd.cdm_reference_data.subscription_targets;ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,4,7,"Complexity is moderate due to nested subqueries and date parsing/truncation, but lacks joins or advanced functions. Consolidation benefit is high as multiple Looker Studio generated aliases point to the same underlying base metrics.",5,weekly,
t0_qt_xx5gly07qd,total_lgr,Total LGR,"The sum of Looker Generated Revenue (LGR) for records where either the current or prior year PV flag is 'NPV', the relative fiscal year month offset is non-negative, and LGR is not zero.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT SUM(t0.LGR) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE ((t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') AND t0.relative_fy_month_offset >= 0 AND t0.LGR != 0.000000),hardcoded_logic,7ada02b8-e93e-41d8-9a7e-05013ff81247,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_npv,5,6,"Complexity is moderate due to nested subqueries and obfuscated column names, though the underlying logic is simple. Consolidation benefit is moderate as two out of three metrics are derived from the same core financial data with shared filtering logic.",3,mixed,
t0_qt_zjhak707qd,total_relative_fy_month_offset,Total Relative FY Month Offset,"The sum of the relative fiscal year month offset for records where either the current or prior year PV flag is 'NPV', the relative fiscal year month offset is non-negative, and LGR is not zero.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT SUM(t0.relative_fy_month_offset) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE ((t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') AND t0.relative_fy_month_offset >= 0 AND t0.LGR != 0.000000),hardcoded_logic,7ada02b8-e93e-41d8-9a7e-05013ff81247,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_npv,5,6,"Complexity is moderate due to nested subqueries and obfuscated column names, though the underlying logic is simple. Consolidation benefit is moderate as two out of three metrics are derived from the same core financial data with shared filtering logic.",3,mixed,
t0_qt_t030egusod,dw_asl_load_timestamp_truncated,Data Warehouse ASL Load Timestamp (Truncated to Second),"The timestamp when the ASL data was loaded into the data warehouse, truncated to the nearest second.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,"SELECT DATETIME_TRUNC(t0.dw_asl_load_timestamp, SECOND) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0",anti_pattern,7ada02b8-e93e-41d8-9a7e-05013ff81247,1.1,ncau-data-newsquery-prd.asl_finance_derived.adsales_npv,5,6,"Complexity is moderate due to nested subqueries and obfuscated column names, though the underlying logic is simple. Consolidation benefit is moderate as two out of three metrics are derived from the same core financial data with shared filtering logic.",3,mixed,
t0_qt_srywj8t8od,total_subscription_movements,"Total Subscription Movements (Weekly, Digital/Bundles/DPE/Essentials/Metered, Paying, Subscriber, Non-Switch, Non-Print-only, Gender/Age Available)","Calculates the sum of subscription movement counts for paying subscribers with specific digital/bundle classifications, excluding switch types and print-only, for a weekly period, where gender and age data are available.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_adds,"SELECT SUM(t0_subscription_details.detail_subscription_movement_count) FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_adds` AS t0 LEFT JOIN UNNEST(t0.subscription_details) AS t0_subscription_details WHERE (t0.subscriber_movement_date >= DATE '2025-07-09' AND t0.subscriber_movement_date <= DATE '2025-07-15' AND (t0_subscription_details.classification_level_2 = 'Digital' OR t0_subscription_details.classification_level_2 = 'Bundles' OR t0_subscription_details.classification_level_2 = 'DPE only' OR t0_subscription_details.classification_level_2 = 'Essentials' OR t0_subscription_details.classification_level_2 = 'Metered Access') AND t0_subscription_details.is_paying_flag = 'Y' AND t0.member_type = 'subscriber' AND NOT SAFE.REGEXP_CONTAINS(SAFE_CAST(t0_subscription_details.key_adds_type AS STRING), 'Switch') AND t0_subscription_details.classification_level_2 != 'Print-only' AND t0.subscriber_individual_gender != 'NOT AVAILABLE' AND t0.subscriber_individual_age != 'Not Available')","hardcoded_logic, anti_pattern",464dbd27-97f1-4665-bd93-22b4e9520bfe,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_adds,7,9,"Complexity is high due to subqueries, UNNEST, and complex filtering logic. Consolidation potential is high as both identified metrics are filtered variations of the same base column.",2,mixed,
t0_qt_uasgtco3od,total_subscription_movements,"Total Subscription Movements (Daily, Digital/Bundles/DPE/Essentials/Metered, Paying, Subscriber, Non-Available Mosaic Title, Non-Print-only, Masthead TA)","Calculates the sum of subscription movement counts for paying subscribers with specific digital/bundle classifications, excluding print-only, for a daily period, where mosaic title is available and masthead is 'TA'.",ncau-data-newsquery-prd,asl_audience_insights,subscriber_adds,SELECT SUM(t0_subscription_details.detail_subscription_movement_count) FROM `ncau-data-newsquery-prd.asl_audience_insights.subscriber_adds` AS t0 LEFT JOIN UNNEST(t0.subscription_details) AS t0_subscription_details WHERE (t0.subscriber_movement_date >= DATE '2025-08-31' AND t0.subscriber_movement_date <= DATE '2025-08-31' AND (t0_subscription_details.classification_level_2 = 'Digital' OR t0_subscription_details.classification_level_2 = 'Bundles' OR t0_subscription_details.classification_level_2 = 'DPE only' OR t0_subscription_details.classification_level_2 = 'Essentials' OR t0_subscription_details.classification_level_2 = 'Metered Access') AND t0_subscription_details.is_paying_flag = 'Y' AND t0.member_type = 'subscriber' AND t0.subscriber_mosaic_title != 'Not Available' AND t0_subscription_details.classification_level_2 != 'Print-only' AND t0_subscription_details.masthead IN ('TA')),"hardcoded_logic, anti_pattern",464dbd27-97f1-4665-bd93-22b4e9520bfe,1.1,ncau-data-newsquery-prd.asl_audience_insights.subscriber_adds,7,9,"Complexity is high due to subqueries, UNNEST, and complex filtering logic. Consolidation potential is high as both identified metrics are filtered variations of the same base column.",2,mixed,
clmn1_,fiscal_week_of_year,Fiscal Week of Year,The number representing the fiscal week within its respective fiscal year.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim`,none,a1c16d3b-d19a-4abd-b96c-7a87580815db,1.1,ncau-data-newsquery-prd.prstn_finance.calendar_dim,2,8,"Complexity is low due to simple column selections and a single date truncation. Consolidation is high as all metrics originate from a single dimension table, and a derived date metric is duplicated across different internal Looker Studio aliases.",5,mixed,
clmn2_,fiscal_week_of_year_name,Fiscal Week of Year Name,The descriptive name or label for the fiscal week within its respective fiscal year.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year_name FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim`,none,a1c16d3b-d19a-4abd-b96c-7a87580815db,1.1,ncau-data-newsquery-prd.prstn_finance.calendar_dim,2,8,"Complexity is low due to simple column selections and a single date truncation. Consolidation is high as all metrics originate from a single dimension table, and a derived date metric is duplicated across different internal Looker Studio aliases.",5,mixed,
t0c0d1_qt_c5eaduuhmd,iso_week_start_date,ISO Week Start Date,The calculated start date of the ISO week based on the calendar date.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(calendar_date AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim`",hardcoded_logic,a1c16d3b-d19a-4abd-b96c-7a87580815db,1.1,ncau-data-newsquery-prd.prstn_finance.calendar_dim,2,8,"Complexity is low due to simple column selections and a single date truncation. Consolidation is high as all metrics originate from a single dimension table, and a derived date metric is duplicated across different internal Looker Studio aliases.",5,mixed,
clmn3_,fiscal_year,Fiscal Year,The fiscal year number.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim`,none,a1c16d3b-d19a-4abd-b96c-7a87580815db,1.1,ncau-data-newsquery-prd.prstn_finance.calendar_dim,2,8,"Complexity is low due to simple column selections and a single date truncation. Consolidation is high as all metrics originate from a single dimension table, and a derived date metric is duplicated across different internal Looker Studio aliases.",5,mixed,
t0c0d2_qt_7u8jrvuhmd,iso_week_start_date,ISO Week Start Date,The calculated start date of the ISO week based on the calendar date.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(calendar_date AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim`",hardcoded_logic,a1c16d3b-d19a-4abd-b96c-7a87580815db,1.1,ncau-data-newsquery-prd.prstn_finance.calendar_dim,2,8,"Complexity is low due to simple column selections and a single date truncation. Consolidation is high as all metrics originate from a single dimension table, and a derived date metric is duplicated across different internal Looker Studio aliases.",5,mixed,
t0_qt_crybuf6lid,total_adds,Total Adds,The total number of new subscriptions or additions for the specified period and filters.,ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_activity_daily_summary,SELECT SUM(t0.adds) AS t0_qt_crybuf6lid FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_activity_daily_summary` AS t0 WHERE (t0.report_date >= DATE '2025-05-04' AND t0.report_date <= DATE '2025-05-04' AND t0.class_lvl_1 = 'Standard Paid' AND t0.delivery_medium != 'Print' AND t0.masthead = 'CM'),,42b711d5-6567-46b6-bf11-0f33e66e297e,1.1,ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_activity_daily_summary,2,8,Complexity is low due to simple aggregation and no joins. Consolidation is high as all metrics derive from 'adds' and 'cancels' columns. Governance issues include hardcoded date and filter values ('hardcoded_logic') and a Looker Studio export limit ('anti_pattern').,3,daily,
t0_qt_drybuf6lid,total_cancels,Total Cancels,The total number of cancellations or churns for the specified period and filters.,ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_activity_daily_summary,SELECT SUM(t0.cancels) AS t0_qt_drybuf6lid FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_activity_daily_summary` AS t0 WHERE (t0.report_date >= DATE '2025-05-04' AND t0.report_date <= DATE '2025-05-04' AND t0.class_lvl_1 = 'Standard Paid' AND t0.delivery_medium != 'Print' AND t0.masthead = 'CM'),,42b711d5-6567-46b6-bf11-0f33e66e297e,1.1,ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_activity_daily_summary,2,8,Complexity is low due to simple aggregation and no joins. Consolidation is high as all metrics derive from 'adds' and 'cancels' columns. Governance issues include hardcoded date and filter values ('hardcoded_logic') and a Looker Studio export limit ('anti_pattern').,3,daily,
t0_qt_erybuf6lid,net_activity,Net Activity (Adds - Cancels),"The net change in subscriptions, calculated as total adds minus total cancels, for the specified period and filters.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_activity_daily_summary,SELECT SUM(t0.adds - t0.cancels) AS t0_qt_erybuf6lid FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_activity_daily_summary` AS t0 WHERE (t0.report_date >= DATE '2025-05-04' AND t0.report_date <= DATE '2025-05-04' AND t0.class_lvl_1 = 'Standard Paid' AND t0.delivery_medium != 'Print' AND t0.masthead = 'CM'),,42b711d5-6567-46b6-bf11-0f33e66e297e,1.1,ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_activity_daily_summary,2,8,Complexity is low due to simple aggregation and no joins. Consolidation is high as all metrics derive from 'adds' and 'cancels' columns. Governance issues include hardcoded date and filter values ('hardcoded_logic') and a Looker Studio export limit ('anti_pattern').,3,daily,
t0_qt_61faq6u1jd,unique_contacts,Unique Contacts (ID 61faq6u1jd),Counts the number of unique contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards`,anti_pattern,5d551155-3caa-466b-a1ef-01d0cfa95966,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Very simple queries with only a single aggregate function and no joins. All identified metrics are identical in their calculation, indicating high potential for consolidation.",3,none,
t0_qt_rh2ojfy2jd,unique_contacts,Unique Contacts (ID rh2ojfy2jd),Counts the number of unique contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards`,anti_pattern,5d551155-3caa-466b-a1ef-01d0cfa95966,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Very simple queries with only a single aggregate function and no joins. All identified metrics are identical in their calculation, indicating high potential for consolidation.",3,none,
t0_qt_zqzw8ey2jd,unique_contacts,Unique Contacts (ID zqzw8ey2jd),Counts the number of unique contact IDs from the plus rewards program.,ncau-data-newsquery-prd,sdm_rewards,plus_rewards,SELECT COUNT(DISTINCT contact_id) FROM `ncau-data-newsquery-prd.sdm_rewards.plus_rewards`,anti_pattern,5d551155-3caa-466b-a1ef-01d0cfa95966,1.1,ncau-data-newsquery-prd.sdm_rewards.plus_rewards,1,10,"Very simple queries with only a single aggregate function and no joins. All identified metrics are identical in their calculation, indicating high potential for consolidation.",3,none,
t0_qt_5z7upg2tpd,total_visits_target_deviation,Total Visits Target Deviation Percentage,Calculates the percentage deviation of total website visits (web + AMP) from the target number of sessions.,ncau-data-newsquery-prd,prstn_content_interaction,kidspot_daily_traffic,"SELECT SUM(SAFE_DIVIDE(((t0.web_visits + t0.amp_visits) - t0.sessions_target), t0.sessions_target)) AS t0_qt_5z7upg2tpd FROM `ncau-data-newsquery-prd.prstn_content_interaction.kidspot_daily_traffic` AS t0 WHERE t0.visit_date = DATE '2025-07-13'","hardcoded_logic, anti_pattern",0a4ccf98-dfe7-4bab-b2ed-e2a27ebd9588,1.1,ncau-data-newsquery-prd.prstn_content_interaction.kidspot_daily_traffic;ncau-data-newsquery-prd.prstn_content_interaction.kidspot_daily_content,2,5,Complexity is low due to simple queries with no joins or complex functions. Consolidation is moderate as there are distinct core metrics from different tables.,2,daily,
t0_qt_765km6brtd,total_page_views,Total Page Views (Social),Aggregates the total page views for content specifically originating from 'Social' data type.,ncau-data-newsquery-prd,prstn_content_interaction,kidspot_daily_content,SELECT SUM(t0.page_views) AS t0_qt_765km6brtd FROM `ncau-data-newsquery-prd.prstn_content_interaction.kidspot_daily_content` AS t0 WHERE t0.visit_date = DATE '2025-07-23' AND t0.data_type = 'Social',"hardcoded_logic, anti_pattern",0a4ccf98-dfe7-4bab-b2ed-e2a27ebd9588,1.1,ncau-data-newsquery-prd.prstn_content_interaction.kidspot_daily_traffic;ncau-data-newsquery-prd.prstn_content_interaction.kidspot_daily_content,2,5,Complexity is low due to simple queries with no joins or complex functions. Consolidation is moderate as there are distinct core metrics from different tables.,2,daily,
t0_qt_73ldtxh0lc_aug_04_10_2025,c_score_target_sum,"C-Score Target Sum (Aug 4-10, 2025)","The sum of c-score targets for the week of August 4th to August 10th, 2025, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending BETWEEN DATE '2025-08-04' AND DATE '2025-08-10' GROUP BY t0.publication_group",hardcoded_logic,c22e86d8-835d-4a68-8c10-5d131e225e6b,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Low complexity due to simple aggregation and filtering. High consolidation potential as metrics are identical except for hardcoded date ranges.,2,weekly,
t0_qt_73ldtxh0lc_may_19_25_2025,c_score_target_sum,"C-Score Target Sum (May 19-25, 2025)","The sum of c-score targets for the week of May 19th to May 25th, 2025, grouped by publication group.",ncau-data-newsquery-prd,cdm_reference_data,cscore_targets,"SELECT t0.publication_group, SUM(t0.c_score_target) AS t0_qt_73ldtxh0lc FROM `ncau-data-newsquery-prd.cdm_reference_data.cscore_targets` AS t0 WHERE t0.week_ending BETWEEN DATE '2025-05-19' AND DATE '2025-05-25' GROUP BY t0.publication_group",hardcoded_logic,c22e86d8-835d-4a68-8c10-5d131e225e6b,1.1,ncau-data-newsquery-prd.cdm_reference_data.cscore_targets,1,10,Low complexity due to simple aggregation and filtering. High consolidation potential as metrics are identical except for hardcoded date ranges.,2,weekly,
