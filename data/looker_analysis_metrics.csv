metric_id,base_metric_id,metric_name,business_description,gcp_project_name,dataset_name,table_name,sql_logic,metric_sql_core,metric_type,is_kpi,business_criticality,response_id,dashboard_id
fiscal_week_number,fiscal_week_number,Fiscal Week Number,"The fiscal week number within a fiscal year, typically ranging from 1 to 52 or 53.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1;,fy_week_of_year,dimension,False,low,0,a1c16d3b-d19a-4abd-b96c-7a87580815db
fiscal_week_name,fiscal_week_name,Fiscal Week Name,"The descriptive name for the fiscal week, e.g., 'Week 1', 'Week 2'.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year_name FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1;,fy_week_of_year_name,dimension,False,low,0,a1c16d3b-d19a-4abd-b96c-7a87580815db
fiscal_year,fiscal_year,Fiscal Year,The fiscal year to which a calendar date belongs.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1;,fy_year,dimension,False,low,0,a1c16d3b-d19a-4abd-b96c-7a87580815db
iso_week_start_date,iso_week_start_date,ISO Week Start Date,"The start date of the ISO week for a given calendar date, derived by truncating the calendar date to the beginning of its ISO week.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(calendar_date AS DATETIME), ISOWEEK) AS DATE) AS iso_week_start_date FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1;","SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(calendar_date AS DATETIME), ISOWEEK) AS DATE)",calculated_field,False,low,0,a1c16d3b-d19a-4abd-b96c-7a87580815db
absolute_variance_tableau_tm1_jul_2026,absolute_variance_tableau_tm1,Absolute Variance (Tableau vs TM1),"The absolute difference between Tableau Actual Amount and TM1 Amount, summed up. Used to measure reconciliation discrepancies between the two financial systems.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT
    t1.os_level_6,
    SUM(ABS(t1.Tableau_Actual_Amount - t1.TM1_Amount)) AS absolute_variance_tableau_tm1
FROM (
    SELECT
        t0.TM1_Amount,
        t0.Tableau_Actual_Amount,
        t0.fiscal_year,
        t0.month_short_name,
        t0.os_level_6,
        t0.publication_code
    FROM
        `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0
) AS t1
WHERE
    SAFE.REGEXP_CONTAINS(t1.publication_code, '^(^[0-9]+$)$') IS TRUE
    AND t1.fiscal_year = 2026
    AND t1.month_short_name = 'Jul'
GROUP BY
    t1.os_level_6
ORDER BY
    t1.os_level_6 DESC
LIMIT 10;",SUM(ABS(t1.Tableau_Actual_Amount - t1.TM1_Amount)),aggregation,True,high,1,f353b933-30eb-4853-9976-0d35371db7d7
total_tm1_amount_jul_2026,total_tm1_amount,Total TM1 Amount,The sum of amounts recorded in the TM1 financial planning and consolidation system.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT
    t1.os_level_6,
    SUM(t1.TM1_Amount) AS total_tm1_amount
FROM (
    SELECT
        t0.TM1_Amount,
        t0.Tableau_Actual_Amount,
        t0.fiscal_year,
        t0.month_short_name,
        t0.os_level_6,
        t0.publication_code
    FROM
        `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0
) AS t1
WHERE
    SAFE.REGEXP_CONTAINS(t1.publication_code, '^(^[0-9]+$)$') IS TRUE
    AND t1.fiscal_year = 2026
    AND t1.month_short_name = 'Jul'
GROUP BY
    t1.os_level_6
ORDER BY
    t1.os_level_6 DESC
LIMIT 10;",SUM(t1.TM1_Amount),aggregation,True,high,1,f353b933-30eb-4853-9976-0d35371db7d7
total_tableau_actual_amount_jul_2026,total_tableau_actual_amount,Total Tableau Actual Amount,The sum of actual amounts reported and reconciled in Tableau.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT
    t1.os_level_6,
    SUM(t1.Tableau_Actual_Amount) AS total_tableau_actual_amount
FROM (
    SELECT
        t0.TM1_Amount,
        t0.Tableau_Actual_Amount,
        t0.fiscal_year,
        t0.month_short_name,
        t0.os_level_6,
        t0.publication_code
    FROM
        `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0
) AS t1
WHERE
    SAFE.REGEXP_CONTAINS(t1.publication_code, '^(^[0-9]+$)$') IS TRUE
    AND t1.fiscal_year = 2026
    AND t1.month_short_name = 'Jul'
GROUP BY
    t1.os_level_6
ORDER BY
    t1.os_level_6 DESC
LIMIT 10;",SUM(t1.Tableau_Actual_Amount),aggregation,True,high,1,f353b933-30eb-4853-9976-0d35371db7d7
fixed_calendar_period_label_filtered_advertiser_booking,fixed_calendar_period_label,Fixed Calendar Period Label (Filtered by Advertiser & Booking),"A hardcoded label 'Calendar Period' used for display or filtering, specifically when filtered by 'Brisbane Festival' advertiser and '627989' booking number.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END AS fixed_calendar_period_label FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(advertiser_name AS STRING) IN ('Brisbane Festival') AND SAFE_CAST(booking_number AS STRING) IN ('627989'),CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END,calculated_field,False,low,2,70ed3b92-987b-479b-9ed7-d2903bd2787e
dw_asl_load_timestamp_filtered_booking,dw_asl_load_timestamp,Data Warehouse ASL Load Timestamp (Filtered by Booking),"The timestamp when the data was loaded into the ASL data warehouse, specifically for booking number '154245'.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(dw_asl_load_timestamp AS TIMESTAMP) AS dw_asl_load_timestamp FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(booking_number AS STRING) IN ('154245'),dw_asl_load_timestamp,dimension,False,low,2,70ed3b92-987b-479b-9ed7-d2903bd2787e
account_number_filtered_advertiser,account_number,Account Number (Filtered by Advertiser),"The unique identifier for an account, specifically for 'Coles Supermarkets Head Office' advertiser.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(account_number AS STRING) AS account_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(advertiser_name AS STRING) IN ('Coles Supermarkets Head Office'),account_number,dimension,False,low,2,70ed3b92-987b-479b-9ed7-d2903bd2787e
fixed_calendar_period_label_filtered_booking,fixed_calendar_period_label,Fixed Calendar Period Label (Filtered by Booking),"A hardcoded label 'Calendar Period' used for display or filtering, specifically when filtered by '587405' booking number.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END AS fixed_calendar_period_label FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(booking_number AS STRING) = '587405',CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END,calculated_field,False,low,2,70ed3b92-987b-479b-9ed7-d2903bd2787e
crm_account_number_all,crm_account_number,CRM Account Number (All),"The unique identifier for an account as recorded in the CRM system, without any specific filters.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(crm_account_number AS STRING) AS crm_account_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard`,crm_account_number,dimension,False,low,2,70ed3b92-987b-479b-9ed7-d2903bd2787e
fixed_calendar_period_label_all,fixed_calendar_period_label,Fixed Calendar Period Label (All),"A hardcoded label 'Calendar Period' used for display or filtering, without any specific filters.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END AS fixed_calendar_period_label FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard`,CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END,calculated_field,False,low,2,70ed3b92-987b-479b-9ed7-d2903bd2787e
closing_base_3rd_party_v_current_week,closing_base_3rd_party,Closing Base 3rd Party (V) - Current Week,"The closing base for 3rd party subscriptions/accounts, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Closing_Base_3rd_Party_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_v_current_week,total_closing_base,Total Closing Base (V) - Current Week,"The total closing base for all subscriptions/accounts, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Closing_Base_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_v_current_week,revenue_consumer,Revenue Consumer (V) - Current Week,"Revenue generated from consumer subscriptions/sales, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Consumer_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_v_current_week,revenue_3rd_party,Revenue 3rd Party (V) - Current Week,"Revenue generated from 3rd party sources, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_3rd_Party_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_v_current_week,revenue_corp,Revenue Corp (V) - Current Week,"Revenue generated from corporate accounts, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Corp_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_v_current_week,revenue_campus,Revenue Campus (V) - Current Week,"Revenue generated from campus-related sales, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Campus_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_v_current_week,revenue_other,Revenue Other (V) - Current Week,"Revenue generated from other sources, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Other_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_v_current_week,total_revenue,Total Revenue (V) - Current Week,"Total revenue generated from all sources, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Revenue_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_v_current_week,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party (V) - Current Week,"Net growth in subscriptions/accounts including 3rd party, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_incl_3rd_Party_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_v_current_week,net_growth_consumer,Net Growth Consumer (V) - Current Week,"Net growth in consumer subscriptions/accounts, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_Consumer_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_v_current_week,net_growth_3rd_party,Net Growth 3rd Party (V) - Current Week,"Net growth in 3rd party subscriptions/accounts, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_3rd_Party_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_v_current_week,breach_sales,Breach Sales (V) - Current Week,"Sales related to breaches, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Breach_Sales_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_v_current_week,always_on_digital_sales,Always On Digital Sales (V) - Current Week,"Digital sales from 'always on' campaigns, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Always_on_Digital_Sales_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_v_current_week,general_offer_sales,General Offer Sales (V) - Current Week,"Sales from general offers, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(General_Offer_Sales_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_v_current_week,other_sales,Other Sales (V) - Current Week,"Sales from other categories, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Other_Sales_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_v_current_week,total_weekly_sales,Total Weekly Sales (V) - Current Week,"Total sales for the current week, version V.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Weekly_Sales_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_v_current_week,essentials,Essentials (V) - Current Week,"Sales or volume related to essential products/services, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Essentials_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_v_current_week,switches,Switches (V) - Current Week,"Number of customer switches/migrations, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Switches_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_v_current_week,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (V) - Current Week,"Total cancellations including 3rd party, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Cancels_including_3rd_Party_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_v_current_week,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (V) - Current Week,"Total cancellations excluding 3rd party, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Cancels_excluding_3rd_Party_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_v_current_week,net_cancels,Net Cancels (V) - Current Week,"Net cancellations, version V, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Cancels_V),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
failed_payment_volume_current_week,failed_payment_volume,Failed Payment Volume - Current Week,Volume of failed payments for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Failed_Payment_Volume),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_consumer_current_week,closing_base_consumer,Closing Base Consumer - Current Week,The closing base for consumer subscriptions/accounts for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Closing_Base_Consumer),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_gpla_current_week,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA - Current Week,"Net growth in 3rd party subscriptions/accounts from GPLA, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_3rd_Party_GPLA),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_current_week,breach_sales,Breach Sales - Current Week,Sales related to breaches for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Breach_Sales),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_current_week,always_on_digital_sales,Always On Digital Sales - Current Week,Digital sales from 'always on' campaigns for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Always_on_Digital_Sales),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_current_week,general_offer_sales,General Offer Sales - Current Week,Sales from general offers for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(General_Offer_Sales),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_current_week,other_sales,Other Sales - Current Week,Sales from other categories for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Other_Sales),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_current_week,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party - Current Week,Net growth in subscriptions/accounts including 3rd party for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_incl_3rd_Party),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_current_week,total_weekly_sales,Total Weekly Sales - Current Week,Total sales for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Weekly_Sales),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_current_week,net_growth_consumer,Net Growth Consumer - Current Week,Net growth in consumer subscriptions/accounts for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_Consumer),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_current_week,essentials,Essentials - Current Week,Sales or volume related to essential products/services for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Essentials),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_current_week,net_growth_3rd_party,Net Growth 3rd Party - Current Week,Net growth in 3rd party subscriptions/accounts for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_3rd_Party),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_current_week,switches,Switches - Current Week,Number of customer switches/migrations for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Switches),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_apls_current_week,net_growth_3rd_party_apls,Net Growth 3rd Party APLS - Current Week,"Net growth in 3rd party subscriptions/accounts from APLS, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Growth_3rd_Party_APLS),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_current_week,total_cancels_including_3rd_party,Total Cancels Including 3rd Party - Current Week,Total cancellations including 3rd party for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Cancels_including_3rd_Party),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_current_week,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party - Current Week,Total cancellations excluding 3rd party for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Cancels_excluding_3rd_Party),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_current_week,net_cancels,Net Cancels - Current Week,Net cancellations for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Net_Cancels),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_current_week,closing_base_3rd_party,Closing Base 3rd Party - Current Week,The closing base for 3rd party subscriptions/accounts for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Closing_Base_3rd_Party),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_apls_current_week,closing_base_3rd_party_apls,Closing Base 3rd Party APLS - Current Week,"The closing base for 3rd party subscriptions/accounts from APLS, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Closing_Base_3rd_Party_APLS),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_gpla_current_week,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA - Current Week,"The closing base for 3rd party subscriptions/accounts from GPLA, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Closing_Base_3rd_Party_GPLA),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_current_week,total_closing_base,Total Closing Base - Current Week,The total closing base for all subscriptions/accounts for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Closing_Base),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_current_week,revenue_consumer,Revenue Consumer - Current Week,Revenue generated from consumer subscriptions/sales for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Consumer),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_current_week,revenue_3rd_party,Revenue 3rd Party - Current Week,Revenue generated from 3rd party sources for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_3rd_Party),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_apls_current_week,revenue_3rd_party_apls,Revenue 3rd Party APLS - Current Week,"Revenue generated from 3rd party sources via APLS, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_3rd_Party_APLS),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_gpla_current_week,revenue_3rd_party_gpla,Revenue 3rd Party GPLA - Current Week,"Revenue generated from 3rd party sources via GPLA, for the current week.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_3rd_Party_GPLA),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_current_week,revenue_corp,Revenue Corp - Current Week,Revenue generated from corporate accounts for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Corp),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_current_week,revenue_campus,Revenue Campus - Current Week,Revenue generated from campus-related sales for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Campus),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_current_week,revenue_other,Revenue Other - Current Week,Revenue generated from other sources for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Revenue_Other),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_current_week,total_revenue,Total Revenue - Current Week,Total revenue generated from all sources for the current week.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,SUM(Total_Revenue),measure,True,high,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
fy_week_of_year_dimension,fy_week_of_year,Fiscal Week of Year,The fiscal week number within the fiscal year.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT DISTINCT t0c0d2.fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 10,fy_week_of_year,dimension,False,medium,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
fy_year_dimension,fy_year,Fiscal Year,The fiscal year.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT DISTINCT t0c0d2.fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 10,fy_year,dimension,False,medium,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
iso_week_start_date_dimension,iso_week_start_date,ISO Week Start Date,The start date of the ISO week for a given calendar date.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT DISTINCT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(t0c0d2.calendar_date AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 10","SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(calendar_date AS DATETIME), ISOWEEK) AS DATE)",dimension,False,medium,3,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_budget_weekly_courier_mail,total_closing_base,"Total Closing Base (Budget/Forecast) - Weekly, Courier Mail","The total closing base for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN (CASE WHEN t0.fy_week_of_year = 36 THEN t0.Total_Closing_Base_B ELSE NULL END) ELSE t0.Total_Closing_Base_B END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Total_Closing_Base_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
other_sales_budget_weekly_courier_mail,other_sales,"Other Sales (Budget/Forecast) - Weekly, Courier Mail","The sum of other sales for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Other_Sales_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Other_Sales_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_consumer_budget_weekly_courier_mail,revenue_consumer,"Revenue Consumer (Budget/Forecast) - Weekly, Courier Mail","The sum of consumer revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_Consumer_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_Consumer_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_weekly_sales_budget_weekly_courier_mail,total_weekly_sales,"Total Weekly Sales (Budget/Forecast) - Weekly, Courier Mail","The total weekly sales for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Total_Weekly_Sales_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Total_Weekly_Sales_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_budget_weekly_courier_mail,revenue_3rd_party,"Revenue 3rd Party (Budget/Forecast) - Weekly, Courier Mail","The sum of 3rd party revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_3rd_Party_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_3rd_Party_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
essentials_budget_weekly_courier_mail,essentials,"Essentials (Budget/Forecast) - Weekly, Courier Mail","The sum of essentials for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Essentials_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Essentials_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_corp_budget_weekly_courier_mail,revenue_corp,"Revenue Corp (Budget/Forecast) - Weekly, Courier Mail","The sum of corporate revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_Corp_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_Corp_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
switches_budget_weekly_courier_mail,switches,"Switches (Budget/Forecast) - Weekly, Courier Mail","The sum of switches for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Switches_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Switches_B),measure,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_campus_budget_weekly_courier_mail,revenue_campus,"Revenue Campus (Budget/Forecast) - Weekly, Courier Mail","The sum of campus revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_Campus_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_Campus_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_cancels_including_3rd_party_budget_weekly_courier_mail,total_cancels_including_3rd_party,"Total Cancels (incl. 3rd Party) (Budget/Forecast) - Weekly, Courier Mail","The total cancels including 3rd party for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Total_Cancels_including_3rd_Party_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Total_Cancels_including_3rd_Party_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_other_budget_weekly_courier_mail,revenue_other,"Revenue Other (Budget/Forecast) - Weekly, Courier Mail","The sum of other revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_Other_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_Other_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_cancels_excluding_3rd_party_budget_weekly_courier_mail,total_cancels_excluding_3rd_party,"Total Cancels (excl. 3rd Party) (Budget/Forecast) - Weekly, Courier Mail","The total cancels excluding 3rd party for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Total_Cancels_excluding_3rd_Party_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_revenue_budget_weekly_courier_mail,total_revenue,"Total Revenue (Budget/Forecast) - Weekly, Courier Mail","The total revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Total_Revenue_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Total_Revenue_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_cancels_budget_weekly_courier_mail,net_cancels,"Net Cancels (Budget/Forecast) - Weekly, Courier Mail","The net cancels for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Net_Cancels_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Net_Cancels_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_budget_weekly_courier_mail,closing_base_3rd_party,"Closing Base 3rd Party (Budget/Forecast) - Weekly, Courier Mail","The closing base for 3rd party for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN (CASE WHEN t0.fy_week_of_year = 36 THEN t0.Closing_Base_3rd_Party_B ELSE NULL END) ELSE t0.Closing_Base_3rd_Party_B END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Closing_Base_3rd_Party_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_apls_budget_weekly_courier_mail,net_growth_3rd_party_apls,"Net Growth 3rd Party APLS (Budget/Forecast) - Weekly, Courier Mail","The net growth for 3rd party APLS for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Net_Growth_3rd_Party_APLS_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Net_Growth_3rd_Party_APLS_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_gpla_budget_weekly_courier_mail,net_growth_3rd_party_gpla,"Net Growth 3rd Party GPLA (Budget/Forecast) - Weekly, Courier Mail","The net growth for 3rd party GPLA for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Net_Growth_3rd_Party_GPLA_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Net_Growth_3rd_Party_GPLA_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_apls_budget_weekly_courier_mail,closing_base_3rd_party_apls,"Closing Base 3rd Party APLS (Budget/Forecast) - Weekly, Courier Mail","The closing base for 3rd party APLS for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN (CASE WHEN t0.fy_week_of_year = 36 THEN t0.Closing_Base_3rd_Party_APLS_B ELSE NULL END) ELSE t0.Closing_Base_3rd_Party_APLS_B END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Closing_Base_3rd_Party_APLS_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_gpla_budget_weekly_courier_mail,closing_base_3rd_party_gpla,"Closing Base 3rd Party GPLA (Budget/Forecast) - Weekly, Courier Mail","The closing base for 3rd party GPLA for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN (CASE WHEN t0.fy_week_of_year = 36 THEN t0.Closing_Base_3rd_Party_GPLA_B ELSE NULL END) ELSE t0.Closing_Base_3rd_Party_GPLA_B END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Closing_Base_3rd_Party_GPLA_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_incl_3rd_party_budget_weekly_courier_mail,net_growth_incl_3rd_party,"Net Growth (incl. 3rd Party) (Budget/Forecast) - Weekly, Courier Mail","The net growth including 3rd party for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Net_Growth_incl_3rd_Party_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Net_Growth_incl_3rd_Party_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_consumer_budget_weekly_courier_mail,net_growth_consumer,"Net Growth Consumer (Budget/Forecast) - Weekly, Courier Mail","The net growth for consumer for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Net_Growth_Consumer_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Net_Growth_Consumer_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_apls_budget_weekly_courier_mail,revenue_3rd_party_apls,"Revenue 3rd Party APLS (Budget/Forecast) - Weekly, Courier Mail","The sum of 3rd party APLS revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_3rd_Party_APLS_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_3rd_Party_APLS_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_budget_weekly_courier_mail,net_growth_3rd_party,"Net Growth 3rd Party (Budget/Forecast) - Weekly, Courier Mail","The net growth for 3rd party for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Net_Growth_3rd_Party_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Net_Growth_3rd_Party_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_gpla_budget_weekly_courier_mail,revenue_3rd_party_gpla,"Revenue 3rd Party GPLA (Budget/Forecast) - Weekly, Courier Mail","The sum of 3rd party GPLA revenue for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Revenue_3rd_Party_GPLA_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Revenue_3rd_Party_GPLA_B),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
breach_sales_budget_weekly_courier_mail,breach_sales,"Breach Sales (Budget/Forecast) - Weekly, Courier Mail","The sum of breach sales for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Breach_Sales_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Breach_Sales_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
always_on_digital_sales_budget_weekly_courier_mail,always_on_digital_sales,"Always-on Digital Sales (Budget/Forecast) - Weekly, Courier Mail","The sum of always-on digital sales for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.Always_on_Digital_Sales_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.Always_on_Digital_Sales_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
general_offer_sales_budget_weekly_courier_mail,general_offer_sales,"General Offer Sales (Budget/Forecast) - Weekly, Courier Mail","The sum of general offer sales for budget/forecast, filtered for the current fiscal week of 2025 and specifically for 'Courier Mail' masthead.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(t0.General_Offer_Sales_B) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND (t0.masthead = 'CM'),SUM(t0.General_Offer_Sales_B),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
fy_week_of_year_calendar_dim,fy_week_of_year,Fiscal Week of Year (Calendar Dimension),The fiscal week number of the year from the calendar dimension table.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT t0c0d2.fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1,t0c0d2.fy_week_of_year,dimension,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
fy_year_calendar_dim,fy_year,Fiscal Year (Calendar Dimension),The fiscal year from the calendar dimension table.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT t0c0d2.fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1,t0c0d2.fy_year,dimension,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
week_start_date_calendar_dim,week_start_date,Week Start Date (Calendar Dimension),The start date of the ISO week from the calendar dimension table.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(t0c0d2.calendar_date AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1","SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(t0c0d2.calendar_date AS DATETIME), ISOWEEK) AS DATE)",dimension,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
fy_week_of_year_derived_calendar_dim,fy_week_of_year,"Fiscal Week of Year (Derived, Calendar Dim)","Fiscal week of year, potentially adjusted by day of week, from calendar dimension.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-03-26 04:03:25.079241+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-26 04:03:25.079241+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-26 04:03:25.079241+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1","CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-03-26 04:03:25.079241+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-26 04:03:25.079241+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-26 04:03:25.079241+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END",dimension,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_revenue_actual_weekly_all_mastheads,total_revenue,"Total Revenue (Actual) - Weekly, All Mastheads","The total actual revenue, filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Total_Revenue ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Revenue),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_revenue_actual_date_range_all_mastheads,total_revenue,"Total Revenue (Actual) - Date Range, All Mastheads","The total actual revenue, filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Total_Revenue ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Revenue),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_gpla_actual_weekly_all_mastheads,closing_base_3rd_party_gpla,"Closing Base 3rd Party GPLA (Actual) - Weekly, All Mastheads","The closing base for 3rd party GPLA (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Closing_Base_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_gpla_actual_date_range_all_mastheads,closing_base_3rd_party_gpla,"Closing Base 3rd Party GPLA (Actual) - Date Range, All Mastheads","The closing base for 3rd party GPLA (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Closing_Base_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_actual_weekly_all_mastheads,closing_base_3rd_party,"Closing Base 3rd Party (Actual) - Weekly, All Mastheads","The closing base for 3rd party (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Closing_Base_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_actual_date_range_all_mastheads,closing_base_3rd_party,"Closing Base 3rd Party (Actual) - Date Range, All Mastheads","The closing base for 3rd party (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Closing_Base_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_apls_actual_weekly_all_mastheads,closing_base_3rd_party_apls,"Closing Base 3rd Party APLS (Actual) - Weekly, All Mastheads","The closing base for 3rd party APLS (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Closing_Base_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_3rd_party_apls_actual_date_range_all_mastheads,closing_base_3rd_party_apls,"Closing Base 3rd Party APLS (Actual) - Date Range, All Mastheads","The closing base for 3rd party APLS (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Closing_Base_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_consumer_actual_weekly_all_mastheads,closing_base_consumer,"Closing Base Consumer (Actual) - Weekly, All Mastheads","The closing base for consumer (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Closing_Base_Consumer ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_Consumer),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
closing_base_consumer_actual_date_range_all_mastheads,closing_base_consumer,"Closing Base Consumer (Actual) - Date Range, All Mastheads","The closing base for consumer (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Closing_Base_Consumer ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Closing_Base_Consumer),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
essentials_actual_weekly_all_mastheads,essentials,"Essentials (Actual) - Weekly, All Mastheads","The sum of essentials (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Essentials ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Essentials),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
essentials_actual_date_range_all_mastheads,essentials,"Essentials (Actual) - Date Range, All Mastheads","The sum of essentials (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Essentials ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Essentials),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
failed_payment_volume_actual_weekly_all_mastheads,failed_payment_volume,"Failed Payment Volume (Actual) - Weekly, All Mastheads","The sum of failed payment volume (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Failed_Payment_Volume ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Failed_Payment_Volume),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
failed_payment_volume_actual_date_range_all_mastheads,failed_payment_volume,"Failed Payment Volume (Actual) - Date Range, All Mastheads","The sum of failed payment volume (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Failed_Payment_Volume ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Failed_Payment_Volume),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
general_offer_sales_actual_weekly_all_mastheads,general_offer_sales,"General Offer Sales (Actual) - Weekly, All Mastheads","The sum of general offer sales (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.General_Offer_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.General_Offer_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
general_offer_sales_actual_date_range_all_mastheads,general_offer_sales,"General Offer Sales (Actual) - Date Range, All Mastheads","The sum of general offer sales (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.General_Offer_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.General_Offer_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_cancels_actual_weekly_all_mastheads,net_cancels,"Net Cancels (Actual) - Weekly, All Mastheads","The net cancels (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Net_Cancels ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Cancels),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_cancels_actual_date_range_all_mastheads,net_cancels,"Net Cancels (Actual) - Date Range, All Mastheads","The net cancels (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Net_Cancels ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Cancels),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_actual_weekly_all_mastheads,net_growth_3rd_party,"Net Growth 3rd Party (Actual) - Weekly, All Mastheads","The net growth for 3rd party (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Net_Growth_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_actual_date_range_all_mastheads,net_growth_3rd_party,"Net Growth 3rd Party (Actual) - Date Range, All Mastheads","The net growth for 3rd party (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Net_Growth_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_apls_actual_weekly_all_mastheads,net_growth_3rd_party_apls,"Net Growth 3rd Party APLS (Actual) - Weekly, All Mastheads","The net growth for 3rd party APLS (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Net_Growth_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_apls_actual_date_range_all_mastheads,net_growth_3rd_party_apls,"Net Growth 3rd Party APLS (Actual) - Date Range, All Mastheads","The net growth for 3rd party APLS (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Net_Growth_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_gpla_actual_weekly_all_mastheads,net_growth_3rd_party_gpla,"Net Growth 3rd Party GPLA (Actual) - Weekly, All Mastheads","The net growth for 3rd party GPLA (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Net_Growth_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_3rd_party_gpla_actual_date_range_all_mastheads,net_growth_3rd_party_gpla,"Net Growth 3rd Party GPLA (Actual) - Date Range, All Mastheads","The net growth for 3rd party GPLA (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Net_Growth_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_consumer_actual_weekly_all_mastheads,net_growth_consumer,"Net Growth Consumer (Actual) - Weekly, All Mastheads","The net growth for consumer (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Net_Growth_Consumer ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_Consumer),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_consumer_actual_date_range_all_mastheads,net_growth_consumer,"Net Growth Consumer (Actual) - Date Range, All Mastheads","The net growth for consumer (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Net_Growth_Consumer ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_Consumer),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_incl_3rd_party_actual_weekly_all_mastheads,net_growth_incl_3rd_party,"Net Growth (incl. 3rd Party) (Actual) - Weekly, All Mastheads","The net growth including 3rd party (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Net_Growth_incl_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_incl_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_incl_3rd_party_actual_date_range_all_mastheads,net_growth_incl_3rd_party,"Net Growth (incl. 3rd Party) (Actual) - Date Range, All Mastheads","The net growth including 3rd party (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Net_Growth_incl_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Net_Growth_incl_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
other_sales_actual_weekly_all_mastheads,other_sales,"Other Sales (Actual) - Weekly, All Mastheads","The sum of other sales (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Other_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Other_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
other_sales_actual_date_range_all_mastheads,other_sales,"Other Sales (Actual) - Date Range, All Mastheads","The sum of other sales (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Other_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Other_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
opening_base_3rd_party_actual_weekly_all_mastheads,opening_base_3rd_party,"Opening Base 3rd Party (Actual) - Weekly, All Mastheads","The opening base for 3rd party (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Opening_Base_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Opening_Base_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
opening_base_3rd_party_actual_date_range_all_mastheads,opening_base_3rd_party,"Opening Base 3rd Party (Actual) - Date Range, All Mastheads","The opening base for 3rd party (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Opening_Base_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Opening_Base_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
opening_base_3rd_party_apls_actual_weekly_all_mastheads,opening_base_3rd_party_apls,"Opening Base 3rd Party APLS (Actual) - Weekly, All Mastheads","The opening base for 3rd party APLS (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Opening_Base_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Opening_Base_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
opening_base_3rd_party_apls_actual_date_range_all_mastheads,opening_base_3rd_party_apls,"Opening Base 3rd Party APLS (Actual) - Date Range, All Mastheads","The opening base for 3rd party APLS (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Opening_Base_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Opening_Base_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
opening_base_3rd_party_gpla_actual_weekly_all_mastheads,opening_base_3rd_party_gpla,"Opening Base 3rd Party GPLA (Actual) - Weekly, All Mastheads","The opening base for 3rd party GPLA (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Opening_Base_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Opening_Base_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
opening_base_3rd_party_gpla_actual_date_range_all_mastheads,opening_base_3rd_party_gpla,"Opening Base 3rd Party GPLA (Actual) - Date Range, All Mastheads","The opening base for 3rd party GPLA (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Opening_Base_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Opening_Base_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_actual_weekly_all_mastheads,revenue_3rd_party,"Revenue 3rd Party (Actual) - Weekly, All Mastheads","The sum of 3rd party revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_actual_date_range_all_mastheads,revenue_3rd_party,"Revenue 3rd Party (Actual) - Date Range, All Mastheads","The sum of 3rd party revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_apls_actual_weekly_all_mastheads,revenue_3rd_party_apls,"Revenue 3rd Party APLS (Actual) - Weekly, All Mastheads","The sum of 3rd party APLS revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_apls_actual_date_range_all_mastheads,revenue_3rd_party_apls,"Revenue 3rd Party APLS (Actual) - Date Range, All Mastheads","The sum of 3rd party APLS revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_3rd_Party_APLS ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_3rd_Party_APLS),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_gpla_actual_weekly_all_mastheads,revenue_3rd_party_gpla,"Revenue 3rd Party GPLA (Actual) - Weekly, All Mastheads","The sum of 3rd party GPLA revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_3rd_party_gpla_actual_date_range_all_mastheads,revenue_3rd_party_gpla,"Revenue 3rd Party GPLA (Actual) - Date Range, All Mastheads","The sum of 3rd party GPLA revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_3rd_Party_GPLA ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_3rd_Party_GPLA),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_campus_actual_weekly_all_mastheads,revenue_campus,"Revenue Campus (Actual) - Weekly, All Mastheads","The sum of campus revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_Campus ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Campus),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_campus_actual_date_range_all_mastheads,revenue_campus,"Revenue Campus (Actual) - Date Range, All Mastheads","The sum of campus revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_Campus ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Campus),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_consumer_actual_weekly_all_mastheads,revenue_consumer,"Revenue Consumer (Actual) - Weekly, All Mastheads","The sum of consumer revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_Consumer ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Consumer),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_consumer_actual_date_range_all_mastheads,revenue_consumer,"Revenue Consumer (Actual) - Date Range, All Mastheads","The sum of consumer revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_Consumer ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Consumer),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_corp_actual_weekly_all_mastheads,revenue_corp,"Revenue Corp (Actual) - Weekly, All Mastheads","The sum of corporate revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_Corp ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Corp),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_corp_actual_date_range_all_mastheads,revenue_corp,"Revenue Corp (Actual) - Date Range, All Mastheads","The sum of corporate revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_Corp ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Corp),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_other_actual_weekly_all_mastheads,revenue_other,"Revenue Other (Actual) - Weekly, All Mastheads","The sum of other revenue (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Revenue_Other ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Other),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_other_actual_date_range_all_mastheads,revenue_other,"Revenue Other (Actual) - Date Range, All Mastheads","The sum of other revenue (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Revenue_Other ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Revenue_Other),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
switches_actual_weekly_all_mastheads,switches,"Switches (Actual) - Weekly, All Mastheads","The sum of switches (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Switches ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Switches),measure,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
switches_actual_date_range_all_mastheads,switches,"Switches (Actual) - Date Range, All Mastheads","The sum of switches (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Switches ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Switches),measure,False,low,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_cancels_excluding_3rd_party_actual_weekly_all_mastheads,total_cancels_excluding_3rd_party,"Total Cancels (excl. 3rd Party) (Actual) - Weekly, All Mastheads","The total cancels excluding 3rd party (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Total_Cancels_excluding_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Cancels_excluding_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_cancels_excluding_3rd_party_actual_date_range_all_mastheads,total_cancels_excluding_3rd_party,"Total Cancels (excl. 3rd Party) (Actual) - Date Range, All Mastheads","The total cancels excluding 3rd party (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Total_Cancels_excluding_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Cancels_excluding_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_cancels_including_3rd_party_actual_weekly_all_mastheads,total_cancels_including_3rd_party,"Total Cancels (incl. 3rd Party) (Actual) - Weekly, All Mastheads","The total cancels including 3rd party (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Total_Cancels_including_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Cancels_including_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_cancels_including_3rd_party_actual_date_range_all_mastheads,total_cancels_including_3rd_party,"Total Cancels (incl. 3rd Party) (Actual) - Date Range, All Mastheads","The total cancels including 3rd party (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Total_Cancels_including_3rd_Party ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Cancels_including_3rd_Party),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_closing_base_actual_weekly_all_mastheads,total_closing_base,"Total Closing Base (Actual) - Weekly, All Mastheads","The total closing base (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Total_Closing_Base ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Closing_Base),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_closing_base_actual_date_range_all_mastheads,total_closing_base,"Total Closing Base (Actual) - Date Range, All Mastheads","The total closing base (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Total_Closing_Base ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Closing_Base),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_weekly_sales_actual_weekly_all_mastheads,total_weekly_sales,"Total Weekly Sales (Actual) - Weekly, All Mastheads","The total weekly sales (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Total_Weekly_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Weekly_Sales),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_weekly_sales_actual_date_range_all_mastheads,total_weekly_sales,"Total Weekly Sales (Actual) - Date Range, All Mastheads","The total weekly sales (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Total_Weekly_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Total_Weekly_Sales),measure,True,high,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
always_on_digital_sales_actual_weekly_all_mastheads,always_on_digital_sales,"Always-on Digital Sales (Actual) - Weekly, All Mastheads","The sum of always-on digital sales (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Always_on_Digital_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Always_on_Digital_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
always_on_digital_sales_actual_date_range_all_mastheads,always_on_digital_sales,"Always-on Digital Sales (Actual) - Date Range, All Mastheads","The sum of always-on digital sales (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Always_on_Digital_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Always_on_Digital_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
breach_sales_actual_weekly_all_mastheads,breach_sales,"Breach Sales (Actual) - Weekly, All Mastheads","The sum of breach sales (actuals), filtered for the current fiscal week of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Weekly' THEN t0.Breach_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Breach_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
breach_sales_actual_date_range_all_mastheads,breach_sales,"Breach Sales (Actual) - Date Range, All Mastheads","The sum of breach sales (actuals), filtered for the specified fiscal week range of 2025 and all mastheads.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(CASE WHEN 'Weekly' = 'Date Range' THEN t0.Breach_Sales ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` AS t0 WHERE (t0.fy_week_of_year BETWEEN 1 AND 36 AND t0.fy_year = 2025) AND TRUE,SUM(t0.Breach_Sales),measure,False,medium,4,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_tables_monitored_finance_health,total_tables_monitored,Total Tables Monitored,The total number of finance-related tables whose update status is being monitored by the dashboard.,your-gcp-project-id,bdm_finance,__TABLES__,"SELECT COUNT(clmn1_) AS total_tables_monitored FROM (
SELECT t0.alert_status_final AS clmn0_, t0.table_id AS clmn1_ FROM (
WITH
  table_list AS (
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'advertising_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'circulation_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'external_sundry_expenses_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'subscription_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      60 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_balance_fct' AS tableid
    UNION ALL
    SELECT
      60 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_transaction_fct' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_account_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_business_unit_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_company_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_department_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_ledger_type_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_party_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_publication_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_responsibility_unit_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_sub_ledger_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_sub_ledger_type_dim' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'advertising_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'circulation_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'offplatform_subscription_revenue_fct' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'subscription_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'content_licensing_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'expense_depreciation_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'finance_gaap_adjustment' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'sundry_revenue_snapshot_fct' AS tableid
  ),
  table_update_list AS (
    SELECT
      dataset_id,
      table_id,
      datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
      row_count,
      size_bytes / power(2, 30) AS size_gb,
      table_list.update_frequency
    FROM
      `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
      JOIN
      table_list
      ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
  ),
  load_stats AS (
    SELECT
      * EXCEPT (last_update_time),
      CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
      `current_datetime`(""Australia/Sydney"") AS time_now,
      datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
      `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency,
        'Y', 'N') AS delayed
    FROM
      table_update_list
  ),
  alert_sts AS (
    SELECT
      * EXCEPT (last_update_time),
      CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
      CASE
        WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) >
        update_frequency THEN -2
        WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND
        (updated_minutes_ago - update_frequency) > 30 THEN -2
        WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND
        (updated_minutes_ago - update_frequency) > 1440 THEN -2
        WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <=
        update_frequency THEN -1
        WHEN row_count = 0 THEN -3
        ELSE 0
      END AS alert_status
    FROM
      load_stats
  )
SELECT
  *,
  CASE
    WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"",
      ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
    ELSE alert_status
  END AS alert_status_final
FROM
  alert_sts
) AS t0
)",COUNT(table_id),aggregation,True,high,5,f9b52275-5924-4afb-8222-2c55854183ba
healthy_tables_count_finance_health,healthy_tables_count,Healthy Tables Count,The number of finance-related tables that are either not delayed (status 0) or moderately delayed/budget forecast tables (status -1).,your-gcp-project-id,bdm_finance,__TABLES__,"SELECT COUNT(clmn2_) AS healthy_tables_count FROM (
SELECT CASE WHEN (clmn0_ IN (0, -1)) THEN clmn1_ ELSE NULL END AS clmn2_, clmn1_ FROM (
SELECT t0.alert_status_final AS clmn0_, t0.table_id AS clmn1_ FROM (
WITH
  table_list AS (
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'advertising_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'circulation_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'external_sundry_expenses_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      0 AS update_frequency,
      'bdm_finance' AS datasetid,
      'subscription_budget_forecast_fct' AS tableid
    UNION ALL
    SELECT
      60 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_balance_fct' AS tableid
    UNION ALL
    SELECT
      60 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_transaction_fct' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_account_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_business_unit_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_company_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_department_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_ledger_type_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_party_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_publication_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_responsibility_unit_profisee_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_sub_ledger_dim' AS tableid
    UNION ALL
    SELECT
      1440 AS update_frequency,
      'bdm_finance' AS datasetid,
      'gl_sub_ledger_type_dim' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'advertising_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'circulation_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'offplatform_subscription_revenue_fct' AS tableid
    UNION ALL
    SELECT
      10080 AS update_frequency,
      'bdm_finance' AS datasetid,
      'subscription_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'content_licensing_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'expense_depreciation_snapshot_fct' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'finance_gaap_adjustment' AS tableid
    UNION ALL
    SELECT
      44640 AS update_frequency,
      'bdm_finance' AS datasetid,
      'sundry_revenue_snapshot_fct' AS tableid
  ),
  table_update_list AS (
    SELECT
      dataset_id,
      table_id,
      datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
      row_count,
      size_bytes / power(2, 30) AS size_gb,
      table_list.update_frequency
    FROM
      `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
      JOIN
      table_list
      ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
  ),
  load_stats AS (
    SELECT
      * EXCEPT (last_update_time),
      CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
      `current_datetime`(""Australia/Sydney"") AS time_now,
      datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
      `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency,
        'Y', 'N') AS delayed
    FROM
      table_update_list
  ),
  alert_sts AS (
    SELECT
      * EXCEPT (last_update_time),
      CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
      CASE
        WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) >
        update_frequency THEN -2
        WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND
        (updated_minutes_ago - update_frequency) > 30 THEN -2
        WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND
        (updated_minutes_ago - update_frequency) > 1440 THEN -2
        WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <=
        update_frequency THEN -1
        WHEN row_count = 0 THEN -3
        ELSE 0
      END AS alert_status
    FROM
      load_stats
  )
SELECT
  *,
  CASE
    WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"",
      ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
    ELSE alert_status
  END AS alert_status_final
FROM
  alert_sts
) AS t0
)
)","COUNT(CASE WHEN (alert_status_final IN (0, -1)) THEN table_id ELSE NULL END)",aggregation,True,high,5,f9b52275-5924-4afb-8222-2c55854183ba
total_circulation_records_filtered_vendor_date,total_circulation_records,Total Circulation Records (Filtered),"The sum of all circulation records for specific vendors (Woolworth, EG, Coles, Ampol, 7Eleven) within a defined date range (rolling 4 weeks ending yesterday, further filtered by specific dates).",your-gcp-project-id,bdm_circulation,rcti_circulation_volume_revenue_fct,"SELECT SUM(clmn0_) AS total_circulation_records FROM (
SELECT t0.data_total AS clmn0_, t0.draw_date AS clmn1_, t0.vendor AS clmn2_ FROM (
SELECT DISTINCT
  UPPER(vendor_name) AS vendor,
  draw_date,
  Count(*) AS data_total
FROM
  `your-gcp-project-id.bdm_circulation.rcti_circulation_volume_revenue_fct`
WHERE
  dw_tgt_partition_date >= `CURRENT_DATE`('Australia/Sydney') - 1 AND draw_date BETWEEN DATE_SUB(DATE_TRUNC(`CURRENT_DATE`('Australia/Sydney'),
      ISOWEEK), INTERVAL 4 WEEK) AND DATE_SUB(DATE_TRUNC(`CURRENT_DATE`('Australia/Sydney'), WEEK(MONDAY)),
    INTERVAL 1 DAY)
GROUP BY 1, 2
) AS t0
) WHERE (clmn1_ IN (DATE '2025-05-12', DATE '2025-05-13', DATE '2025-05-14', DATE '2025-05-15', DATE '2025-05-16', DATE '2025-05-17', DATE '2025-05-18', DATE '2025-05-19', DATE '2025-05-20', DATE '2025-05-21', DATE '2025-05-22', DATE '2025-05-23', DATE '2025-05-24', DATE '2025-05-25', DATE '2025-05-26', DATE '2025-05-27', DATE '2025-05-28', DATE '2025-05-29', DATE '2025-05-30', DATE '2025-05-31', DATE '2025-06-01', DATE '2025-06-02', DATE '2025-06-03', DATE '2025-06-04', DATE '2025-06-05', DATE '2025-06-06', DATE '2025-06-07', DATE '2025-06-08') AND clmn2_ IN ('WOOLWORTH', 'EG', 'COLES', 'AMPOL', '7ELEVEN'))",SUM(data_total),aggregation,True,medium,5,f9b52275-5924-4afb-8222-2c55854183ba
total_budget_opening_base_fy25_wk36,total_budget_opening_base,"Budget Opening Base (FY25, Week 36)","The total budget opening base for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.BudgetOpeningBase ELSE 0 END) AS total_budget_opening_base_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.BudgetOpeningBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_budget_earned_amount_fy25_wk36,total_budget_earned_amount,"Budget Earned Amount (FY25, Week 36)","The total budget earned amount for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) THEN t0.BudgetEarnedAmount ELSE 0 END) AS total_budget_earned_amount_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) THEN t0.BudgetEarnedAmount ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_ny_budget_opening_base_fy25_wk36,total_ny_budget_opening_base,"NY Budget Opening Base (FY25, Week 36)","The total New Year budget opening base for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.NYBudgetOpeningBase ELSE 0 END) AS total_ny_budget_opening_base_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.NYBudgetOpeningBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_ny_budget_closing_base_fy25_wk36,total_ny_budget_closing_base,"NY Budget Closing Base (FY25, Week 36)","The total New Year budget closing base for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.NYBudgetClosingBase ELSE 0 END) AS total_ny_budget_closing_base_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.NYBudgetClosingBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_closing_base_fy25_wk36_specific_sources,total_closing_base,"Closing Base (FY25, Week 36, Specific Sources)","The total closing base for Fiscal Year 2025, Week 36, specifically for digital recognition, non-discontinued mastheads, and table union sources 'bmasnap_close', 'SC - CODE Manual APLS', or 'SC Manual APLS'.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) AS total_closing_base_fy25_wk36_specific_sources FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition'","SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END)",measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_earned_amount_fy24_wk36_nf_manual_hist,total_earned_amount,"Earned Amount (FY24, Week 36, NF Manual History)","The total earned amount for Fiscal Year 2024, Week 36, specifically for digital recognition, non-discontinued mastheads, and 'nfmanualhist' table union source.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount ELSE 0 END) AS total_earned_amount_fy24_wk36_nf_manual_hist FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_budget_closing_base_fy25_wk36,total_budget_closing_base,"Budget Closing Base (FY25, Week 36)","The total budget closing base for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.BudgetClosingBase ELSE 0 END) AS total_budget_closing_base_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36) THEN t0.BudgetClosingBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_ny_budget_earned_amount_fy25_wk36,total_ny_budget_earned_amount,"NY Budget Earned Amount (FY25, Week 36)","The total New Year budget earned amount for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) THEN t0.NYBudgetEarnedAmount ELSE 0 END) AS total_ny_budget_earned_amount_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2025) THEN t0.NYBudgetEarnedAmount ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_opening_base_fy25_wk36_bmasnap_open,total_opening_base,"Opening Base (FY25, Week 36, BMASnap Open)","The total opening base for Fiscal Year 2025, Week 36, specifically for digital recognition, non-discontinued mastheads, and 'bmasnap_open' table union source.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END) AS total_opening_base_fy25_wk36_bmasnap_open FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_earned_amount_fy25_wk36_subsnapfact,total_earned_amount,"Earned Amount (FY25, Week 36, Subsnap Fact)","The total earned amount for Fiscal Year 2025, Week 36, specifically for digital recognition, non-discontinued mastheads, and 'subsnapfact' table union source.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE 0 END) AS total_earned_amount_fy25_wk36_subsnapfact FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_forecast_closing_base_fy25_wk36,total_closing_base,"Forecast Closing Base (FY25, Week 36)","The total forecast closing base for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.fy_week_of_year > 22) THEN t0.ForecastClosingBase ELSE 0 END) AS total_forecast_closing_base_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.fy_week_of_year > 22) THEN t0.ForecastClosingBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_forecast_budget_earned_amount_fy25_wk36,total_forecast_budget_earned_amount,"Forecast Budget Earned Amount (FY25, Week 36)","The total forecast budget earned amount for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2025 AND t0.fy_week_of_year > 22) THEN t0.ForecastBudgetEarnedAmount ELSE 0 END) AS total_forecast_budget_earned_amount_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_week_of_year = 36 AND t0.fy_year = 2025 AND t0.fy_week_of_year > 22) THEN t0.ForecastBudgetEarnedAmount ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_forecast_opening_base_fy25_wk36,total_opening_base,"Forecast Opening Base (FY25, Week 36)","The total forecast opening base for Fiscal Year 2025, Week 36, specifically for digital recognition and non-discontinued mastheads.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.fy_week_of_year > 22) THEN t0.ForecastOpeningBase ELSE 0 END) AS total_forecast_opening_base_fy25_wk36 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition',SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36 AND t0.fy_week_of_year > 22) THEN t0.ForecastOpeningBase ELSE 0 END),measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_closing_base_fy24_wk36_specific_sources,total_closing_base,"Closing Base (FY24, Week 36, Specific Sources)","The total closing base for Fiscal Year 2024, Week 36, specifically for digital recognition, non-discontinued mastheads, and table union sources 'bmasnap_close', 'SC - CODE Manual APLS', or 'SC Manual APLS'.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2024 AND t0.fy_week_of_year = 36 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) AS total_closing_base_fy24_wk36_specific_sources FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE t0.masthead_group != 'Discontinued' AND t0.delivery_medium_type != 'Print Recognition'","SUM(CASE WHEN (t0.fy_year = 2024 AND t0.fy_week_of_year = 36 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END)",measure,False,medium,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
total_count_digital_non_discontinued,total_count,Total Digital Subscriptions (Non-Discontinued),A count of records representing digital subscriptions that are not associated with 'Discontinued' masthead groups.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(*) AS total_count_digital_non_discontinued FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (CASE WHEN (t0.subscriber_has_email_flag = 'subsnapfact') THEN 'Y' WHEN (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle') THEN t0.subscriber_has_email_flag ELSE 'Y' END = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.gl_publication_code = '100' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '34' OR t0.gl_publication_code = '24' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '41' OR t0.gl_publication_code = '14' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '55' OR t0.gl_publication_code = '45' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '24' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '34' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '48' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '58' OR t0.gl_publication_code = '12' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '36' OR t0.gl_publication_code = '53' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '37' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '59' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '42' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = '44' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = '47' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.classification_level_2_description = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END) != 'Discontinued',COUNT(*),measure,True,high,6,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
record_count_by_source_system,record_count,Record Count by Source System,Counts the number of records (rows) associated with each source system within the financial data.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  COUNT(1) AS record_count,
  t0.source_system_name
FROM (
  WITH OSandFACT AS (
    SELECT
      source_system_name,
      fiscal_week_id,
      gl_publication_code,
      os_level_12
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
  SELECT
    *
  FROM
    OSandFACT
) AS t0
GROUP BY
  t0.source_system_name
ORDER BY
  record_count DESC
LIMIT 10;",COUNT(1),aggregation,False,low,7,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_by_source_system,total_actual_amount,Total Actual Amount by Source System,"The sum of 'Actual_Amount' for each source system, representing the total actual financial value.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t0.Actual_Amount) AS total_actual_amount,
  t0.source_system_name
FROM (
  WITH OSandFACT AS (
    SELECT
      source_system_name,
      Actual_Amount,
      fiscal_week_id,
      gl_publication_code,
      os_level_12
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
  SELECT
    *
  FROM
    OSandFACT
) AS t0
GROUP BY
  t0.source_system_name
ORDER BY
  total_actual_amount DESC
LIMIT 10;",SUM(Actual_Amount),measure,True,high,7,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_by_fiscal_year_and_source_system,total_actual_amount,Total Actual Amount by Fiscal Year and Source System,"The sum of 'Actual_Amount' for each fiscal year and source system, providing a breakdown of actual financial performance over time.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t0.Actual_Amount) AS total_actual_amount,
  t0.fy_year,
  t0.source_system_name
FROM (
  WITH OSandFACT AS (
    SELECT
      source_system_name,
      Actual_Amount,
      fiscal_week_id,
      gl_publication_code,
      os_level_12,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
  SELECT
    *
  FROM
    OSandFACT
) AS t0
GROUP BY
  t0.fy_year,
  t0.source_system_name
ORDER BY
  t0.fy_year DESC, total_actual_amount DESC
LIMIT 10;",SUM(Actual_Amount),measure,True,high,7,d7412673-0af1-4efe-8374-ca475b001fb6
earned_amount_fy25_w42_digital_non_discontinued,earned_amount,"Earned Amount (FY25, Week 42, Digital, Non-Discontinued)","Total earned amount for Digital Recognition subscriptions, for Fiscal Year 2025, Week 42, from non-discontinued mastheads, specifically from the 'subsnapfact' source.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 42 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END) AS earned_amount_fy25_w42_digital_non_discontinued FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (CASE WHEN (t0.subscriber_has_email_flag = 'subsnapfact') THEN 'Y' WHEN (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle') THEN t0.subscriber_has_email_flag ELSE 'Y' END = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END = 'Digital Recognition' AND CASE WHEN (t0.gl_publication_code = 'The Australian') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('Courier Mail', 'Daily Telegraph', 'Herald Sun', 'The Advertiser') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('Cairns Post', 'Geelong', 'Gold Coast', 'The Mercury', 'Toowoomba', 'Townsville') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'TM', 'TC', 'TB')) THEN 'Regionals' WHEN (t0.gl_publication_code = 'Weekly Times') THEN 'Others' WHEN (t0.gl_publication_code IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Racenet', 'Punters', 'Others') OR t0.masthead_code IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END != 'Discontinued')",SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 42 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END),measure,True,high,8,449b9707-f939-42e1-b6f5-11998369f473
earned_amount_fy24_w42_digital_non_discontinued,earned_amount,"Earned Amount (FY24, Week 42, Digital, Non-Discontinued)","Total earned amount for Digital Recognition subscriptions, for Fiscal Year 2024, Week 42, from non-discontinued mastheads, specifically from the 'nfmanualhist' source.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2024 AND t0.fy_week_of_year = 42 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount ELSE 0 END) AS earned_amount_fy24_w42_digital_non_discontinued FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (CASE WHEN (t0.subscriber_has_email_flag = 'subsnapfact') THEN 'Y' WHEN (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle') THEN t0.subscriber_has_email_flag ELSE 'Y' END = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END = 'Digital Recognition' AND CASE WHEN (t0.gl_publication_code = 'The Australian') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('Courier Mail', 'Daily Telegraph', 'Herald Sun', 'The Advertiser') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('Cairns Post', 'Geelong', 'Gold Coast', 'The Mercury', 'Toowoomba', 'Townsville') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'TM', 'TC', 'TB')) THEN 'Regionals' WHEN (t0.gl_publication_code = 'Weekly Times') THEN 'Others' WHEN (t0.gl_publication_code IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Racenet', 'Punters', 'Others') OR t0.masthead_code IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END != 'Discontinued')",SUM(CASE WHEN (t0.fy_year = 2024 AND t0.fy_week_of_year = 42 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount ELSE 0 END),measure,True,high,8,449b9707-f939-42e1-b6f5-11998369f473
forecast_budget_earned_amount_fy25_w42_digital_non_discontinued,forecast_budget_earned_amount,"Forecast Budget Earned Amount (FY25, Week 42, Digital, Non-Discontinued)","Total forecast budget earned amount for Digital Recognition subscriptions, for Fiscal Year 2025, Week 42, from non-discontinued mastheads.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_week_of_year = 42 AND t0.fy_year = 2025) THEN t0.ForecastBudgetEarnedAmount ELSE NULL END) AS forecast_budget_earned_amount_fy25_w42_digital_non_discontinued FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (CASE WHEN (t0.subscriber_has_email_flag = 'subsnapfact') THEN 'Y' WHEN (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle') THEN t0.subscriber_has_email_flag ELSE 'Y' END = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END = 'Digital Recognition' AND CASE WHEN (t0.gl_publication_code = 'The Australian') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('Courier Mail', 'Daily Telegraph', 'Herald Sun', 'The Advertiser') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('Cairns Post', 'Geelong', 'Gold Coast', 'The Mercury', 'Toowoomba', 'Townsville') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'TM', 'TC', 'TB')) THEN 'Regionals' WHEN (t0.gl_publication_code = 'Weekly Times') THEN 'Others' WHEN (t0.gl_publication_code IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Racenet', 'Punters', 'Others') OR t0.masthead_code IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END != 'Discontinued')",SUM(CASE WHEN (t0.fy_week_of_year = 42 AND t0.fy_year = 2025) THEN t0.ForecastBudgetEarnedAmount ELSE NULL END),measure,True,high,8,449b9707-f939-42e1-b6f5-11998369f473
actual_amount_by_os_level_5,actual_amount,Actual Amount by OS Level 5,"The sum of actual financial amounts, broken down by OS Level 5.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT t0.os_level_5, SUM(t0.Actual_Amount) AS actual_amount FROM (
WITH
  OSandFACT AS (
    SELECT
      os.Actual_Amount,
      os.os_level_5,
      os.fiscal_week_id
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year,
          CASE WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y' ELSE 'N' END AS month_end_flag
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department` AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  *
FROM
  OSandFACT
) AS t0
GROUP BY t0.os_level_5",SUM(Actual_Amount),measure,True,high,9,cbab66df-64cb-4ec6-a112-088557684b7e
actual_amount_fy25_week40_filtered,actual_amount,"Actual Amount (FY25, Week 40, Revenue/Expenses, News Media Publishing)","The sum of actual financial amounts for Fiscal Year 2025, Week 40, specifically for 'Total Revenue' or 'Total Expenses' within 'News Media Publishing', grouped by publication code, print/digital flag, and OS levels 5 and 6.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT t0.gl_publication_code, t0.is_print_digital_flag, t0.os_level_5, t0.os_level_6, SUM(t0.Actual_Amount) AS actual_amount FROM (
WITH
  OSandFACT AS (
    SELECT
      os.Actual_Amount,
      os.fiscal_week_id,
      os.gl_publication_code,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      os.os_level_12,
      pub.gl_hierarchy_code,
      pub.l03_publication_code,
      pub.is_print_digital_flag,
      calendar.fy_week_of_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year,
          CASE WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y' ELSE 'N' END AS month_end_flag
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department` AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  *
FROM
  OSandFACT
) AS t0
WHERE (t0.gl_hierarchy_code = 'FY2025' AND t0.os_level_4 IN ('Total Revenue', 'Total Expenses') AND t0.l03_publication_code = 'News Media Publishing' AND t0.fy_week_of_year IN (40))
GROUP BY t0.gl_publication_code, t0.is_print_digital_flag, t0.os_level_5, t0.os_level_6",SUM(Actual_Amount),measure,True,high,9,cbab66df-64cb-4ec6-a112-088557684b7e
last_year_actual_amount_fy25_week40_filtered,last_year_actual_amount,"Last Year Actual Amount (FY25, Week 40, Revenue/Expenses, News Media Publishing)","The sum of last year's actual financial amounts for Fiscal Year 2025, Week 40, specifically for 'Total Revenue' or 'Total Expenses' within 'News Media Publishing', grouped by publication code, print/digital flag, and OS levels 5 and 6.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT t0.gl_publication_code, t0.is_print_digital_flag, t0.os_level_5, t0.os_level_6, SUM(t0.Last_Year_Actual_Amount) AS last_year_actual_amount FROM (
WITH
  OSandFACT AS (
    SELECT
      os.Last_Year_Actual_Amount,
      os.fiscal_week_id,
      os.gl_publication_code,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      os.os_level_12,
      pub.gl_hierarchy_code,
      pub.l03_publication_code,
      pub.is_print_digital_flag,
      calendar.fy_week_of_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year,
          CASE WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y' ELSE 'N' END AS month_end_flag
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department` AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  *
FROM
  OSandFACT
) AS t0
WHERE (t0.gl_hierarchy_code = 'FY2025' AND t0.os_level_4 IN ('Total Revenue', 'Total Expenses') AND t0.l03_publication_code = 'News Media Publishing' AND t0.fy_week_of_year IN (40))
GROUP BY t0.gl_publication_code, t0.is_print_digital_flag, t0.os_level_5, t0.os_level_6",SUM(Last_Year_Actual_Amount),measure,True,high,9,cbab66df-64cb-4ec6-a112-088557684b7e
last_year_actual_amount_fy25_filtered,last_year_actual_amount,"Last Year Actual Amount (FY25, Revenue/Expenses, News Media Publishing)","The sum of last year's actual financial amounts for Fiscal Year 2025, specifically for 'Total Revenue' or 'Total Expenses' within 'News Media Publishing', grouped by fiscal week, print/digital flag, publication codes, and OS levels.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT t0.fy_week_of_year, t0.is_print_digital_flag, t0.l12_publication_code, t0.os_level_5, t0.os_level_6, t0.publication_name, SUM(t0.Last_Year_Actual_Amount) AS last_year_actual_amount FROM (
WITH
  OSandFACT AS (
    SELECT
      os.Last_Year_Actual_Amount,
      os.fiscal_week_id,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      os.os_level_12,
      pub.gl_hierarchy_code,
      pub.l03_publication_code,
      pub.l12_publication_code,
      pub.is_print_digital_flag,
      pub.publication_name,
      calendar.fy_week_of_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_year AS int) AS fy_year,
          CASE WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y' ELSE 'N' END AS month_end_flag
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department` AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  *
FROM
  OSandFACT
) AS t0
WHERE (t0.gl_hierarchy_code = 'FY2025' AND t0.os_level_4 IN ('Total Revenue', 'Total Expenses') AND t0.l03_publication_code = 'News Media Publishing')
GROUP BY t0.fy_week_of_year, t0.is_print_digital_flag, t0.l12_publication_code, t0.os_level_5, t0.os_level_6, t0.publication_name",SUM(Last_Year_Actual_Amount),measure,True,high,9,cbab66df-64cb-4ec6-a112-088557684b7e
scenario_dimension,scenario,Scenario,"Represents the specific type or category of a digital subscription, as defined in the underlying data.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT t0.scenario FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 100;,t0.scenario,dimension,False,medium,10,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
total_records_count,record_count,Total Records,The total number of entries or rows present in the digital subscriptions dataset. This metric provides a basic count of all records.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(1) AS total_records FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`;,COUNT(1),measure,False,low,10,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
records_by_scenario_count,record_count,Records by Scenario,"The count of digital subscription records, aggregated and broken down by each unique 'scenario' type. This helps understand the distribution of different subscription types.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT t0.scenario, COUNT(1) AS records_count FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY t0.scenario;",COUNT(1),aggregation,False,medium,10,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
earned_amount_fy2025,earned_amount,Earned Amount (FY 2025),"The total earned amount for the fiscal year 2025, specifically for digital subscriptions and excluding discontinued masthead groups.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN t0.fy_year = 2025 THEN t0.EarnedAmount ELSE NULL END) AS earned_amount_fy2025 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition',SUM(CASE WHEN t0.fy_year = 2025 THEN t0.EarnedAmount ELSE NULL END),measure,true,high,11,bb49fa78-5abe-4e68-a9c1-8172a832e724
budget_earned_amount_fy2025,budget_earned_amount,Budget Earned Amount (FY 2025),"The budgeted earned amount for the fiscal year 2025, specifically for digital subscriptions and excluding discontinued masthead groups.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN t0.fy_year = 2025 THEN t0.BudgetEarnedAmount ELSE NULL END) AS budget_earned_amount_fy2025 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition',SUM(CASE WHEN t0.fy_year = 2025 THEN t0.BudgetEarnedAmount ELSE NULL END),measure,true,high,11,bb49fa78-5abe-4e68-a9c1-8172a832e724
closing_base_fy2025,closing_base,Closing Base (FY 2025),"The closing base value for the fiscal year 2025, specifically for digital subscriptions and excluding discontinued masthead groups.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN t0.fy_year = 2025 THEN t0.ClosingBase ELSE 0 END) AS closing_base_fy2025 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition',SUM(CASE WHEN t0.fy_year = 2025 THEN t0.ClosingBase ELSE 0 END),measure,true,high,11,bb49fa78-5abe-4e68-a9c1-8172a832e724
opening_base_fy2025,opening_base,Opening Base (FY 2025),"The opening base value for the fiscal year 2025, specifically for digital subscriptions and excluding discontinued masthead groups.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN t0.fy_year = 2025 THEN t0.OpeningBase ELSE 0 END) AS opening_base_fy2025 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition',SUM(CASE WHEN t0.fy_year = 2025 THEN t0.OpeningBase ELSE 0 END),measure,true,high,11,bb49fa78-5abe-4e68-a9c1-8172a832e724
net_change_fy2024,net_change,Net Change (FY 2024),"The net change calculated as (Closing Base - Opening Base) for the fiscal year 2024, specifically for digital subscriptions and excluding discontinued masthead groups.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN t0.fy_year = 2024 THEN t0.ClosingBase ELSE 0 END - CASE WHEN t0.fy_year = 2024 THEN t0.OpeningBase ELSE 0 END) AS net_change_fy2024 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition',SUM(CASE WHEN t0.fy_year = 2024 THEN t0.ClosingBase ELSE 0 END - CASE WHEN t0.fy_year = 2024 THEN t0.OpeningBase ELSE 0 END),measure,false,medium,11,bb49fa78-5abe-4e68-a9c1-8172a832e724
total_monitored_tables,total_monitored_tables,Total Monitored Tables,"The total count of BigQuery tables being actively monitored by the dashboard for freshness and row count, as defined in the internal 'table_list'.",your-gcp-project-id,bdm_finance,__TABLES__,"SELECT COUNT(t0.table_id) AS total_monitored_tables FROM (
  WITH
    table_list AS (
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'advertising_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'circulation_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'external_sundry_expenses_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'subscription_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        60 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_balance_fct' AS tableid
      UNION ALL
      SELECT
        60 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_transaction_fct' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_account_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_business_unit_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_company_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_department_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_ledger_type_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_party_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_publication_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_responsibility_unit_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_sub_ledger_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_sub_ledger_type_dim' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'advertising_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'circulation_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'offplatform_subscription_revenue_fct' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'subscription_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'content_licensing_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'expense_depreciation_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'finance_gaap_adjustment' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'sundry_revenue_snapshot_fct' AS tableid
    ),
    table_update_list AS (
      SELECT
        dataset_id,
        table_id,
        datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
        row_count,
        size_bytes / power(2, 30) AS size_gb,
        table_list.update_frequency
      FROM
        `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
        JOIN
        table_list
        ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
    ),
    load_stats AS (
      SELECT
        * EXCEPT (last_update_time),
        CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
        `current_datetime`(""Australia/Sydney"") AS time_now,
        datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
        `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency,
          'Y', 'N') AS delayed
      FROM
        table_update_list
    ),
    alert_sts AS (
      SELECT
        *,
        CASE
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) >
          update_frequency THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND
          (updated_minutes_ago - update_frequency) > 30 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND
          (updated_minutes_ago - update_frequency) > 1440 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <=
          update_frequency THEN -1
          WHEN row_count = 0 THEN -3
          ELSE 0
        END AS alert_status
      FROM
        load_stats
    )
  SELECT
    *,
    CASE
      WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"",
        ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
      ELSE alert_status
    END AS alert_status_final
  FROM
    alert_sts
) AS t0",COUNT(t0.table_id),measure,True,high,12,8f848270-688f-4455-82a6-3bc9a7d39cce
healthy_acceptable_tables,healthy_acceptable_tables,Healthy/Acceptable Tables,The count of monitored BigQuery tables that are either up-to-date (alert_status_final = 0) or considered acceptably delayed/budget forecast tables (alert_status_final = -1).,your-gcp-project-id,bdm_finance,__TABLES__,"SELECT COUNT(CASE WHEN (t0.alert_status_final IN (0, -1)) THEN t0.table_id ELSE NULL END) AS healthy_acceptable_tables FROM (
  WITH
    table_list AS (
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'advertising_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'circulation_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'external_sundry_expenses_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        0 AS update_frequency,
        'bdm_finance' AS datasetid,
        'subscription_budget_forecast_fct' AS tableid
      UNION ALL
      SELECT
        60 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_balance_fct' AS tableid
      UNION ALL
      SELECT
        60 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_transaction_fct' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_account_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_business_unit_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_company_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_department_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_ledger_type_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_party_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_publication_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_responsibility_unit_profisee_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_sub_ledger_dim' AS tableid
      UNION ALL
      SELECT
        1440 AS update_frequency,
        'bdm_finance' AS datasetid,
        'gl_sub_ledger_type_dim' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'advertising_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'circulation_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'offplatform_subscription_revenue_fct' AS tableid
      UNION ALL
      SELECT
        10080 AS update_frequency,
        'bdm_finance' AS datasetid,
        'subscription_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'content_licensing_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'expense_depreciation_snapshot_fct' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'finance_gaap_adjustment' AS tableid
      UNION ALL
      SELECT
        44640 AS update_frequency,
        'bdm_finance' AS datasetid,
        'sundry_revenue_snapshot_fct' AS tableid
    ),
    table_update_list AS (
      SELECT
        dataset_id,
        table_id,
        datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
        row_count,
        size_bytes / power(2, 30) AS size_gb,
        table_list.update_frequency
      FROM
        `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
        JOIN
        table_list
        ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
    ),
    load_stats AS (
      SELECT
        * EXCEPT (last_update_time),
        CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
        `current_datetime`(""Australia/Sydney"") AS time_now,
        datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
        `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency,
          'Y', 'N') AS delayed
      FROM
        table_update_list
    ),
    alert_sts AS (
      SELECT
        *,
        CASE
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) >
          update_frequency THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND
          (updated_minutes_ago - update_frequency) > 30 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND
          (updated_minutes_ago - update_frequency) > 1440 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <=
          update_frequency THEN -1
          WHEN row_count = 0 THEN -3
          ELSE 0
        END AS alert_status
      FROM
        load_stats
    )
  SELECT
    *,
    CASE
      WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"",
        ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
      ELSE alert_status
    END AS alert_status_final
  FROM
    alert_sts
) AS t0","COUNT(CASE WHEN (t0.alert_status_final IN (0, -1)) THEN t0.table_id ELSE NULL END)",measure,True,high,12,8f848270-688f-4455-82a6-3bc9a7d39cce
budget_amount_fy2025_revenue_expenses_week4,budget_amount,"Budget Amount (FY2025, Revenue/Expenses, Week 4)","Total budgeted amount for FY2025, specifically for 'Total Revenue' and 'Total Expenses' categories, for fiscal week 4, filtered by 'News Media Publishing' and grouped by various publication and OS levels.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(SAFE_CAST(t0.Budget_Amount AS BIGNUMERIC)) AS Budget_Amount_Sum
FROM
  (
    SELECT
      os.Budget_Amount,
      calendar.fy_week_of_year,
      os.gl_hierarchy_code,
      os.is_print_digital_flag,
      pub.l03_publication_code,
      pub.l12_publication_code,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      pub.publication_name
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON SAFE_CAST(os.gl_publication_code AS STRING) = SAFE_CAST(pub.publication_code AS STRING)
    LEFT JOIN
      (SELECT DISTINCT SAFE_CAST(c.fy_week_of_year AS int) AS fy_week_of_year, SAFE_CAST(c.fy_year_week_number AS int) AS fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON SAFE_CAST(control.source_week_number AS INT) = SAFE_CAST(c.fy_year_week_number AS INT) AND SAFE_CAST(control.period_name AS STRING) IN ('CP', 'PY')) AS calendar
      ON SAFE_CAST(os.fiscal_week_id AS INT) = SAFE_CAST(calendar.fy_year_week_number AS INT)
  ) AS t0
WHERE
  SAFE_CAST(t0.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(t0.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(t0.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(t0.fy_week_of_year AS INT) IN (4)
LIMIT 10;",SUM(Budget_Amount),measure,True,high,13,b1c5901f-a535-42eb-870d-05cc025f7c27
sum_fy_week_of_year_fy2025_revenue_expenses_week4,sum_fy_week_of_year,"Sum of Fiscal Week of Year (FY2025, Revenue/Expenses, Week 4)","Sum of fiscal week numbers for FY2025, specifically for 'Total Revenue' and 'Total Expenses' categories, for fiscal week 4. This is an unusual aggregation and might indicate a data modeling or dashboard configuration issue.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(SAFE_CAST(t0.fy_week_of_year AS BIGNUMERIC)) AS Sum_of_Fiscal_Week_of_Year
FROM
  (
    SELECT
      calendar.fy_week_of_year,
      os.gl_hierarchy_code,
      os.is_print_digital_flag,
      pub.l03_publication_code,
      pub.l12_publication_code,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      pub.publication_name
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON SAFE_CAST(os.gl_publication_code AS STRING) = SAFE_CAST(pub.publication_code AS STRING)
    LEFT JOIN
      (SELECT DISTINCT SAFE_CAST(c.fy_week_of_year AS int) AS fy_week_of_year, SAFE_CAST(c.fy_year_week_number AS int) AS fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON SAFE_CAST(control.source_week_number AS INT) = SAFE_CAST(c.fy_year_week_number AS INT) AND SAFE_CAST(control.period_name AS STRING) IN ('CP', 'PY')) AS calendar
      ON SAFE_CAST(os.fiscal_week_id AS INT) = SAFE_CAST(calendar.fy_year_week_number AS INT)
  ) AS t0
WHERE
  SAFE_CAST(t0.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(t0.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(t0.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(t0.fy_week_of_year AS INT) IN (4)
LIMIT 10;",SUM(fy_week_of_year),measure,False,low,13,b1c5901f-a535-42eb-870d-05cc025f7c27
actual_amount_fy2025_revenue_expenses_week40,actual_amount,"Actual Amount (FY2025, Revenue/Expenses, Week 40)","Total actual amount for FY2025, specifically for 'Total Revenue' and 'Total Expenses' categories, for fiscal week 40, grouped by various publication and OS levels.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(SAFE_CAST(t0.Actual_Amount AS BIGNUMERIC)) AS Actual_Amount_Sum
FROM
  (
    SELECT
      os.Actual_Amount,
      calendar.fy_week_of_year,
      os.gl_hierarchy_code,
      os.is_print_digital_flag,
      pub.l12_publication_code,
      os.os_level_4,
      os.os_level_5,
      os.os_level_9,
      pub.publication_name
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON SAFE_CAST(os.gl_publication_code AS STRING) = SAFE_CAST(pub.publication_code AS STRING)
    LEFT JOIN
      (SELECT DISTINCT SAFE_CAST(c.fy_week_of_year AS int) AS fy_week_of_year, SAFE_CAST(c.fy_year_week_number AS int) AS fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON SAFE_CAST(control.source_week_number AS INT) = SAFE_CAST(c.fy_year_week_number AS INT) AND SAFE_CAST(control.period_name AS STRING) IN ('CP', 'PY')) AS calendar
      ON SAFE_CAST(os.fiscal_week_id AS INT) = SAFE_CAST(calendar.fy_year_week_number AS INT)
  ) AS t0
WHERE
  SAFE_CAST(t0.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(t0.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(t0.fy_week_of_year AS INT) IN (40)
LIMIT 10;",SUM(Actual_Amount),measure,True,high,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_fy_week_of_year,fy_week_of_year,Fiscal Week of Year,The fiscal week number within the fiscal year.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_calendar,SELECT DISTINCT SAFE_CAST(fy_week_of_year AS INT) AS fy_week_of_year FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` LIMIT 10;,fy_week_of_year,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_gl_hierarchy_code,gl_hierarchy_code,GL Hierarchy Code,"The General Ledger hierarchy code, often representing the fiscal year.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(gl_hierarchy_code AS STRING) AS gl_hierarchy_code FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 10;,gl_hierarchy_code,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_is_print_digital_flag,is_print_digital_flag,Is Print Digital Flag,Flag indicating whether the item is print or digital.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(is_print_digital_flag AS STRING) AS is_print_digital_flag FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 10;,is_print_digital_flag,dimension,False,low,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_l03_publication_code,l03_publication_code,L03 Publication Code,Level 3 publication code from the OS publication hierarchy.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_os_publication_hierachy,SELECT DISTINCT SAFE_CAST(l03_publication_code AS STRING) AS l03_publication_code FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` LIMIT 10;,l03_publication_code,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_l12_publication_code,l12_publication_code,L12 Publication Code,Level 12 publication code from the OS publication hierarchy.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_os_publication_hierachy,SELECT DISTINCT SAFE_CAST(l12_publication_code AS STRING) AS l12_publication_code FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` LIMIT 10;,l12_publication_code,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_os_level_4,os_level_4,OS Level 4,"Operational Structure Level 4, often used for high-level categories like Revenue/Expenses.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(os_level_4 AS STRING) AS os_level_4 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 10;,os_level_4,dimension,False,high,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_os_level_5,os_level_5,OS Level 5,Operational Structure Level 5.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(os_level_5 AS STRING) AS os_level_5 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 10;,os_level_5,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_os_level_6,os_level_6,OS Level 6,Operational Structure Level 6.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(os_level_6 AS STRING) AS os_level_6 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 10;,os_level_6,dimension,False,low,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_os_level_9,os_level_9,OS Level 9,Operational Structure Level 9.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(os_level_9 AS STRING) AS os_level_9 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 10;,os_level_9,dimension,False,low,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_publication_name,publication_name,Publication Name,The human-readable name of the publication.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_os_publication_hierachy,SELECT DISTINCT SAFE_CAST(publication_name AS STRING) AS publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` LIMIT 10;,publication_name,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
dimension_fy_year,fy_year,Fiscal Year,The fiscal year.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_calendar,SELECT DISTINCT SAFE_CAST(fy_year AS INT) AS fy_year FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` ORDER BY fy_year DESC LIMIT 10;,fy_year,dimension,False,medium,13,b1c5901f-a535-42eb-870d-05cc025f7c27
total_draw_volume,circulation_volume,Total Draw Volume,"The total volume of publications drawn (distributed) for circulation, aggregated by fiscal week.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT
  SAFE_CAST(ci.fiscal_week_id AS STRING) AS fiscal_week,
  SUM(CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'DRAW' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END) AS total_draw_volume
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
  ON ci.charge_date = cal.calendar_date
WHERE
  LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) IN ('2025')
GROUP BY
  1",SUM(CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'DRAW' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END),measure,True,high,14,c441950c-1e3f-432c-9838-847d1d315b9e
total_returns_volume,circulation_volume,Total Returns Volume,"The total volume of publications returned from circulation, aggregated by fiscal week.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT
  SAFE_CAST(ci.fiscal_week_id AS STRING) AS fiscal_week,
  SUM(CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'RETURNS' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END) AS total_returns_volume
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
  ON ci.charge_date = cal.calendar_date
WHERE
  LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) IN ('2025')
GROUP BY
  1",SUM(CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'RETURNS' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END),measure,True,high,14,c441950c-1e3f-432c-9838-847d1d315b9e
total_adjustment_volume,circulation_volume,Total Adjustment Volume,"The total volume of publications adjusted in circulation records, aggregated by fiscal week.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT
  SAFE_CAST(ci.fiscal_week_id AS STRING) AS fiscal_week,
  SUM(CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'ADJUSTMENT' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END) AS total_adjustment_volume
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
  ON ci.charge_date = cal.calendar_date
WHERE
  LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) IN ('2025')
GROUP BY
  1",SUM(CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'ADJUSTMENT' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END),measure,False,medium,14,c441950c-1e3f-432c-9838-847d1d315b9e
total_circulation_volume,circulation_volume,Total Circulation Volume,"The sum of Draw, Returns, and Adjustment volumes, representing the overall movement of publications, aggregated by fiscal week.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT
  SAFE_CAST(ci.fiscal_week_id AS STRING) AS fiscal_week,
  SUM(
    CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'DRAW' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END +
    CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'ADJUSTMENT' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END +
    CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'RETURNS' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END
  ) AS total_circulation_volume
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
  ON ci.charge_date = cal.calendar_date
WHERE
  LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) IN ('2025')
GROUP BY
  1","SUM(
    CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'DRAW' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END +
    CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'ADJUSTMENT' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END +
    CASE WHEN SAFE_CAST(ci.charge_type AS STRING) = 'RETURNS' THEN SAFE_CAST(ci.route_volume AS BIGNUMERIC) ELSE 0 END
  )",measure,True,high,14,c441950c-1e3f-432c-9838-847d1d315b9e
total_charge_amount,financial_amount,Total Charge Amount,"The sum of all charge amounts, typically representing revenue or cost, aggregated by day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT
  SAFE_CAST(cal.day_short_name AS STRING) AS day_of_week,
  SUM(SAFE_CAST(ci.charge_amount AS BIGNUMERIC)) AS total_charge_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
  ON ci.charge_date = cal.calendar_date
WHERE
  LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) IN ('2025')
GROUP BY
  1",SUM(SAFE_CAST(ci.charge_amount AS BIGNUMERIC)),measure,True,high,14,c441950c-1e3f-432c-9838-847d1d315b9e
record_count_by_fiscal_week_subs_rateplangroup_check,record_count_by_time_dimension,Record Count by Fiscal Week (Subscription Rate Plan Group Check),"Counts the total number of records within the `v_subs_rateplangroup_check` table, grouped by fiscal week. Used to monitor data volume and completeness for subscription rate plan group checks.",ncau-data-newsquery-prd,finance_monthend_checks,v_subs_rateplangroup_check,"SELECT SAFE_CAST(t0.fiscal_week_id AS STRING) AS fiscal_week_id, COUNT(1) AS record_count FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_subs_rateplangroup_check` AS t0 GROUP BY 1 ORDER BY 2 DESC LIMIT 100;",COUNT(1),aggregation,False,medium,15,712ca6fe-b491-4a01-af6e-1495fb3c7d12
sum_of_rev_persisted_os_nulls_check,total_revenue_or_null_indicator,Sum of Revenue (Persisted OS Nulls Check),Calculates the sum of the 'rev' column from the `v_persisted_os_nulls_Check` table. This metric likely represents a total count or value related to null or problematic revenue entries identified during data quality checks.,ncau-data-newsquery-prd,finance_monthend_checks,v_persisted_os_nulls_Check,SELECT SUM(t0.rev) AS sum_of_rev FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check` AS t0 LIMIT 1;,SUM(t0.rev),aggregation,False,high,15,712ca6fe-b491-4a01-af6e-1495fb3c7d12
distinct_fiscal_month_id_missing_bus_check,time_dimension_fiscal_month,Distinct Fiscal Month ID (Missing Business Check),Retrieves distinct fiscal month IDs from the `v_missing_Bus_check` table. This is likely used as a dimension to filter or group data related to checks for missing business units by fiscal month.,ncau-data-newsquery-prd,finance_monthend_checks,v_missing_Bus_check,SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check` AS t0 GROUP BY 1 ORDER BY 1 DESC LIMIT 100;,t0.fiscal_month_id,dimension,False,medium,15,712ca6fe-b491-4a01-af6e-1495fb3c7d12
total_agency_commission,total_agency_commission,Total Agency Commission,"The total amount of commission paid to agencies for advertising bookings. This metric is typically filtered for 'STD' record types, 'ADPT' source systems, 'Billed' or 'Booked' transaction statuses, and 'Digital' revenue types, within specific financial and calendar year ranges.",your-gcp-project-id,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(agency_commission_amount) AS total_agency_commission
FROM
  `your-gcp-project-id.asl_advertising.v_adsales_revenue_client`
WHERE
  reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT'
  AND financial_year BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND revenue_type = 'Digital';",SUM(agency_commission_amount),measure,true,high,16,5515c1c6-18fe-449d-b621-d47631023320
total_revenue_gross_plus_adjustment,total_revenue_gross_plus_adjustment,Total Revenue (Gross + Adjustment),"The sum of gross revenue before adjustments and any additional adjustment amounts. This represents the comprehensive revenue figure for advertising line items. This metric is typically filtered for 'STD' record types, 'ADPT' source systems, 'Billed' or 'Booked' transaction statuses, and 'Digital' revenue types, within specific financial and calendar year ranges.",your-gcp-project-id,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(gross_revenue_ex_adj_amount + adjustment_amount) AS total_revenue_gross_plus_adjustment
FROM
  `your-gcp-project-id.asl_advertising.v_adsales_revenue_client`
WHERE
  reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT'
  AND financial_year BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND revenue_type = 'Digital';",SUM(gross_revenue_ex_adj_amount + adjustment_amount),measure,true,high,16,5515c1c6-18fe-449d-b621-d47631023320
total_acquisitions,total_acquisitions,Total Acquisitions,The total count of new acquisitions.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.acquisition_count) AS total_acquisitions FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,SUM(acquisition_count),measure,true,high,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_free_to_paid_conversions,total_free_to_paid_conversions,Total Free-to-Paid Conversions,The total count of conversions from free subscriptions/trials to paid subscriptions.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.free_to_paid_conversion_count) AS total_free_to_paid_conversions FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,SUM(free_to_paid_conversion_count),measure,true,high,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_reactivation_30day_acquisitions,total_reactivation_acquisitions,Total 30-Day Reactivation Acquisitions,The total count of reactivated subscriptions within a 30-day period.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.reactivation_30day_acquisition_count) AS total_reactivation_30day_acquisitions FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,SUM(reactivation_30day_acquisition_count),measure,true,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_switch_acquisitions,total_switch_acquisitions,Total Switch Acquisitions,The total count of subscriptions acquired through a switch from another product or plan.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.switch_acquisition_count) AS total_switch_acquisitions FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,SUM(switch_acquisition_count),measure,true,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
product_group_category,product_group_category,Product Group Category,"A high-level classification of products into 'Core Consumer', 'B2B', 'Deep Niche Products', or 'Check for New Products', based on detailed product types.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.budfor_product,
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.delivery_schedule_group,
    t0.dw_billing_system_code,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_step1 AS (
  SELECT
    *,
    CASE
      WHEN (classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer'
      WHEN (classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus'
      WHEN (classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP'
      WHEN (classification_level_2 = 'Free Staff') THEN 'Staff'
      WHEN (classification_level_2 = 'IP Access') THEN 'Corporate IP'
      WHEN (classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education'
      ELSE NULL
    END AS customer_type_grouped,
    CASE WHEN (delivery_medium_type = 'Not Available') THEN 'Digital' ELSE delivery_medium_type END AS delivery_medium_type_cleaned,
    (delivery_schedule_group = 'Weekend (2 Days)') AS is_weekend_2_days,
    (delivery_schedule_group = 'Weekend (1 Day)') AS is_weekend_1_day,
    CASE
      WHEN (masthead = 'AA') THEN 'The Advertiser' WHEN (masthead = 'AP') THEN 'Apple Podcast: Crime X' WHEN (masthead = 'CM') THEN 'Courier Mail' WHEN (masthead = 'CP') THEN 'Cairns Post' WHEN (masthead = 'CS') THEN 'Code' WHEN (masthead = 'DT') THEN 'Daily Telegraph' WHEN (masthead = 'GA') THEN 'Geelong' WHEN (masthead = 'GC') THEN 'Gold Coast' WHEN (masthead = 'HS') THEN 'Herald Sun' WHEN (masthead = 'NT') THEN 'NT News' WHEN (masthead = 'NW') THEN 'News.com.au' WHEN (masthead = 'PU') THEN 'Punters' WHEN (masthead = 'RN') THEN 'Racenet' WHEN (masthead = 'SC') THEN 'Supercoach Plus' WHEN (masthead = 'TA') THEN 'The Australian' WHEN (masthead = 'TB') THEN 'Townsville' WHEN (masthead = 'TC') THEN 'Toowoomba' WHEN (masthead = 'TM') THEN 'The Mercury' WHEN (masthead = 'TS') THEN 'Taste Online' WHEN (masthead = 'WT') THEN 'Weekly Times' ELSE NULL
    END AS masthead_full_name,
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian' WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (masthead = 'WT') THEN 'Other Publications' WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (masthead IS NULL) THEN 'check' ELSE 'Exclude'
    END AS publication_type,
    CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) AS delivery_email_flag_concat
  FROM base_data
),
derived_step2 AS (
  SELECT
    *,
    CASE
      WHEN (customer_type_grouped IN ('Consumer', 'Gift Receiver')) THEN 'B2C'
      WHEN (customer_type_grouped IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B'
      ELSE 'Others'
    END AS business_segment
  FROM derived_step1
),
derived_step3 AS (
  SELECT
    *,
    CASE
      WHEN (business_segment = 'B2B') THEN customer_type_grouped
      WHEN (publication_type = 'Deep Niche Publications') THEN masthead_full_name
      WHEN (dw_billing_system_code = 'WINE') THEN 'Wine Club'
      WHEN (classification_level_1 = 'Offplatform - Paid') THEN '3rd Party and Other'
      WHEN (table_nm IN ('budfor_cancel', 'budfor_acq')) THEN budfor_product
      WHEN (customer_type_grouped = 'Consumer') THEN
        CASE WHEN (classification_level_2 = 'Essentials') THEN 'Essentials' WHEN (delivery_medium_type_cleaned = 'Digital') THEN 'Digital' ELSE CONCAT(SAFE_CAST(delivery_medium_type_cleaned AS STRING),' ',SAFE_CAST(CASE WHEN is_weekend_1_day OR is_weekend_2_days THEN 'Weekend' ELSE '7 Day' END AS STRING)) END
      WHEN (customer_type_grouped = 'Education') THEN customer_type_grouped
      ELSE customer_type_grouped
    END AS product_type_detailed
  FROM derived_step2
)
SELECT
  CASE
    WHEN (product_type_detailed = 'Print 7 Day' OR product_type_detailed = 'Bundle 7 day and Other' OR product_type_detailed = 'Bundle Only' OR product_type_detailed = 'Bundle Weekend' OR product_type_detailed = 'Bundle Weekend Only' OR product_type_detailed = 'Digital' OR product_type_detailed = 'Digital Only' OR product_type_detailed = 'Essentials' OR product_type_detailed = 'Print Weekend Only' OR product_type_detailed = '3rd Party and Other' OR product_type_detailed = '3rd Party and Others' OR product_type_detailed = 'Print 7 day and Other' OR product_type_detailed = 'Print Weekend') THEN 'Core Consumer'
    WHEN (product_type_detailed = 'Campus' OR product_type_detailed = 'Corporate' OR product_type_detailed = 'Corporate excluding IP' OR product_type_detailed = 'Corporate IP' OR product_type_detailed = 'IP Access' OR product_type_detailed = 'SMB') THEN 'B2B'
    WHEN (product_type_detailed = 'Null' OR product_type_detailed = 'Apple Podcast: Crime X' OR product_type_detailed = 'Code' OR product_type_detailed = 'Education' OR product_type_detailed = 'Not Available 7 Day' OR product_type_detailed = 'Punters' OR product_type_detailed = 'Print Only' OR product_type_detailed = 'Racenet' OR product_type_detailed = 'Supercoach Plus' OR product_type_detailed = 'Taste Online' OR product_type_detailed = 'Wine Club') THEN 'Deep Niche Products'
    ELSE 'Check for New Products'
  END AS product_group_category
FROM derived_step3",CASE WHEN (product_type_detailed = 'Print 7 Day' OR product_type_detailed = 'Bundle 7 day and Other' OR product_type_detailed = 'Bundle Only' OR product_type_detailed = 'Bundle Weekend' OR product_type_detailed = 'Bundle Weekend Only' OR product_type_detailed = 'Digital' OR product_type_detailed = 'Digital Only' OR product_type_detailed = 'Essentials' OR product_type_detailed = 'Print Weekend Only' OR product_type_detailed = '3rd Party and Other' OR product_type_detailed = '3rd Party and Others' OR product_type_detailed = 'Print 7 day and Other' OR product_type_detailed = 'Print Weekend') THEN 'Core Consumer' WHEN (product_type_detailed = 'Campus' OR product_type_detailed = 'Corporate' OR product_type_detailed = 'Corporate excluding IP' OR product_type_detailed = 'Corporate IP' OR product_type_detailed = 'IP Access' OR product_type_detailed = 'SMB') THEN 'B2B' WHEN (product_type_detailed = 'Null' OR product_type_detailed = 'Apple Podcast: Crime X' OR product_type_detailed = 'Code' OR product_type_detailed = 'Education' OR product_type_detailed = 'Not Available 7 Day' OR product_type_detailed = 'Punters' OR product_type_detailed = 'Print Only' OR product_type_detailed = 'Racenet' OR product_type_detailed = 'Supercoach Plus' OR product_type_detailed = 'Taste Online' OR product_type_detailed = 'Wine Club') THEN 'Deep Niche Products' ELSE 'Check for New Products' END,dimension,false,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
publication_type,publication_type,Publication Type,"Categorization of mastheads into groups like 'The Australian', 'Metro', 'Regionals', 'Other Publications', 'Deep Niche Publications', 'check', or 'Exclude'.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (t0.masthead = 'WT') THEN 'Other Publications' WHEN (t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (t0.masthead IS NULL) THEN 'check' ELSE 'Exclude' END AS publication_type FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0","CASE WHEN (masthead = 'TA') THEN 'The Australian' WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (masthead = 'WT') THEN 'Other Publications' WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (masthead IS NULL) THEN 'check' ELSE 'Exclude' END",dimension,false,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
subscription_category,subscription_category,Subscription Category,Categorizes subscriptions as 'Digital Subscriptions' or 'Print Subscriptions' based on delivery medium and email flag.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_category FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0","CASE WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END",dimension,false,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
business_segment,business_segment,Business Segment,"Classifies customers as 'B2C' (Business-to-Consumer), 'B2B' (Business-to-Business), or 'Others' based on their customer type grouping.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END IN ('Consumer', 'Gift Receiver')) THEN 'B2C' WHEN (CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B' ELSE 'Others' END AS business_segment FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0","CASE WHEN (customer_type_grouped IN ('Consumer', 'Gift Receiver')) THEN 'B2C' WHEN (customer_type_grouped IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B' ELSE 'Others' END",dimension,false,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
customer_type_grouped,customer_type_grouped,Customer Type Grouped,"A classification of customers based on their `classification_level_2` into broader categories like 'Consumer', 'Campus', 'Corporate excluding IP', 'Staff', 'Corporate IP', or 'Education'.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END AS customer_type_grouped FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0","CASE WHEN (classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END",dimension,false,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
delivery_medium_type_cleaned,delivery_medium_type_cleaned,Delivery Medium Type Cleaned,"The delivery medium type, with 'Not Available' mapped to 'Digital'.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT CASE WHEN (t0.delivery_medium_type = 'Not Available') THEN 'Digital' ELSE t0.delivery_medium_type END AS delivery_medium_type_cleaned FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,CASE WHEN (delivery_medium_type = 'Not Available') THEN 'Digital' ELSE delivery_medium_type END,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
masthead_full_name,masthead_full_name,Masthead Full Name,"The full, human-readable name of the masthead (e.g., 'AA' becomes 'The Advertiser').",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT CASE WHEN (t0.masthead = 'AA') THEN 'The Advertiser' WHEN (t0.masthead = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'CS') THEN 'Code' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'GA') THEN 'Geelong' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'NW') THEN 'News.com.au' WHEN (t0.masthead = 'PU') THEN 'Punters' WHEN (t0.masthead = 'RN') THEN 'Racenet' WHEN (t0.masthead = 'SC') THEN 'Supercoach Plus' WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'TB') THEN 'Townsville' WHEN (t0.masthead = 'TC') THEN 'Toowoomba' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'TS') THEN 'Taste Online' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' ELSE NULL END AS masthead_full_name FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,CASE WHEN (masthead = 'AA') THEN 'The Advertiser' WHEN (masthead = 'AP') THEN 'Apple Podcast: Crime X' WHEN (masthead = 'CM') THEN 'Courier Mail' WHEN (masthead = 'CP') THEN 'Cairns Post' WHEN (masthead = 'CS') THEN 'Code' WHEN (masthead = 'DT') THEN 'Daily Telegraph' WHEN (masthead = 'GA') THEN 'Geelong' WHEN (masthead = 'GC') THEN 'Gold Coast' WHEN (masthead = 'HS') THEN 'Herald Sun' WHEN (masthead = 'NT') THEN 'NT News' WHEN (masthead = 'NW') THEN 'News.com.au' WHEN (masthead = 'PU') THEN 'Punters' WHEN (masthead = 'RN') THEN 'Racenet' WHEN (masthead = 'SC') THEN 'Supercoach Plus' WHEN (masthead = 'TA') THEN 'The Australian' WHEN (masthead = 'TB') THEN 'Townsville' WHEN (masthead = 'TC') THEN 'Toowoomba' WHEN (masthead = 'TM') THEN 'The Mercury' WHEN (masthead = 'TS') THEN 'Taste Online' WHEN (masthead = 'WT') THEN 'Weekly Times' ELSE NULL END,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
delivery_email_flag_concat,delivery_email_flag_concat,Delivery Email Flag Concatenation,"A concatenated string of delivery medium type and subscriber email flag, used for further categorization.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) AS delivery_email_flag_concat FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0","CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING))",dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
product_type_detailed,product_type_detailed,Product Type Detailed,"A highly detailed classification of products based on various attributes like business segment, publication type, billing system, and customer type.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.budfor_product,
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.delivery_schedule_group,
    t0.dw_billing_system_code,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_step1 AS (
  SELECT
    *,
    CASE
      WHEN (classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer'
      WHEN (classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus'
      WHEN (classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP'
      WHEN (classification_level_2 = 'Free Staff') THEN 'Staff'
      WHEN (classification_level_2 = 'IP Access') THEN 'Corporate IP'
      WHEN (classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education'
      ELSE NULL
    END AS customer_type_grouped,
    CASE WHEN (delivery_medium_type = 'Not Available') THEN 'Digital' ELSE delivery_medium_type END AS delivery_medium_type_cleaned,
    (delivery_schedule_group = 'Weekend (2 Days)') AS is_weekend_2_days,
    (delivery_schedule_group = 'Weekend (1 Day)') AS is_weekend_1_day,
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian' WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (masthead = 'WT') THEN 'Other Publications' WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (masthead IS NULL) THEN 'check' ELSE 'Exclude'
    END AS publication_type
  FROM base_data
),
derived_step2 AS (
  SELECT
    *,
    CASE
      WHEN (customer_type_grouped IN ('Consumer', 'Gift Receiver')) THEN 'B2C'
      WHEN (customer_type_grouped IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B'
      ELSE 'Others'
    END AS business_segment
  FROM derived_step1
)
SELECT
  CASE
    WHEN (business_segment = 'B2B') THEN customer_type_grouped
    WHEN (publication_type = 'Deep Niche Publications') THEN masthead_full_name
    WHEN (dw_billing_system_code = 'WINE') THEN 'Wine Club'
    WHEN (classification_level_1 = 'Offplatform - Paid') THEN '3rd Party and Other'
    WHEN (table_nm IN ('budfor_cancel', 'budfor_acq')) THEN budfor_product
    WHEN (customer_type_grouped = 'Consumer') THEN
      CASE WHEN (classification_level_2 = 'Essentials') THEN 'Essentials' WHEN (delivery_medium_type_cleaned = 'Digital') THEN 'Digital' ELSE CONCAT(SAFE_CAST(delivery_medium_type_cleaned AS STRING),' ',SAFE_CAST(CASE WHEN is_weekend_1_day OR is_weekend_2_days THEN 'Weekend' ELSE '7 Day' END AS STRING)) END
    WHEN (customer_type_grouped = 'Education') THEN customer_type_grouped
    ELSE customer_type_grouped
  END AS product_type_detailed
FROM derived_step2","CASE WHEN (business_segment = 'B2B') THEN customer_type_grouped WHEN (publication_type = 'Deep Niche Publications') THEN masthead_full_name WHEN (dw_billing_system_code = 'WINE') THEN 'Wine Club' WHEN (classification_level_1 = 'Offplatform - Paid') THEN '3rd Party and Other' WHEN (table_nm IN ('budfor_cancel', 'budfor_acq')) THEN budfor_product WHEN (customer_type_grouped = 'Consumer') THEN CASE WHEN (classification_level_2 = 'Essentials') THEN 'Essentials' WHEN (delivery_medium_type_cleaned = 'Digital') THEN 'Digital' ELSE CONCAT(SAFE_CAST(delivery_medium_type_cleaned AS STRING),' ',SAFE_CAST(CASE WHEN is_weekend_1_day OR is_weekend_2_days THEN 'Weekend' ELSE '7 Day' END AS STRING)) END WHEN (customer_type_grouped = 'Education') THEN customer_type_grouped ELSE customer_type_grouped END",dimension,false,medium,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
fy_year,fy_year,Fiscal Year,The fiscal year of the acquisition or movement.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.fy_year FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,fy_year,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
fy_week_of_year,fy_week_of_year,Fiscal Week of Year,The fiscal week number within the fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.fy_week_of_year FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,fy_week_of_year,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
masthead,masthead,Masthead Code,"The abbreviated code for the masthead (e.g., 'AA', 'CM').",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.masthead FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,masthead,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
offer_category_group_name,offer_category_group_name,Offer Category Group Name,"The name of the group to which the offer category belongs (e.g., 'Full Price').",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.offer_category_group_name FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,offer_category_group_name,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
offer_category_name,offer_category_name,Offer Category Name,The specific name of the offer category.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.offer_category_name FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,offer_category_name,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
budfor_product,budfor_product,Budfor Product,The product code related to the Budfor system.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.budfor_product FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,budfor_product,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
classification_level_1,classification_level_1,Classification Level 1,The first level of product or customer classification.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.classification_level_1 FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,classification_level_1,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
classification_level_2,classification_level_2,Classification Level 2,"The second level of product or customer classification, providing more detail than Level 1.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.classification_level_2 FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,classification_level_2,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
delivery_medium_type,delivery_medium_type,Delivery Medium Type,The original type of delivery medium for the subscription.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.delivery_medium_type FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,delivery_medium_type,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
delivery_schedule_group,delivery_schedule_group,Delivery Schedule Group,"The group defining the delivery schedule (e.g., 'Weekend (2 Days)', '7 Day').",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.delivery_schedule_group FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,delivery_schedule_group,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
dw_billing_system_code,dw_billing_system_code,DW Billing System Code,The code for the billing system used in the data warehouse.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.dw_billing_system_code FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,dw_billing_system_code,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
subscriber_has_email_flag,subscriber_has_email_flag,Subscriber Has Email Flag,A flag indicating whether the subscriber has an email address on record.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.subscriber_has_email_flag FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,subscriber_has_email_flag,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
table_nm,table_nm,Table Name,The name of the source table or data segment.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.table_nm FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,table_nm,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
subscription_movement_count_sub_type,subscription_movement_count_sub_type,Subscription Movement Count Sub Type,"The sub-type of subscription movement count (e.g., 'acquisition', 'free_to_paid_conversion').",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT t0.subscription_movement_count_sub_type FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,subscription_movement_count_sub_type,dimension,false,low,17,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_movements_fy_quarter_bucket_digital_2025_filtered_masthead,total_movements,"Total Movements by FY Quarter Bucket (Digital Subscriptions, FY 2025, Filtered Mastheads)","Counts the total number of acquisition/cancellation movements, grouped by fiscal year quarter, specifically for Digital Subscriptions in FY 2025, excluding 'Deep Niche Publications' and 'Exclude' masthead groups, and including only 'Standard Paid'/'Other Paid' and specific classification levels.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.fy_week_of_year,
    t0.fy_year,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_fields AS (
  SELECT
    classification_level_1,
    classification_level_2,
    fy_year,
    table_nm,
    -- Derived subscription_type
    CASE
      WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
      ELSE 'Print Subscriptions'
    END AS subscription_type,
    -- Derived masthead_group (clmn9_)
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn9,
    -- Derived masthead_group (clmn10_) - same as clmn9_
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn10,
    -- Derived fy_quarter_bucket (clmn8_)
    CASE
      WHEN (fy_week_of_year <= 13) THEN 1
      WHEN (fy_week_of_year <= 26) THEN 2
      WHEN (fy_week_of_year <= 39) THEN 3
      ELSE 4
    END AS fy_quarter_bucket
  FROM base_data
)
SELECT
  fy_quarter_bucket,
  COUNT(1) AS total_movements
FROM derived_fields
WHERE
  masthead_group_clmn9 != 'Exclude'
  AND table_nm IN ('mov', 'agg')
  AND classification_level_1 IN ('Standard Paid', 'Other Paid')
  AND classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
  AND fy_year IN (2025)
  AND subscription_type IN ('Digital Subscriptions')
  AND (masthead_group_clmn10 NOT IN ('Deep Niche Publications') OR masthead_group_clmn10 IS NULL)
GROUP BY
  fy_quarter_bucket
ORDER BY
  total_movements DESC
LIMIT 2000001;",COUNT(1),aggregation,True,high,18,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_acquisitions_fy_year_digital_filtered_masthead,total_acquisitions,"Total Acquisitions by FY Year (Digital Subscriptions, Filtered Mastheads)","Sums the acquisition count, grouped by fiscal year, specifically for Digital Subscriptions and 'The Australian', 'Metro', 'Regionals', 'Other Publications' masthead groups, and including only 'Standard Paid'/'Other Paid' and specific classification levels.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.acquisition_count,
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.fy_year,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_fields AS (
  SELECT
    acquisition_count,
    classification_level_1,
    classification_level_2,
    fy_year,
    table_nm,
    -- Derived masthead_group (clmn8_)
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn8,
    -- Derived masthead_group (clmn9_) - same as clmn8_
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn9,
    -- Derived subscription_type (clmn11_)
    CASE
      WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
      ELSE 'Print Subscriptions'
    END AS subscription_type
  FROM base_data
)
SELECT
  fy_year,
  SUM(acquisition_count) AS total_acquisitions
FROM derived_fields
WHERE
  masthead_group_clmn8 != 'Exclude'
  AND table_nm IN ('mov', 'agg')
  AND classification_level_1 IN ('Standard Paid', 'Other Paid')
  AND classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
  AND masthead_group_clmn9 IN ('The Australian', 'Metro', 'Regionals', 'Other Publications')
  AND subscription_type IN ('Digital Subscriptions')
GROUP BY
  fy_year
ORDER BY
  total_acquisitions DESC
LIMIT 2000001;",SUM(acquisition_count),aggregation,True,high,18,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_movements_delivery_medium_type_adjusted_digital_filtered_masthead,total_movements,"Total Movements by Adjusted Delivery Medium Type (Digital Subscriptions, Filtered Mastheads)","Counts the total number of acquisition/cancellation movements, grouped by adjusted delivery medium type (where 'Not Available' becomes 'Digital'), specifically for Digital Subscriptions and 'The Australian', 'Regionals', 'Other Publications', 'Metro' masthead groups, and including only 'Standard Paid'/'Other Paid' and specific classification levels.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_fields AS (
  SELECT
    classification_level_1,
    classification_level_2,
    table_nm,
    -- Derived delivery_medium_type_adjusted (clmn6_)
    CASE
      WHEN (delivery_medium_type = 'Not Available') THEN 'Digital'
      ELSE delivery_medium_type
    END AS delivery_medium_type_adjusted,
    -- Derived masthead_group (clmn7_)
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn7,
    -- Derived masthead_group (clmn8_) - same as clmn7_
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn8,
    -- Derived subscription_type (clmn10_)
    CASE
      WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
      ELSE 'Print Subscriptions'
    END AS subscription_type
  FROM base_data
)
SELECT
  delivery_medium_type_adjusted,
  COUNT(1) AS total_movements
FROM derived_fields
WHERE
  masthead_group_clmn7 != 'Exclude'
  AND table_nm IN ('mov', 'agg')
  AND classification_level_1 IN ('Standard Paid', 'Other Paid')
  AND classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
  AND masthead_group_clmn8 IN ('The Australian', 'Regionals', 'Other Publications', 'Metro')
  AND subscription_type IN ('Digital Subscriptions')
GROUP BY
  delivery_medium_type_adjusted
ORDER BY
  delivery_medium_type_adjusted DESC
LIMIT 2000001;",COUNT(1),aggregation,True,high,18,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_movements_frontbook_backbook_digital_2025_q3,total_movements,"Total Movements by Frontbook/Backbook Group (Digital Subscriptions, FY 2025, Q3)","Counts the total number of acquisition/cancellation movements, grouped by frontbook/backbook group, specifically for Digital Subscriptions in FY 2025 and fiscal quarter 3, and including only 'Standard Paid'/'Other Paid' and specific classification levels.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.frontbook_backbook_group_name,
    t0.fy_week_of_year,
    t0.fy_year,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_fields AS (
  SELECT
    classification_level_1,
    classification_level_2,
    frontbook_backbook_group_name,
    fy_year,
    table_nm,
    -- Derived masthead_group (clmn10_)
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group,
    -- Derived fy_quarter_bucket (clmn9_)
    CASE
      WHEN (fy_week_of_year <= 13) THEN 1
      WHEN (fy_week_of_year <= 26) THEN 2
      WHEN (fy_week_of_year <= 39) THEN 3
      ELSE 4
    END AS fy_quarter_bucket,
    -- Derived subscription_type (clmn12_)
    CASE
      WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
      ELSE 'Print Subscriptions'
    END AS subscription_type
  FROM base_data
)
SELECT
  frontbook_backbook_group_name,
  COUNT(1) AS total_movements
FROM derived_fields
WHERE
  masthead_group != 'Exclude'
  AND table_nm IN ('mov', 'agg')
  AND classification_level_1 IN ('Standard Paid', 'Other Paid')
  AND classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
  AND fy_year IN (2025)
  AND fy_quarter_bucket IN (3)
  AND subscription_type IN ('Digital Subscriptions')
GROUP BY
  frontbook_backbook_group_name
ORDER BY
  frontbook_backbook_group_name DESC
LIMIT 2000001;",COUNT(1),aggregation,True,high,18,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_movements_delivery_medium_type_adjusted_digital_2026,total_movements,"Total Movements by Adjusted Delivery Medium Type (Digital Subscriptions, FY 2026)","Counts the total number of acquisition/cancellation movements, grouped by adjusted delivery medium type (where 'Not Available' becomes 'Digital'), specifically for Digital Subscriptions in FY 2026, and including only 'Standard Paid'/'Other Paid' and specific classification levels.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.fy_year,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_fields AS (
  SELECT
    classification_level_1,
    classification_level_2,
    fy_year,
    table_nm,
    -- Derived delivery_medium_type_adjusted (clmn7_)
    CASE
      WHEN (delivery_medium_type = 'Not Available') THEN 'Digital'
      ELSE delivery_medium_type
    END AS delivery_medium_type_adjusted,
    -- Derived masthead_group (clmn8_)
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group,
    -- Derived subscription_type (clmn10_)
    CASE
      WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
      ELSE 'Print Subscriptions'
    END AS subscription_type
  FROM base_data
)
SELECT
  delivery_medium_type_adjusted,
  COUNT(1) AS total_movements
FROM derived_fields
WHERE
  masthead_group != 'Exclude'
  AND table_nm IN ('mov', 'agg')
  AND classification_level_1 IN ('Standard Paid', 'Other Paid')
  AND classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
  AND subscription_type IN ('Digital Subscriptions')
  AND fy_year IN (2026)
GROUP BY
  delivery_medium_type_adjusted
ORDER BY
  delivery_medium_type_adjusted DESC
LIMIT 2000001;",COUNT(1),aggregation,True,high,18,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_movements_fy_week_of_year_digital_filtered_masthead,total_movements,"Total Movements by FY Week of Year (Digital Subscriptions, Filtered Mastheads)","Counts the total number of acquisition/cancellation movements, grouped by fiscal week of year, specifically for Digital Subscriptions and 'The Australian', 'Regionals', 'Other Publications', 'Metro' masthead groups, and including only 'Standard Paid'/'Other Paid' and specific classification levels.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH base_data AS (
  SELECT
    t0.classification_level_1,
    t0.classification_level_2,
    t0.delivery_medium_type,
    t0.fy_week_of_year,
    t0.masthead,
    t0.subscriber_has_email_flag,
    t0.table_nm
  FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
),
derived_fields AS (
  SELECT
    classification_level_1,
    classification_level_2,
    fy_week_of_year,
    table_nm,
    -- Derived masthead_group (clmn7_)
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn7,
    -- Derived masthead_group (clmn8_) - same as clmn7_
    CASE
      WHEN (masthead = 'TA') THEN 'The Australian'
      WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
      WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
      WHEN (masthead = 'WT') THEN 'Other Publications'
      WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
      WHEN (masthead IS NULL) THEN 'check'
      ELSE 'Exclude'
    END AS masthead_group_clmn8,
    -- Derived subscription_type (clmn10_)
    CASE
      WHEN (CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
      ELSE 'Print Subscriptions'
    END AS subscription_type
  FROM base_data
)
SELECT
  fy_week_of_year,
  COUNT(1) AS total_movements
FROM derived_fields
WHERE
  masthead_group_clmn7 != 'Exclude'
  AND table_nm IN ('mov', 'agg')
  AND classification_level_1 IN ('Standard Paid', 'Other Paid')
  AND classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
  AND masthead_group_clmn8 IN ('The Australian', 'Regionals', 'Other Publications', 'Metro')
  AND subscription_type IN ('Digital Subscriptions')
GROUP BY
  fy_week_of_year
ORDER BY
  total_movements DESC
LIMIT 2000001;",COUNT(1),aggregation,True,high,18,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_cost_by_cost_component,total_cost_aud,Total Cost by Cost Component,"The total cost in AUD, broken down by the specific cost component (SKU description) for the selected period, excluding invoice costs.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  sku.description AS cost_component,
  SUM(cost) AS total_cost_aud
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2`
WHERE
  date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND
  service.description NOT IN ('Invoice')
GROUP BY 1
ORDER BY total_cost_aud DESC
LIMIT 2000001;",SUM(cost),measure,true,high,19,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_service_and_day_filtered,total_cost_aud,Total Cost by Service and Day (Filtered),"The total cost in AUD, broken down by service and day, specifically for a predefined list of key GCP services (e.g., BigQuery, Cloud Storage, Compute Engine), excluding invoice costs.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  service.description AS service,
  date(datetime(usage_end_time, ""Australia/Sydney"")) AS service_day,
  SUM(cost) AS total_cost_aud
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2`
WHERE
  date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND
  service.description NOT IN ('Invoice') AND
  service.description IN ('BigQuery Reservation API', 'BigQuery', 'Cloud Storage', 'Support', 'Cloud Dataflow', 'Cloud Composer', 'Cloud Run Functions', 'Compute Engine', 'Vertex AI', 'Cloud SQL')
GROUP BY 1, 2
ORDER BY service_day ASC
LIMIT 2000001;",SUM(cost),measure,true,high,19,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_project,total_cost_aud,Total Cost by Project,"The total cost in AUD, broken down by the GCP project name (with 'ncau-data-newsquery-' prefix removed), excluding invoice costs.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  `replace`(project.name, 'ncau-data-newsquery-', '') AS project,
  SUM(cost) AS total_cost_aud
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2`
WHERE
  date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND
  service.description NOT IN ('Invoice')
GROUP BY 1
ORDER BY total_cost_aud DESC
LIMIT 2000001;",SUM(cost),measure,true,high,19,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_service,total_cost_aud,Total Cost by Service,"The total cost in AUD, broken down by the GCP service description, excluding invoice costs.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  service.description AS service,
  SUM(cost) AS total_cost_aud
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2`
WHERE
  date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND
  service.description NOT IN ('Invoice')
GROUP BY 1
ORDER BY total_cost_aud DESC
LIMIT 2000001;",SUM(cost),measure,true,high,19,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_component_project_service,total_cost_aud,"Total Cost by Cost Component, Project, and Service","The total cost in AUD, broken down by cost component, GCP project (with prefix removed), and service description, excluding invoice costs.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  sku.description AS cost_component,
  `replace`(project.name, 'ncau-data-newsquery-', '') AS project,
  service.description AS service,
  SUM(cost) AS total_cost_aud
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2`
WHERE
  date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND
  service.description NOT IN ('Invoice')
GROUP BY 1, 2, 3
ORDER BY total_cost_aud DESC
LIMIT 2000001;",SUM(cost),measure,true,high,19,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_month,total_cost_aud,Total Cost by Month,"The total cost in AUD, aggregated monthly based on the usage end time, excluding invoice costs.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT
  date_trunc(date(datetime(usage_end_time, ""Australia/Sydney"")), MONTH) AS service_month,
  SUM(cost) AS total_cost_aud
FROM
  `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2`
WHERE
  date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND
  service.description NOT IN ('Invoice')
GROUP BY 1
ORDER BY service_month ASC
LIMIT 2000001;",SUM(cost),measure,true,high,19,fbf4d483-b17a-4040-b18c-091481d62200
total_gross_revenue_digital_billed_booked_adpt_std_guaranteed_2024,gross_revenue,"Total Gross Revenue (Digital, Billed/Booked, ADPT, STD, Guaranteed, 2024)","Total gross revenue for digital ad sales, specifically for billed or booked transactions from the Adpoint system, standard record types, with a 'Guaranteed' cost model, for calendar year 2024, excluding 'Medium Rare Content Agency' publishing division.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(gross_revenue_amount) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
  AND source_publishing_division != 'Medium Rare Content Agency'
  AND SAFE_CAST(calendar_year AS STRING) IN ('2024')
  AND cost_model_type IN ('Guaranteed')",SUM(gross_revenue_amount),measure,true,high,20,38809f41-7138-4b94-94d1-ae919b2d9517
total_agency_commission_digital_billed_booked_adpt_std_guaranteed_2024,agency_commission,"Total Agency Commission (Digital, Billed/Booked, ADPT, STD, Guaranteed, 2024)","Total agency commission for digital ad sales, specifically for billed or booked transactions from the Adpoint system, standard record types, with a 'Guaranteed' cost model, for calendar year 2024, excluding 'Medium Rare Content Agency' publishing division.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(agency_commission_amount) AS total_agency_commission
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
  AND source_publishing_division != 'Medium Rare Content Agency'
  AND SAFE_CAST(calendar_year AS STRING) IN ('2024')
  AND cost_model_type IN ('Guaranteed')",SUM(agency_commission_amount),measure,false,medium,20,38809f41-7138-4b94-94d1-ae919b2d9517
data_load_datetime_second_grain,data_load_datetime,Data Load Datetime (Second Grain),"Timestamp indicating when the data was loaded, truncated to the second, used for time-series analysis or filtering.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DATETIME_TRUNC(data_load_datetime, SECOND) AS data_load_datetime_second FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026' AND revenue_transaction_status IN ('Billed', 'Booked') AND source_system_code = 'ADPT' AND revenue_type = 'Digital' LIMIT 1","DATETIME_TRUNC(data_load_datetime, SECOND)",dimension,false,low,20,38809f41-7138-4b94-94d1-ae919b2d9517
calendar_year_dimension,calendar_year,Calendar Year,"The calendar year of the transaction, used for filtering and grouping.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT calendar_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026' AND revenue_transaction_status IN ('Billed', 'Booked') AND source_system_code = 'ADPT' AND revenue_type = 'Digital' GROUP BY calendar_year LIMIT 1",calendar_year,dimension,false,medium,20,38809f41-7138-4b94-94d1-ae919b2d9517
unified_publication_name_dimension,unified_publication_name,Unified Publication Name,"The name of the unified publication associated with the ad sale, used for filtering and grouping.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT unified_publication_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026' AND revenue_transaction_status IN ('Billed', 'Booked') AND source_system_code = 'ADPT' AND revenue_type = 'Digital' GROUP BY unified_publication_name LIMIT 1",unified_publication_name,dimension,false,medium,20,38809f41-7138-4b94-94d1-ae919b2d9517
advertiser_name_dimension,advertiser_name,Advertiser Name,"The name of the advertiser, used for filtering and grouping.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT advertiser_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026' AND revenue_transaction_status IN ('Billed', 'Booked') AND source_system_code = 'ADPT' AND revenue_type = 'Digital' GROUP BY advertiser_name LIMIT 1",advertiser_name,dimension,false,medium,20,38809f41-7138-4b94-94d1-ae919b2d9517
product_revenue,product_revenue,Product Revenue,Total revenue generated by products.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Product_Revenue) AS product_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0,SUM(t0.Product_Revenue),measure,True,high,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1,total_expense,Expense (Margin Level 1),Total expense for products specifically categorized with Margin Level '1'.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) = '1' THEN t0.Expense ELSE 0 END) AS expense_margin_level_1 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0,SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) = '1' THEN t0.Expense ELSE 0 END),measure,False,medium,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2,total_expense,Expense (Margin Level 1 & 2),Total expense for products categorized with Margin Level '1' or '2'.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2') THEN t0.Expense ELSE 0 END) AS expense_margin_level_1_2 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0","SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2') THEN t0.Expense ELSE 0 END)",measure,False,medium,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_3,total_expense,"Expense (Margin Level 1, 2 & 3)","Total expense for products categorized with Margin Level '1', '2', or '3'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3') THEN t0.Expense ELSE 0 END) AS expense_margin_level_1_2_3 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0","SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3') THEN t0.Expense ELSE 0 END)",measure,False,medium,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_3_4,total_expense,"Expense (Margin Level 1, 2, 3 & 4)","Total expense for products categorized with Margin Level '1', '2', '3', or '4'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4') THEN t0.Expense ELSE 0 END) AS expense_margin_level_1_2_3_4 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0","SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4') THEN t0.Expense ELSE 0 END)",measure,False,medium,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_3_4_5,total_expense,"Expense (Margin Level 1, 2, 3, 4 & 5)","Total expense for products categorized with Margin Level '1', '2', '3', '4', or '5'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5') THEN t0.Expense ELSE 0 END) AS expense_margin_level_1_2_3_4_5 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0","SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5') THEN t0.Expense ELSE 0 END)",measure,False,medium,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_3_4_5_6,total_expense,"Expense (Margin Level 1, 2, 3, 4, 5 & 6)",Total expense for products categorized across all defined Margin Levels ('1' through '6'). This likely represents the overall total expense.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5', '6') THEN t0.Expense ELSE 0 END) AS expense_margin_level_1_2_3_4_5_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0","SUM(CASE WHEN SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5', '6') THEN t0.Expense ELSE 0 END)",measure,True,high,21,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
total_value_by_revenue_type_filtered_by_fiscal_year_and_prefix_01,total_value,"Total Value by Revenue Type (Fiscal Year 2025, Prefix '01')","The sum of either 'amount' or 'volume' (currently 'amount' as per dashboard configuration) grouped by revenue type, specifically for fiscal year 2025 and revenue types starting with '01'.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT
  SUM(t0.amount) AS total_value,
  t0.revenue_type
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
WHERE
  FLOOR(SAFE_DIVIDE(t0.fy_year_week_number, 100)) = 2025.000000
  AND SAFE.LEFT(t0.revenue_type, 2) = '01'
GROUP BY
  t0.revenue_type
ORDER BY
  total_value DESC
LIMIT 2000001;",SUM(t0.amount),measure,true,high,22,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
total_value_by_week_and_revenue_type_filtered_by_prefix_02_and_specific_types,total_value,"Total Value by Week and Revenue Type (Prefix '02', Specific Types)","The sum of either 'amount' or 'volume' (currently 'amount' as per dashboard configuration) grouped by fiscal year week number and revenue type, specifically for revenue types starting with '02' and a predefined list of specific revenue types and fiscal year week numbers.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT
  t0.fy_year_week_number,
  SUM(t0.amount) AS total_value,
  t0.revenue_type
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
WHERE
  SAFE.LEFT(t0.revenue_type, 2) = '02'
  AND t0.fy_year_week_number IN (202511, 202512, 202513, 202514, 202515, 202516, 202517, 202518, 202519, 202520, 202521, 202522, 202523, 202524, 202525, 202526, 202527, 202528, 202529, 202530, 202531, 202532, 202533, 202534, 202535, 202536, 202537)
  AND t0.revenue_type IN ('02 - snapshot - DTI Charges & Volume', '02 - snapshot - THINK - print subs revenue', '02 - snapshot - RCTI Charges & Volume', '02 - snapshot - RCTI - rev rec charge', '02 - snapshot - DTI - rev rec charge', '02 - snapshot - DTI - unmigrated print subs revenue')
GROUP BY
  t0.fy_year_week_number,
  t0.revenue_type
ORDER BY
  t0.fy_year_week_number ASC
LIMIT 2000001;",SUM(t0.amount),measure,true,high,22,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
total_value_by_revenue_type_filtered_by_prefix_02,total_value,Total Value by Revenue Type (Prefix '02'),"The sum of either 'amount' or 'volume' (currently 'amount' as per dashboard configuration) grouped by revenue type, specifically for revenue types starting with '02'.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT
  SUM(t0.amount) AS total_value,
  t0.revenue_type
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
WHERE
  SAFE.LEFT(t0.revenue_type, 2) = '02'
GROUP BY
  t0.revenue_type
ORDER BY
  total_value DESC
LIMIT 2000001;",SUM(t0.amount),measure,true,high,22,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
earned_revenue_news_media_q1_2026_excl_free_comp,earned_revenue,"Earned Revenue - News Media Publishing (Q1 2026, Excl. Free/Comp)","Total revenue earned from News Media Publishing for Q1 2026, excluding complimentary, free staff, and free trial classifications.",ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    SUM(t0.earned_amount) AS earned_revenue
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    (
        (CASE WHEN (t0.classification_level_1_description IS NULL) THEN 'null' ELSE t0.classification_level_1_description END) NOT IN ('Complimentary', 'Free Staff', 'Free Trials')
        AND
        (CASE WHEN (t0.classification_level_2_description IS NULL) THEN 'null' ELSE t0.classification_level_2_description END) NOT IN ('Brand Registration', 'Business', 'Cafe', 'CAFE', 'Café', 'CLIENT', 'Complimentary', 'DIGITAL', 'Digital Bundle', 'Education', 'Existing Subscribers', 'Free Staff', 'Free to Paid', 'Free Trials', 'Group Activation', 'Home Delivery', 'Library', 'Metered Access', 'Miscellaneous', 'Staff', 'TAB', 'Unknown', 'VIP Access')
    )
    AND SAFE_CAST(t0.L03_publication_name AS STRING) = 'News Media Publishing'
    AND SAFE_CAST(t0.fiscal_week_id AS STRING) IN ('202601', '202602', '202603', '202604')
LIMIT 1;",SUM(t0.earned_amount),measure,True,high,23,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
gl_publication_code_true_up_202504,gl_publication_code,GL Publication Code - True Up Adjustment (Week 202504),List of GL publication codes associated with 'True Up Adjustment' scenarios for fiscal week 202504.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    t0.gl_publication_code
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.fiscal_week_id AS STRING) IN ('202504')
    AND SAFE_CAST(t0.scenario AS STRING) IN ('True Up Adjustment')
GROUP BY
    t0.gl_publication_code
ORDER BY
    t0.gl_publication_code DESC
LIMIT 2000001;",t0.gl_publication_code,dimension,False,low,23,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
gl_publication_code_estimate,gl_publication_code,GL Publication Code - Estimate Scenario,List of GL publication codes associated with 'Estimate' scenarios.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    t0.gl_publication_code
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.scenario AS STRING) IN ('Estimate')
GROUP BY
    t0.gl_publication_code
ORDER BY
    t0.gl_publication_code DESC
LIMIT 2000001;",t0.gl_publication_code,dimension,False,low,23,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
earned_revenue_news_media_q1_2025_estimate_excl_free_comp,earned_revenue,"Earned Revenue - News Media Publishing (Q1 2025, Estimate, Excl. Free/Comp)","Total estimated revenue earned from News Media Publishing for Q1 2025, excluding complimentary, free staff, and free trial classifications.",ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    SUM(t0.earned_amount) AS earned_revenue
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    (
        (CASE WHEN (t0.classification_level_1_description IS NULL) THEN 'null' ELSE t0.classification_level_1_description END) NOT IN ('Complimentary', 'Free Staff', 'Free Trials')
        AND
        (CASE WHEN (t0.classification_level_2_description IS NULL) THEN 'null' ELSE t0.classification_level_2_description END) NOT IN ('Brand Registration', 'Business', 'Cafe', 'CAFE', 'Café', 'CLIENT', 'Complimentary', 'DIGITAL', 'Digital Bundle', 'Education', 'Existing Subscribers', 'Free Staff', 'Free to Paid', 'Free Trials', 'Group Activation', 'Home Delivery', 'Library', 'Metered Access', 'Miscellaneous', 'Staff', 'TAB', 'Unknown', 'VIP Access')
    )
    AND SAFE_CAST(t0.L03_publication_name AS STRING) = 'News Media Publishing'
    AND SAFE_CAST(t0.fiscal_week_id AS STRING) IN ('202501', '202502', '202503', '202504')
    AND SAFE_CAST(t0.scenario AS STRING) IN ('Estimate')
LIMIT 1;",SUM(t0.earned_amount),measure,True,high,23,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
scenario_202504,scenario,Scenario - Week 202504,List of distinct scenarios available for fiscal week 202504.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    t0.scenario
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.fiscal_week_id AS STRING) IN ('202504')
GROUP BY
    t0.scenario
ORDER BY
    t0.scenario DESC
LIMIT 2000001;",t0.scenario,dimension,False,low,23,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
l03_publication_name_estimate_q1_2025,l03_publication_name,Publication Name - Estimate (Q1 2025),List of L03 publication names associated with 'Estimate' scenarios for Q1 2025.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    t0.L03_publication_name
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.fiscal_week_id AS STRING) IN ('202501', '202502', '202503', '202504')
    AND SAFE_CAST(t0.scenario AS STRING) IN ('Estimate')
GROUP BY
    t0.L03_publication_name
ORDER BY
    t0.L03_publication_name DESC
LIMIT 2000001;",t0.L03_publication_name,dimension,False,low,23,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
actual_amount_ytd_fiscal_week_46_fy2025,actual_amount,"Actual Amount (YTD Fiscal Week 46, FY2025)","The sum of actual financial amounts for fiscal year 2025 up to and including fiscal week 46, divided by 1000, for circulation-related data excluding specific publication codes.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT_Base AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.l04_publication_code,
    pub.l06_publication_code,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.fy_month_of_year,
    calendar.fy_year
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND pub.l04_publication_code <> 'Free News & Lifestyle'
    AND pub.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(SAFE_DIVIDE(t0.Actual_Amount, 1000)) AS actual_amount_ytd_fy2025_wk46
FROM
  OSandFACT_Base AS t0
WHERE
  t0.fy_year = 2025
  AND t0.fy_year_week_number <= 202546
LIMIT 1;",SUM(Actual_Amount) / 1000,measure,True,high,24,aca2f032-b796-49a2-89fe-781ca947aa33
actual_volume_fy2025,volume,Actual Volume (FY2025),"The sum of actual circulation volume for fiscal year 2025, divided by 1000, for circulation-related data excluding specific publication codes.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT_Base AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.l04_publication_code,
    pub.l06_publication_code,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.fy_month_of_year,
    calendar.fy_year
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND pub.l04_publication_code <> 'Free News & Lifestyle'
    AND pub.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(SAFE_DIVIDE(t0.volume, 1000)) AS actual_volume_fy2025
FROM
  OSandFACT_Base AS t0
LIMIT 1;",SUM(volume) / 1000,measure,True,high,24,aca2f032-b796-49a2-89fe-781ca947aa33
actual_amount_current_fiscal_week_fy2025_by_publication_group,actual_amount,"Actual Amount (Current Fiscal Week, FY2025, by Publication Group)","The sum of actual financial amounts for the current fiscal week of FY2025, grouped by custom publication categories, excluding 'Other' category, and filtered for 'All Sales Channels'. The current fiscal week is dynamically determined based on a fixed date (2025-05-28) relative to a fiscal year start (2024-07-03).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT_Base AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.l04_publication_code,
    pub.l06_publication_code,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.fy_month_of_year,
    calendar.fy_year
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND pub.l04_publication_code <> 'Free News & Lifestyle'
    AND pub.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(t0.Actual_Amount) AS actual_amount_current_week,
  CASE
    WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals'
    WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN t0.publication_name IN ('The Australian') THEN ' The Australian'
    WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    ELSE '        Other'
  END AS publication_group
FROM
  OSandFACT_Base AS t0
WHERE
  t0.os_level_7 = 'All Sales Channels'
  AND (CASE WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals' WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser' WHEN t0.publication_name IN ('The Australian') THEN ' The Australian' WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail' WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph' WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun' ELSE '        Other' END) != '        Other'
  AND t0.fy_year_week_number = ((2025*100) + DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK))
GROUP BY
  publication_group
ORDER BY
  actual_amount_current_week DESC
LIMIT 12;",SUM(Actual_Amount),measure,True,high,24,aca2f032-b796-49a2-89fe-781ca947aa33
ytd_actuals_forecast_amount_dynamic_by_publication_group,ytd_actual_forecast_amount,"YTD Actuals & Forecast Amount (Dynamic, by Publication Group)","A dynamic year-to-date metric that sums actual amounts for past fiscal months and forecast amounts for future fiscal months, based on the current fiscal month. Grouped by custom publication categories, excluding 'Other' category, and filtered for 'All Sales Channels'. The current fiscal month is dynamically determined based on a fixed date (2025-05-28) relative to the fiscal calendar.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT_Base AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.l04_publication_code,
    pub.l06_publication_code,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.fy_month_of_year,
    calendar.fy_year
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND pub.l04_publication_code <> 'Free News & Lifestyle'
    AND pub.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(
    CASE
      WHEN t0.fy_month_of_year <= SAFE_CAST(SAFE_CAST(CASE WHEN (DATETIME_SUB(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'UTC') AS DATETIME), INTERVAL -7 DAY) >= SAFE_CAST(t0.fy_first_day_of_week AS DATETIME)) AND (DATETIME_SUB(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'UTC') AS DATETIME), INTERVAL 7 DAY) >= SAFE_CAST(t0.fy_last_day_of_week AS DATETIME)) THEN SAFE_CAST(t0.fy_month_of_year AS STRING) ELSE NULL END AS STRING) AS INT64)
      THEN t0.Actual_Amount
      ELSE t0.Forecast_Amount
    END
  ) AS ytd_actual_forecast_amount,
  CASE
    WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals'
    WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN t0.publication_name IN ('The Australian') THEN ' The Australian'
    WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    ELSE '        Other'
  END AS publication_group
FROM
  OSandFACT_Base AS t0
WHERE
  t0.os_level_7 = 'All Sales Channels'
  AND (CASE WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals' WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser' WHEN t0.publication_name IN ('The Australian') THEN ' The Australian' WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail' WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph' WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun' ELSE '        Other' END) != '        Other'
  AND t0.fy_year_week_number = ((2025*100) + DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK))
GROUP BY
  publication_group
ORDER BY
  ytd_actual_forecast_amount DESC
LIMIT 12;",SUM(CASE WHEN t0.fy_month_of_year <= <current_fiscal_month> THEN t0.Actual_Amount ELSE t0.Forecast_Amount END),calculated_field,True,high,24,aca2f032-b796-49a2-89fe-781ca947aa33
ytd_actuals_forecast_amount_dynamic_all_sales_channels,ytd_actual_forecast_amount,"YTD Actuals & Forecast Amount (Dynamic, All Sales Channels)","A dynamic year-to-date metric that sums actual amounts for past fiscal months and forecast amounts for future fiscal months, based on the current fiscal month, specifically for 'All Sales Channels'. The current fiscal month is dynamically determined based on a fixed date (2025-05-28) relative to the fiscal calendar.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT_Base AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.l04_publication_code,
    pub.l06_publication_code,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.fy_month_of_year,
    calendar.fy_year
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND pub.l04_publication_code <> 'Free News & Lifestyle'
    AND pub.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(
    CASE
      WHEN t0.fy_month_of_year <= SAFE_CAST(SAFE_CAST(CASE WHEN (DATETIME_SUB(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'UTC') AS DATETIME), INTERVAL -7 DAY) >= SAFE_CAST(t0.fy_first_day_of_week AS DATETIME)) AND (DATETIME_SUB(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'UTC') AS DATETIME), INTERVAL 7 DAY) >= SAFE_CAST(t0.fy_last_day_of_week AS DATETIME)) THEN SAFE_CAST(t0.fy_month_of_year AS STRING) ELSE NULL END AS STRING) AS INT64)
      THEN t0.Actual_Amount
      ELSE t0.Forecast_Amount
    END
  ) AS ytd_actual_forecast_amount_all_sales_channels
FROM
  OSandFACT_Base AS t0
WHERE
  t0.os_level_7 = 'All Sales Channels'
  AND (CASE WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals' WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser' WHEN t0.publication_name IN ('The Australian') THEN ' The Australian' WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail' WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph' WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun' ELSE '        Other' END) != '        Other'
  AND t0.fy_year_week_number = ((2025*100) + DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-28 05:32:37.432682+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK))
LIMIT 1;",SUM(CASE WHEN t0.fy_month_of_year <= <current_fiscal_month> THEN t0.Actual_Amount ELSE t0.Forecast_Amount END),calculated_field,True,high,24,aca2f032-b796-49a2-89fe-781ca947aa33
publication_group,publication_group,Publication Group,"A categorical grouping of publications based on their names, used for aggregation and filtering within the dashboard. Excludes the 'Other' category.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT_Base AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.l04_publication_code,
    pub.l06_publication_code,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.fy_month_of_year,
    calendar.fy_year
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND pub.l04_publication_code <> 'Free News & Lifestyle'
    AND pub.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT DISTINCT
  CASE
    WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals'
    WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN t0.publication_name IN ('The Australian') THEN ' The Australian'
    WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    ELSE '        Other'
  END AS publication_group
FROM
  OSandFACT_Base AS t0
WHERE
  (CASE WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals' WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser' WHEN t0.publication_name IN ('The Australian') THEN ' The Australian' WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail' WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph' WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun' ELSE '        Other' END) != '        Other'
LIMIT 12;",CASE WHEN t0.publication_name IN (...) THEN 'Regionals' ... ELSE 'Other' END,dimension,False,medium,24,aca2f032-b796-49a2-89fe-781ca947aa33
ytd_actual_revenue,actual_revenue,YTD Actual Revenue,"The sum of actual revenue for the latest year-to-date period, excluding future weeks.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_year_flag = 1 AND t0.future_week_flag = 0",SUM(actual),measure,True,high,25,415199ee-c67c-4b55-85f1-38b4aa291931
ytd_forecast_revenue,forecast_revenue,YTD Forecast Revenue,"The sum of forecast revenue for the latest year-to-date period, excluding future weeks.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.forecast) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_year_flag = 1 AND t0.future_week_flag = 0",SUM(forecast),measure,True,high,25,415199ee-c67c-4b55-85f1-38b4aa291931
ytd_actual_vs_forecast_revenue_variance,revenue_variance,YTD Actual vs Forecast Revenue Variance,"The difference between YTD Actual Revenue and YTD Forecast Revenue for the latest year, excluding future weeks.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual - t0.forecast) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_year_flag = 1 AND t0.future_week_flag = 0",SUM(actual - forecast),calculated_field,True,high,25,415199ee-c67c-4b55-85f1-38b4aa291931
latest_year_actual_revenue,actual_revenue,Latest Year Actual Revenue,The sum of actual revenue for the latest year.,ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_year_flag = 1",SUM(actual),measure,True,high,25,415199ee-c67c-4b55-85f1-38b4aa291931
latest_year_projected_revenue,projected_revenue,Latest Year Projected Revenue,"The sum of projected revenue for the latest year, calculated using a combination of forecast, actual, and ML forecast values based on specific date ranges.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(CASE WHEN t0.fiscal_week_end_date <= DATE('2023-09-24') THEN t0.forecast WHEN t0.fiscal_week_end_date <= DATE('2023-11-12') THEN t0.actual * 0.98 WHEN t0.fiscal_week_end_date < DATE('2024-06-01') THEN t0.ml_forecast_rev * 0.96 ELSE 0 END) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_year_flag = 1",SUM(CASE WHEN fiscal_week_end_date <= DATE('2023-09-24') THEN forecast WHEN fiscal_week_end_date <= DATE('2023-11-12') THEN actual * 0.98 WHEN fiscal_week_end_date < DATE('2024-06-01') THEN ml_forecast_rev * 0.96 ELSE 0 END),calculated_field,True,high,25,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_actual_volume,actual_volume,Latest Week Actual Volume,The sum of actual volume for the latest week.,ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual_volume) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_week_flag = 1",SUM(actual_volume),measure,False,medium,25,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_actual_volume_120_uplift,actual_volume,Latest Week Actual Volume (120% Uplift),"The sum of actual volume for the latest week, increased by 20%.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual_volume * 1.2) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_week_flag = 1",SUM(actual_volume * 1.2),calculated_field,False,low,25,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_actual_revenue,actual_revenue,Latest Week Actual Revenue,The sum of actual revenue for the latest week.,ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_week_flag = 1",SUM(actual),measure,False,medium,25,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_projected_revenue,projected_revenue,Latest Week Projected Revenue,"The sum of projected revenue for the latest week, calculated using a combination of forecast, actual, and ML forecast values based on specific date ranges.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(CASE WHEN t0.fiscal_week_end_date <= DATE('2023-09-24') THEN t0.forecast WHEN t0.fiscal_week_end_date <= DATE('2023-11-12') THEN t0.actual * 0.98 WHEN t0.fiscal_week_end_date < DATE('2024-06-01') THEN t0.ml_forecast_rev * 0.96 ELSE 0 END) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0
WHERE t0.latest_week_flag = 1",SUM(CASE WHEN fiscal_week_end_date <= DATE('2023-09-24') THEN forecast WHEN fiscal_week_end_date <= DATE('2023-11-12') THEN actual * 0.98 WHEN fiscal_week_end_date < DATE('2024-06-01') THEN ml_forecast_rev * 0.96 ELSE 0 END),calculated_field,False,medium,25,415199ee-c67c-4b55-85f1-38b4aa291931
total_actual_volume,actual_volume,Total Actual Volume,"The sum of actual volume across the entire dataset, filtered by standard operating statement categories and excluding month-end flags.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual_volume) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0",SUM(actual_volume),measure,False,medium,25,415199ee-c67c-4b55-85f1-38b4aa291931
total_actual_revenue,actual_revenue,Total Actual Revenue,"The sum of actual revenue across the entire dataset, filtered by standard operating statement categories and excluding month-end flags.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"SELECT SUM(t0.actual) FROM (
  WITH
    tab_num AS (
      SELECT fiscal_week_end_date, COUNT(*) AS num FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES') GROUP BY 1
    ),
    model_rev AS (
      SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_rev, prediction_interval_lower_bound AS ml_forecast_rev_lb, prediction_interval_upper_bound AS ml_forecast_rev_ub, ml_forecast_vol, ml_forecast_vol_lb, ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) AS a INNER JOIN ( SELECT CAST(forecast_timestamp AS date) AS fiscal_week_end_date, forecast_value AS ml_forecast_vol, prediction_interval_lower_bound AS ml_forecast_vol_lb, prediction_interval_upper_bound AS ml_forecast_vol_ub FROM ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_vol`, STRUCT(20 AS horizon, 0.9 AS confidence_level)) ) AS b ON CAST(a.forecast_timestamp AS date) = CAST(b.fiscal_week_end_date AS date)
    ),
    main AS (
      SELECT fiscal_week_end_date, publication_name, os_l7, fiscal_week_number, actual, actual_volume, forecast, forecast_volume, budget, budget_volume,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 1 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_year_flag,
        CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = ( SELECT EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_year_flag,
        CASE WHEN fiscal_week_end_date + 7 = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS previous_week_flag,
        CASE WHEN fiscal_week_end_date = ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS latest_week_flag,
        CASE WHEN fiscal_week_end_date > ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS future_week_flag,
        CASE WHEN fiscal_week_end_date - 84 >= ( SELECT MAX(fiscal_week_end_date) FROM ( SELECT fiscal_week_end_date, sum(actual) AS actuals, sum(actual_volume) AS volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` GROUP BY fiscal_week_end_date ) WHERE actuals > 0 AND volume > 0 ) THEN 1 ELSE 0 END AS projection_week_flag
      FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
    )
  SELECT
    m.fiscal_week_end_date, m.publication_name, m.os_l7, m.fiscal_week_number, sum(m.actual) AS actual, sum(m.actual_volume) AS actual_volume, sum(m.forecast) AS forecast, sum(m.forecast_volume) AS forecast_volume, sum(m.budget) AS budget, sum(m.budget_volume) AS budget_volume, max(m.previous_week_flag) AS previous_week_flag, max(m.latest_year_flag) AS latest_year_flag, max(m.previous_year_flag) AS previous_year_flag, max(m.future_week_flag) AS future_week_flag, max(m.latest_week_flag) AS latest_week_flag, max(m.projection_week_flag) AS projection_week_flag, sum(a.ml_forecast_rev) AS ml_forecast_rev, sum(a.ml_forecast_rev_lb) AS ml_forecast_rev_lb, sum(a.ml_forecast_rev_ub) AS ml_forecast_rev_ub, sum(a.ml_forecast_vol) AS ml_forecast_vol, sum(a.ml_forecast_vol_lb) AS ml_forecast_vol_lb, sum(a.ml_forecast_vol_ub) AS ml_forecast_vol_ub
  FROM main AS m
  LEFT JOIN ( SELECT mr.fiscal_week_end_date, sum(ml_forecast_rev) / tn.num AS ml_forecast_rev, sum(ml_forecast_rev_lb) / tn.num AS ml_forecast_rev_lb, sum(ml_forecast_rev_ub) / tn.num AS ml_forecast_rev_ub, sum(ml_forecast_vol) / tn.num AS ml_forecast_vol, sum(ml_forecast_vol_lb) / tn.num AS ml_forecast_vol_lb, sum(ml_forecast_vol_ub) / tn.num AS ml_forecast_vol_ub FROM model_rev AS mr LEFT JOIN tab_num AS tn ON mr.fiscal_week_end_date = tn.fiscal_week_end_date GROUP BY 1, tn.num ) AS a
  ON m.fiscal_week_end_date = a.fiscal_week_end_date
  GROUP BY 1, 2, 3, 4
) AS t0",SUM(actual),measure,True,high,25,415199ee-c67c-4b55-85f1-38b4aa291931
service_model_filtered_future_months,service_model,Service Model (Filtered for Future Months),"Lists service models where the fiscal month ID is greater than the current fiscal month ID, excluding 'V1. Hybrid'. Used for filtering or grouping.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT t0.service_model FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) > SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid') GROUP BY t0.service_model,t0.service_model,dimension,false,low,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_2nd_margin_rev_by_fiscal_month_service_model_future,total_2nd_margin_rev,Total 2nd Margin Revenue by Fiscal Month and Service Model (Future Months),"Sum of total 2nd margin revenue, grouped by fiscal month and service model, for specific fiscal months and service models, where fiscal month ID is greater than current fiscal month ID and service model is not 'V1. Hybrid'.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model, SUM(t0.total_2nd_margin_rev) AS total_2nd_margin_rev FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) > SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY fiscal_month_id, t0.service_model",SUM(t0.total_2nd_margin_rev),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
sales_cost_by_fiscal_month_service_model_future,sales_cost,Sales Cost by Fiscal Month and Service Model (Future Months),"Sum of sales cost, grouped by fiscal month and service model, for specific fiscal months and service models, where fiscal month ID is greater than current fiscal month ID and service model is not 'V1. Hybrid'.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model, SUM(t0.sales_cost) AS sales_cost FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) > SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY fiscal_month_id, t0.service_model",SUM(t0.sales_cost),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_after_exclusion_by_fiscal_month_service_model_future,revenue_served_after_exclusion,Revenue Served After Exclusion by Fiscal Month and Service Model (Future Months),"Sum of revenue served after exclusion, grouped by fiscal month and service model, for specific fiscal months and service models, where fiscal month ID is greater than current fiscal month ID and service model is not 'V1. Hybrid'.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model, SUM(t0.revenue_served_after_exclusion) AS revenue_served_after_exclusion FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) > SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY fiscal_month_id, t0.service_model",SUM(t0.revenue_served_after_exclusion),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_other_margin_rev_by_fiscal_month_service_model_future,total_other_margin_rev,Total Other Margin Revenue by Fiscal Month and Service Model (Future Months),"Sum of total other margin revenue, grouped by fiscal month and service model, for specific fiscal months and service models, where fiscal month ID is greater than current fiscal month ID and service model is not 'V1. Hybrid'.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model, SUM(t0.total_other_margin_rev) AS total_other_margin_rev FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) > SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY fiscal_month_id, t0.service_model",SUM(t0.total_other_margin_rev),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
allocated_cost_by_business_unit,allocated_cost,Allocated Cost by Business Unit,"Sum of allocated costs, grouped by business unit code.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_bu_cost,"SELECT t0.business_unit_code, SUM(t0.allocated_cost) AS allocated_cost FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_bu_cost` AS t0 GROUP BY t0.business_unit_code",SUM(t0.allocated_cost),measure,true,medium,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
product_revenue_by_fiscal_month_service_model,product_revenue,Product Revenue by Fiscal Month and Service Model,"Sum of product revenue, grouped by fiscal month and service model, for specific fiscal months and service models.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_product,"SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model, SUM(t0.product_revenue) AS product_revenue FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_product` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY fiscal_month_id, t0.service_model",SUM(t0.product_revenue),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
min_other_additional_margin_by_fiscal_month_service_model,other_additional_margin,Min Other Additional Margin by Fiscal Month and Service Model,"Minimum of other additional margin, grouped by fiscal month and service model, for specific fiscal months and service models.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_product,"SELECT SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model, MIN(t0.other_additional_margin) AS other_additional_margin FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_product` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY fiscal_month_id, t0.service_model",MIN(t0.other_additional_margin),measure,false,low,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_2nd_margin_rev_by_service_model_past_concat,total_2nd_margin_rev,Total 2nd Margin Revenue by Service Model (Past Month & Specific Concat Month),"Sum of total 2nd margin revenue, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, SUM(t0.total_2nd_margin_rev) AS total_2nd_margin_rev FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",SUM(t0.total_2nd_margin_rev),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
sales_cost_by_service_model_past_concat,sales_cost,Sales Cost by Service Model (Past Month & Specific Concat Month),"Sum of sales cost, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, SUM(t0.sales_cost) AS sales_cost FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",SUM(t0.sales_cost),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_after_exclusion_by_service_model_past_concat,revenue_served_after_exclusion,Revenue Served After Exclusion by Service Model (Past Month & Specific Concat Month),"Sum of revenue served after exclusion, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, SUM(t0.revenue_served_after_exclusion) AS revenue_served_after_exclusion FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",SUM(t0.revenue_served_after_exclusion),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_other_margin_rev_by_service_model_past_concat,total_other_margin_rev,Total Other Margin Revenue by Service Model (Past Month & Specific Concat Month),"Sum of total other margin revenue, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, SUM(t0.total_other_margin_rev) AS total_other_margin_rev FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",SUM(t0.total_other_margin_rev),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_count_by_service_model_past_concat,target_cost_to_serve_percentage,Target Cost to Serve Percentage (Count) by Service Model (Past Month & Specific Concat Month),"Count of target cost to serve percentage entries, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, COUNT(t0.target_cost_to_serve_percentage) AS target_cost_to_serve_percentage_count FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",COUNT(t0.target_cost_to_serve_percentage),aggregation,false,medium,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_sum_by_service_model_past_concat,target_cost_to_serve_percentage,Target Cost to Serve Percentage (Sum) by Service Model (Past Month & Specific Concat Month),"Sum of target cost to serve percentage entries, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, SUM(t0.target_cost_to_serve_percentage) AS target_cost_to_serve_percentage_sum FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",SUM(t0.target_cost_to_serve_percentage),aggregation,false,medium,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_by_service_model_past_concat,revenue_served,Revenue Served by Service Model (Past Month & Specific Concat Month),"Sum of revenue served, grouped by service model, where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches a specific value.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT t0.service_model, SUM(t0.revenue_served) AS revenue_served FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan')) GROUP BY t0.service_model",SUM(t0.revenue_served),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_2nd_margin_rev_past_multiple_concat,total_2nd_margin_rev,Total 2nd Margin Revenue (Past Month & Multiple Concat Months),"Sum of total 2nd margin revenue where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SUM(t0.total_2nd_margin_rev) AS total_2nd_margin_rev FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",SUM(t0.total_2nd_margin_rev),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
sales_cost_past_multiple_concat,sales_cost,Sales Cost (Past Month & Multiple Concat Months),"Sum of sales cost where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SUM(t0.sales_cost) AS sales_cost FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",SUM(t0.sales_cost),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_after_exclusion_past_multiple_concat,revenue_served_after_exclusion,Revenue Served After Exclusion (Past Month & Multiple Concat Months),"Sum of revenue served after exclusion where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SUM(t0.revenue_served_after_exclusion) AS revenue_served_after_exclusion FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",SUM(t0.revenue_served_after_exclusion),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_other_margin_rev_past_multiple_concat,total_other_margin_rev,Total Other Margin Revenue (Past Month & Multiple Concat Months),"Sum of total other margin revenue where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SUM(t0.total_other_margin_rev) AS total_other_margin_rev FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",SUM(t0.total_other_margin_rev),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_count_past_multiple_concat,target_cost_to_serve_percentage,Target Cost to Serve Percentage (Count) (Past Month & Multiple Concat Months),"Count of target cost to serve percentage entries where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT COUNT(t0.target_cost_to_serve_percentage) AS target_cost_to_serve_percentage_count FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",COUNT(t0.target_cost_to_serve_percentage),aggregation,false,medium,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_sum_past_multiple_concat,target_cost_to_serve_percentage,Target Cost to Serve Percentage (Sum) (Past Month & Multiple Concat Months),"Sum of target cost to serve percentage entries where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SUM(t0.target_cost_to_serve_percentage) AS target_cost_to_serve_percentage_sum FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",SUM(t0.target_cost_to_serve_percentage),aggregation,false,medium,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_past_multiple_concat,revenue_served,Revenue Served (Past Month & Multiple Concat Months),"Sum of revenue served where fiscal month ID is less than current fiscal month ID, service model is not 'V1. Hybrid', and the concatenated fiscal month ID and fiscal month matches one of several specified values.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,"SELECT SUM(t0.revenue_served) AS revenue_served FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid' AND CONCAT(SAFE_CAST(t0.fiscal_month_id AS STRING),' ',SAFE_CAST(t0.fiscal_month AS STRING)) IN ('202507 Jan', '202506 Dec', '202505 Nov', '202504 Oct', '202503 Sep'))",SUM(t0.revenue_served),measure,true,high,26,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
npv_lgr_amount,lgr_amount,NPV LGR Amount,"The LGR (likely Gross Revenue or Gross Margin) amount, aggregated for entries identified as 'NPV' based on either current or prior year PV flags, excluding zero values, and restricted to current or future fiscal months.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT SUM(SAFE_CAST(t0.LGR AS BIGNUMERIC)) AS npv_lgr_amount FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE (t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') AND SAFE_CAST(t0.relative_fy_month_offset AS INT64) >= 0 AND SAFE_CAST(t0.LGR AS BIGNUMERIC) != 0.000000 LIMIT 1;,SUM(t0.LGR),measure,True,high,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
sum_relative_fy_month_offset,relative_fy_month_offset_sum,Sum of Relative Fiscal Month Offset,"The sum of the relative fiscal month offset for entries identified as 'NPV', excluding zero LGR values, and restricted to current or future fiscal months. The business meaning of summing this offset is unclear without further context, but it is explicitly aggregated in the source queries.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT SUM(SAFE_CAST(t0.relative_fy_month_offset AS INT64)) AS sum_relative_fy_month_offset FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE (t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') AND SAFE_CAST(t0.relative_fy_month_offset AS INT64) >= 0 AND SAFE_CAST(t0.LGR AS BIGNUMERIC) != 0.000000 LIMIT 1;,SUM(t0.relative_fy_month_offset),measure,False,low,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
sales_region_derived,sales_region,Sales Region (Derived),"The sales region, derived from the 'GM' (Gross Margin or General Manager) field if it contains a value, otherwise falling back to the 'sales_region_name' field. This allows for flexible regional categorization.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT CASE WHEN (t0.GM IS NULL) THEN SAFE_CAST(t0.sales_region_name AS STRING) ELSE SAFE_CAST(t0.GM AS STRING) END AS sales_region_derived FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 LIMIT 1;,CASE WHEN (t0.GM IS NULL) THEN t0.sales_region_name ELSE t0.GM END,dimension,False,medium,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
sales_team_derived,sales_team,Sales Team (Derived),"The sales team, derived from the 'GSD' (Global Sales Director or similar) field if it contains a value, otherwise falling back to the 'sales_team_name' field. This provides a flexible way to categorize sales teams.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT CASE WHEN (t0.GSD IS NULL) THEN SAFE_CAST(t0.sales_team_name AS STRING) ELSE SAFE_CAST(t0.GSD AS STRING) END AS sales_team_derived FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 LIMIT 1;,CASE WHEN (t0.GSD IS NULL) THEN t0.sales_team_name ELSE t0.GSD END,dimension,False,medium,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
npv_flag_filter,pv_flag_status_filter,NPV Flag Filter,A filter applied to ensure that only records where either the current period value flag (CURR_PV_FLAG) or the same-time-last-year period value flag (STLY_PV_FLAG) is explicitly set to 'NPV' are included in the analysis. This defines the core scope of 'NPV' related data.,ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE (t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') LIMIT 1;,(t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV'),filter,False,high,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
current_future_fy_month_filter,fy_month_offset_filter,Current/Future Fiscal Month Filter,"A filter applied to include only data points where the 'relative_fy_month_offset' is greater than or equal to zero, effectively focusing the analysis on the current and future fiscal months relative to a baseline.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE SAFE_CAST(t0.relative_fy_month_offset AS INT64) >= 0 LIMIT 1;,t0.relative_fy_month_offset >= 0,filter,False,medium,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
non_zero_lgr_filter,lgr_value_filter,Non-Zero LGR Filter,"A filter applied to exclude any records where the LGR (Gross Revenue/Margin) amount is exactly zero, ensuring that only meaningful revenue figures are included in calculations.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE SAFE_CAST(t0.LGR AS BIGNUMERIC) != 0.000000 LIMIT 1;,t0.LGR != 0.000000,filter,False,low,27,7ada02b8-e93e-41d8-9a7e-05013ff81247
gross_amount_diff_total_q1_q2,gross_amount_diff_total,"Total Gross Amount Difference (Digital, State & Communities)","The total gross amount difference, representing revenue movement, specifically for Digital revenue type and 'State & Communities' product group, within a specified date range.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(t0.GROSS_AMOUNT_DIFF) AS total_gross_amount_diff FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-06-26' AND t0.movement_date <= DATE '2025-07-03' AND (t0.financial_year NOT IN ('2025') OR t0.financial_year IS NULL) AND t0.revenue_type IN ('DIGITAL') AND t0.product_group_name IN ('State & Communities')),SUM(t0.GROSS_AMOUNT_DIFF),measure,true,high,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_digital_q1_q2,gross_amount_diff_digital,"Digital Gross Amount Difference (Digital, State & Communities)","The gross amount difference specifically for digital revenue types, filtered for 'Digital' revenue type and 'State & Communities' product group, within a specified date range.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(CASE WHEN (t0.revenue_type = 'DIGITAL') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS digital_gross_amount_diff FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-06-26' AND t0.movement_date <= DATE '2025-07-03' AND (t0.financial_year NOT IN ('2025') OR t0.financial_year IS NULL) AND t0.revenue_type IN ('DIGITAL') AND t0.product_group_name IN ('State & Communities')),SUM(CASE WHEN (t0.revenue_type = 'DIGITAL') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END),measure,true,high,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_print_q1_q2,gross_amount_diff_print,"Print Gross Amount Difference (Digital, State & Communities)","The gross amount difference specifically for print revenue types, filtered for 'Digital' revenue type and 'State & Communities' product group, within a specified date range.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(CASE WHEN (t0.revenue_type = 'PRINT') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS print_gross_amount_diff FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-06-26' AND t0.movement_date <= DATE '2025-07-03' AND (t0.financial_year NOT IN ('2025') OR t0.financial_year IS NULL) AND t0.revenue_type IN ('DIGITAL') AND t0.product_group_name IN ('State & Communities')),SUM(CASE WHEN (t0.revenue_type = 'PRINT') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END),measure,false,medium,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_total_q3_q4,gross_amount_diff_total,"Total Gross Amount Difference (2025, Consortium/Direct SA WA)","The total gross amount difference, representing revenue movement, for financial year 2025 and specific portfolio parent groups ('CONSORTIUM SA', 'DIRECT SA WA'), for a specific date.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,"SELECT SUM(t0.GROSS_AMOUNT_DIFF) AS total_gross_amount_diff FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-05-29' AND t0.movement_date <= DATE '2025-05-29' AND t0.financial_year IN ('2025') AND t0.portfolio_parent_group_name_sync IN ('CONSORTIUM SA', 'DIRECT SA WA'))",SUM(t0.GROSS_AMOUNT_DIFF),measure,true,high,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_digital_q3_q4,gross_amount_diff_digital,"Digital Gross Amount Difference (2025, Consortium/Direct SA WA)","The gross amount difference specifically for digital revenue types, filtered for financial year 2025 and specific portfolio parent groups ('CONSORTIUM SA', 'DIRECT SA WA'), for a specific date.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,"SELECT SUM(CASE WHEN (t0.revenue_type = 'DIGITAL') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS digital_gross_amount_diff FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-05-29' AND t0.movement_date <= DATE '2025-05-29' AND t0.financial_year IN ('2025') AND t0.portfolio_parent_group_name_sync IN ('CONSORTIUM SA', 'DIRECT SA WA'))",SUM(CASE WHEN (t0.revenue_type = 'DIGITAL') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END),measure,true,high,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_print_q3_q4,gross_amount_diff_print,"Print Gross Amount Difference (2025, Consortium/Direct SA WA)","The gross amount difference specifically for print revenue types, filtered for financial year 2025 and specific portfolio parent groups ('CONSORTIUM SA', 'DIRECT SA WA'), for a specific date.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,"SELECT SUM(CASE WHEN (t0.revenue_type = 'PRINT') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS print_gross_amount_diff FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-05-29' AND t0.movement_date <= DATE '2025-05-29' AND t0.financial_year IN ('2025') AND t0.portfolio_parent_group_name_sync IN ('CONSORTIUM SA', 'DIRECT SA WA'))",SUM(CASE WHEN (t0.revenue_type = 'PRINT') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END),measure,false,medium,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
publishing_division_group_dimension_q5_q6,publishing_division_group,"Publishing Division Group (2026, Digital)","A dimension representing the publishing division group, filtered by movement date range, financial year 2026, and 'DIGITAL' revenue type.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.publishing_division_group FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_date >= DATE '2025-08-04' AND t0.movement_date <= DATE '2025-08-11' AND t0.financial_year IN ('2026') AND t0.revenue_type IN ('DIGITAL')) GROUP BY t0.publishing_division_group,t0.publishing_division_group,dimension,false,low,29,a1b901e6-c4fb-44bc-955a-3a7070c15829
os_level_4_mer_externals_jan_2025,os_level_4,"OS Level 4 (MER Externals, Jan 2025)","Organizational Structure Level 4 dimension, filtered for January 2025, from the MER Externals dataset.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_externals,SELECT t0.os_level_4 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Jan' GROUP BY t0.os_level_4 LIMIT 100,t0.os_level_4,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
os_level_6_monthly_expenses_apr_2025,os_level_6,"OS Level 6 (Monthly Expenses, Apr 2025)","Organizational Structure Level 6 dimension, filtered for April 2025, from the Monthly Expenses dataset.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,SELECT t0.os_level_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Apr' GROUP BY t0.os_level_6 LIMIT 100,t0.os_level_6,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
os_level_6_monthly_revenue_aug_2025,os_level_6,"OS Level 6 (Monthly Revenue, Aug 2025)","Organizational Structure Level 6 dimension, filtered for August 2025 and numeric publication codes, from the Monthly Revenue dataset.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT t0.os_level_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Aug' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') GROUP BY t0.os_level_6 LIMIT 100",t0.os_level_6,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
tm1_net_revenue_aug_2025,tm1_net_revenue,TM1 Net Revenue (Aug 2025),"Total Net Revenue as reported in TM1, filtered for August 2025 and numeric publication codes.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT SUM(t0.TM1_Net_Revenue) AS tm1_net_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Aug' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')",SUM(t0.TM1_Net_Revenue),measure,True,high,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
tableau_actual_revenue_aug_2025,tableau_actual_revenue,Tableau Actual Revenue (Aug 2025),"Total Actual Revenue as reported in Tableau, filtered for August 2025 and numeric publication codes.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT SUM(t0.Tableau_Actual) AS tableau_actual_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Aug' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')",SUM(t0.Tableau_Actual),measure,True,high,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
revenue_variance_aug_2025,revenue_variance,"Revenue Variance (Tableau Actual vs TM1 Net, Aug 2025)","The difference between Tableau Actual Revenue and TM1 Net Revenue, filtered for August 2025 and numeric publication codes.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT SUM(t0.Tableau_Actual - t0.TM1_Net_Revenue) AS revenue_variance FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Aug' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')",SUM(t0.Tableau_Actual - t0.TM1_Net_Revenue),calculated_field,True,high,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
is_print_digital_flag_mer_externals_2025,is_print_digital_flag,"Is Print Digital Flag (MER Externals, 2025)","Flag indicating if a record is for print or digital, from the MER Externals dataset, filtered for fiscal year 2025.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_externals,"SELECT t0.is_print_digital_flag, t0.month_short_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals` AS t0 WHERE t0.fiscal_year = 2025 GROUP BY t0.is_print_digital_flag, t0.month_short_name ORDER BY t0.is_print_digital_flag ASC LIMIT 100",t0.is_print_digital_flag,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
month_short_name_mer_externals_2025,month_short_name,"Month Short Name (MER Externals, 2025)","Short name of the month (e.g., 'Jan', 'Feb'), from the MER Externals dataset, filtered for fiscal year 2025.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_externals,"SELECT t0.month_short_name, t0.is_print_digital_flag FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals` AS t0 WHERE t0.fiscal_year = 2025 GROUP BY t0.month_short_name, t0.is_print_digital_flag ORDER BY t0.is_print_digital_flag ASC LIMIT 100",t0.month_short_name,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
actual_amount_finance_os_agg_2025,actual_amount,"Actual Amount (Finance OS Agg, 2025)","Total actual financial amount from the aggregated finance dataset, filtered for fiscal year 2025.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_asl_FCT_finance_os_agg_with_hierarchy,"SELECT SUM(t0.Actual_Amount) AS actual_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_asl_FCT_finance_os_agg_with_hierarchy` AS t0 WHERE SUBSTR(SAFE_CAST(t0.fiscal_week_id AS STRING), 1, 4) = '2025'",SUM(t0.Actual_Amount),measure,True,high,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
os_level_3_finance_os_agg_2025,os_level_3,"OS Level 3 (Finance OS Agg, 2025)","Organizational Structure Level 3 dimension from the aggregated finance dataset, filtered for fiscal year 2025.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_asl_FCT_finance_os_agg_with_hierarchy,"SELECT t0.os_level_3 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_asl_FCT_finance_os_agg_with_hierarchy` AS t0 WHERE SUBSTR(SAFE_CAST(t0.fiscal_week_id AS STRING), 1, 4) = '2025' GROUP BY t0.os_level_3 LIMIT 100",t0.os_level_3,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
os_level_6_monthly_revenue_jul_2025,os_level_6,"OS Level 6 (Monthly Revenue, Jul 2025)","Organizational Structure Level 6 dimension, filtered for July 2025, from the Monthly Revenue dataset.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,SELECT t0.os_level_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Jul' GROUP BY t0.os_level_6 LIMIT 100,t0.os_level_6,dimension,False,low,30,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
current_fy_gross_revenue_sbx_dcp_ia,current_fy_gross_revenue,Current FY Gross Revenue,"Total gross revenue for the current financial year, typically excluding 'PROGRAMMATIC EXCHANGE' revenue based on dashboard filters.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE (t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL),SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END),measure,True,high,31,fed70b12-c274-4cde-9920-592ca4c4dab0
previous_fy_gross_revenue_sbx_dcp_ia,previous_fy_gross_revenue,Previous FY Gross Revenue,"Total gross revenue for the previous financial year, typically excluding 'PROGRAMMATIC EXCHANGE' revenue based on dashboard filters.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = -1) THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE (t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL),SUM(CASE WHEN (t0.relative_fy_year_offset = -1) THEN t0.gross_revenue_amount ELSE 0 END),measure,True,high,31,fed70b12-c274-4cde-9920-592ca4c4dab0
previous_fy_gross_revenue_ytd_or_full_year_sbx_dcp_ia,previous_fy_gross_revenue_ytd_or_full_year,Previous FY Gross Revenue (YTD or Full Year),"Gross revenue for the previous financial year. If the current fiscal period is still ongoing, it compares YTD to YTD. If the current fiscal period has passed the comparison point, it compares full year to full year. The comparison date is dynamically set by the dashboard. Typically excludes 'PROGRAMMATIC EXCHANGE' revenue.",ncau-data-newsquery-prd,sbx_dcp,ia,"SELECT SUM(CASE WHEN t0.relative_fy_month_offset < -12 THEN (CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) ELSE (CASE WHEN t0.relative_fy_year_offset = -1 AND SAFE_CAST(t0.booking_line_created_date AS DATETIME) <= DATETIME_ADD(CURRENT_DATE(), INTERVAL -365 DAY) THEN t0.gross_revenue_amount ELSE 0 END) END) AS previous_fy_gross_revenue_ytd_or_full_year FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE (t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL)","SUM(CASE WHEN t0.relative_fy_month_offset < -12 THEN (CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) ELSE (CASE WHEN t0.relative_fy_year_offset = -1 AND SAFE_CAST(t0.booking_line_created_date AS DATETIME) <= DATETIME_ADD(CURRENT_DATE(), INTERVAL -365 DAY) THEN t0.gross_revenue_amount ELSE 0 END) END)",measure,True,high,31,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_amount_difference_asl_finance_derived_revenue_movement,gross_amount_difference,Gross Amount Difference,"The difference in gross revenue amount, typically used for tracking revenue movements or adjustments. This metric excludes data from the 'min_week' as per dashboard filtering.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(t0.GROSS_AMOUNT_DIFF) AS gross_amount_difference FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE (t0.movement_financial_week != t0.min_week),SUM(t0.GROSS_AMOUNT_DIFF),measure,False,medium,31,fed70b12-c274-4cde-9920-592ca4c4dab0
total_expense_margin_1_or_2,total_expense,Total Expense (Margin Level 1 or 2),"Total expense where the margin level is 1 or 2, derived from the 'Expense' column.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT SUM(CASE WHEN (SAFE_CAST(t0.Margin_Level AS STRING) = '1' OR SAFE_CAST(t0.Margin_Level AS STRING) = '2') THEN t0.Expense ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,SUM(CASE WHEN (SAFE_CAST(t0.Margin_Level AS STRING) = '1' OR SAFE_CAST(t0.Margin_Level AS STRING) = '2') THEN t0.Expense ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
total_product_revenue,total_revenue,Total Product Revenue,Total revenue generated from products.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT SUM(t0.Product_Revenue) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,SUM(t0.Product_Revenue),measure,True,high,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_1_dynamic,running_expense,Running Expense 1 (Dynamic Selection),"Running expense for level 1, dynamically selected based on Category (Consumer/Advertising) and Source (Actuals/Budget). The MAX aggregation is used to pick the relevant value from pre-calculated columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_1_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_1_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_1_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_1_Budget ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_1_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_1_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_1_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_1_Budget ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_2_dynamic,running_expense,Running Expense 2 (Dynamic Selection),"Running expense for level 2, dynamically selected based on Category (Consumer/Advertising) and Source (Actuals/Budget). The MAX aggregation is used to pick the relevant value from pre-calculated columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_2_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_2_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_2_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_2_Budget ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_2_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_2_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_2_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_2_Budget ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_3_dynamic,running_expense,Running Expense 3 (Dynamic Selection),"Running expense for level 3, dynamically selected based on Category (Consumer/Advertising) and Source (Actuals/Budget). The MAX aggregation is used to pick the relevant value from pre-calculated columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_3_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_3_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_3_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_3_Budget ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_3_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_3_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_3_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_3_Budget ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_4_dynamic,running_expense,Running Expense 4 (Dynamic Selection),"Running expense for level 4, dynamically selected based on Category (Consumer/Advertising) and Source (Actuals/Budget). The MAX aggregation is used to pick the relevant value from pre-calculated columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_4_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_4_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_4_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_4_Budget ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_4_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_4_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_4_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_4_Budget ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_5_dynamic,running_expense,Running Expense 5 (Dynamic Selection),"Running expense for level 5, dynamically selected based on Category (Consumer/Advertising) and Source (Actuals/Budget). The MAX aggregation is used to pick the relevant value from pre-calculated columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_5_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_5_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_5_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_5_Budget ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_5_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_5_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_5_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_5_Budget ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_6_dynamic,running_expense,Running Expense 6 (Dynamic Selection),"Running expense for level 6, dynamically selected based on Category (Consumer/Advertising) and Source (Actuals/Budget). The MAX aggregation is used to pick the relevant value from pre-calculated columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_6_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_6_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_6_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_6_Budget ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,MAX(CASE WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Actuals') THEN t0.Running_Expense_CONSUMER_6_Actuals WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Actuals') THEN t0.Running_Expense_ADVERTISING_6_Actuals WHEN (t0.Category = 'CONSUMER' AND t0.Source = 'Budget') THEN t0.Running_Expense_CONSUMER_6_Budget WHEN (t0.Category = 'ADVERTISING' AND t0.Source = 'Budget') THEN t0.Running_Expense_ADVERTISING_6_Budget ELSE 0 END),measure,False,medium,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
record_count,record_count,Record Count,Total number of records in the dataset.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT COUNT(1) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,COUNT(1),aggregation,False,low,32,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
fiscal_week_label_2025_may_14,fiscal_week_label,Fiscal Week Label (2025-05-14),"A concatenated string representing the fiscal year, week, and month for the specific date 2025-05-14, used as a display dimension. This value is a constant 'FY 2025 Week 45 (May)' based on the embedded date parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT MIN(CONCAT('FY ','2025',' Week ',SAFE_CAST(CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END AS STRING),' (',SAFE_CAST(CASE WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 4) THEN 1 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 9) THEN 2 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 13) THEN 3 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 17) THEN 4 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 22) THEN 5 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 26) THEN 6 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 30) THEN 7 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 35) THEN 8 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 39) THEN 9 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 43) THEN 10 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 48) THEN 11 WHEN (CASE WHEN (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-14 01:55:14.250367+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END <= 53) THEN 12 ELSE NULL END AS STRING),')') FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` LIMIT 1;",'FY 2025 Week 45 (May)',dimension,False,low,33,37641205-ec3e-4184-a5dd-f5ca79248335
scenario_type_fct,scenario_type,Scenario Type (Forecast),"Indicates the data scenario being viewed, in this case, 'Forecast'. This is a constant value likely derived from a dashboard parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT MIN(CASE WHEN (2 = 1) THEN 'BUD' WHEN (2 = 2) THEN 'FCT' WHEN (2 = 3) THEN 'YOY' WHEN (2 = 4) THEN 'BUD NY' ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` LIMIT 1;,'FCT',dimension,False,low,33,37641205-ec3e-4184-a5dd-f5ca79248335
digital_closing_base_fy25_current_week_filtered_pubs,closing_base,"Digital Closing Base (FY25, Current Week, Filtered Publications)","The closing base value for Fiscal Year 2025, for the current week (week 43 relative to 2024-07-03), specifically for 'bmasnap_close', 'SC - CODE Manual APLS', or 'SC Manual APLS' sources, filtered for digital recognition and specific publication groups (not 'Discontinued' and not 'Deep Niche Publications').",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"WITH base_data AS (
  SELECT
    t0.fy_year,
    t0.fy_week_of_year,
    t0.delivery_medium_type,
    t0.gl_publication_code,
    t0.masthead_code,
    t0.subscriber_has_email_flag,
    t0.ClosingBase,
    t0.OpeningBase,
    t0.EarnedAmount,
    t0.NFEarnedAmount,
    t0.table_union_source,
    t0.classification_level_1_description,
    t0.classification_level_2_description
  FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
),
intermediate_flags AS (
  SELECT
    *,
    (SAFE_CAST(classification_level_1_description AS STRING) = 'Standard Paid') AS is_standard_paid,
    (SAFE_CAST(delivery_medium_type AS STRING) = 'Bundle') AS is_bundle,
    (SAFE_CAST(subscriber_has_email_flag AS STRING) = 'subsnapfact') AS is_subsnapfact_email_flag
  FROM base_data
),
intermediate_masthead AS (
  SELECT
    *,
    CASE
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '100' OR SAFE_CAST(gl_publication_code AS STRING) = '101' OR SAFE_CAST(masthead_code AS STRING) = 'TA') THEN 'The Australian'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '401' OR SAFE_CAST(gl_publication_code AS STRING) = '402' OR SAFE_CAST(gl_publication_code AS STRING) = '17' OR SAFE_CAST(masthead_code AS STRING) = 'CM') THEN 'Courier Mail'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '110' OR SAFE_CAST(gl_publication_code AS STRING) = '111' OR SAFE_CAST(gl_publication_code AS STRING) = '116' OR SAFE_CAST(masthead_code AS STRING) = 'DT') THEN 'Daily Telegraph'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '301' OR SAFE_CAST(gl_publication_code AS STRING) = '302' OR SAFE_CAST(gl_publication_code AS STRING) = '303' OR SAFE_CAST(masthead_code AS STRING) = 'HS') THEN 'Herald Sun'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '500' OR SAFE_CAST(gl_publication_code AS STRING) = '501' OR SAFE_CAST(gl_publication_code AS STRING) = '560' OR SAFE_CAST(masthead_code AS STRING) = 'AA') THEN 'The Advertiser'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '450' OR SAFE_CAST(gl_publication_code AS STRING) = '460' OR SAFE_CAST(masthead_code AS STRING) = 'CP') THEN 'Cairns Post'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '350' OR SAFE_CAST(gl_publication_code AS STRING) = '351' OR SAFE_CAST(masthead_code AS STRING) = 'GA') THEN 'Geelong'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '670' OR SAFE_CAST(gl_publication_code AS STRING) = '685' OR SAFE_CAST(masthead_code AS STRING) = 'GC') THEN 'Gold Coast'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '961' OR SAFE_CAST(gl_publication_code AS STRING) = '962' OR SAFE_CAST(gl_publication_code AS STRING) = '963' OR SAFE_CAST(masthead_code AS STRING) = 'NT') THEN 'NT News'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '850' OR SAFE_CAST(gl_publication_code AS STRING) = '851' OR SAFE_CAST(gl_publication_code AS STRING) = '852' OR SAFE_CAST(masthead_code AS STRING) = 'TM') THEN 'The Mercury'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '5053' OR SAFE_CAST(gl_publication_code AS STRING) = '5253' OR SAFE_CAST(masthead_code AS STRING) = 'TC') THEN 'Toowoomba'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '475' OR SAFE_CAST(gl_publication_code AS STRING) = '490' OR SAFE_CAST(masthead_code AS STRING) = 'TB') THEN 'Townsville'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '305' OR SAFE_CAST(gl_publication_code AS STRING) = '307' OR SAFE_CAST(masthead_code AS STRING) = 'WT') THEN 'Weekly Times'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9001' OR SAFE_CAST(masthead_code AS STRING) = 'CS') THEN 'Code'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '8821' OR SAFE_CAST(gl_publication_code AS STRING) = 'Punters.com.au' OR SAFE_CAST(masthead_code AS STRING) = 'PU') THEN 'Punters'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '8822' OR SAFE_CAST(gl_publication_code AS STRING) = 'Racenet' OR SAFE_CAST(masthead_code AS STRING) = 'RN') THEN 'Racenet'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9653' OR SAFE_CAST(masthead_code AS STRING) = 'SC') THEN 'Supercoach Plus'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9600' OR SAFE_CAST(masthead_code AS STRING) = 'TS') THEN 'Taste Online'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9003' OR SAFE_CAST(masthead_code AS STRING) = 'AP') THEN 'Apple Podcast: Crime X'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '103' OR SAFE_CAST(classification_level_2_description AS STRING) = 'The Oz') THEN 'The Oz'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9000' OR SAFE_CAST(masthead_code AS STRING) = 'NW') THEN 'news.com.au'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '121') THEN 'Others'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9002' OR SAFE_CAST(masthead_code AS STRING) = 'BG') THEN 'Brain Games'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9504' OR SAFE_CAST(gl_publication_code AS STRING) = '9514' OR SAFE_CAST(gl_publication_code AS STRING) = '9556' OR SAFE_CAST(gl_publication_code AS STRING) = '9558' OR SAFE_CAST(gl_publication_code AS STRING) = '9560' OR SAFE_CAST(gl_publication_code AS STRING) = '9603' OR SAFE_CAST(gl_publication_code AS STRING) = '9623') THEN 'Others'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9644') THEN 'Suddenly'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9903') THEN 'News Corporate'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
      ELSE NULL
    END AS masthead_name_raw
  FROM intermediate_flags
),
categorized_data AS (
  SELECT
    *,
    CASE
      WHEN (masthead_name_raw = 'The Australian') THEN 'The Australian'
      WHEN (masthead_name_raw IN ('Courier Mail', 'Daily Telegraph', 'Herald Sun', 'The Advertiser')) THEN 'Metros'
      WHEN (masthead_name_raw IN ('Cairns Post', 'Geelong', 'Gold Coast', 'NT News', 'The Mercury', 'Toowoomba', 'Townsville')) THEN 'Regionals'
      WHEN (masthead_name_raw = 'Weekly Times') THEN 'Others'
      WHEN (masthead_name_raw IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Racenet', 'Punters', 'Others')) THEN 'Deep Niche Publications'
      ELSE 'Discontinued'
    END AS publication_group,
    CASE
      WHEN (SAFE_CAST(delivery_medium_type AS STRING) = 'Print') THEN 'Print Recognition'
      WHEN (is_subsnapfact_email_flag OR (is_standard_paid AND is_bundle)) THEN 'Print Recognition'
      ELSE 'Digital Recognition'
    END AS recognition_type
  FROM intermediate_masthead
)
SELECT
  SUM(CASE WHEN (SAFE_CAST(fy_year AS INT64) = 2025 AND SAFE_CAST(fy_week_of_year AS INT64) = 43 AND SAFE_CAST(table_union_source AS STRING) IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN SAFE_CAST(ClosingBase AS BIGNUMERIC) ELSE 0 END)
FROM categorized_data
WHERE
  publication_group != 'Discontinued'
  AND recognition_type = 'Digital Recognition'
  AND (publication_group NOT IN ('Deep Niche Publications') OR publication_group IS NULL)
LIMIT 1;","SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 43 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END)",measure,True,high,33,37641205-ec3e-4184-a5dd-f5ca79248335
digital_opening_base_fy25_current_week_filtered_pubs,opening_base,"Digital Opening Base (FY25, Current Week, Filtered Publications)","The opening base value for Fiscal Year 2025, for the current week (week 43 relative to 2024-07-03), specifically for 'bmasnap_open' source, filtered for digital recognition and specific publication groups (not 'Discontinued' and not 'Deep Niche Publications').",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"WITH base_data AS (
  SELECT
    t0.fy_year,
    t0.fy_week_of_year,
    t0.delivery_medium_type,
    t0.gl_publication_code,
    t0.masthead_code,
    t0.subscriber_has_email_flag,
    t0.ClosingBase,
    t0.OpeningBase,
    t0.EarnedAmount,
    t0.NFEarnedAmount,
    t0.table_union_source,
    t0.classification_level_1_description,
    t0.classification_level_2_description
  FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
),
intermediate_flags AS (
  SELECT
    *,
    (SAFE_CAST(classification_level_1_description AS STRING) = 'Standard Paid') AS is_standard_paid,
    (SAFE_CAST(delivery_medium_type AS STRING) = 'Bundle') AS is_bundle,
    (SAFE_CAST(subscriber_has_email_flag AS STRING) = 'subsnapfact') AS is_subsnapfact_email_flag
  FROM base_data
),
intermediate_masthead AS (
  SELECT
    *,
    CASE
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '100' OR SAFE_CAST(gl_publication_code AS STRING) = '101' OR SAFE_CAST(masthead_code AS STRING) = 'TA') THEN 'The Australian'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '401' OR SAFE_CAST(gl_publication_code AS STRING) = '402' OR SAFE_CAST(gl_publication_code AS STRING) = '17' OR SAFE_CAST(masthead_code AS STRING) = 'CM') THEN 'Courier Mail'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '110' OR SAFE_CAST(gl_publication_code AS STRING) = '111' OR SAFE_CAST(gl_publication_code AS STRING) = '116' OR SAFE_CAST(masthead_code AS STRING) = 'DT') THEN 'Daily Telegraph'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '301' OR SAFE_CAST(gl_publication_code AS STRING) = '302' OR SAFE_CAST(gl_publication_code AS STRING) = '303' OR SAFE_CAST(masthead_code AS STRING) = 'HS') THEN 'Herald Sun'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '500' OR SAFE_CAST(gl_publication_code AS STRING) = '501' OR SAFE_CAST(gl_publication_code AS STRING) = '560' OR SAFE_CAST(masthead_code AS STRING) = 'AA') THEN 'The Advertiser'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '450' OR SAFE_CAST(gl_publication_code AS STRING) = '460' OR SAFE_CAST(masthead_code AS STRING) = 'CP') THEN 'Cairns Post'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '350' OR SAFE_CAST(gl_publication_code AS STRING) = '351' OR SAFE_CAST(masthead_code AS STRING) = 'GA') THEN 'Geelong'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '670' OR SAFE_CAST(gl_publication_code AS STRING) = '685' OR SAFE_CAST(masthead_code AS STRING) = 'GC') THEN 'Gold Coast'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '961' OR SAFE_CAST(gl_publication_code AS STRING) = '962' OR SAFE_CAST(gl_publication_code AS STRING) = '963' OR SAFE_CAST(masthead_code AS STRING) = 'NT') THEN 'NT News'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '850' OR SAFE_CAST(gl_publication_code AS STRING) = '851' OR SAFE_CAST(gl_publication_code AS STRING) = '852' OR SAFE_CAST(masthead_code AS STRING) = 'TM') THEN 'The Mercury'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '5053' OR SAFE_CAST(gl_publication_code AS STRING) = '5253' OR SAFE_CAST(masthead_code AS STRING) = 'TC') THEN 'Toowoomba'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '475' OR SAFE_CAST(gl_publication_code AS STRING) = '490' OR SAFE_CAST(masthead_code AS STRING) = 'TB') THEN 'Townsville'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '305' OR SAFE_CAST(gl_publication_code AS STRING) = '307' OR SAFE_CAST(masthead_code AS STRING) = 'WT') THEN 'Weekly Times'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9001' OR SAFE_CAST(masthead_code AS STRING) = 'CS') THEN 'Code'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '8821' OR SAFE_CAST(gl_publication_code AS STRING) = 'Punters.com.au' OR SAFE_CAST(masthead_code AS STRING) = 'PU') THEN 'Punters'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '8822' OR SAFE_CAST(gl_publication_code AS STRING) = 'Racenet' OR SAFE_CAST(masthead_code AS STRING) = 'RN') THEN 'Racenet'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9653' OR SAFE_CAST(masthead_code AS STRING) = 'SC') THEN 'Supercoach Plus'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9600' OR SAFE_CAST(masthead_code AS STRING) = 'TS') THEN 'Taste Online'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9003' OR SAFE_CAST(masthead_code AS STRING) = 'AP') THEN 'Apple Podcast: Crime X'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '103' OR SAFE_CAST(classification_level_2_description AS STRING) = 'The Oz') THEN 'The Oz'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9000' OR SAFE_CAST(masthead_code AS STRING) = 'NW') THEN 'news.com.au'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '121') THEN 'Others'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9002' OR SAFE_CAST(masthead_code AS STRING) = 'BG') THEN 'Brain Games'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9504' OR SAFE_CAST(gl_publication_code AS STRING) = '9514' OR SAFE_CAST(gl_publication_code AS STRING) = '9556' OR SAFE_CAST(gl_publication_code AS STRING) = '9558' OR SAFE_CAST(gl_publication_code AS STRING) = '9560' OR SAFE_CAST(gl_publication_code AS STRING) = '9603' OR SAFE_CAST(gl_publication_code AS STRING) = '9623') THEN 'Others'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9644') THEN 'Suddenly'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9903') THEN 'News Corporate'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
      ELSE NULL
    END AS masthead_name_raw
  FROM intermediate_flags
),
categorized_data AS (
  SELECT
    *,
    CASE
      WHEN (masthead_name_raw = 'The Australian') THEN 'The Australian'
      WHEN (masthead_name_raw IN ('Courier Mail', 'Daily Telegraph', 'Herald Sun', 'The Advertiser')) THEN 'Metros'
      WHEN (masthead_name_raw IN ('Cairns Post', 'Geelong', 'Gold Coast', 'NT News', 'The Mercury', 'Toowoomba', 'Townsville')) THEN 'Regionals'
      WHEN (masthead_name_raw = 'Weekly Times') THEN 'Others'
      WHEN (masthead_name_raw IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Racenet', 'Punters', 'Others')) THEN 'Deep Niche Publications'
      ELSE 'Discontinued'
    END AS publication_group,
    CASE
      WHEN (SAFE_CAST(delivery_medium_type AS STRING) = 'Print') THEN 'Print Recognition'
      WHEN (is_subsnapfact_email_flag OR (is_standard_paid AND is_bundle)) THEN 'Print Recognition'
      ELSE 'Digital Recognition'
    END AS recognition_type
  FROM intermediate_masthead
)
SELECT
  SUM(CASE WHEN (SAFE_CAST(fy_year AS INT64) = 2025 AND SAFE_CAST(fy_week_of_year AS INT64) = 43 AND SAFE_CAST(table_union_source AS STRING) = 'bmasnap_open') THEN SAFE_CAST(OpeningBase AS BIGNUMERIC) ELSE 0 END)
FROM categorized_data
WHERE
  publication_group != 'Discontinued'
  AND recognition_type = 'Digital Recognition'
  AND (publication_group NOT IN ('Deep Niche Publications') OR publication_group IS NULL)
LIMIT 1;",SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 43 AND t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END),measure,True,high,33,37641205-ec3e-4184-a5dd-f5ca79248335
digital_recognized_revenue_fy25_current_week_filtered_pubs,recognized_revenue,"Digital Recognized Revenue (FY25, Current Week, Filtered Publications)","The recognized revenue (EarnedAmount or NFEarnedAmount based on year and source) for Fiscal Year 2025, for the current week (week 43 relative to 2024-07-03), filtered for digital recognition and specific publication groups (not 'Discontinued' and not 'Deep Niche Publications').",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"WITH base_data AS (
  SELECT
    t0.fy_year,
    t0.fy_week_of_year,
    t0.delivery_medium_type,
    t0.gl_publication_code,
    t0.masthead_code,
    t0.subscriber_has_email_flag,
    t0.ClosingBase,
    t0.OpeningBase,
    t0.EarnedAmount,
    t0.NFEarnedAmount,
    t0.table_union_source,
    t0.classification_level_1_description,
    t0.classification_level_2_description
  FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
),
intermediate_flags AS (
  SELECT
    *,
    (SAFE_CAST(classification_level_1_description AS STRING) = 'Standard Paid') AS is_standard_paid,
    (SAFE_CAST(delivery_medium_type AS STRING) = 'Bundle') AS is_bundle,
    (SAFE_CAST(subscriber_has_email_flag AS STRING) = 'subsnapfact') AS is_subsnapfact_email_flag
  FROM base_data
),
intermediate_masthead AS (
  SELECT
    *,
    CASE
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '100' OR SAFE_CAST(gl_publication_code AS STRING) = '101' OR SAFE_CAST(masthead_code AS STRING) = 'TA') THEN 'The Australian'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '401' OR SAFE_CAST(gl_publication_code AS STRING) = '402' OR SAFE_CAST(gl_publication_code AS STRING) = '17' OR SAFE_CAST(masthead_code AS STRING) = 'CM') THEN 'Courier Mail'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '110' OR SAFE_CAST(gl_publication_code AS STRING) = '111' OR SAFE_CAST(gl_publication_code AS STRING) = '116' OR SAFE_CAST(masthead_code AS STRING) = 'DT') THEN 'Daily Telegraph'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '301' OR SAFE_CAST(gl_publication_code AS STRING) = '302' OR SAFE_CAST(gl_publication_code AS STRING) = '303' OR SAFE_CAST(masthead_code AS STRING) = 'HS') THEN 'Herald Sun'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '500' OR SAFE_CAST(gl_publication_code AS STRING) = '501' OR SAFE_CAST(gl_publication_code AS STRING) = '560' OR SAFE_CAST(masthead_code AS STRING) = 'AA') THEN 'The Advertiser'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '450' OR SAFE_CAST(gl_publication_code AS STRING) = '460' OR SAFE_CAST(masthead_code AS STRING) = 'CP') THEN 'Cairns Post'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '350' OR SAFE_CAST(gl_publication_code AS STRING) = '351' OR SAFE_CAST(masthead_code AS STRING) = 'GA') THEN 'Geelong'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '670' OR SAFE_CAST(gl_publication_code AS STRING) = '685' OR SAFE_CAST(masthead_code AS STRING) = 'GC') THEN 'Gold Coast'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '961' OR SAFE_CAST(gl_publication_code AS STRING) = '962' OR SAFE_CAST(gl_publication_code AS STRING) = '963' OR SAFE_CAST(masthead_code AS STRING) = 'NT') THEN 'NT News'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '850' OR SAFE_CAST(gl_publication_code AS STRING) = '851' OR SAFE_CAST(gl_publication_code AS STRING) = '852' OR SAFE_CAST(masthead_code AS STRING) = 'TM') THEN 'The Mercury'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '5053' OR SAFE_CAST(gl_publication_code AS STRING) = '5253' OR SAFE_CAST(masthead_code AS STRING) = 'TC') THEN 'Toowoomba'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '475' OR SAFE_CAST(gl_publication_code AS STRING) = '490' OR SAFE_CAST(masthead_code AS STRING) = 'TB') THEN 'Townsville'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '305' OR SAFE_CAST(gl_publication_code AS STRING) = '307' OR SAFE_CAST(masthead_code AS STRING) = 'WT') THEN 'Weekly Times'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9001' OR SAFE_CAST(masthead_code AS STRING) = 'CS') THEN 'Code'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '8821' OR SAFE_CAST(gl_publication_code AS STRING) = 'Punters.com.au' OR SAFE_CAST(masthead_code AS STRING) = 'PU') THEN 'Punters'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '8822' OR SAFE_CAST(gl_publication_code AS STRING) = 'Racenet' OR SAFE_CAST(masthead_code AS STRING) = 'RN') THEN 'Racenet'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9653' OR SAFE_CAST(masthead_code AS STRING) = 'SC') THEN 'Supercoach Plus'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9600' OR SAFE_CAST(masthead_code AS STRING) = 'TS') THEN 'Taste Online'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9003' OR SAFE_CAST(masthead_code AS STRING) = 'AP') THEN 'Apple Podcast: Crime X'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '103' OR SAFE_CAST(classification_level_2_description AS STRING) = 'The Oz') THEN 'The Oz'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9000' OR SAFE_CAST(masthead_code AS STRING) = 'NW') THEN 'news.com.au'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '121') THEN 'Others'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9002' OR SAFE_CAST(masthead_code AS STRING) = 'BG') THEN 'Brain Games'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9504' OR SAFE_CAST(gl_publication_code AS STRING) = '9514' OR SAFE_CAST(gl_publication_code AS STRING) = '9556' OR SAFE_CAST(gl_publication_code AS STRING) = '9558' OR SAFE_CAST(gl_publication_code AS STRING) = '9560' OR SAFE_CAST(gl_publication_code AS STRING) = '9603' OR SAFE_CAST(gl_publication_code AS STRING) = '9623') THEN 'Others'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9644') THEN 'Suddenly'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = '9903') THEN 'News Corporate'
      WHEN (SAFE_CAST(gl_publication_code AS STRING) = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
      ELSE NULL
    END AS masthead_name_raw
  FROM intermediate_flags
),
categorized_data AS (
  SELECT
    *,
    CASE
      WHEN (masthead_name_raw = 'The Australian') THEN 'The Australian'
      WHEN (masthead_name_raw IN ('Courier Mail', 'Daily Telegraph', 'Herald Sun', 'The Advertiser')) THEN 'Metros'
      WHEN (masthead_name_raw IN ('Cairns Post', 'Geelong', 'Gold Coast', 'NT News', 'The Mercury', 'Toowoomba', 'Townsville')) THEN 'Regionals'
      WHEN (masthead_name_raw = 'Weekly Times') THEN 'Others'
      WHEN (masthead_name_raw IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Racenet', 'Punters', 'Others')) THEN 'Deep Niche Publications'
      ELSE 'Discontinued'
    END AS publication_group,
    CASE
      WHEN (SAFE_CAST(delivery_medium_type AS STRING) = 'Print') THEN 'Print Recognition'
      WHEN (is_subsnapfact_email_flag OR (is_standard_paid AND is_bundle)) THEN 'Print Recognition'
      ELSE 'Digital Recognition'
    END AS recognition_type
  FROM intermediate_masthead
)
SELECT
  SUM(CASE WHEN (SAFE_CAST(fy_year AS INT64) = 2025 AND SAFE_CAST(fy_week_of_year AS INT64) = 43) THEN (CASE WHEN (SAFE_CAST(fy_year AS INT64) <= 2024 AND SAFE_CAST(table_union_source AS STRING) = 'nfmanualhist') THEN SAFE_CAST(NFEarnedAmount AS BIGNUMERIC) WHEN (SAFE_CAST(fy_year AS INT64) > 2024 AND SAFE_CAST(table_union_source AS STRING) = 'subsnapfact') THEN SAFE_CAST(EarnedAmount AS BIGNUMERIC) ELSE NULL END) ELSE NULL END)
FROM categorized_data
WHERE
  publication_group != 'Discontinued'
  AND recognition_type = 'Digital Recognition'
  AND (publication_group NOT IN ('Deep Niche Publications') OR publication_group IS NULL)
LIMIT 1;",SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 43) THEN (CASE WHEN (t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount WHEN (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END) ELSE NULL END),measure,True,high,33,37641205-ec3e-4184-a5dd-f5ca79248335
current_fy_gross_revenue,gross_revenue,Current FY Gross Revenue,"The total gross revenue amount for the current financial year, specifically for 'VIDEO' and 'TUBI' revenue types.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = 0 THEN SAFE_CAST(t0.gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) AS Current_FY_Gross_Revenue FROM (
SELECT t0.Rev_Type AS clmn0_, t0.gross_revenue_amount, t0.relative_fy_year_offset FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI')",SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) = 0 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END),measure,True,high,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
previous_fy_gross_revenue,gross_revenue,Previous FY Gross Revenue,"The total gross revenue amount for the previous financial year, specifically for 'VIDEO' and 'TUBI' revenue types.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 THEN SAFE_CAST(t0.gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) AS Previous_FY_Gross_Revenue FROM (
SELECT t0.Rev_Type AS clmn0_, t0.gross_revenue_amount, t0.relative_fy_year_offset FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI')",SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) = -1 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END),measure,True,high,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
total_target,target,Total Target,The aggregated target amount for 'VIDEO' and 'TUBI' revenue types.,ncau-data-newsquery-prd,sbx_dcp,Progo_Streaming_Tgt,"SELECT SUM(SAFE_CAST(t0.Target AS BIGNUMERIC)) AS Total_Target FROM (
SELECT t0.Rev_Type AS clmn0_, t0.Target FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI')",SUM(SAFE_CAST(Target AS BIGNUMERIC)),measure,True,high,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
team_dimension,team,Team,The team associated with the revenue or target.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SAFE_CAST(t0.Team AS STRING) AS Team FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI') GROUP BY 1 ORDER BY 1 ASC LIMIT 10",Team,dimension,False,medium,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
advertiser_group_dimension,advertiser_group,Advertiser Group,"The group to which an advertiser belongs, filtered for 'VIDEO' and 'TUBI' revenue types and 'Target Only' teams.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SAFE_CAST(t0.advertiser_group AS STRING) AS Advertiser_Group FROM (
SELECT t0.Rev_Type AS clmn0_, t0.Target_team_flag AS clmn1_, t0.advertiser_group, t0.portfolio_parent_group_name_sync AS clmn3_ FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE (SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI') AND SAFE_CAST(t0.Target_team_flag AS STRING) = 'Target Only' AND SAFE_CAST(t0.portfolio_parent_group_name_sync AS STRING) IN ('TOWNSVILLE', 'TOOWOOMBA', 'THE WEEKLY TIMES', 'PRESTIGE NSW', 'INDEPENDENT AGENCIES VIC', 'INDEPENDENT AGENCIES SA', 'INDEPENDENT AGENCIES QLD BNE', 'INDEPENDENT AGENCIES NSW', 'HOBART', 'GEELONG', 'DIRECT VIC', 'DIRECT SA WA', 'DIRECT QLD', 'DIRECT NSW', 'DARWIN', 'CAIRNS')) GROUP BY 1 ORDER BY 1 ASC LIMIT 10",advertiser_group,dimension,False,medium,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
unified_publication_name_dimension,unified_publication_name,Unified Publication Name,"The unified publication name, filtered for 'VIDEO' and 'TUBI' revenue types, 'Target Only' teams, and specific portfolio parent groups.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SAFE_CAST(t0.unified_publication_name AS STRING) AS Unified_Publication_Name FROM (
SELECT t0.Rev_Type AS clmn0_, t0.Target_team_flag AS clmn1_, t0.portfolio_parent_group_name_sync AS clmn2_, t0.unified_publication_name FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE (SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI') AND SAFE_CAST(t0.Target_team_flag AS STRING) = 'Target Only' AND SAFE_CAST(t0.portfolio_parent_group_name_sync AS STRING) IN ('DIRECT VIC', 'DIRECT SA WA', 'DIRECT QLD', 'DIRECT NSW', 'DARWIN', 'CAIRNS')) GROUP BY 1 ORDER BY 1 ASC LIMIT 10",unified_publication_name,dimension,False,low,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
advertiser_parent_dimension,advertiser_parent,Advertiser Parent,"The parent company of an advertiser, filtered for 'VIDEO' and 'TUBI' revenue types and 'Target Only' teams.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SAFE_CAST(t0.advertiser_parent AS STRING) AS Advertiser_Parent FROM (
SELECT t0.Rev_Type AS clmn0_, t0.Target_team_flag AS clmn1_, t0.advertiser_parent FROM (
WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code,
      null AS sales_segment_gm_name_sync,
      null AS current_portfolio_group_owner_full_name_sync,
      null AS current_portfolio_conformed_owner_full_name_sync,
      null AS current_portfolio_group_owner_full,
      null AS current_portfolio_conformed_owner_full,
      null AS publisher_vertical,
      null AS data_load_datetime,
      null AS relative_day_offset,
      null AS sales_segment_gm_name,
      null AS nca_industry_pillar,
      null AS revenue_type,
      null AS revenue_group_subtype,
      null AS fin_adtype_name,
      null AS cost_model_type,
      null AS xtend_flag,
      null AS adsize_name,
      null AS pos_page_achieved,
      null AS account_number,
      null AS advertiser_name,
      null AS advertiser_group,
      null AS advertiser_parent,
      null AS crm_account_number,
      null AS agency_name,
      null AS agency_group,
      null AS agency_parent,
      null AS booking_number,
      null AS booking_name,
      null AS booking_line_number,
      null AS booking_line_created_date,
      null AS insertion_name,
      null AS sort_caption,
      null AS classification_name,
      null AS reporting_date,
      null AS portfolio_group_name_current,
      null AS portfolio_conformed_name_current,
      null AS portfolio_parent_group_name_current,
      null AS portfolio_group_name_sync,
      null AS portfolio_conformed_name_sync,
      null AS portfolio_parent_group_name_sync,
      null AS unified_publication_name,
      null AS employee_name,
      null AS financial_year,
      CASE Month_Num
        WHEN 1 THEN '1'
        WHEN 2 THEN '1'
        WHEN 3 THEN '1'
        WHEN 4 THEN '2'
        WHEN 5 THEN '2'
        WHEN 6 THEN '2'
        WHEN 7 THEN '3'
        WHEN 8 THEN '3'
        WHEN 9 THEN '3'
        WHEN 10 THEN '4'
        WHEN 11 THEN '4'
        WHEN 12 THEN '4'
      END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num
        WHEN 1 THEN 'Jul'
        WHEN 2 THEN 'Aug'
        WHEN 3 THEN 'Sep'
        WHEN 4 THEN 'Oct'
        WHEN 5 THEN 'Nov'
        WHEN 6 THEN 'Dec'
        WHEN 7 THEN 'Jan'
        WHEN 8 THEN 'Feb'
        WHEN 9 THEN 'Mar'
        WHEN 10 THEN 'Apr'
        WHEN 11 THEN 'May'
        WHEN 12 THEN 'Jun'
      END AS financial_short_month,
      null AS relative_fy_year_offset,
      null AS relative_fy_month_offset,
      null AS relative_cal_year_offset,
      null AS calendar_year,
      null AS calendar_week,
      null AS calendar_month,
      null AS calendar_month_short_name,
      null AS dow,
      null AS revenue_group_level_2_name,
      null AS publication_date,
      null AS revenue_category,
      null AS publishing_division_group,
      null AS adpoint_account_number,
      null AS FPE,
      null AS gross_revenue_amount,
      null AS gross_revenue_ex_adj_amount,
      null AS adjustment_amount,
      null AS col_cms_finance,
      null AS system_price_amount,
      null AS gross_less_agency_commission_amount,
      null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.*,
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
) AS t0 WHERE (SAFE_CAST(t0.Rev_Type AS STRING) IN ('VIDEO', 'TUBI') AND SAFE_CAST(t0.Target_team_flag AS STRING) = 'Target Only') GROUP BY 1 ORDER BY 1 ASC LIMIT 10",advertiser_parent,dimension,False,low,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
revenue_type_dimension,revenue_type,Revenue Type,"Categorization of revenue as 'VIDEO', 'TUBI', or 'OTHER' based on publication name and ad type.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SAFE_CAST(t0.Rev_Type AS STRING) AS Revenue_Type FROM (
SELECT
  *,
  CASE
    WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
    WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
    ELSE 'OTHER'
  END AS Rev_Type
FROM
  `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
) AS t0 GROUP BY 1 LIMIT 10","CASE WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI' WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO' ELSE 'OTHER' END",dimension,False,medium,34,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
gross_revenue_amount_digital_fy24_25_filtered,gross_revenue_amount,"Gross Revenue (Digital, FY24-25, Filtered)","Total gross revenue for digital campaigns in financial years 2024 and 2025, excluding specific ad types and publication names as defined in the dashboard's filters.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SUM(t0.gross_revenue_amount) AS gross_revenue_amount_digital_fy24_25_filtered FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.revenue_type = 'DIGITAL' AND SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025') AND t0.fin_adtype_name NOT IN ('Xtend', 'Unruly (Non-Targeted)', 'Taboola', 'SUDDENLY (Non-Targeted)', 'Finda', 'Events (Non-Targeted)', 'Edmedia', 'Display', 'Creatives', 'Classified', '-') AND t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly');",SUM(t0.gross_revenue_amount),measure,True,high,35,4114bd43-f752-4628-9b6c-1941b3c0d962
data_load_datetime_dimension,data_load_datetime,Data Load Datetime,"Timestamp indicating when the data was loaded into the system, used for data freshness and time-based filtering.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DATETIME_TRUNC(t0.data_load_datetime, SECOND) AS data_load_datetime FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 LIMIT 1;","DATETIME_TRUNC(t0.data_load_datetime, SECOND)",dimension,False,low,35,4114bd43-f752-4628-9b6c-1941b3c0d962
financial_year_dimension,financial_year,Financial Year,"The financial year associated with the revenue data, used for filtering and aggregation.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT t0.financial_year FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') GROUP BY t0.financial_year ORDER BY t0.financial_year ASC LIMIT 1;",t0.financial_year,dimension,False,medium,35,4114bd43-f752-4628-9b6c-1941b3c0d962
unified_publication_name_dimension,unified_publication_name,Unified Publication Name,"The name of the unified publication associated with the revenue, used for filtering and segmentation.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT t0.unified_publication_name FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') AND SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025') GROUP BY t0.unified_publication_name ORDER BY t0.unified_publication_name ASC LIMIT 1;",t0.unified_publication_name,dimension,False,medium,35,4114bd43-f752-4628-9b6c-1941b3c0d962
booking_number_dimension,booking_number,Booking Number,Unique identifier for a booking or campaign.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT t0.booking_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 LIMIT 1;,t0.booking_number,dimension,False,low,35,4114bd43-f752-4628-9b6c-1941b3c0d962
fin_adtype_name_dimension,fin_adtype_name,Financial Ad Type Name,"The name of the financial ad type, used for categorization and filtering.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT t0.fin_adtype_name FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 LIMIT 1;,t0.fin_adtype_name,dimension,False,medium,35,4114bd43-f752-4628-9b6c-1941b3c0d962
financial_month_dimension,financial_month,Financial Month,The financial month associated with the revenue data.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SAFE_CAST(t0.financial_month AS FLOAT64) AS financial_month FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 LIMIT 1;,SAFE_CAST(t0.financial_month AS FLOAT64),dimension,False,low,35,4114bd43-f752-4628-9b6c-1941b3c0d962
revenue_type_dimension,revenue_type,Revenue Type,"The type of revenue (e.g., 'DIGITAL'), used for filtering and categorization.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT t0.revenue_type FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 LIMIT 1;,t0.revenue_type,dimension,False,low,35,4114bd43-f752-4628-9b6c-1941b3c0d962
owner_full_contra_renee_sycamore,current_portfolio_conformed_owner_full,Current Portfolio Conformed Owner Full (Contra/Renee Sycamore),"Full name of the current portfolio owner, filtered for 'Contra' industry pillar and 'Renee Sycamore' sales segment GM.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT t0.current_portfolio_conformed_owner_full FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE (t0.nca_industry_pillar = 'Contra' AND t0.sales_segment_gm_name IN ('Renee Sycamore')) LIMIT 10;,current_portfolio_conformed_owner_full,dimension,False,low,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
total_gross_revenue_open_contra,gross_revenue_amount,Total Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, excluding specific filters.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(t0_base.gross_revenue_amount) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(gross_revenue_amount),aggregation,True,high,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
previous_fy_gross_revenue_open_contra,gross_revenue_amount,Previous FY Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for the previous financial year (relative_fy_year_offset = -1).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.relative_fy_year_offset = -1) THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (relative_fy_year_offset = -1) THEN gross_revenue_amount ELSE 0 END),aggregation,False,medium,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
older_fy_gross_revenue_open_contra,gross_revenue_amount,Older FY Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for financial years older than the previous one (relative_fy_year_offset < -1).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.relative_fy_year_offset < -1) THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (relative_fy_year_offset < -1) THEN gross_revenue_amount ELSE 0 END),aggregation,False,low,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
current_fy_gross_revenue_open_contra,gross_revenue_amount,Current FY Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for the current financial year (relative_fy_year_offset = 0).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.relative_fy_year_offset = 0) THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (relative_fy_year_offset = 0) THEN gross_revenue_amount ELSE 0 END),aggregation,True,high,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
future_fy_gross_revenue_open_contra,gross_revenue_amount,Future FY Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for future financial years (relative_fy_year_offset > 0).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.relative_fy_year_offset > 0) THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (relative_fy_year_offset > 0) THEN gross_revenue_amount ELSE 0 END),aggregation,False,medium,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
past_fy_gross_revenue_open_contra,gross_revenue_amount,Past FY Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for all past financial years (relative_fy_year_offset < 0).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.relative_fy_year_offset < 0) THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (relative_fy_year_offset < 0) THEN gross_revenue_amount ELSE 0 END),aggregation,False,medium,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
digital_gross_revenue_open_contra,gross_revenue_amount,Digital Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for 'Digital' revenue type.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.revenue_type = 'Digital') THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (revenue_type = 'Digital') THEN gross_revenue_amount ELSE 0 END),aggregation,True,high,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
print_gross_revenue_open_contra,gross_revenue_amount,Print Gross Revenue (Open Contra Accounts),"Sum of gross revenue for 'Contra' related accounts with 'Open' status, specifically for 'Print' revenue type.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN (t0_base.revenue_type = 'Print') THEN t0_base.gross_revenue_amount ELSE 0 END) FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open');",SUM(CASE WHEN (revenue_type = 'Print') THEN gross_revenue_amount ELSE 0 END),aggregation,True,high,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
adpoint_account_number_transformed_open_contra,adpoint_account_number,"Adpoint Account Number (Transformed, Open Contra Accounts)","Adpoint account number, transformed to 'ctr1' for specific accounts, filtered for 'Contra' related accounts with 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT DISTINCT
  CASE WHEN (t0_base.adpoint_account_number IN ('13019', '52246', '18387')) THEN 'ctr1' ELSE t0_base.adpoint_account_number END
FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open') LIMIT 10;","CASE WHEN (adpoint_account_number IN ('13019', '52246', '18387')) THEN 'ctr1' ELSE adpoint_account_number END",dimension,False,medium,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
advertiser_name_transformed_open_contra,advertiser_name,"Advertiser Name (Transformed, Open Contra Accounts)","Advertiser name, transformed for 'ctr1' accounts, filtered for 'Contra' related accounts with 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT DISTINCT
  CASE WHEN (CASE WHEN (t0_base.adpoint_account_number IN ('13019', '52246', '18387')) THEN 'ctr1' ELSE t0_base.adpoint_account_number END = 'ctr1') THEN 'CTR_2023_AFL Sports CTR_2023_Sydney Swans CTR_2023_GWS Giants' ELSE t0_base.advertiser_name END
FROM (
  SELECT
    financial_year,
    CAST(financial_month AS int) AS financial_month_no,
    financial_short_month,
    calendar_year_month,
    sales_segment_gm_name,
    portfolio_conformed_name_current,
    portfolio_parent_group_name_current,
    IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
    advertiser_name,
    adpoint_account_number,
    revenue_type,
    relative_fy_year_offset,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE Status = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl,
    sum(gross_revenue_amount) AS gross_revenue_amount
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(`left`(advertiser_name, 3)) = 'ctr' AND adpoint_account_number != '20696' AND (NOT(cost_model_type = 'Guaranteed' AND revenue_group_name = 'Exchange')) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (account_number IN ('17114', '29172', '52809') OR adtype_name = '-')))
  GROUP BY ALL
) AS t0_base
WHERE t0_base.status_asl IN ('Open') LIMIT 10;","CASE WHEN (CASE WHEN (adpoint_account_number IN ('13019', '52246', '18387')) THEN 'ctr1' ELSE adpoint_account_number END = 'ctr1') THEN 'CTR_2023_AFL Sports CTR_2023_Sydney Swans CTR_2023_GWS Giants' ELSE advertiser_name END",dimension,False,medium,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
record_count_filtered_advertisers,record_count,Record Count (Filtered Advertisers),"Count of records grouped by account and adpoint number, filtered by specific 'CTR' advertiser names.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT COUNT(1) FROM (
SELECT t0.account_number AS clmn0_, t0.adpoint_account_number AS clmn1_, t0.advertiser_name AS clmn2_ FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
) WHERE clmn2_ IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia') LIMIT 1;",COUNT(1),aggregation,False,low,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
account_number_filtered_advertisers,account_number,Account Number (Filtered Advertisers),Account numbers associated with specific 'CTR' advertiser names.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DISTINCT t0.account_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.advertiser_name IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia') LIMIT 10;",account_number,dimension,False,low,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
adpoint_account_number_filtered_advertisers,adpoint_account_number,Adpoint Account Number (Filtered Advertisers),Adpoint account numbers associated with specific 'CTR' advertiser names.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DISTINCT t0.adpoint_account_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.advertiser_name IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia') LIMIT 10;",adpoint_account_number,dimension,False,low,36,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
unearned_revenue_record_count_filtered_by_rate_plan,unearned_revenue_record_count,Unearned Revenue Record Count (Filtered by Rate Plan),"Count of unearned revenue records for a specific rate plan and date range, where GST exclusive revenue is positive.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,"SELECT COUNT(1) AS unearned_revenue_record_count_filtered_by_rate_plan FROM (WITH core AS (SELECT *, greatest(allocation_start_date, date('2025-02-10')) AS week_prorata_allocation_start, least(allocation_end_date, date('2025-02-16')) AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` WHERE '2025-02-16' BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN '2025-02-10' AND '2025-02-16') OR (allocation_end_date BETWEEN '2025-02-10' AND '2025-02-16')), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, earned_rev_dollars, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT core_2.rate_plan_code, core_2.should_be_allocated_to_revenue_gst_exclusive, core_2.week_prorata_allocation_end, core_2.week_prorata_allocation_start FROM core_2) AS t0 WHERE (t0.week_prorata_allocation_start = DATE '2025-02-10' AND t0.week_prorata_allocation_end = DATE '2025-02-16' AND t0.should_be_allocated_to_revenue_gst_exclusive > 0.000000 AND t0.rate_plan_code IN ('TA_PB_WKNCON19M12'))",COUNT(1),measure,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_gst_exclusive_calculated,unearned_revenue_gst_exclusive,Unearned Revenue (GST Exclusive),"The portion of payment base amount allocated to revenue for the prorated week, excluding GST.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,"SELECT ((date_diff(least(t0.allocation_end_date, DATE '2025-02-16'), greatest(t0.allocation_start_date, DATE '2025-02-10'), day) + 1) / t0.installment_allocation_days * t0.payment_base_amount) / 1.1 AS unearned_revenue_gst_exclusive FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` AS t0 WHERE '2025-02-16' BETWEEN t0.allocation_start_date AND t0.allocation_end_date OR (t0.allocation_start_date BETWEEN '2025-02-10' AND '2025-02-16') OR (t0.allocation_end_date BETWEEN '2025-02-10' AND '2025-02-16') LIMIT 1","((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1",calculated_field,True,high,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_gst_inclusive_calculated,unearned_revenue_gst_inclusive,Unearned Revenue (GST Inclusive),"The portion of payment base amount allocated to revenue for the prorated week, including GST.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,"SELECT (date_diff(least(t0.allocation_end_date, DATE '2025-02-16'), greatest(t0.allocation_start_date, DATE '2025-02-10'), day) + 1) / t0.installment_allocation_days * t0.payment_base_amount AS unearned_revenue_gst_inclusive FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` AS t0 WHERE '2025-02-16' BETWEEN t0.allocation_start_date AND t0.allocation_end_date OR (t0.allocation_start_date BETWEEN '2025-02-10' AND '2025-02-16') OR (t0.allocation_end_date BETWEEN '2025-02-10' AND '2025-02-16') LIMIT 1","(date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount",calculated_field,True,high,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_record_count_by_masthead,unearned_revenue_record_count,Unearned Revenue Record Count (by Masthead),Count of unearned revenue records grouped by masthead for a dynamic date range.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,"SELECT COUNT(1) AS unearned_revenue_record_count_by_masthead FROM (SELECT t0.masthead AS clmn0_ FROM (WITH core AS (SELECT *, greatest(allocation_start_date, PARSE_DATE(""%Y%m%d"", @DS_START_DATE)) AS week_prorata_allocation_start, least(allocation_end_date, PARSE_DATE(""%Y%m%d"", @DS_END_DATE)) AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` WHERE PARSE_DATE(""%Y%m%d"", @DS_START_DATE) BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE)) OR (allocation_end_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE))), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT * FROM core_2) AS t0)",COUNT(1),measure,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_record_count_by_masthead_filtered_by_order_id,unearned_revenue_record_count,"Unearned Revenue Record Count (by Masthead, Filtered by Order ID)",Count of unearned revenue records grouped by masthead for a specific order ID and date range.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_Jun25,"SELECT COUNT(1) AS unearned_revenue_record_count_by_masthead_filtered_by_order_id FROM (SELECT t0.masthead AS clmn0_, t0.subscription_order_id_src AS clmn1_ FROM (WITH core AS (SELECT *, greatest(allocation_start_date, date('2025-06-09')) AS week_prorata_allocation_start, least(allocation_end_date, date('2025-06-15')) AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25` WHERE '2025-06-09' BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN '2025-06-09' AND '2025-06-15') OR (allocation_end_date BETWEEN '2025-06-09' AND '2025-06-15')), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT * FROM core_2) AS t0) WHERE t0.subscription_order_id_src = 961289025",COUNT(1),measure,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
total_unearned_revenue_gst_exclusive,unearned_revenue_gst_exclusive,Total Unearned Revenue (GST Exclusive),The sum of unearned revenue (GST exclusive) for the specified date range.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_Jun25,"SELECT SUM(((date_diff(least(t0.allocation_end_date, DATE '2025-06-15'), greatest(t0.allocation_start_date, DATE '2025-06-09'), day) + 1) / t0.installment_allocation_days * t0.payment_base_amount) / 1.1) AS total_unearned_revenue_gst_exclusive FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25` AS t0 WHERE '2025-06-09' BETWEEN t0.allocation_start_date AND t0.allocation_end_date OR (t0.allocation_start_date BETWEEN '2025-06-09' AND '2025-06-15') OR (t0.allocation_end_date BETWEEN '2025-06-09' AND '2025-06-15')","SUM(((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1)",aggregation,True,high,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
total_unearned_revenue_gst_exclusive_rounded,unearned_revenue_gst_exclusive,"Total Unearned Revenue (GST Exclusive, Rounded)","The sum of unearned revenue (GST exclusive), rounded to 2 decimal places, for a dynamic date range, grouped by various dimensions.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,"SELECT SUM(round(((date_diff(least(t0.allocation_end_date, PARSE_DATE(""%Y%m%d"", @DS_END_DATE)), greatest(t0.allocation_start_date, PARSE_DATE(""%Y%m%d"", @DS_START_DATE)), day) + 1) / t0.installment_allocation_days * t0.payment_base_amount) / 1.1, 2)) AS total_unearned_revenue_gst_exclusive_rounded FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` AS t0 WHERE PARSE_DATE(""%Y%m%d"", @DS_START_DATE) BETWEEN t0.allocation_start_date AND t0.allocation_end_date OR (t0.allocation_start_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE)) OR (t0.allocation_end_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE))","SUM(round(((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1, 2))",aggregation,True,high,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
total_payment_base_amount_latest_attempt,total_payment_base_amount,Total Payment Base Amount (Latest Attempt),"The sum of payment base amounts for records marked as the latest attempt, grouped by various subscription and payment details.",ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,"SELECT SUM(t0.payment_base_amount) AS total_payment_base_amount_latest_attempt FROM (WITH contracts_in_scope_active_and_cancelled AS (SELECT DISTINCT dw_subscription_id, dw_rate_plan_id, term_period_name, 'active' AS subscription_status, date(null) AS cancellation_date, masthead, rate_plan_code, offer_category_name, offer_category_group_name FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base` WHERE offer_category_group_name = 'Contract' AND lower(offer_category_name) NOT LIKE '%upfront%' AND subscription_status_code = 'active' UNION ALL SELECT DISTINCT dw_subscription_id, dw_rate_plan_id, term_period_name, 'cancelled' AS subscription_status, report_date AS cancellation_date, masthead, rate_plan_code, offer_category_name, offer_category_group_name FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` WHERE offer_category_group_name = 'Contract' AND lower(offer_category_name) NOT LIKE '%upfront%' AND subscription_movement_count_type = 'cancellation' AND report_date > '2022-07-01'), contracts_in_scope_active_cancelled_inactivenotcancelled AS (SELECT * FROM contracts_in_scope_active_and_cancelled UNION ALL SELECT DISTINCT dw_subscription_id, dw_rate_plan_id, term_period_name, 'inactive not cancelled - contract in the past' AS subscription_status, date(null) AS cancellation_date, masthead, rate_plan_code, offer_category_name, offer_category_group_name FROM (SELECT *, row_number() OVER (PARTITION BY dw_subscription_id, dw_rate_plan_id ORDER BY date(dw_effective_start_datetime) DESC) AS xrank FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base`) WHERE offer_category_group_name = 'Contract' AND lower(offer_category_name) NOT LIKE '%upfront%' AND dw_subscription_id NOT IN (SELECT DISTINCT dw_subscription_id FROM contracts_in_scope_active_and_cancelled) AND xrank = 1) SELECT a.*, b.subscription_status FROM `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` AS a JOIN contracts_in_scope_active_cancelled_inactivenotcancelled AS b ON a.dw_subscription_id = b.dw_subscription_id AND a.dw_rate_plan_id = b.dw_rate_plan_id) AS t0 WHERE t0.latest_attempt_flag = 'Y'",SUM(payment_base_amount),aggregation,True,high,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
masthead,masthead,Masthead,The masthead associated with the subscription or transaction.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT masthead FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,masthead,dimension,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
rate_plan_code,rate_plan_code,Rate Plan Code,The code identifying the specific rate plan for a subscription.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,SELECT rate_plan_code FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` LIMIT 1,rate_plan_code,dimension,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
subscription_order_id,subscription_order_id,Subscription Order ID,The source ID for the subscription order.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_Jun25,SELECT subscription_order_id_src FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25` LIMIT 1,subscription_order_id_src,dimension,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
prorata_allocation_start_date,prorata_allocation_start_date,Prorata Allocation Start Date,"The calculated start date for prorated revenue allocation, considering the dashboard's date range.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,"SELECT greatest(allocation_start_date, date('2025-02-10')) AS week_prorata_allocation_start FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` LIMIT 1","greatest(allocation_start_date, [dashboard_start_date])",dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
prorata_allocation_end_date,prorata_allocation_end_date,Prorata Allocation End Date,"The calculated end date for prorated revenue allocation, considering the dashboard's date range.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,"SELECT least(allocation_end_date, date('2025-02-16')) AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` LIMIT 1","least(allocation_end_date, [dashboard_end_date])",dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
allocation_start_date,allocation_start_date,Allocation Start Date,The original start date for revenue allocation.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT allocation_start_date FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,allocation_start_date,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
allocation_end_date,allocation_end_date,Allocation End Date,The original end date for revenue allocation.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT allocation_end_date FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,allocation_end_date,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
installment_allocation_days,installment_allocation_days,Installment Allocation Days,The total number of days over which an installment is allocated.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT installment_allocation_days FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,installment_allocation_days,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
payment_base_amount,payment_base_amount,Payment Base Amount,The base amount of a payment before any allocations or deductions.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT payment_base_amount FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,payment_base_amount,dimension,False,medium,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
subscriber_id,subscriber_id,Subscriber ID,The source ID for the subscriber.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT subscriber_id_src FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,subscriber_id_src,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
subscription_id,subscription_id,Subscription ID,The source ID for the subscription.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT subscription_id_src FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,subscription_id_src,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
transaction_date,transaction_date,Transaction Date,The date of the transaction.,ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,SELECT tran_date FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` LIMIT 1,tran_date,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
creation_date,creation_date,Creation Date,The creation date of the payment record.,ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,SELECT creation_date FROM `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` LIMIT 1,creation_date,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
latest_attempt_flag,latest_attempt_flag,Latest Attempt Flag,A flag indicating if the payment record is the latest attempt ('Y' or 'N').,ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,SELECT latest_attempt_flag FROM `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` LIMIT 1,latest_attempt_flag,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
offer_category_group_name,offer_category_group_name,Offer Category Group Name,"The group name for the offer category (e.g., 'Contract').",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base,SELECT offer_category_group_name FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base` LIMIT 1,offer_category_group_name,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
offer_category_name,offer_category_name,Offer Category Name,The specific name for the offer category.,ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base,SELECT offer_category_name FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base` LIMIT 1,offer_category_name,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
payment_sequence,payment_sequence,Payment Sequence,The sequence number of the payment.,ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,SELECT payment_seq FROM `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` LIMIT 1,payment_seq,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
payment_sequence_status_description,payment_sequence_status_description,Payment Sequence Status Description,The derived description of the payment sequence status.,ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,SELECT payment_seq_status_desc_derived FROM `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` LIMIT 1,payment_seq_status_desc_derived,dimension,False,low,37,be4575e4-3850-46e2-9ba9-73a4393c5d2a
no_time_volume_sc_filtered,no_time_volume,No Time Volume (SuperCoach Plus),"The sum of 'No Time Volume' for the 'SuperCoach Plus' masthead, representing sales or subscriptions without a specified time period.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(No_Time_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(No_Time_Volume),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
failed_payment_volume_sc_filtered,failed_payment_volume,Failed Payment Volume (SuperCoach Plus),"The sum of 'Failed Payment Volume' for the 'SuperCoach Plus' masthead, indicating the total volume of payments that failed.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Failed_Payment_Volume),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
price_volume_sc_filtered,price_volume,Price Volume (SuperCoach Plus),"The sum of 'Price Volume' for the 'SuperCoach Plus' masthead, likely related to the total volume of transactions at a specific price point.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Price_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Price_Volume),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
total_cancels_sc_filtered,total_cancels,Total Cancels (SuperCoach Plus),"The sum of 'Total Cancels' for the 'SuperCoach Plus' masthead, representing the total number of cancellations.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Total_Cancels),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
fy_year_count_sc_filtered,fy_year_count,Count of FY Year (SuperCoach Plus),The count of 'fy_year' records for the 'SuperCoach Plus' masthead. This might be used to count rows per year or distinct years.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT COUNT(fy_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',COUNT(fy_year),measure,False,low,38,61cc5171-703d-44b5-acd7-e9db7cf81778
fy_year_sum_sc_filtered,fy_year_sum,Sum of FY Year (SuperCoach Plus),"The sum of 'fy_year' values for the 'SuperCoach Plus' masthead. This is an unusual metric, possibly used for internal calculations or debugging.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(fy_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(fy_year),measure,False,low,38,61cc5171-703d-44b5-acd7-e9db7cf81778
fy_week_of_year_count_sc_filtered,fy_week_of_year_count,Count of FY Week of Year (SuperCoach Plus),The count of 'fy_week_of_year' records for the 'SuperCoach Plus' masthead. This might be used to count rows per week or distinct weeks.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT COUNT(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',COUNT(fy_week_of_year),measure,False,low,38,61cc5171-703d-44b5-acd7-e9db7cf81778
fy_week_of_year_sum_sc_filtered,fy_week_of_year_sum,Sum of FY Week of Year (SuperCoach Plus),"The sum of 'fy_week_of_year' values for the 'SuperCoach Plus' masthead. This is an unusual metric, possibly used for internal calculations or debugging.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(fy_week_of_year),measure,False,low,38,61cc5171-703d-44b5-acd7-e9db7cf81778
revenue_3rd_party_gpla_sc_filtered,revenue_3rd_party_gpla,Revenue 3rd Party GPLA (SuperCoach Plus),"The sum of 'Revenue 3rd Party GPLA' for the 'SuperCoach Plus' masthead, representing revenue from third-party sources via Google Play.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Revenue_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Revenue_3rd_Party_GPLA),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
total_revenue_sc_filtered,total_revenue,Total Revenue (SuperCoach Plus),"The sum of 'Total Revenue' for the 'SuperCoach Plus' masthead, representing the overall revenue generated.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Revenue) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Total_Revenue),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
closing_base_3rd_party_sc_filtered,closing_base_3rd_party,Closing Base 3rd Party (SuperCoach Plus),"The sum of 'Closing Base 3rd Party' for the 'SuperCoach Plus' masthead, indicating the closing customer base from third-party acquisitions.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Closing_Base_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Closing_Base_3rd_Party),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
closing_base_3rd_party_apls_sc_filtered,closing_base_3rd_party_apls,Closing Base 3rd Party APLS (SuperCoach Plus),"The sum of 'Closing Base 3rd Party APLS' for the 'SuperCoach Plus' masthead, indicating the closing customer base from third-party Apple acquisitions.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Closing_Base_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Closing_Base_3rd_Party_APLS),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
closing_base_3rd_party_gpla_sc_filtered,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA (SuperCoach Plus),"The sum of 'Closing Base 3rd Party GPLA' for the 'SuperCoach Plus' masthead, indicating the closing customer base from third-party Google Play acquisitions.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Closing_Base_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Closing_Base_3rd_Party_GPLA),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
total_closing_base_sc_filtered,total_closing_base,Total Closing Base (SuperCoach Plus),"The sum of 'Total Closing Base' for the 'SuperCoach Plus' masthead, representing the overall closing customer base.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Closing_Base) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Total_Closing_Base),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_incl_3rd_party_sc_filtered,net_growth_incl_3rd_party,Net Growth Incl 3rd Party (SuperCoach Plus),"The sum of 'Net Growth incl 3rd Party' for the 'SuperCoach Plus' masthead, representing net customer growth including third-party sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_incl_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Net_Growth_incl_3rd_Party),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_3rd_party_sc_filtered,net_growth_3rd_party,Net Growth 3rd Party (SuperCoach Plus),"The sum of 'Net Growth 3rd Party' for the 'SuperCoach Plus' masthead, representing net customer growth from third-party sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Net_Growth_3rd_Party),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_3rd_party_apls_sc_filtered,net_growth_3rd_party_apls,Net Growth 3rd Party APLS (SuperCoach Plus),"The sum of 'Net Growth 3rd Party APLS' for the 'SuperCoach Plus' masthead, representing net customer growth from third-party Apple sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Net_Growth_3rd_Party_APLS),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_3rd_party_gpla_sc_filtered,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA (SuperCoach Plus),"The sum of 'Net Growth 3rd Party GPLA' for the 'SuperCoach Plus' masthead, representing net customer growth from third-party Google Play sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Net_Growth_3rd_Party_GPLA),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
breach_sales_sc_filtered,breach_sales,Breach Sales (SuperCoach Plus),"The sum of 'Breach Sales' for the 'SuperCoach Plus' masthead, indicating sales related to breaches or specific conditions.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Breach_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Breach_Sales),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
always_on_digital_sales_sc_filtered,always_on_digital_sales,Always On Digital Sales (SuperCoach Plus),"The sum of 'Always on Digital Sales' for the 'SuperCoach Plus' masthead, representing continuous digital sales.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Always_on_Digital_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Always_on_Digital_Sales),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
general_offer_sales_sc_filtered,general_offer_sales,General Offer Sales (SuperCoach Plus),"The sum of 'General Offer Sales' for the 'SuperCoach Plus' masthead, representing sales from general offers.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(General_Offer_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(General_Offer_Sales),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
other_sales_sc_filtered,other_sales,Other Sales (SuperCoach Plus),"The sum of 'Other Sales' for the 'SuperCoach Plus' masthead, representing sales from miscellaneous sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Other_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Other_Sales),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
acquisition_3rd_party_sc_filtered,acquisition_3rd_party,Acquisition 3rd Party (SuperCoach Plus),"The sum of 'Acquisition 3rd Party' for the 'SuperCoach Plus' masthead, representing customer acquisitions from third-party channels.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Acquisition_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Acquisition_3rd_Party),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
acquisition_3rd_party_apls_sc_filtered,acquisition_3rd_party_apls,Acquisition 3rd Party APLS (SuperCoach Plus),"The sum of 'Acquisition 3rd Party APLS' for the 'SuperCoach Plus' masthead, representing customer acquisitions from third-party Apple sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Acquisition_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Acquisition_3rd_Party_APLS),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
acquisition_3rd_party_gpla_sc_filtered,acquisition_3rd_party_gpla,Acquisition 3rd Party GPLA (SuperCoach Plus),"The sum of 'Acquisition 3rd Party GPLA' for the 'SuperCoach Plus' masthead, representing customer acquisitions from third-party Google Play sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Acquisition_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Acquisition_3rd_Party_GPLA),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
total_weekly_sales_sc_filtered,total_weekly_sales,Total Weekly Sales (SuperCoach Plus),"The sum of 'Total Weekly Sales' for the 'SuperCoach Plus' masthead, representing the total sales volume on a weekly basis.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Weekly_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Total_Weekly_Sales),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
switches_sc_filtered,switches,Switches (SuperCoach Plus),"The sum of 'Switches' for the 'SuperCoach Plus' masthead, representing customer movements between products or plans.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Switches) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Switches),measure,True,medium,38,61cc5171-703d-44b5-acd7-e9db7cf81778
net_cancels_sc_filtered,net_cancels,Net Cancels (SuperCoach Plus),"The sum of 'Net Cancels' for the 'SuperCoach Plus' masthead, representing the net number of cancellations (cancellations minus reactivations/saves).",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Net_Cancels),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
revenue_3rd_party_sc_filtered,revenue_3rd_party,Revenue 3rd Party (SuperCoach Plus),"The sum of 'Revenue 3rd Party' for the 'SuperCoach Plus' masthead, representing total revenue from third-party sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Revenue_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Revenue_3rd_Party),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
revenue_3rd_party_apls_sc_filtered,revenue_3rd_party_apls,Revenue 3rd Party APLS (SuperCoach Plus),"The sum of 'Revenue 3rd Party APLS' for the 'SuperCoach Plus' masthead, representing revenue from third-party Apple sources.",ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Revenue_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',SUM(Revenue_3rd_Party_APLS),measure,True,high,38,61cc5171-703d-44b5-acd7-e9db7cf81778
gross_revenue_amount_total,gross_revenue_amount_total,Total Gross Revenue,"The sum of all gross revenue amounts without specific filters, representing the overall revenue generated.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
    SUM(t0.gross_revenue_amount) AS total_gross_revenue
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1000",SUM(t0.gross_revenue_amount),measure,True,high,39,f502f44a-e283-405f-ab8f-6a641edb4194
gross_revenue_travel_services_fy25,gross_revenue_amount_total,Gross Revenue - Travel Services (FY25),The total gross revenue specifically for the 'Travel Services' industry pillar in Financial Year 2025.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
    SUM(t0.gross_revenue_amount) AS gross_revenue_travel_services_fy25
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE
    SAFE_CAST(t0.financial_year AS STRING) = '2025'
    AND t0.nca_industry_pillar = 'Travel Services'
LIMIT 1000",SUM(t0.gross_revenue_amount),measure,True,high,39,f502f44a-e283-405f-ab8f-6a641edb4194
gross_digital_revenue_fy24_filtered,gross_revenue_amount_total,"Gross Digital Revenue (FY24, Filtered)","The total gross revenue from 'DIGITAL' revenue types for Financial Year 2024, excluding specific ad types and publication names.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
    SUM(t0.gross_revenue_amount) AS gross_digital_revenue_fy24_filtered
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE
    t0.revenue_type = 'DIGITAL'
    AND SAFE_CAST(t0.financial_year AS STRING) = '2024'
    AND t0.fin_adtype_name NOT IN ('Xtend', 'Unruly (Non-Targeted)', 'Taboola', 'SUDDENLY (Non-Targeted)', 'Finda', 'Events (Non-Targeted)', 'Edmedia', 'Display', 'Creatives', 'Classified', '-')
    AND t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly')
LIMIT 1000",SUM(t0.gross_revenue_amount),measure,True,high,39,f502f44a-e283-405f-ab8f-6a641edb4194
data_load_datetime_fy24_25,data_load_datetime,Data Load Datetime (FY24-25),"The truncated data load datetime values available for Financial Years 2024 and 2025, typically used for data freshness checks or dashboard filtering.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
    DATETIME_TRUNC(t0.data_load_datetime, SECOND) AS data_load_datetime_truncated
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE
    SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025')
GROUP BY
    data_load_datetime_truncated
ORDER BY
    data_load_datetime_truncated DESC
LIMIT 1000","DATETIME_TRUNC(t0.data_load_datetime, SECOND)",dimension,False,low,39,f502f44a-e283-405f-ab8f-6a641edb4194
data_load_datetime_fy26,data_load_datetime,Data Load Datetime (FY26),"The truncated data load datetime values available for Financial Year 2026, typically used for data freshness checks or dashboard filtering.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
    DATETIME_TRUNC(t0.data_load_datetime, SECOND) AS data_load_datetime_truncated
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE
    SAFE_CAST(t0.financial_year AS STRING) IN ('2026')
GROUP BY
    data_load_datetime_truncated
ORDER BY
    data_load_datetime_truncated DESC
LIMIT 1000","DATETIME_TRUNC(t0.data_load_datetime, SECOND)",dimension,False,low,39,f502f44a-e283-405f-ab8f-6a641edb4194
unified_publication_name_fy24_25_filtered,unified_publication_name,"Unified Publication Name (FY24-25, Filtered)","Distinct unified publication names for Financial Years 2024 and 2025, excluding a predefined list of administrative or irrelevant entries. Used for filtering reports.",ncau-data-newsquery-prd,asl_finance_derived_archive,details_dashboard_archive_FY25_T,"SELECT
    t0.unified_publication_name AS unified_publication_name
FROM
    `ncau-data-newsquery-prd.asl_finance_derived_archive.details_dashboard_archive_FY25_T` AS t0
WHERE
    t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly')
    AND SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025')
GROUP BY
    unified_publication_name
ORDER BY
    unified_publication_name ASC
LIMIT 1000",t0.unified_publication_name,dimension,False,medium,39,f502f44a-e283-405f-ab8f-6a641edb4194
fin_adtype_name_fy24_25,fin_adtype_name,Financial Ad Type Name (FY24-25),Distinct financial ad type names for Financial Years 2024 and 2025. Used for filtering and categorizing revenue.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
    t0.fin_adtype_name AS fin_adtype_name
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE
    SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025')
GROUP BY
    fin_adtype_name
ORDER BY
    fin_adtype_name DESC
LIMIT 1000",t0.fin_adtype_name,dimension,False,medium,39,f502f44a-e283-405f-ab8f-6a641edb4194
add_volume,add_volume,Added Volume,The volume of new subscriptions or additions recorded.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.add_volume FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.add_volume,measure,false,medium,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
category_name,category_name,Category Name,The name of the category associated with the subscription.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.category_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.category_name,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
closing_base,closing_base,Closing Base,The total number of subscriptions or base at the end of a period.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.closing_base FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.closing_base,measure,true,high,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
earned_amount,earned_amount,Earned Amount,The revenue or amount earned from subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.earned_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.earned_amount,measure,true,high,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
fiscal_week_id,fiscal_week_id,Fiscal Week ID,"The identifier for the fiscal week (e.g., YYYYWW).",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.fiscal_week_id FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.fiscal_week_id,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
gl_publication_code,gl_publication_code,GL Publication Code,The General Ledger publication code.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.gl_publication_code FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.gl_publication_code,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
opening_base,opening_base,Opening Base,The total number of subscriptions or base at the beginning of a period.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.opening_base FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.opening_base,measure,false,medium,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
red_volume,red_volume,Reduced Volume,The volume of reduced subscriptions or churn.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.red_volume FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.red_volume,measure,false,medium,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
transfer_in,transfer_in,Transfer In,The volume of subscriptions transferred into this category/unit.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.transfer_in FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.transfer_in,measure,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
transfer_out,transfer_out,Transfer Out,The volume of subscriptions transferred out of this category/unit.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT t0.transfer_out FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0 WHERE t0.fiscal_week_id IN (202535) LIMIT 1,t0.transfer_out,measure,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_code,business_unit_code,Business Unit Code,Unique identifier for a business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.business_unit_code FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.business_unit_code,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_name,business_unit_name,Business Unit Name,The name of the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.business_unit_name FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.business_unit_name,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_status,business_unit_status,Business Unit Status,The current operational status of the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.business_unit_status FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.business_unit_status,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_type_code,business_unit_type_code,Business Unit Type Code,The code indicating the type of business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.business_unit_type_code FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.business_unit_type_code,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
company_number,company_number,Company Number,The company number associated with the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.company_number FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.company_number,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
department,department,Department,The department name associated with the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.department FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.department,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
legacy_reporting_group,legacy_reporting_group,Legacy Reporting Group,The legacy reporting group for the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.legacy_reporting_group FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.legacy_reporting_group,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
publication_group,publication_group,Publication Group,The group to which the publication belongs.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.publication_group FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.publication_group,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
publication_number,publication_number,Publication Number,The unique number identifying a publication.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.publication_number FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.publication_number,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
reporting_group,reporting_group,Reporting Group,The reporting group for the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT t0.reporting_group FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,t0.reporting_group,dimension,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
record_count,record_count,Record Count,A count of records in the business unit dimension table.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT COUNT(1) FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim` AS t0 LIMIT 1,COUNT(1),aggregation,false,low,40,23c8b213-a9f0-4158-b8fa-bff14425abb5
unique_standard_paid_subscribers_by_gateway,unique_subscribers_latest_attempt,Unique Standard Paid Subscribers by Payment Gateway,"Counts the number of unique subscribers with 'Standard Paid' subscriptions, grouped by the payment gateway used for their latest payment attempt within the last 60 days.",ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,"WITH base_subquery_cte AS (
  SELECT
    t0.payment_gateway AS clmn0_,
    t0.subscriber_id_src AS clmn1_,
    t0.subscription_classification_type AS clmn2_
  FROM (
    WITH driver AS (
      SELECT
        subscriber_id_src,
        subscription_id_src,
        max(tran_date) AS latest_tran_date
      FROM
        `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans`
      WHERE
        tran_date BETWEEN `current_date`() - 60 AND `current_date`()
      GROUP BY 1, 2
    )
    SELECT
      b.*
    FROM
      driver AS a
      JOIN
      `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` AS b
      ON a.subscriber_id_src = b.subscriber_id_src AND a.subscription_id_src = b.subscription_id_src AND a.latest_tran_date = b.tran_date
    WHERE
      b.latest_attempt_flag = 'Y'
  ) AS t0
)
SELECT
  clmn0_ AS payment_gateway,
  COUNT(DISTINCT clmn1_) AS unique_subscribers
FROM
  base_subquery_cte
WHERE
  clmn2_ IN ('Standard Paid')
GROUP BY
  clmn0_
LIMIT 10;",COUNT(DISTINCT clmn1_),measure,True,high,41,da5dcd47-2e80-45e8-94b8-5b71d81182f5
unique_standard_paid_subscribers_other_gateways,unique_subscribers_latest_attempt,Unique Standard Paid Subscribers (Other Gateways),"Counts the number of unique subscribers with 'Standard Paid' subscriptions whose latest payment attempt within the last 60 days was not via 'Stripe', 'B-Point', 'PayPal', 'Bpay', or 'Australia Post', or where the payment gateway is null.",ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,"WITH base_subquery_cte AS (
  SELECT
    t0.payment_gateway AS clmn0_,
    t0.subscriber_id_src AS clmn1_,
    t0.subscription_classification_type AS clmn2_
  FROM (
    WITH driver AS (
      SELECT
        subscriber_id_src,
        subscription_id_src,
        max(tran_date) AS latest_tran_date
      FROM
        `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans`
      WHERE
        tran_date BETWEEN `current_date`() - 60 AND `current_date`()
      GROUP BY 1, 2
    )
    SELECT
      b.*
    FROM
      driver AS a
      JOIN
      `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` AS b
      ON a.subscriber_id_src = b.subscriber_id_src AND a.subscription_id_src = b.subscription_id_src AND a.latest_tran_date = b.tran_date
    WHERE
      b.latest_attempt_flag = 'Y'
  ) AS t0
)
SELECT
  COUNT(DISTINCT clmn1_) AS unique_subscribers_other_gateways
FROM
  base_subquery_cte
WHERE
  (clmn2_ IN ('Standard Paid') AND (clmn0_ NOT IN ('Stripe', 'B-Point', 'PayPal', 'Bpay', 'Australia Post') OR clmn0_ IS NULL))
LIMIT 1;",COUNT(DISTINCT clmn1_),measure,True,high,41,da5dcd47-2e80-45e8-94b8-5b71d81182f5
total_actual_amount_q1_filtered,actual_amount,Total Actual Amount (Q1 Filtered),"The sum of actual amounts, filtered for specific retail channels (Convenience Stores, Supermarkets, Newsagencies) and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(t0.Actual_Amount) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602",SUM(t0.Actual_Amount),measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_q1_filtered,actual_amount,Actual Amount (Thousands) (Q1 Filtered),"The sum of actual amounts, divided by 1000, filtered for specific retail channels (Convenience Stores, Supermarkets, Newsagencies) and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(t0.Actual_Amount_k) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(SAFE_DIVIDE(t0.Actual_Amount, 1000))",measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
conditional_budget_amount_k_q1_filtered,budget_amount,Conditional Budget Amount (Thousands) (Q1 Filtered),"The sum of budget amounts for the specific fiscal week (2), divided by 1000, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000)) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000))",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_k_all_sales_channels_q1_filtered,budget_amount,Budget Amount (Thousands) for All Sales Channels (Q1 Filtered),"The sum of conditional budget amounts (for fiscal week 2), divided by 1000, specifically for 'ALL SALES CHANNELS', filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (t0.Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE 0 END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE 0 END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
conditional_budget_amount_k_sat_q1_filtered,budget_amount,Conditional Budget Amount (Thousands) for Saturday (Q1 Filtered),"The sum of conditional budget amounts (for fiscal week 2), divided by 1000, specifically for Saturdays, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'SAT') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'SAT') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_vs_conditional_budget_diff_k_sat_q1_filtered,actual_vs_budget_diff,Actual vs Conditional Budget Diff (Thousands) for Saturday (Q1 Filtered),"The difference between Actual Amount (k) and Conditional Budget Amount (k) for 'ALL SALES CHANNELS', specifically for Saturdays, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'SAT') THEN (t0.Actual_Amount_k - CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'SAT') THEN (Actual_Amount_k - CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
conditional_budget_amount_q1_filtered,budget_amount,Conditional Budget Amount (Q1 Filtered),"The sum of budget amounts for the specific fiscal week (2), filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602",SUM(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END),measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_vs_conditional_budget_diff_k_sun_q1_filtered,actual_vs_budget_diff,Actual vs Conditional Budget Diff (Thousands) for Sunday (Q1 Filtered),"The difference between Actual Amount (k) and Conditional Budget Amount (k) for 'ALL SALES CHANNELS', specifically for Sundays, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'SUN') THEN (t0.Actual_Amount_k - CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'SUN') THEN (Actual_Amount_k - CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
conditional_budget_amount_k_mf_q1_filtered,budget_amount,Conditional Budget Amount (Thousands) for Mon-Fri (Q1 Filtered),"The sum of conditional budget amounts (for fiscal week 2), divided by 1000, specifically for Monday-Friday, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'M-F') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'M-F') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_vs_conditional_budget_diff_k_mf_q1_filtered,actual_vs_budget_diff,Actual vs Conditional Budget Diff (Thousands) for Mon-Fri (Q1 Filtered),"The difference between Actual Amount (k) and Conditional Budget Amount (k) for 'ALL SALES CHANNELS', specifically for Monday-Friday, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'M-F') THEN (t0.Actual_Amount_k - CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'M-F') THEN (Actual_Amount_k - CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
conditional_budget_amount_for_all_sales_channels_q1_filtered,budget_amount,Conditional Budget Amount for All Sales Channels (Q1 Filtered),"The sum of conditional budget amounts (for fiscal week 2), specifically for 'ALL SALES CHANNELS', filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (t0.Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END ELSE 0 END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602",SUM(CASE WHEN (Publication_Level_7_Upper = 'ALL SALES CHANNELS') THEN CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END ELSE 0 END),measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
conditional_budget_amount_k_sun_q1_filtered,budget_amount,Conditional Budget Amount (Thousands) for Sunday (Q1 Filtered),"The sum of conditional budget amounts (for fiscal week 2), divided by 1000, specifically for Sundays, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'SUN') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'SUN') THEN SAFE_DIVIDE(CASE WHEN (t0.fy_week_of_year = 2) THEN t0.Budget_Amount ELSE 0 END, 1000) ELSE NULL END)",measure,False,medium,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_mf_q1_filtered,actual_amount,Actual Amount (Thousands) for Mon-Fri (Q1 Filtered),"The sum of actual amounts, divided by 1000, specifically for Monday-Friday, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'M-F') THEN t0.Actual_Amount_k ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'M-F') THEN SAFE_DIVIDE(t0.Actual_Amount, 1000) ELSE NULL END)",measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_sat_q1_filtered,actual_amount,Actual Amount (Thousands) for Saturday (Q1 Filtered),"The sum of actual amounts, divided by 1000, specifically for Saturdays, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'SAT') THEN t0.Actual_Amount_k ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'SAT') THEN SAFE_DIVIDE(t0.Actual_Amount, 1000) ELSE NULL END)",measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_sun_q1_filtered,actual_amount,Actual Amount (Thousands) for Sunday (Q1 Filtered),"The sum of actual amounts, divided by 1000, specifically for Sundays, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'SUN') THEN t0.Actual_Amount_k ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'SUN') THEN SAFE_DIVIDE(t0.Actual_Amount, 1000) ELSE NULL END)",measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
volume_k_mf_q1_filtered,volume,Volume (Thousands) for Mon-Fri (Q1 Filtered),"The sum of volume, divided by 1000, specifically for Monday-Friday, filtered for specific retail channels and a specific fiscal week (202602).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(CASE WHEN (Day_Group = 'M-F') THEN t0.Volume_k ELSE NULL END) FROM base_table_cte AS t0 WHERE (t0.Channel_Group_L1 = 'Convenience Stores / Service Stations' OR t0.Channel_Group_L1 = 'Supermarkets' OR t0.Channel_Group_L1 = 'Newsagencies') AND t0.fy_year_week_number = 202602","SUM(CASE WHEN (Day_Group = 'M-F') THEN SAFE_DIVIDE(t0.volume, 1000) ELSE NULL END)",measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
total_actual_amount_q2_filtered,actual_amount,Total Actual Amount (Q2 Filtered),"The sum of actual amounts, filtered for fiscal year 2026, fiscal week up to 202601, excluding specific publications, and for 'All Sales Channels'.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(t0.Actual_Amount) FROM base_table_cte AS t0 WHERE (t0.fy_year = 2026 AND t0.fy_year_week_number <= 202601) AND t0.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND t0.os_level_7 = 'All Sales Channels'",SUM(t0.Actual_Amount),measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
total_volume_q2_filtered,volume,Total Volume (Q2 Filtered),"The sum of volume, filtered for fiscal year 2026, fiscal week up to 202601, excluding specific publications, and for 'All Sales Channels'.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH base_table_cte AS (
  WITH OSandFACT AS (SELECT os.Actual_Amount, os.Budget_Amount, os.Forecast_Amount, os.Last_Year_Actual_Amount, os.volume, os.day_of_week, calendar.fy_first_day_of_week, calendar.fy_last_day_of_week, calendar.fy_month_of_year, calendar.fy_week_of_year, calendar.fy_year, calendar.fy_year_week_number, os.os_level_10, os.os_level_7, calendar.relative_fisc_week_number, calendar.relative_fisc_year_number, pub.l04_publication_code, pub.l06_publication_code, os.gl_hierarchy_code, pub.publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY') WHERE 1 = 1) SELECT t0.Actual_Amount, t0.Budget_Amount, t0.Forecast_Amount, t0.Last_Year_Actual_Amount, t0.volume, t0.day_of_week, t0.fy_first_day_of_week, t0.fy_last_day_of_week, t0.fy_month_of_year, t0.fy_week_of_year, t0.fy_year, t0.fy_year_week_number, t0.os_level_10, t0.os_level_7, t0.relative_fisc_week_number, t0.relative_fisc_year_number, t0.l04_publication_code, t0.l06_publication_code, t0.gl_hierarchy_code, t0.publication_name, SAFE_DIVIDE(t0.Actual_Amount, 1000) AS Actual_Amount_k, SAFE_DIVIDE(t0.volume, 1000) AS Volume_k, CASE WHEN (t0.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (t0.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (t0.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (t0.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (t0.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END AS Channel_Group_L1, CASE WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) IN ('MON', 'TUE', 'WED', 'THU', 'FRI', 'WEEKDAY ENTRY')) THEN 'M-F' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SAT') THEN 'SAT' WHEN (UPPER(SAFE_CAST(t0.day_of_week AS STRING)) = 'SUN') THEN 'SUN' ELSE NULL END AS Day_Group, UPPER(SAFE_CAST(t0.os_level_7 AS STRING)) AS Publication_Level_7_Upper FROM OSandFACT AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'
)
SELECT SUM(t0.volume) FROM base_table_cte AS t0 WHERE (t0.fy_year = 2026 AND t0.fy_year_week_number <= 202601) AND t0.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND t0.os_level_7 = 'All Sales Channels'",SUM(t0.volume),measure,True,high,42,2104a3f5-9424-4087-a928-e67fecae789a
total_records_count_os_daily_circulation_202548,total_records_count_os,"Total Records Count (OS Data Load - Circulation, Daily, Fiscal Week 202548)","The total number of records loaded from the 'Circulation' source system for a specific fiscal week and presentation date, as recorded in the OS data load check table. This metric helps verify the volume of data ingested for a specific data stream.",ncau-data-newsquery-prd,finance_monthend_checks,v_os_data_load_check,"SELECT
  t0.fiscal_week_id,
  DATETIME_TRUNC(t0.dw_prstn_load_datetime, SECOND) AS presentation_datetime,
  SUM(t0.records_count) AS total_records_count,
  t0.scenario,
  t0.source_system_name
FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_os_data_load_check` AS t0
WHERE
  t0.dw_prstn_load_datetime >= DATE '2025-06-04' AND t0.dw_prstn_load_datetime < DATETIME_ADD(DATE '2025-06-04', INTERVAL 1 DAY)
  AND t0.fiscal_week_id IN ('202548')
  AND t0.source_system_name IN ('Circulation')
GROUP BY
  t0.fiscal_week_id,
  presentation_datetime,
  t0.scenario,
  t0.source_system_name
LIMIT 2000001;",SUM(records_count),measure,True,high,44,2dfb1b58-42eb-44cb-b550-66469ae7df3c
total_jde_rows_daily,total_jde_rows,Total JDE Rows (Daily),"The total number of rows loaded into JDE for a specific partition date, grouped by table schema. This metric is used to monitor the volume of data processed by the JDE system, ensuring data completeness.",ncau-data-newsquery-prd,finance_monthend_checks,v_jde_data_load_check,"SELECT
  SUM(t0.total_rows) AS total_jde_rows,
  t0.table_schema
FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_jde_data_load_check` AS t0
WHERE
  PARSE_DATE('%Y%m%d', SAFE_CAST(t0.partition_id AS STRING)) >= DATE '2025-04-29'
  AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.partition_id AS STRING)) <= DATE '2025-04-29'
GROUP BY t0.table_schema
LIMIT 2000001;",SUM(total_rows),measure,True,high,44,2dfb1b58-42eb-44cb-b550-66469ae7df3c
unique_scenarios_count_os_daily,unique_scenarios_os,Unique Scenarios Count (OS Data Load - Daily),"The count of distinct scenarios observed in the OS data load for a specific presentation date, grouped by source system name. This metric helps identify the variety and consistency of data processing scenarios active on a given day.",ncau-data-newsquery-prd,finance_monthend_checks,v_os_data_load_check,"SELECT
  COUNT(DISTINCT t0.scenario) AS unique_scenarios_count,
  t0.source_system_name
FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_os_data_load_check` AS t0
WHERE
  t0.dw_prstn_load_datetime >= DATE '2025-04-29' AND t0.dw_prstn_load_datetime < DATETIME_ADD(DATE '2025-04-29', INTERVAL 1 DAY)
GROUP BY t0.source_system_name
LIMIT 2000001;",COUNT(DISTINCT scenario),measure,True,high,44,2dfb1b58-42eb-44cb-b550-66469ae7df3c
