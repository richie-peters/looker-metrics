metric_id,base_metric_id,metric_name,business_description,gcp_project_name,dataset_name,table_name,sql_logic,metric_type,is_kpi,business_criticality,response_id,dashboard_id
current_fy_gross_revenue_raw,gross_revenue,Current FY Gross Revenue,"Total gross revenue for the current fiscal year, based on billed or booked transactions, excluding specific composite and agency types. This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  )
SELECT
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue
FROM
  CTE2",measure,True,high,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
current_fy_gross_revenue_k_aud,gross_revenue,Current FY Gross Revenue (000s),"Total gross revenue for the current fiscal year, expressed in thousands, based on billed or booked transactions, excluding specific composite and agency types. This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  )
SELECT
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) / 1000 AS current_fy_gross_revenue_k_aud
FROM
  CTE2",measure,True,high,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
next_fy_gross_revenue_raw,gross_revenue,Next FY Gross Revenue,"Total gross revenue projected for the next fiscal year, based on billed or booked transactions, excluding specific composite and agency types. This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  )
SELECT
  SUM(CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END) AS next_fy_gross_revenue
FROM
  CTE2",measure,True,high,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
next_fy_gross_revenue_k_aud,gross_revenue,Next FY Gross Revenue (000s),"Total gross revenue projected for the next fiscal year, expressed in thousands, based on billed or booked transactions, excluding specific composite and agency types. This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  )
SELECT
  SUM(CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END) / 1000 AS next_fy_gross_revenue_k_aud
FROM
  CTE2",measure,True,high,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
current_fy_programmatic_digital_revenue_raw,programmatic_digital_revenue,Programmatic/Digital Revenue (Current FY),"Gross revenue for the current fiscal year specifically from programmatic or digital 'other' revenue types (Outstream, Xtend, Edmedia, Ecommerce) or specific date conditions, based on billed or booked transactions. This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  ),
CTE_Final AS (
    SELECT
        *,
        MIN(CASE WHEN advertiser_parent = ""DOUBLECLICK"" THEN CAST(booking_line_created_date AS DATE) END) OVER (PARTITION BY financial_year) AS fix_date_lod
    FROM CTE2
)
SELECT
  SUM(
    CASE
      WHEN relative_fy_year_offset = 0 AND (UPPER(revenue_group_subtype) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE') OR SAFE_CAST(booking_line_created_date AS DATETIME) <= fix_date_lod)
      THEN gross_revenue_amount
      ELSE 0
    END
  ) AS programmatic_digital_revenue_current_fy
FROM
  CTE_Final",measure,True,high,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
current_fy_programmatic_digital_revenue_k_aud,programmatic_digital_revenue,Programmatic/Digital Revenue (Current FY) (000s),"Gross revenue for the current fiscal year specifically from programmatic or digital 'other' revenue types (Outstream, Xtend, Edmedia, Ecommerce) or specific date conditions, expressed in thousands, based on billed or booked transactions. This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  ),
CTE_Final AS (
    SELECT
        *,
        MIN(CASE WHEN advertiser_parent = ""DOUBLECLICK"" THEN CAST(booking_line_created_date AS DATE) END) OVER (PARTITION BY financial_year) AS fix_date_lod
    FROM CTE2
)
SELECT
  SUM(
    CASE
      WHEN relative_fy_year_offset = 0 AND (UPPER(revenue_group_subtype) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE') OR SAFE_CAST(booking_line_created_date AS DATETIME) <= fix_date_lod)
      THEN gross_revenue_amount
      ELSE 0
    END
  ) / 1000 AS programmatic_digital_revenue_current_fy_k_aud
FROM
  CTE_Final",measure,True,high,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
revenue_type_transaction_count,transaction_count,Revenue Type Transaction Count,"Count of transactions categorized by their derived revenue type (e.g., Print, Digital, Programmatic). This metric is derived from the 'adsales_revenue_performance_daily' table.",ncau-data-newsquery-prd,asl_advertising,adsales_revenue_performance_daily,"WITH CTE2 AS (
    SELECT
      ad_type_name AS adtype_name,
      is_xtend_flag AS xtend_flag,
      unified_publication_name,
      unified_publication_gl_code,
      CASE
        WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
          'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
          'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
          'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
          'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
          'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
      END AS Sundry_Pubs_Flag,
      fy_year_month_number,
      CAST(`right`(CAST(fy_year_month_number AS STRING), 2) AS INT) AS fiscal_month_number,
      fy_year AS financial_year,
      fy_quarter_of_year AS financial_quarter,
      fy_month_of_year AS financial_month,
      fy_month_short_name AS financial_short_month,
      fy_week_of_year AS financial_week,
      revenue_transaction_status_code AS revenue_transaction_status,
      is_print_digital_flag,
      current_fy_month_of_year AS current_financial_month,
      current_fy_week_of_year AS current_financial_week,
      fy_year_week_number,
      style_name,
      UPPER(ASL.fin_adtype_name) AS fin_adtype_name,
      CASE
        WHEN sync_sales_segment_l2_name = 'MRCA' THEN 'MRCA'
        ELSE 'Client'
      END AS Sales_Group,
      EXTRACT(DAYOFWEEK FROM `current_date`()) AS DOW_Today,
      sales_segment_l1_name AS sales_segment_l_1_name,
      sales_segment_l2_name AS sales_segment_l_2_name,
      sync_sales_segment_l1_name AS sales_segment_l_1_name_sync,
      sync_sales_segment_l2_name AS sales_segment_l_2_name_sync,
      fy_quarter_of_year_name,
      relative_fy_year_offset,
      relative_fy_quarter_offset,
      relative_fy_month_offset,
      relative_fy_week_offset,
      customer_group_name AS advertiser_group,
      customer_group_parent_name AS advertiser_parent,
      SUM(IFNULL(adjustment_amount, 0)) AS adjustment_amount,
      curr_sales_segment_gm_name AS sales_segment_gm_name,
      sync_sales_segment_gm_name AS sales_segment_gm_name_sync,
      revenue_group_level1_name AS revenue_group_level_1_name,
      revenue_group_level2_name AS revenue_group_level_2_name,
      SUM(IFNULL(lgb_pub_amount, 0)) AS pub_lgb,
      SUM(IFNULL(lgb_ss_amount, 0)) AS ss_lgb,
      SUM(IFNULL(pipeline_amount, 0)) AS pipeline,
      SUM(IFNULL(gross_revenue_amount, 0)) AS gross_revenue_amount,
      UPPER(revenue_group_type_code) AS revenue_type,
      Upper(revenue_type_level2_code) AS revenue_type_Level2,
      UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
      current_portfolio_group_owner_sync,
      sync_portfolio_group_name AS portfolio_group_name_sync,
      current_portfolio_group_name AS portfolio_group_name_current,
      sync_portfolio_parent_group_name AS portfolio_parent_group_name_sync,
      industry_level1_name AS aszsic_industry_level_1_name,
      industry_level1_code AS anzsic_industry_level_1_code,
      industry_level2_code AS anzsic_industry_level_2_code,
      industry_level2_name AS aszsic_industry_level_2_name,
      industry_level3_code AS anzsic_industry_level_3_code,
      industry_level3_name AS anzsic_industry_level_3_name,
      industry_level4_code AS anzsic_industry_level_4_code,
      industry_level4_name AS anzsic_industry_level_4_name,
      industry_pillar_name AS nca_industry_pillar,
      industry_pillar_group_name AS nca_industry_anzsic_pillar_group,
      ASL.product_group_name AS product_group,
      division_group_name AS publishing_division_group,
      division_parent_group_name AS publishing_division_parent,
      CASE
        WHEN client_reporting_date >= `current_date`('Australia/Sydney') THEN 'Y'
        ELSE 'N'
      END AS is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL -365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ly_is_future_period_flag,
      CASE
        WHEN client_reporting_date >= DATE_ADD(`current_date`('Australia/Sydney'), INTERVAL 365 DAY) THEN 'Y'
        ELSE 'N'
      END AS ny_is_future_period_flag,
      cost_model_type_code AS cost_model_type,
      CASE
        WHEN dw_source_system_code = 'PLUTO' THEN CAST(client_reporting_date AS string)
        ELSE booking_line_created_date
      END AS booking_line_created_date,
      advertiser_name,
      current_portfolio_conformed_owner_sync,
      sync_portfolio_conformed_name AS portfolio_conformed_name_sync,
      publishing_division_name AS publishing_division,
      booking_line_created_week_of_year AS booking_line_created_week,
      booking_line_created_month_of_year AS booking_line_created_month,
      booking_line_created_month_short_name AS booking_line_created_short_month,
      booking_line_created_quarter_of_year AS booking_line_created_quarter,
      booking_line_created_year,
      agency_group_parent_name AS agency_parent,
      agency_group_name AS agency_group,
      agency_name,
      agency_id_src AS agency_number,
      cal_month_name AS calendar_month_name,
      cal_year AS calendar_year,
      section_l5_name AS classification_name,
      SUM(IFNULL(target_amount, 0)) AS target,
      IFNULL(current_portfolio_group_owner_full_name_sync, 'VACANT') AS GSD,
      IFNULL(current_portfolio_group_owner_full_name_current, 'VACANT') AS current_portfolio_group_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS portfolio_full_name_sync,
      IFNULL(current_portfolio_conformed_owner_full_name_sync, 'VACANT') AS sync_portfolio_conformed_owner_full,
      current_portfolio_conformed_owner_current,
      current_portfolio_group_owner_current,
      adtype_l1,
      adtype_l2,
      legacy_growth_flag,
      relative_cal_year_offset,
      cal_quarter_of_year_name AS calendar_quarter_of_year,
      cal_year_week_number AS calendar_week
    FROM
      `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
    WHERE
      (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code,
          'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name,
          'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
      (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name =
      '-')))
    GROUP BY ALL
  ),
CTE_Final AS (
    SELECT
        *,
        MIN(CASE WHEN advertiser_parent = ""DOUBLECLICK"" THEN CAST(booking_line_created_date AS DATE) END) OVER (PARTITION BY financial_year) AS fix_date_lod
    FROM CTE2
)
SELECT
  COUNT(
    CASE
      WHEN (CASE WHEN (portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND UPPER(revenue_group_subtype) = 'DIGITAL') THEN 'PROGRAMMATIC' ELSE UPPER(revenue_group_subtype) END) = 'PRINT' THEN 1
      WHEN (CASE WHEN (portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND UPPER(revenue_group_subtype) = 'DIGITAL') THEN 'PROGRAMMATIC' ELSE UPPER(revenue_group_subtype) END) = 'DIGITAL' THEN 2
      WHEN (CASE WHEN (UPPER(fin_adtype_name) = 'XTEND') THEN 'XTEND' ELSE UPPER(revenue_type) END) = 'XTEND' THEN 3
      ELSE NULL
    END
  ) AS revenue_type_transaction_count
FROM
  CTE_Final",measure,False,low,0,52c11c9c-052a-4e45-9cda-8fecd87d7964
advertiser_group_dimension,advertiser_group,Advertiser Group,Categorization of advertisers for reporting and analysis.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT advertiser_group FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 10;,dimension,False,medium,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
product_group_dimension,product_group,Product Group,"Grouping of products or services offered, used for filtering and segmentation.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT product_group FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 10;,dimension,False,medium,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
fin_adtype_name_dimension,fin_adtype_name,Financial Ad Type Name,The name of the financial advertising type.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT fin_adtype_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 10;,dimension,False,low,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
unified_publication_name_dimension,unified_publication_name,Unified Publication Name,The standardized name of the publication.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT unified_publication_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 10;,dimension,False,medium,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
financial_week_dimension,financial_week,Financial Week,"The financial week number, used for time-based analysis.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT SAFE_CAST(financial_week AS INT64) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` ORDER BY 1 DESC LIMIT 10;,dimension,False,medium,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
current_fy_actual_gross_revenue_k,gross_revenue_amount,Current FY Actual Gross Revenue (k),"Gross revenue amount for the current financial year, excluding future periods, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.is_future_period_flag = 'N' AND t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0;",measure,True,high,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
current_fy_gross_revenue_k,gross_revenue_amount,Current FY Gross Revenue (k),"Total gross revenue amount for the current financial year, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0;",measure,True,high,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
stly_gross_revenue_k,gross_revenue_amount,STLY Gross Revenue (k),"Gross revenue amount for the 'Same Time Last Year' period, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = -1 AND t0.stly_flag = 'Y') THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0;",measure,True,high,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
current_fy_past_weeks_pub_lgb,pub_lgb,Current FY Past Weeks Pub LGB,"Publisher's Last Year's Gross Budget (LGB) for the current financial year, covering past weeks.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 0 AND t0.relative_fy_week_offset < 0) THEN t0.pub_lgb ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0;,measure,False,medium,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
current_fy_current_week_prorated_pub_lgb,pub_lgb,Current FY Current Week Prorated Pub LGB,"Publisher's Last Year's Gross Budget (LGB) for the current financial year, prorated for the current week based on Day of Week.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 0 AND t0.relative_fy_week_offset = 0) THEN SAFE_DIVIDE((t0.pub_lgb * t0.DOW_Today), 7) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0;",measure,False,medium,1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
budget_earned_amount_current_week,budget_earned_amount,Budget Earned Amount - Current Week,"The total Budget Earned Amount for the current fiscal week and fiscal year, filtered by 'Digital Recognition' and excluding 'Discontinued' masthead groups. The 'current week' is dynamically calculated based on a fixed date (2025-03-26) relative to a base date (2024-07-03).",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (SAFE_CAST(t0.fy_year AS INT64) = 2025 AND SAFE_CAST(t0.fy_week_of_year AS INT64) = DATETIME_DIFF(SAFE_CAST(DATE '2025-03-26' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03' AS DATETIME), WEEK)) THEN SAFE_CAST(t0.BudgetEarnedAmount AS BIGNUMERIC) ELSE 0 END) AS budget_earned_amount_current_week FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'",measure,true,high,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
closing_base_current_week,closing_base,Closing Base - Current Week,"The total Closing Base for the current fiscal week and fiscal year, filtered by 'Digital Recognition' and excluding 'Discontinued' masthead groups. The 'current week' is dynamically calculated based on a fixed date (2025-03-26) relative to a base date (2024-07-03).",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (SAFE_CAST(t0.fy_year AS INT64) = 2025 AND SAFE_CAST(t0.fy_week_of_year AS INT64) = DATETIME_DIFF(SAFE_CAST(DATE '2025-03-26' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03' AS DATETIME), WEEK)) THEN SAFE_CAST(t0.ClosingBase AS BIGNUMERIC) ELSE 0 END) AS closing_base_current_week FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'",measure,true,high,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
opening_base_current_week,opening_base,Opening Base - Current Week,"The total Opening Base for the current fiscal week and fiscal year, filtered by 'Digital Recognition' and excluding 'Discontinued' masthead groups. The 'current week' is dynamically calculated based on a fixed date (2025-03-26) relative to a base date (2024-07-03).",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (SAFE_CAST(t0.fy_year AS INT64) = 2025 AND SAFE_CAST(t0.fy_week_of_year AS INT64) = DATETIME_DIFF(SAFE_CAST(DATE '2025-03-26' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03' AS DATETIME), WEEK)) THEN SAFE_CAST(t0.OpeningBase AS BIGNUMERIC) ELSE 0 END) AS opening_base_current_week FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'",measure,true,high,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
earned_amount_current_week,earned_amount,Earned Amount - Current Week,"The total Earned Amount for the current fiscal week and fiscal year, filtered by 'Digital Recognition' and excluding 'Discontinued' masthead groups. The 'current week' is dynamically calculated based on a fixed date (2025-03-26) relative to a base date (2024-07-03).",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (SAFE_CAST(t0.fy_year AS INT64) = 2025 AND SAFE_CAST(t0.fy_week_of_year AS INT64) = DATETIME_DIFF(SAFE_CAST(DATE '2025-03-26' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03' AS DATETIME), WEEK)) THEN SAFE_CAST(t0.EarnedAmount AS BIGNUMERIC) ELSE NULL END) AS earned_amount_current_week FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'",measure,true,high,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
net_change_previous_year_current_week,net_change,Net Change - Previous Year Current Week,"The net change (Closing Base - Opening Base) for the previous fiscal year (2024) for the current fiscal week, filtered by 'Digital Recognition' and excluding 'Discontinued' masthead groups. The 'current week' is dynamically calculated based on a fixed date (2025-03-26) relative to a base date (2024-07-03).",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (SAFE_CAST(t0.fy_year AS INT64) = 2024 AND SAFE_CAST(t0.fy_week_of_year AS INT64) = DATETIME_DIFF(SAFE_CAST(DATE '2025-03-26' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03' AS DATETIME), WEEK)) THEN (SAFE_CAST(t0.ClosingBase AS BIGNUMERIC) - SAFE_CAST(t0.OpeningBase AS BIGNUMERIC)) ELSE 0 END) AS net_change_previous_year_current_week FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'",measure,false,medium,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
dashboard_data_presence,data_presence,Dashboard Data Presence,"A simple indicator (always 1) to confirm the presence of data for the dashboard's primary query, after applying filters for 'Digital Recognition' and excluding 'Discontinued' masthead groups.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT MAX(1) AS dashboard_data_presence FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition',aggregation,false,low,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
cancellation_type_dimension,cancellation_type,Cancellation Type Filter,"A dimension used to filter or categorize data by cancellation type, currently hardcoded to 'Gross Cancellations'. This is likely part of a dynamic filter control in Looker Studio.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT 'Gross Cancellations' AS cancellation_type FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' GROUP BY 1 LIMIT 1,dimension,false,low,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
view_type_dimension,view_type,View Type Filter (BUD/FCT/YOY/BUD NY),"A dimension used to filter or categorize data by a specific view type (Budget, Forecast, Year-over-Year, Budget Next Year), currently hardcoded to 'BUD'. This is likely part of a dynamic filter control in Looker Studio.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT 'BUD' AS view_type FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 GROUP BY 1 LIMIT 1,dimension,false,low,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
date_range_view_type_dimension,date_range_view_type,Date Range & View Type Filter,"A dimension used to filter or categorize data by a combination of date range and view type, currently hardcoded to 'Week to Date & Budget View'. This is likely part of a dynamic filter control in Looker Studio.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT 'Week to Date & Budget View' AS date_range_view_type FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued' GROUP BY 1 LIMIT 1,dimension,false,low,2,bb49fa78-5abe-4e68-a9c1-8172a832e724
product_revenue_sum_exclude_lod,product_revenue,Product Revenue (Exclude LOD),Total product revenue from the 'exclude product L3 and L4' dataset.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Product_Revenue) AS product_revenue_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0,measure,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
product_revenue_merged_one_row_sum_exclude_lod,product_revenue_merged,Product Revenue Merged OneRow (Exclude LOD),"Total product revenue from the 'exclude product L3 and L4' dataset, specifically from the 'Product_Revenue_Merged_OneRow' column, which might represent a consolidated or adjusted revenue figure.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Product_Revenue_Merged_OneRow) AS product_revenue_merged_one_row_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0,measure,false,medium,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
product_revenue_sum_pacman,product_revenue,Product Revenue (PACMAN),"Total product revenue from the 'PACMAN running expense' dataset, without any specific fiscal year filter.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT SUM(t0.Product_Revenue) AS product_revenue_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,measure,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
product_revenue_sum_pacman_fy2025,product_revenue,"Product Revenue (PACMAN, FY 2025)","Total product revenue from the 'PACMAN running expense' dataset, specifically filtered for Fiscal Year 2025.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT SUM(t0.Product_Revenue) AS product_revenue_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE t0.Fiscal_Year IN (2025),measure,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
fiscal_year_sum_exclude_lod,fiscal_year_sum,Fiscal Year Sum (Exclude LOD),"The sum of fiscal year values from the 'exclude product L3 and L4' dataset. Note: Summing fiscal years is an unusual aggregation and might indicate a misconfiguration or a specific use case (e.g., counting records per year, where the year itself is the value).",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Fiscal_Year) AS fiscal_year_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0,measure,false,low,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
fiscal_year_sum_exclude_lod_fy2025,fiscal_year_sum,"Fiscal Year Sum (Exclude LOD, FY 2025)","The sum of fiscal year values from the 'exclude product L3 and L4' dataset, filtered for Fiscal Year 2025. Note: Summing fiscal years is an unusual aggregation and might indicate a misconfiguration or a specific use case.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Fiscal_Year) AS fiscal_year_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE t0.Fiscal_Year IN (2025),measure,false,low,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
fiscal_year_sum_pacman,fiscal_year_sum,Fiscal Year Sum (PACMAN),The sum of fiscal year values from the 'PACMAN running expense' dataset. Note: Summing fiscal years is an unusual aggregation and might indicate a misconfiguration or a specific use case.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT SUM(t0.Fiscal_Year) AS fiscal_year_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0,measure,false,low,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_ml2_fy2025_advertising,running_expense_conditional,"Running Expense ML2 (FY 2025, Advertising)","Maximum running expense for Margin Level '2', specifically for Fiscal Year 2025 and 'ADVERTISING' category. The expense value is conditionally selected based on the 'Category' (CONSUMER or ADVERTISING) from the respective running expense columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN t0.Category = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_2 WHEN t0.Category = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_2 ELSE 0 END) AS running_expense_ml2 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE t0.Fiscal_Year IN (2025) AND t0.Category IN ('ADVERTISING'),calculated_field,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_ml3_fy2025_advertising,running_expense_conditional,"Running Expense ML3 (FY 2025, Advertising)","Maximum running expense for Margin Level '3', specifically for Fiscal Year 2025 and 'ADVERTISING' category. The expense value is conditionally selected based on the 'Category' (CONSUMER or ADVERTISING) from the respective running expense columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN t0.Category = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_3 WHEN t0.Category = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_3 ELSE 0 END) AS running_expense_ml3 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE t0.Fiscal_Year IN (2025) AND t0.Category IN ('ADVERTISING'),calculated_field,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_ml4_fy2025_advertising,running_expense_conditional,"Running Expense ML4 (FY 2025, Advertising)","Maximum running expense for Margin Level '4', specifically for Fiscal Year 2025 and 'ADVERTISING' category. The expense value is conditionally selected based on the 'Category' (CONSUMER or ADVERTISING) from the respective running expense columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN t0.Category = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_4 WHEN t0.Category = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_4 ELSE 0 END) AS running_expense_ml4 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE t0.Fiscal_Year IN (2025) AND t0.Category IN ('ADVERTISING'),calculated_field,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_ml5_fy2025_advertising,running_expense_conditional,"Running Expense ML5 (FY 2025, Advertising)","Maximum running expense for Margin Level '5', specifically for Fiscal Year 2025 and 'ADVERTISING' category. The expense value is conditionally selected based on the 'Category' (CONSUMER or ADVERTISING) from the respective running expense columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN t0.Category = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_5 WHEN t0.Category = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_5 ELSE 0 END) AS running_expense_ml5 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE t0.Fiscal_Year IN (2025) AND t0.Category IN ('ADVERTISING'),calculated_field,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_ml6_fy2025_advertising,running_expense_conditional,"Running Expense ML6 (FY 2025, Advertising)","Maximum running expense for Margin Level '6', specifically for Fiscal Year 2025 and 'ADVERTISING' category. The expense value is conditionally selected based on the 'Category' (CONSUMER or ADVERTISING) from the respective running expense columns.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,SELECT MAX(CASE WHEN t0.Category = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_6 WHEN t0.Category = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_6 ELSE 0 END) AS running_expense_ml6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE t0.Fiscal_Year IN (2025) AND t0.Category IN ('ADVERTISING'),calculated_field,true,high,3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
source_system_record_count_by_source_system,record_count,Record Count by Source System,"Counts the number of records for each source system within the aggregated finance data, considering the active fiscal periods.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  COUNT(1) AS record_count,
  t0.source_system_name
FROM (
  WITH OSandFACT AS (
    SELECT
      os.source_system_name,
      CAST(os.fiscal_week_id AS INT) AS fiscal_week_id,
      os.gl_publication_code,
      os.os_level_12
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
GROUP BY
  t0.source_system_name",aggregation,False,low,4,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_by_year_and_source,total_actual_amount,Total Actual Amount by Fiscal Year and Source System,"Calculates the sum of actual financial amounts, broken down by fiscal year and the source system, for active fiscal periods.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t0.Actual_Amount) AS total_actual_amount,
  t0.fy_year,
  t0.source_system_name
FROM (
  WITH OSandFACT AS (
    SELECT
      os.source_system_name,
      os.Actual_Amount,
      CAST(os.fiscal_week_id AS INT) AS fiscal_week_id,
      os.gl_publication_code,
      os.os_level_12,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number,
          CAST(c.fy_year AS INT) AS fy_year
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
GROUP BY
  t0.fy_year,
  t0.source_system_name",measure,True,high,4,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_by_source,total_actual_amount,Total Actual Amount by Source System,"Calculates the sum of actual financial amounts, broken down by the source system, for active fiscal periods.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t0.Actual_Amount) AS total_actual_amount,
  t0.source_system_name
FROM (
  WITH OSandFACT AS (
    SELECT
      os.source_system_name,
      os.Actual_Amount,
      CAST(os.fiscal_week_id AS INT) AS fiscal_week_id,
      os.gl_publication_code,
      os.os_level_12
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
GROUP BY
  t0.source_system_name",measure,True,high,4,d7412673-0af1-4efe-8374-ca475b001fb6
gross_amount_diff_sum,gross_amount_diff,Gross Amount Difference (Sum),The sum of the gross amount difference for revenue movements. This is the primary financial measure.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(GROSS_AMOUNT_DIFF) AS gross_amount_diff_sum FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 1;,measure,True,high,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_digital_sum,gross_amount_diff_digital,Digital Gross Amount Difference (Sum),The sum of gross amount difference specifically for digital revenue types.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(CASE WHEN (t0.revenue_type = 'DIGITAL') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS digital_gross_amount_diff_sum FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 LIMIT 1;,calculated_field,True,high,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_print_sum,gross_amount_diff_print,Print Gross Amount Difference (Sum),The sum of gross amount difference specifically for print revenue types.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(CASE WHEN (t0.revenue_type = 'PRINT') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS print_gross_amount_diff_sum FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 LIMIT 1;,calculated_field,True,high,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
revenue_channel_type_dimension,revenue_channel_type,Revenue Channel Type,"Categorization of revenue based on Xtend flag, programmatic indicators, or revenue sub-type.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,"SELECT DISTINCT CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' WHEN (SAFE.LEFT(t0.revenue_sub_type, 3) = 'PRO' OR (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_sub_type = 'DIGITAL')) THEN 'PROGRAMMATIC' WHEN (t0.revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL' WHEN (SAFE.LEFT(t0.revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY' ELSE t0.revenue_sub_type END AS revenue_channel_type FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 LIMIT 100;",calculated_field,False,medium,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
advertiser_group_display_dimension,advertiser_group_display,Advertiser Group Display,"Advertiser group name, defaulting to 'Nah' if null.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT CASE WHEN (t0.advertiser_group IS NULL) THEN 'Nah' ELSE t0.advertiser_group END AS advertiser_group_display FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 LIMIT 100;,calculated_field,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
advertiser_group_dimension,advertiser_group,Advertiser Group,The group name associated with the advertiser.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT advertiser_group FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
advertiser_parent_dimension,advertiser_parent,Advertiser Parent,The parent company or entity of the advertiser.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT advertiser_parent FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
booking_line_id_dimension,booking_line_id,Booking Line ID,Unique identifier for a specific booking line item.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT booking_line_id FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
booking_number_dimension,booking_number,Booking Number,Identifier for the overall booking.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT booking_number FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
financial_short_month_dimension,financial_short_month,Financial Short Month,The short name of the financial month.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT financial_short_month FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
financial_year_dimension,financial_year,Financial Year,The financial year of the revenue movement.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT financial_year FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,medium,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
movement_date_dimension,movement_date,Movement Date,The specific date of the revenue movement.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT movement_date FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` ORDER BY movement_date DESC LIMIT 100;,dimension,False,medium,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
portfolio_group_name_sync_dimension,portfolio_group_name_sync,Portfolio Group Name (Sync),Synchronized name of the portfolio group.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT portfolio_group_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
portfolio_parent_group_name_sync_dimension,portfolio_parent_group_name_sync,Portfolio Parent Group Name (Sync),Synchronized name of the parent portfolio group.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT portfolio_parent_group_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,medium,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
revenue_sub_type_dimension,revenue_sub_type,Revenue Sub Type,Detailed sub-categorization of revenue.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT revenue_sub_type FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,medium,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
revenue_type_dimension,revenue_type,Revenue Type,"Broad categorization of revenue (e.g., Digital, Print).",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT revenue_type FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,medium,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
xtend_flag_dimension,xtend_flag,Xtend Flag,Flag indicating if the revenue is associated with Xtend.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT xtend_flag FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
sales_segment_gm_name_sync_dimension,sales_segment_gm_name_sync,Sales Segment GM Name (Sync),Synchronized name of the sales segment General Manager.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT sales_segment_gm_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
publishing_division_group_dimension,publishing_division_group,Publishing Division Group,The group name of the publishing division.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT publishing_division_group FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
portfolio_conformed_name_sync_dimension,portfolio_conformed_name_sync,Portfolio Conformed Name (Sync),Synchronized conformed name of the portfolio.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT DISTINCT portfolio_conformed_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` LIMIT 100;,dimension,False,low,5,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_revenue_smith_family,total_gross_revenue,Gross Revenue - The Smith Family,The total gross revenue generated specifically from the advertiser 'The Smith Family *'.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT SUM(t0.RevenueGross) AS gross_revenue_smith_family FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.Advertiser IN ('The Smith Family *'),measure,true,high,6,87651b69-c43e-471f-9c4b-98df1208a844
dsp_dimension,dsp,DSP,A list of unique Demand-Side Platforms (DSPs) associated with programmatic advertising data.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT DISTINCT t0.DSP AS dsp FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0,dimension,false,medium,6,87651b69-c43e-471f-9c4b-98df1208a844
source_dimension,source,Source,A list of unique sources from which programmatic advertising data originates.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT DISTINCT t0.Source AS source FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0,dimension,false,medium,6,87651b69-c43e-471f-9c4b-98df1208a844
paid_impressions_guaranteed_chemist_warehouse_202506,total_paid_impressions,"Paid Impressions - Guaranteed, Chemist Warehouse, Jun 2025",The total number of paid impressions for 'Guaranteed' transaction types from 'Chemist Warehouse *' for June 2025.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT SUM(t0.PaidImpressions) AS paid_impressions_guaranteed_chemist_warehouse_202506 FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.TransactionType IN ('Guaranteed') AND t0.Advertiser IN ('Chemist Warehouse *') AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) IN (DATE '2025-06-01')",measure,true,high,6,87651b69-c43e-471f-9c4b-98df1208a844
gross_revenue_guaranteed_chemist_warehouse_202506,total_gross_revenue,"Gross Revenue - Guaranteed, Chemist Warehouse, Jun 2025",The total gross revenue for 'Guaranteed' transaction types from 'Chemist Warehouse *' for June 2025.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT SUM(t0.RevenueGross) AS gross_revenue_guaranteed_chemist_warehouse_202506 FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.TransactionType IN ('Guaranteed') AND t0.Advertiser IN ('Chemist Warehouse *') AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) IN (DATE '2025-06-01')",measure,true,high,6,87651b69-c43e-471f-9c4b-98df1208a844
advertiser_dimension_filtered,advertiser,Advertiser (Filtered),"A list of unique advertisers, specifically filtered for 'Guaranteed' transaction types from 'Chemist Warehouse *' for June 2025.",ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT DISTINCT t0.Advertiser AS advertiser FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.TransactionType IN ('Guaranteed') AND t0.Advertiser IN ('Chemist Warehouse *') AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) IN (DATE '2025-06-01')",dimension,false,medium,6,87651b69-c43e-471f-9c4b-98df1208a844
calendar_month_dimension_filtered,calendar_month,Calendar Month (Filtered),"A list of unique calendar months, specifically filtered for 'Guaranteed' transaction types from 'Chemist Warehouse *' for June 2025.",ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT DISTINCT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) AS calendar_month FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.TransactionType IN ('Guaranteed') AND t0.Advertiser IN ('Chemist Warehouse *') AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) IN (DATE '2025-06-01')",dimension,false,medium,6,87651b69-c43e-471f-9c4b-98df1208a844
net_revenue_by_buyer_filtered_transaction_type,total_net_revenue,Net Revenue by Buyer (Filtered Transaction Type),"The total net revenue grouped by buyer, filtered for specific transaction types ('Deal', 'Direct', 'Guaranteed', 'Open Auction').",ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT t0.Buyer, SUM(t0.RevenueNet) AS net_revenue FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.TransactionType IN ('Deal', 'Direct', 'Guaranteed', 'Open Auction') GROUP BY t0.Buyer",aggregation,true,high,6,87651b69-c43e-471f-9c4b-98df1208a844
buyer_dimension,buyer,Buyer,A list of unique buyers involved in programmatic advertising transactions.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT DISTINCT t0.Buyer AS buyer FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0,dimension,false,medium,6,87651b69-c43e-471f-9c4b-98df1208a844
calendar_month_dimension,calendar_month,Calendar Month,"A list of unique calendar months present in the programmatic advertising data, truncated to the start of the month.",ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,"SELECT DISTINCT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) AS calendar_month FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0",dimension,false,medium,6,87651b69-c43e-471f-9c4b-98df1208a844
current_fy_gross_revenue,gross_revenue,Current FY Gross Revenue,"Total gross revenue amount for the current financial year, based on the relative fiscal year offset (relative_fy_year_offset = 0).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_weekly,"WITH
  SFCE_USER AS (
    SELECT
      TEMP1.network_user_name AS login_name,
      TEMP1.user_name AS full_name
    FROM
      (
        SELECT
          UPPER(network_user_name) AS network_user_name,
          UPPER(user_name) AS user_name,
          ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
        FROM
          `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
        WHERE
          dw_source_system_code = 'SFCE'
      ) AS TEMP1
    WHERE
      TEMP1.RN = 1
  )
SELECT
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` AS t0
  LEFT JOIN
  SFCE_USER AS GSD_JOIN
  ON UPPER(t0.current_portfolio_group_owner_sync) = GSD_JOIN.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CURR
  ON UPPER(t0.current_portfolio_group_owner_current) = GSD_JOIN_CURR.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CONFORM
  ON UPPER(t0.current_portfolio_conformed_owner_current) = GSD_JOIN_CONFORM.login_name
WHERE
  t0.relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(t0.revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(t0.style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(t0.source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(t0.publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(t0.publication_name) LIKE 'SUDDENLY%' AND t0.account_number IN ('17114', '29172', '52809')));",measure,True,high,7,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
current_fy_pipeline,pipeline,Current FY Pipeline,"Total pipeline amount for the current financial year, based on the relative fiscal year offset (relative_fy_year_offset = 0).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_weekly,"WITH
  SFCE_USER AS (
    SELECT
      TEMP1.network_user_name AS login_name,
      TEMP1.user_name AS full_name
    FROM
      (
        SELECT
          UPPER(network_user_name) AS network_user_name,
          UPPER(user_name) AS user_name,
          ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
        FROM
          `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
        WHERE
          dw_source_system_code = 'SFCE'
      ) AS TEMP1
    WHERE
      TEMP1.RN = 1
  )
SELECT
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.pipeline ELSE 0 END) AS current_fy_pipeline
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` AS t0
  LEFT JOIN
  SFCE_USER AS GSD_JOIN
  ON UPPER(t0.current_portfolio_group_owner_sync) = GSD_JOIN.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CURR
  ON UPPER(t0.current_portfolio_group_owner_current) = GSD_JOIN_CURR.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CONFORM
  ON UPPER(t0.current_portfolio_conformed_owner_current) = GSD_JOIN_CONFORM.login_name
WHERE
  t0.relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(t0.revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(t0.style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(t0.source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(t0.publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(t0.publication_name) LIKE 'SUDDENLY%' AND t0.account_number IN ('17114', '29172', '52809')));",measure,True,high,7,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
total_pipeline,pipeline,Total Pipeline,"Total pipeline amount across all relevant financial years (relative_fy_year_offset -1, 0, 1), including null values as zero.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_weekly,"WITH
  SFCE_USER AS (
    SELECT
      TEMP1.network_user_name AS login_name,
      TEMP1.user_name AS full_name
    FROM
      (
        SELECT
          UPPER(network_user_name) AS network_user_name,
          UPPER(user_name) AS user_name,
          ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
        FROM
          `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
        WHERE
          dw_source_system_code = 'SFCE'
      ) AS TEMP1
    WHERE
      TEMP1.RN = 1
  )
SELECT
  SUM(IFNULL(t0.pipeline, 0)) AS total_pipeline
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` AS t0
  LEFT JOIN
  SFCE_USER AS GSD_JOIN
  ON UPPER(t0.current_portfolio_group_owner_sync) = GSD_JOIN.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CURR
  ON UPPER(t0.current_portfolio_group_owner_current) = GSD_JOIN_CURR.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CONFORM
  ON UPPER(t0.current_portfolio_conformed_owner_current) = GSD_JOIN_CONFORM.login_name
WHERE
  t0.relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(t0.revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(t0.style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(t0.source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(t0.publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(t0.publication_name) LIKE 'SUDDENLY%' AND t0.account_number IN ('17114', '29172', '52809')));",measure,False,medium,7,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
is_digital_other_sales_segment,sales_segment_flag,Is Digital Other Sales Segment,"A boolean flag (1 for true, 0 for false) indicating if the sales segment is 'Digital Other' within the grouped data. Calculated as the maximum value of the boolean expression.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_weekly,"WITH
  SFCE_USER AS (
    SELECT
      TEMP1.network_user_name AS login_name,
      TEMP1.user_name AS full_name
    FROM
      (
        SELECT
          UPPER(network_user_name) AS network_user_name,
          UPPER(user_name) AS user_name,
          ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
        FROM
          `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
        WHERE
          dw_source_system_code = 'SFCE'
      ) AS TEMP1
    WHERE
      TEMP1.RN = 1
  )
SELECT
  MAX(t0.sales_segment_l_2_name_sync = 'Digital Other') AS is_digital_other_sales_segment
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` AS t0
  LEFT JOIN
  SFCE_USER AS GSD_JOIN
  ON UPPER(t0.current_portfolio_group_owner_sync) = GSD_JOIN.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CURR
  ON UPPER(t0.current_portfolio_group_owner_current) = GSD_JOIN_CURR.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CONFORM
  ON UPPER(t0.current_portfolio_conformed_owner_current) = GSD_JOIN_CONFORM.login_name
WHERE
  t0.relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(t0.revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(t0.style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(t0.source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(t0.publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(t0.publication_name) LIKE 'SUDDENLY%' AND t0.account_number IN ('17114', '29172', '52809')));",aggregation,False,low,7,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
revenue_type_xtend_categorized,revenue_type_categorization,Revenue Type (XTEND/Other),"A categorical dimension that reclassifies revenue types: 'XTEND' if the xtend_flag is 'Y', otherwise uses the original revenue_type.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_weekly,"WITH
  SFCE_USER AS (
    SELECT
      TEMP1.network_user_name AS login_name,
      TEMP1.user_name AS full_name
    FROM
      (
        SELECT
          UPPER(network_user_name) AS network_user_name,
          UPPER(user_name) AS user_name,
          ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
        FROM
          `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
        WHERE
          dw_source_system_code = 'SFCE'
      ) AS TEMP1
    WHERE
      TEMP1.RN = 1
  )
SELECT DISTINCT
  CASE WHEN t0.xtend_flag = 'Y' THEN 'XTEND' ELSE UPPER(t0.revenue_type) END AS revenue_type_xtend_categorized
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` AS t0
  LEFT JOIN
  SFCE_USER AS GSD_JOIN
  ON UPPER(t0.current_portfolio_group_owner_sync) = GSD_JOIN.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CURR
  ON UPPER(t0.current_portfolio_group_owner_current) = GSD_JOIN_CURR.login_name
  LEFT JOIN
  SFCE_USER AS GSD_JOIN_CONFORM
  ON UPPER(t0.current_portfolio_conformed_owner_current) = GSD_JOIN_CONFORM.login_name
WHERE
  t0.relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(t0.revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(t0.style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(t0.source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(t0.publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(t0.publication_name) LIKE 'SUDDENLY%' AND t0.account_number IN ('17114', '29172', '52809')))
LIMIT 10;",dimension,False,medium,7,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
gross_revenue_total_overall_current_fy,gross_revenue_total_overall,Total Gross Revenue (Current Fiscal Year),"The sum of all gross revenue for the current fiscal year, across all categories.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.relative_fy_year_offset = 0,measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_total_overall_previous_fy,gross_revenue_total_overall,Total Gross Revenue (Previous Fiscal Year),"The sum of all gross revenue for the previous fiscal year, across all categories.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.relative_fy_year_offset = -1,measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_total_overall_current_fy_feb,gross_revenue_total_overall,"Total Gross Revenue (Current Fiscal Year, February)","The sum of all gross revenue for February of the current fiscal year, across all categories.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.relative_fy_year_offset = 0 AND SAFE_CAST(t0.financial_month AS INT64) = 2,measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_total_overall_previous_fy_feb,gross_revenue_total_overall,"Total Gross Revenue (Previous Fiscal Year, February)","The sum of all gross revenue for February of the previous fiscal year, across all categories.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.relative_fy_year_offset = -1 AND SAFE_CAST(t0.financial_month AS INT64) = 2,measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_programmatic_tubi_total_current_fy,gross_revenue_programmatic_tubi_total,Programmatic/Tubi Gross Revenue (Current Fiscal Year),"The sum of gross revenue for the current fiscal year, specifically for 'TUBI', 'PERFORMANCE' categories, or 'PROGRAMMATIC SOURCE' subtype. This is a filtered total.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.revenue_group_subtype,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND (revenue_category IN ('TUBI', 'PERFORMANCE') OR revenue_group_subtype = 'PROGRAMMATIC SOURCE')",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_programmatic_tubi_total_current_fy_ytd,gross_revenue_programmatic_tubi_total,Programmatic/Tubi Gross Revenue (Current Fiscal Year YTD),"The sum of gross revenue year-to-date for the current fiscal year, specifically for 'TUBI', 'PERFORMANCE' categories, or 'PROGRAMMATIC SOURCE' subtype. This is a filtered total.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.revenue_group_subtype,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() AND (revenue_category IN ('TUBI', 'PERFORMANCE') OR revenue_group_subtype = 'PROGRAMMATIC SOURCE')",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pmp_current_fy,gross_revenue_pmp,PMP Gross Revenue (Current Fiscal Year),The sum of gross revenue for PMP (Private Marketplace) deals in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND revenue_category = 'PMP'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pmp_current_fy_ytd,gross_revenue_pmp,PMP Gross Revenue (Current Fiscal Year YTD),The sum of gross revenue for PMP (Private Marketplace) deals year-to-date in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() AND revenue_category = 'PMP'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pmp_previous_fy,gross_revenue_pmp,PMP Gross Revenue (Previous Fiscal Year),The sum of gross revenue for PMP (Private Marketplace) deals in the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND revenue_category = 'PMP'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pmp_current_fy_feb,gross_revenue_pmp,"PMP Gross Revenue (Current Fiscal Year, February)",The sum of gross revenue for PMP (Private Marketplace) deals in February of the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'PMP'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pmp_previous_fy_feb,gross_revenue_pmp,"PMP Gross Revenue (Previous Fiscal Year, February)",The sum of gross revenue for PMP (Private Marketplace) deals in February of the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'PMP'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pg_current_fy,gross_revenue_pg,PG Gross Revenue (Current Fiscal Year),The sum of gross revenue for PG (Programmatic Guaranteed) deals in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND revenue_category = 'PG'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pg_current_fy_ytd,gross_revenue_pg,PG Gross Revenue (Current Fiscal Year YTD),The sum of gross revenue for PG (Programmatic Guaranteed) deals year-to-date in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() AND revenue_category = 'PG'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pg_previous_fy,gross_revenue_pg,PG Gross Revenue (Previous Fiscal Year),The sum of gross revenue for PG (Programmatic Guaranteed) deals in the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND revenue_category = 'PG'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pg_current_fy_feb,gross_revenue_pg,"PG Gross Revenue (Current Fiscal Year, February)",The sum of gross revenue for PG (Programmatic Guaranteed) deals in February of the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'PG'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_pg_previous_fy_feb,gross_revenue_pg,"PG Gross Revenue (Previous Fiscal Year, February)",The sum of gross revenue for PG (Programmatic Guaranteed) deals in February of the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'PG'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_omp_current_fy,gross_revenue_omp,OMP Gross Revenue (Current Fiscal Year),The sum of gross revenue for OMP (Open Marketplace) deals in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND revenue_category = 'OMP'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_omp_current_fy_ytd,gross_revenue_omp,OMP Gross Revenue (Current Fiscal Year YTD),The sum of gross revenue for OMP (Open Marketplace) deals year-to-date in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() AND revenue_category = 'OMP'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_omp_previous_fy,gross_revenue_omp,OMP Gross Revenue (Previous Fiscal Year),The sum of gross revenue for OMP (Open Marketplace) deals in the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND revenue_category = 'OMP'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_omp_current_fy_feb,gross_revenue_omp,"OMP Gross Revenue (Current Fiscal Year, February)",The sum of gross revenue for OMP (Open Marketplace) deals in February of the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'OMP'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_omp_previous_fy_feb,gross_revenue_omp,"OMP Gross Revenue (Previous Fiscal Year, February)",The sum of gross revenue for OMP (Open Marketplace) deals in February of the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'OMP'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_tubi_current_fy,gross_revenue_tubi,Tubi Gross Revenue (Current Fiscal Year),The sum of gross revenue attributed to Tubi in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND revenue_category = 'TUBI'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_tubi_current_fy_ytd,gross_revenue_tubi,Tubi Gross Revenue (Current Fiscal Year YTD),The sum of gross revenue attributed to Tubi year-to-date in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() AND revenue_category = 'TUBI'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_tubi_previous_fy,gross_revenue_tubi,Tubi Gross Revenue (Previous Fiscal Year),The sum of gross revenue attributed to Tubi in the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND revenue_category = 'TUBI'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_tubi_current_fy_feb,gross_revenue_tubi,"Tubi Gross Revenue (Current Fiscal Year, February)",The sum of gross revenue attributed to Tubi in February of the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'TUBI'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_tubi_previous_fy_feb,gross_revenue_tubi,"Tubi Gross Revenue (Previous Fiscal Year, February)",The sum of gross revenue attributed to Tubi in February of the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'TUBI'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_performance_current_fy,gross_revenue_performance,Performance Gross Revenue (Current Fiscal Year),The sum of gross revenue for 'Performance' deals (Run of Audience Extension) in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND revenue_category = 'PERFORMANCE'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_performance_current_fy_ytd,gross_revenue_performance,Performance Gross Revenue (Current Fiscal Year YTD),The sum of gross revenue for 'Performance' deals (Run of Audience Extension) year-to-date in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() AND revenue_category = 'PERFORMANCE'",measure,True,high,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_performance_previous_fy,gross_revenue_performance,Performance Gross Revenue (Previous Fiscal Year),The sum of gross revenue for 'Performance' deals (Run of Audience Extension) in the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND revenue_category = 'PERFORMANCE'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_performance_current_fy_feb,gross_revenue_performance,"Performance Gross Revenue (Current Fiscal Year, February)",The sum of gross revenue for 'Performance' deals (Run of Audience Extension) in February of the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = 0 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'PERFORMANCE'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
gross_revenue_performance_previous_fy_feb,gross_revenue_performance,"Performance Gross Revenue (Previous Fiscal Year, February)",The sum of gross revenue for 'Performance' deals (Run of Audience Extension) in February of the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH base_data AS (
    SELECT
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        t0.financial_month,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT SUM(gross_revenue_amount) FROM base_data WHERE relative_fy_year_offset = -1 AND SAFE_CAST(financial_month AS INT64) = 2 AND revenue_category = 'PERFORMANCE'",measure,False,medium,8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
financial_period_static_days_kargo,financial_period_dimension,Financial Period (Static Days) - Kargo,"A dimension representing the financial period (YearMonth) combined with a static number of days, filtered for 'Kargo' source and current month flag. Used for filtering and grouping data.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT CONCAT(SAFE_CAST(t0.StaticDays AS STRING),CONCAT(' (',SAFE_CAST(((t0.FinancialYear*100)+t0.FinancialMonthNumber) AS STRING)),' )') FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.CurrentMonthFlag = 1 AND t0.Source IN ('Kargo')",dimension,False,medium,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
financial_period_actual_days_non_adx,financial_period_dimension,Financial Period (Actual Days) - Non-AdX,"A dimension representing the financial period (YearMonth) combined with the actual number of days in the month, filtered for non-'AdX' sources and current month flag. Used for filtering and grouping data.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT CONCAT(SAFE_CAST(t0.NumDays AS STRING),CONCAT(' (',SAFE_CAST(((t0.FinancialYear*100)+t0.FinancialMonthNumber) AS STRING)),' )') FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.CurrentMonthFlag = 1 AND (t0.Source NOT IN ('AdX') OR t0.Source IS NULL)",dimension,False,medium,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
transaction_type_dimension,transaction_type_dimension,Transaction Type,A dimension representing the type of transaction. Used for filtering and grouping data.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT t0.TransactionType FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0,dimension,False,low,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
buyer_dimension_kargo,buyer_dimension,Buyer - Kargo,"A dimension representing the buyer, filtered for 'Kargo' source. Used for filtering and grouping data.",ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT t0.Buyer FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.Source IN ('Kargo'),dimension,False,medium,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
product_type_dimension,product_type_dimension,Product Type,A dimension representing the type of product. Used for filtering and grouping data.,ncau-data-newsquery-prd,prstn_advertising,programmatic_cal_month,SELECT t0.ProductType FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0,dimension,False,low,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
revenue_6m_prior_fy_equals_prior_year_current_month,revenue_pacing,Revenue (6M Prior to Financial Month = Prior Year Current Month),"Sum of RevenueNet where the financial month start date minus 6 months equals a fixed date (current month start date minus 1 year, based on '2025-05-12'), filtered for 'Kargo' source. Used for specific historical pacing comparisons.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT SUM(CASE WHEN (DATE(DATETIME_SUB(SAFE_CAST(DATE(t0.FinancialYear, t0.FinancialMonthNumber, 1) AS DATETIME), INTERVAL 6 MONTH)) = DATE(DATETIME_SUB(DATETIME_TRUNC(DATETIME(TIMESTAMP '2025-05-12 05:05:50.817324+00', 'UTC'), MONTH), INTERVAL 1 YEAR))) THEN t0.RevenueNet ELSE NULL END) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.Source IN ('Kargo')",measure,True,high,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
prorated_revenue_6m_prior_fy_equals_current_month,revenue_pacing,Prorated Revenue (6M Prior to Financial Month = Current Month),"Sum of Prorated Revenue (RevenueNet / NumDays * StaticDays) where the financial month start date minus 6 months equals a fixed date (current month start date, based on '2025-05-12'), filtered for 'Kargo' source. Used for specific historical pacing comparisons.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT SUM(CASE WHEN (DATE(DATETIME_SUB(SAFE_CAST(DATE(t0.FinancialYear, t0.FinancialMonthNumber, 1) AS DATETIME), INTERVAL 6 MONTH)) = DATE(DATETIME_TRUNC(DATETIME(TIMESTAMP '2025-05-12 05:05:50.817324+00', 'UTC'), MONTH))) THEN (SAFE_DIVIDE(t0.RevenueNet, t0.NumDays)*t0.StaticDays) ELSE NULL END) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.Source IN ('Kargo')",measure,True,high,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
revenue_6m_prior_fy_equals_prior_month_current_month,revenue_pacing,Revenue (6M Prior to Financial Month = Prior Month Current Month),"Sum of RevenueNet where the financial month start date minus 6 months equals a fixed date (current month start date minus 1 month, based on '2025-05-12'), filtered for 'Kargo' source. Used for specific historical pacing comparisons.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT SUM(CASE WHEN (DATE(DATETIME_SUB(SAFE_CAST(DATE(t0.FinancialYear, t0.FinancialMonthNumber, 1) AS DATETIME), INTERVAL 6 MONTH)) = DATE(DATETIME_SUB(DATETIME_TRUNC(DATETIME(TIMESTAMP '2025-05-12 05:05:50.817324+00', 'UTC'), MONTH), INTERVAL 1 MONTH))) THEN t0.RevenueNet ELSE NULL END) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.Source IN ('Kargo')",measure,True,high,9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
total_records_digital_b2c_aus_2025,total_records,"Total Records (Digital B2C, The Australian & Prestige, FY2025)","The total count of records (likely representing acquisitions or movements) filtered for Digital Subscriptions, B2C segment, The Australian and Prestige masthead group, for Fiscal Year 2025, with a valid acquisition source and not 'op' table_nm.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH pre_calculated_dims AS (
    SELECT
        t0.fy_year,
        t0.table_nm,
        t0.masthead,
        t0.sold_in_source_code,
        t0.delivery_medium_type,
        t0.subscriber_has_email_flag,
        t0.classification_level_2,
        -- Subscription Type Category
        CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category,
        -- Masthead Category Level 1
        CASE
            WHEN t0.masthead = 'TA' THEN 'The Australian'
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
            WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
            WHEN t0.masthead = 'WT' THEN 'Other Publications'
            WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
            WHEN t0.masthead IS NULL THEN 'check'
            ELSE 'Exclude'
        END AS masthead_category_level1,
        -- Masthead Category Level 2
        CASE
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
            WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
            WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
            WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
            ELSE 'Exclude'
        END AS masthead_category_level2,
        -- Acquisition Source Category
        CASE
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
            ELSE NULL
        END AS acquisition_source_category,
        -- Business Segment Category
        CASE
            WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
            WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
            ELSE 'Others'
        END AS business_segment_category
    FROM
        `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
SELECT
    COUNT(1) AS total_records
FROM
    pre_calculated_dims
WHERE
    pre_calculated_dims.masthead_category_level1 != 'Exclude'
    AND pre_calculated_dims.subscription_type_category = 'Digital Subscriptions'
    AND pre_calculated_dims.table_nm != 'op'
    AND pre_calculated_dims.acquisition_source_category IS NOT NULL
    AND pre_calculated_dims.masthead_category_level2 = 'The Australian and Prestige'
    AND pre_calculated_dims.fy_year = 2025
    AND pre_calculated_dims.business_segment_category IN ('B2C')
LIMIT 1",measure,True,high,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
sum_acquisition_count_digital_b2c_aus_2025,sum_acquisition_count,"Sum of Acquisition Count (Digital B2C, The Australian & Prestige, FY2025)","The sum of the 'acquisition_count' metric, filtered for Digital Subscriptions, B2C segment, The Australian and Prestige masthead group, for Fiscal Year 2025, with a valid acquisition source and not 'op' table_nm.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH pre_calculated_dims AS (
    SELECT
        t0.acquisition_count,
        t0.fy_year,
        t0.table_nm,
        t0.masthead,
        t0.sold_in_source_code,
        t0.delivery_medium_type,
        t0.subscriber_has_email_flag,
        t0.classification_level_2,
        -- Subscription Type Category
        CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category,
        -- Masthead Category Level 1
        CASE
            WHEN t0.masthead = 'TA' THEN 'The Australian'
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
            WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
            WHEN t0.masthead = 'WT' THEN 'Other Publications'
            WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
            WHEN t0.masthead IS NULL THEN 'check'
            ELSE 'Exclude'
        END AS masthead_category_level1,
        -- Masthead Category Level 2
        CASE
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
            WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
            WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
            WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
            ELSE 'Exclude'
        END AS masthead_category_level2,
        -- Acquisition Source Category
        CASE
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
            ELSE NULL
        END AS acquisition_source_category,
        -- Business Segment Category
        CASE
            WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
            WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
            ELSE 'Others'
        END AS business_segment_category
    FROM
        `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
SELECT
    SUM(pre_calculated_dims.acquisition_count) AS sum_acquisition_count
FROM
    pre_calculated_dims
WHERE
    pre_calculated_dims.masthead_category_level1 != 'Exclude'
    AND pre_calculated_dims.subscription_type_category = 'Digital Subscriptions'
    AND pre_calculated_dims.table_nm != 'op'
    AND pre_calculated_dims.acquisition_source_category IS NOT NULL
    AND pre_calculated_dims.masthead_category_level2 = 'The Australian and Prestige'
    AND pre_calculated_dims.fy_year = 2025
    AND pre_calculated_dims.business_segment_category IN ('B2C')
LIMIT 1",measure,True,high,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
sum_free_to_paid_conversions_digital_b2c_aus_2025,sum_free_to_paid_conversions,"Sum of Free to Paid Conversions (Digital B2C, The Australian & Prestige, FY2025)","The sum of the 'free_to_paid_conversion_count' metric, filtered for Digital Subscriptions, B2C segment, The Australian and Prestige masthead group, for Fiscal Year 2025, with a valid acquisition source and not 'op' table_nm.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH pre_calculated_dims AS (
    SELECT
        t0.free_to_paid_conversion_count,
        t0.fy_year,
        t0.table_nm,
        t0.masthead,
        t0.sold_in_source_code,
        t0.delivery_medium_type,
        t0.subscriber_has_email_flag,
        t0.classification_level_2,
        -- Subscription Type Category
        CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category,
        -- Masthead Category Level 1
        CASE
            WHEN t0.masthead = 'TA' THEN 'The Australian'
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
            WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
            WHEN t0.masthead = 'WT' THEN 'Other Publications'
            WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
            WHEN t0.masthead IS NULL THEN 'check'
            ELSE 'Exclude'
        END AS masthead_category_level1,
        -- Masthead Category Level 2
        CASE
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
            WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
            WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
            WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
            ELSE 'Exclude'
        END AS masthead_category_level2,
        -- Acquisition Source Category
        CASE
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
            ELSE NULL
        END AS acquisition_source_category,
        -- Business Segment Category
        CASE
            WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
            WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
            ELSE 'Others'
        END AS business_segment_category
    FROM
        `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
SELECT
    SUM(pre_calculated_dims.free_to_paid_conversion_count) AS sum_free_to_paid_conversions
FROM
    pre_calculated_dims
WHERE
    pre_calculated_dims.masthead_category_level1 != 'Exclude'
    AND pre_calculated_dims.subscription_type_category = 'Digital Subscriptions'
    AND pre_calculated_dims.table_nm != 'op'
    AND pre_calculated_dims.acquisition_source_category IS NOT NULL
    AND pre_calculated_dims.masthead_category_level2 = 'The Australian and Prestige'
    AND pre_calculated_dims.fy_year = 2025
    AND pre_calculated_dims.business_segment_category IN ('B2C')
LIMIT 1",measure,True,high,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
sum_30day_reactivations_digital_b2c_aus_2025,sum_30day_reactivations,"Sum of 30-Day Reactivations (Digital B2C, The Australian & Prestige, FY2025)","The sum of the 'reactivation_30day_acquisition_count' metric, filtered for Digital Subscriptions, B2C segment, The Australian and Prestige masthead group, for Fiscal Year 2025, with a valid acquisition source and not 'op' table_nm.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH pre_calculated_dims AS (
    SELECT
        t0.reactivation_30day_acquisition_count,
        t0.fy_year,
        t0.table_nm,
        t0.masthead,
        t0.sold_in_source_code,
        t0.delivery_medium_type,
        t0.subscriber_has_email_flag,
        t0.classification_level_2,
        -- Subscription Type Category
        CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category,
        -- Masthead Category Level 1
        CASE
            WHEN t0.masthead = 'TA' THEN 'The Australian'
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
            WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
            WHEN t0.masthead = 'WT' THEN 'Other Publications'
            WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
            WHEN t0.masthead IS NULL THEN 'check'
            ELSE 'Exclude'
        END AS masthead_category_level1,
        -- Masthead Category Level 2
        CASE
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
            WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
            WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
            WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
            ELSE 'Exclude'
        END AS masthead_category_level2,
        -- Acquisition Source Category
        CASE
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
            ELSE NULL
        END AS acquisition_source_category,
        -- Business Segment Category
        CASE
            WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
            WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
            ELSE 'Others'
        END AS business_segment_category
    FROM
        `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
SELECT
    SUM(pre_calculated_dims.reactivation_30day_acquisition_count) AS sum_30day_reactivations
FROM
    pre_calculated_dims
WHERE
    pre_calculated_dims.masthead_category_level1 != 'Exclude'
    AND pre_calculated_dims.subscription_type_category = 'Digital Subscriptions'
    AND pre_calculated_dims.table_nm != 'op'
    AND pre_calculated_dims.acquisition_source_category IS NOT NULL
    AND pre_calculated_dims.masthead_category_level2 = 'The Australian and Prestige'
    AND pre_calculated_dims.fy_year = 2025
    AND pre_calculated_dims.business_segment_category IN ('B2C')
LIMIT 1",measure,True,high,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
sum_switch_acquisitions_digital_b2c_aus_2025,sum_switch_acquisitions,"Sum of Switch Acquisitions (Digital B2C, The Australian & Prestige, FY2025)","The sum of the 'switch_acquisition_count' metric, filtered for Digital Subscriptions, B2C segment, The Australian and Prestige masthead group, for Fiscal Year 2025, with a valid acquisition source and not 'op' table_nm.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"WITH pre_calculated_dims AS (
    SELECT
        t0.switch_acquisition_count,
        t0.fy_year,
        t0.table_nm,
        t0.masthead,
        t0.sold_in_source_code,
        t0.delivery_medium_type,
        t0.subscriber_has_email_flag,
        t0.classification_level_2,
        -- Subscription Type Category
        CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category,
        -- Masthead Category Level 1
        CASE
            WHEN t0.masthead = 'TA' THEN 'The Australian'
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
            WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
            WHEN t0.masthead = 'WT' THEN 'Other Publications'
            WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
            WHEN t0.masthead IS NULL THEN 'check'
            ELSE 'Exclude'
        END AS masthead_category_level1,
        -- Masthead Category Level 2
        CASE
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
            WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
            WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
            WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
            ELSE 'Exclude'
        END AS masthead_category_level2,
        -- Acquisition Source Category
        CASE
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
            ELSE NULL
        END AS acquisition_source_category,
        -- Business Segment Category
        CASE
            WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
            WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
            ELSE 'Others'
        END AS business_segment_category
    FROM
        `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
SELECT
    SUM(pre_calculated_dims.switch_acquisition_count) AS sum_switch_acquisitions
FROM
    pre_calculated_dims
WHERE
    pre_calculated_dims.masthead_category_level1 != 'Exclude'
    AND pre_calculated_dims.subscription_type_category = 'Digital Subscriptions'
    AND pre_calculated_dims.table_nm != 'op'
    AND pre_calculated_dims.acquisition_source_category IS NOT NULL
    AND pre_calculated_dims.masthead_category_level2 = 'The Australian and Prestige'
    AND pre_calculated_dims.fy_year = 2025
    AND pre_calculated_dims.business_segment_category IN ('B2C')
LIMIT 1",measure,True,high,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
delivery_medium_type_category,delivery_medium_type_category,Subscription Type Category,Categorization of subscription delivery medium into 'Digital Subscriptions' or 'Print Subscriptions' based on the delivery medium type and subscriber email flag.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
LIMIT 1",dimension,False,medium,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
masthead_group_level1,masthead_group_level1,Masthead Category Level 1,"Primary categorization of mastheads into broad groups like 'The Australian', 'Metro', 'Regionals', 'Other Publications', 'Deep Niche Publications', 'check', or 'Exclude'.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE
        WHEN t0.masthead = 'TA' THEN 'The Australian'
        WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
        WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
        WHEN t0.masthead = 'WT' THEN 'Other Publications'
        WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
        WHEN t0.masthead IS NULL THEN 'check'
        ELSE 'Exclude'
    END AS masthead_category_level1
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
LIMIT 1",dimension,False,medium,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
masthead_group_level2,masthead_group_level2,Masthead Category Level 2,"Secondary categorization of mastheads into broader business-oriented groups like 'States and Community', 'The Australian and Prestige', 'Commercial Content', 'Free & Lifestyle', or 'Exclude'.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE
        WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
        WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
        WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
        WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
        ELSE 'Exclude'
    END AS masthead_category_level2
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
LIMIT 1",dimension,False,medium,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
sold_in_source_code_category,sold_in_source_code_category,Acquisition Source Category,"Categorization of the 'sold_in_source_code' field, indicating the marketing channel or specific campaign from which a subscription originated.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
        WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
        WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
        WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
        WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
        WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
        WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
        ELSE NULL
    END AS acquisition_source_category
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
LIMIT 1",dimension,False,medium,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
business_segment_category,business_segment_category,Business Segment Category,"Categorization of subscriber classification level 2 into 'B2C' (Business-to-Consumer), 'B2B' (Business-to-Business), or 'Others'.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE
        WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
        WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
        ELSE 'Others'
    END AS business_segment_category
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
LIMIT 1",dimension,False,medium,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
product_group_category,product_group_category,Product Group Category,"High-level categorization of products based on various flags and classifications, such as 'Core Consumer', 'B2B', 'Deep Niche Products', or 'Check for New Products'. This is a complex derived dimension.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE
        WHEN (
            (clmn30_value = 'Bundle 7 Day') OR (clmn30_value = 'Bundle 7 day and Other') OR (clmn30_value = 'Bundle Only') OR (clmn30_value = 'Bundle Weekend') OR (clmn30_value = 'Bundle Weekend Only') OR (clmn30_value = 'Digital') OR (clmn30_value = 'Digital Only') OR (clmn30_value = 'Essentials') OR (clmn30_value = 'Print 7 Day') OR (clmn30_value = 'Print 7 day and Other') OR (clmn30_value = 'Print Weekend') OR (clmn30_value = 'Print Weekend Only') OR (clmn30_value = '3rd Party and Others') OR (clmn30_value = '3rd Party and Other')
        ) THEN 'Core Consumer'
        WHEN (
            (clmn30_value = 'Campus') OR (clmn30_value = 'Corporate') OR (clmn30_value = 'Corporate IP') OR (clmn30_value = 'Corporate excluding IP') OR (clmn30_value = 'IP Access') OR (clmn30_value = 'SMB')
        ) THEN 'B2B'
        WHEN (
            (clmn30_value = 'Null') OR (clmn30_value = 'Apple Podcast: Crime X') OR (clmn30_value = 'Code') OR (clmn30_value = 'Education') OR (clmn30_value = 'Not Available 7 Day') OR (clmn30_value = 'Print Only') OR (clmn30_value = 'Punters') OR (clmn30_value = 'Racenet') OR (clmn30_value = 'Supercoach Plus') OR (clmn30_value = 'Taste Online') OR (clmn30_value = 'Wine Club')
        ) THEN 'Deep Niche Products'
        ELSE 'Check for New Products'
    END AS product_group_category
FROM (
    SELECT
        t0.budfor_product,
        t0.classification_level_1,
        t0.classification_level_2,
        t0.delivery_medium_type,
        t0.delivery_schedule_group,
        t0.dw_billing_system_code,
        t0.masthead,
        t0.table_nm,
        -- Intermediate calculation for clmn30_value based on Q5 logic
        CASE
            WHEN (CASE WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C' WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B' ELSE 'Others' END = 'B2B') THEN
                (CASE WHEN t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club') THEN 'Consumer' WHEN t0.classification_level_2 IN ('Campus Activation', 'Campus Sub') THEN 'Campus' WHEN t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital') THEN 'Corporate excluding IP' WHEN t0.classification_level_2 = 'Free Staff' THEN 'Staff' WHEN t0.classification_level_2 = 'IP Access' THEN 'Corporate IP' WHEN t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital') THEN 'Education' ELSE NULL END)
            WHEN (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END = 'Deep Niche Publications') THEN
                (CASE WHEN t0.masthead = 'AA' THEN 'The Advertiser' WHEN t0.masthead = 'AP' THEN 'Apple Podcast: Crime X' WHEN t0.masthead = 'CM' THEN 'Courier Mail' WHEN t0.masthead = 'CP' THEN 'Cairns Post' WHEN t0.masthead = 'CS' THEN 'Code' WHEN t0.masthead = 'DT' THEN 'Daily Telegraph' WHEN t0.masthead = 'GA' THEN 'Geelong' WHEN t0.masthead = 'GC' THEN 'Gold Coast' WHEN t0.masthead = 'HS' THEN 'Herald Sun' WHEN t0.masthead = 'NT' THEN 'NT News' WHEN t0.masthead = 'NW' THEN 'News.com.au' WHEN t0.masthead = 'PU' THEN 'Punters' WHEN t0.masthead = 'RN' THEN 'Racenet' WHEN t0.masthead = 'SC' THEN 'Supercoach Plus' WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead = 'TB' THEN 'Townsville' WHEN t0.masthead = 'TC' THEN 'Toowoomba' WHEN t0.masthead = 'TM' THEN 'The Mercury' WHEN t0.masthead = 'TS' THEN 'Taste Online' WHEN t0.masthead = 'WT' THEN 'Weekly Times' ELSE NULL END)
            WHEN (t0.dw_billing_system_code = 'WINE') THEN 'Wine Club'
            WHEN (t0.classification_level_1 = 'Offplatform - Paid') THEN '3rd Party and Other'
            WHEN (t0.table_nm IN ('budfor_cancel', 'budfor_acq')) THEN t0.budfor_product
            WHEN (CASE WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C' WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B' ELSE 'Others' END = 'Consumer') THEN
                (CASE WHEN (t0.delivery_medium_type = 'Not Available') THEN 'Digital' ELSE t0.delivery_medium_type END)
            WHEN (CASE WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C' WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B' ELSE 'Others' END = 'Education') THEN
                (CASE WHEN t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club') THEN 'Consumer' WHEN t0.classification_level_2 IN ('Campus Activation', 'Campus Sub') THEN 'Campus' WHEN t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital') THEN 'Corporate excluding IP' WHEN t0.classification_level_2 = 'Free Staff' THEN 'Staff' WHEN t0.classification_level_2 = 'IP Access' THEN 'Corporate IP' WHEN t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital') THEN 'Education' ELSE NULL END)
            ELSE
                (CASE WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C' WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B' ELSE 'Others' END)
        END AS clmn30_value
    FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
LIMIT 1",dimension,False,medium,10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
gross_revenue_cy,gross_revenue,Gross Revenue Current Fiscal Year,Total gross revenue generated in the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_cy FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,measure,True,high,11,155c4518-72bf-4309-a0e9-240dd564f421
gross_revenue_ly,gross_revenue,Gross Revenue Last Fiscal Year,Total gross revenue generated in the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_ly FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,measure,True,high,11,155c4518-72bf-4309-a0e9-240dd564f421
target_cy,target,Target Current Fiscal Year,The financial target set for the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.target ELSE 0 END) AS target_cy FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,measure,True,high,11,155c4518-72bf-4309-a0e9-240dd564f421
digital_revenue_ly_filtered,gross_revenue,Digital Revenue Last Fiscal Year (Filtered),"Gross revenue from digital sources in the last fiscal year, subject to specific date and category filters (Digital Other, not Doubleclick, etc.). This metric is used for specific reporting periods and digital segments.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT
  SUM(
    CASE
      WHEN t0.relative_fy_year_offset = -1
      AND (
        CASE
          WHEN (
            t0.revenue_type = 'DIGITAL'
            AND t0.revenue_group_subtype = 'DIGITAL'
            AND t0.sales_segment_l_2_name_sync = 'Digital Other'
            AND t0.advertiser_parent != 'DOUBLECLICK'
          ) THEN SAFE_CAST(t0.fix_date_lod AS DATETIME)
          ELSE SAFE_CAST(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) AS DATETIME)
        END
      ) <= DATETIME_ADD(SAFE_CAST(DATE(TIMESTAMP '2025-06-26 22:29:53.217363+00', 'Australia/Sydney') AS DATETIME), INTERVAL -365 DAY)
      THEN t0.gross_revenue_amount
      ELSE 0
    END
  ) AS digital_revenue_ly_filtered
FROM
  `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0",measure,False,medium,11,155c4518-72bf-4309-a0e9-240dd564f421
gross_revenue_cy_cq,gross_revenue,Gross Revenue Current Fiscal Year Current Quarter,Total gross revenue generated in the current quarter of the current fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 AND t0.relative_fy_quarter_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_cy_cq FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,measure,True,high,11,155c4518-72bf-4309-a0e9-240dd564f421
gross_revenue_ly_cq,gross_revenue,Gross Revenue Last Fiscal Year Current Quarter,Total gross revenue generated in the same quarter of the previous fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 AND t0.relative_fy_quarter_offset = -4 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_ly_cq FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,measure,True,high,11,155c4518-72bf-4309-a0e9-240dd564f421
target_cq,target,Target Current Fiscal Quarter,The financial target set for the current fiscal quarter.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_quarter_offset = 0 THEN t0.target ELSE 0 END) AS target_cq FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,measure,True,high,11,155c4518-72bf-4309-a0e9-240dd564f421
product_group_count,record_count,Count of Records by Product Group,"A count of records, typically used to understand the distribution of data across different product groups, often under specific filters (e.g., by GSD or revenue type).",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT COUNT(*) AS product_group_count FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,aggregation,False,low,11,155c4518-72bf-4309-a0e9-240dd564f421
sales_segment_gm_name_sync,sales_segment_gm_name_sync,Sales Segment GM Name,The name of the General Manager for the sales segment.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.sales_segment_gm_name_sync FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,dimension,False,medium,11,155c4518-72bf-4309-a0e9-240dd564f421
financial_short_month,financial_short_month,Financial Short Month,"The abbreviated name of the financial month (e.g., 'Jul', 'Aug').",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.financial_short_month FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0,dimension,False,low,11,155c4518-72bf-4309-a0e9-240dd564f421
fiscal_week_id_dimension,fiscal_week_id,Fiscal Week ID,Identifier for the fiscal week.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT fiscal_week_id FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` WHERE SAFE_CAST(LEFT(SAFE_CAST(fiscal_week_id AS STRING), 4) AS INT64) = 2025",dimension,False,low,12,c441950c-1e3f-432c-9838-847d1d315b9e
sales_channel_l4_dimension,sales_channel_l4,Sales Channel Level 4,Fourth level of sales channel categorization.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT sales_channel_l4 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`,dimension,False,low,12,c441950c-1e3f-432c-9838-847d1d315b9e
scenario_dimension,scenario,Scenario,"Scenario type (e.g., Estimate, Actual).",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT scenario FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`,dimension,False,low,12,c441950c-1e3f-432c-9838-847d1d315b9e
returns_route_volume,route_volume_total,Returns Route Volume,The volume of routes categorized as 'RETURNS'.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT SUM(CASE WHEN ci.charge_type = 'RETURNS' THEN ci.route_volume ELSE 0 END) AS returns_route_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci LEFT JOIN `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal ON ci.charge_date = cal.calendar_date WHERE SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025",measure,False,medium,12,c441950c-1e3f-432c-9838-847d1d315b9e
day_of_week_dimension,day_of_week,Day of Week,The day of the week for the charge date.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT day_of_week FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`,dimension,False,low,12,c441950c-1e3f-432c-9838-847d1d315b9e
sales_channel_l5_dimension,sales_channel_l5,Sales Channel Level 5,Fifth level of sales channel categorization.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT sales_channel_l5 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`,dimension,False,low,12,c441950c-1e3f-432c-9838-847d1d315b9e
draw_route_volume,route_volume_total,Draw Route Volume,The volume of routes categorized as 'DRAW'.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT SUM(CASE WHEN ci.charge_type = 'DRAW' THEN ci.route_volume ELSE 0 END) AS draw_route_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci LEFT JOIN `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal ON ci.charge_date = cal.calendar_date WHERE SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025",measure,False,medium,12,c441950c-1e3f-432c-9838-847d1d315b9e
publication_name_dimension,gl_publication_code_mapping,Publication Name,Categorized publication name based on GL publication code.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT CASE WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('500', '560') THEN 'ADV' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '100' THEN 'AUS' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('400', '402') THEN 'CM' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9504' THEN 'Delicious' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9505' THEN 'Delicious Specials' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('110', '116') THEN 'DT' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '350' THEN 'GAD' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '670' THEN 'GCB' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '180' THEN 'Group Shared Services' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '156' THEN 'Hobart Print Services' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('301', '303') THEN 'HS' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5003' THEN 'MDM' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('850', '852') THEN 'MERCURY' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('961', '963') THEN 'NTN' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '158' THEN 'Perth Print Services' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = 'Post Courier' THEN 'Post Courier' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5024' THEN 'SC' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('9514', '9515') THEN 'Taste' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5053' THEN 'TCHRN' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '450' THEN 'TCP' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '475' THEN 'TVB' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9560' THEN 'Vogue' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9556' THEN 'Vogue Living' WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '305' THEN 'WT' ELSE 'Other' END AS publication_name FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci",calculated_field,False,medium,12,c441950c-1e3f-432c-9838-847d1d315b9e
adjustment_route_volume,route_volume_total,Adjustment Route Volume,The volume of routes categorized as 'ADJUSTMENT'.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT SUM(CASE WHEN ci.charge_type = 'ADJUSTMENT' THEN ci.route_volume ELSE 0 END) AS adjustment_route_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci LEFT JOIN `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal ON ci.charge_date = cal.calendar_date WHERE SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025",measure,False,medium,12,c441950c-1e3f-432c-9838-847d1d315b9e
total_route_volume_draw_adj_returns,route_volume_total,Total Route Volume (Draw + Adjustment + Returns),"The sum of route volumes for 'DRAW', 'ADJUSTMENT', and 'RETURNS' charge types.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT SUM(CASE WHEN ci.charge_type = 'DRAW' THEN ci.route_volume ELSE 0 END + CASE WHEN ci.charge_type = 'ADJUSTMENT' THEN ci.route_volume ELSE 0 END + CASE WHEN ci.charge_type = 'RETURNS' THEN ci.route_volume ELSE 0 END) AS total_route_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci LEFT JOIN `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal ON ci.charge_date = cal.calendar_date WHERE SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025",measure,True,high,12,c441950c-1e3f-432c-9838-847d1d315b9e
total_charge_amount,charge_amount_total,Total Charge Amount,The total monetary charge amount.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,"SELECT SUM(ci.charge_amount) AS total_charge_amount FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci LEFT JOIN `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal ON ci.charge_date = cal.calendar_date WHERE SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025",measure,True,high,12,c441950c-1e3f-432c-9838-847d1d315b9e
gross_revenue_base,gross_revenue,Gross Revenue (Base),The raw gross revenue amount before any specific filtering or adjustments.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(t0.gross_revenue_amount) AS gross_revenue_base FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
gross_revenue_previous_fy,gross_revenue,Gross Revenue - Previous FY,"Gross revenue for the previous financial year, based on the 'relative_fy_year_offset' field being -1.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_previous_fy FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
gross_revenue_current_fy,gross_revenue,Gross Revenue - Current FY,"Gross revenue for the current financial year, based on the 'relative_fy_year_offset' field being 0.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_current_fy FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
gross_revenue_previous_fy_k_adjusted,gross_revenue,Gross Revenue - Previous FY (K Adjusted),"Gross revenue for the previous financial year, divided by 1000 (K adjusted). The original query's parameter for this adjustment ('$\'000' = '$') evaluates to FALSE, so the division by 1000 is always applied.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS gross_revenue_previous_fy_k_adjusted FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
gross_revenue_current_fy_k_adjusted,gross_revenue,Gross Revenue - Current FY (K Adjusted),"Gross revenue for the current financial year, divided by 1000 (K adjusted). The original query's parameter for this adjustment ('$\'000' = '$') evaluates to FALSE, so the division by 1000 is always applied.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS gross_revenue_current_fy_k_adjusted FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
gross_revenue_specific_filtered_k_adjusted,gross_revenue,Gross Revenue - Specific Filtered (K Adjusted),"Gross revenue for the previous financial year (-1 offset), filtered by a complex date condition and digital revenue attributes, then divided by 1000 (K adjusted). The date condition checks if a derived date (based on revenue type/subtype/segment or booking date) is less than or equal to a fixed date (2025-04-02) minus 365 days.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT
  SUM(SAFE_DIVIDE(
    CASE
      WHEN (
        t0.relative_fy_year_offset = -1
        AND (
          CASE
            WHEN (
              t0.revenue_type = 'DIGITAL'
              AND t0.revenue_group_subtype = 'DIGITAL'
              AND t0.sales_segment_l_2_name_sync = 'Digital Other'
              AND t0.advertiser_parent != 'DOUBLECLICK'
            ) THEN t0.fix_date_lod
            ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)
          END
        ) <= DATETIME_ADD(DATE(TIMESTAMP '2025-04-02 23:25:34.704992+00', 'Australia/Sydney'), INTERVAL -365 DAY)
      ) THEN t0.gross_revenue_amount
      ELSE 0
    END, 1000
  )) AS gross_revenue_specific_filtered_k_adjusted
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
sales_group,sales_group,Sales Group,The sales group associated with the sales record.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.Sales_Group AS sales_group FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,dimension,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
advertiser_name,advertiser_name,Advertiser Name,The name of the advertiser.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.advertiser_name AS advertiser_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,dimension,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
portfolio_conformed_name,portfolio_conformed_name,Portfolio Conformed Name,The conformed name of the portfolio.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.portfolio_conformed_name_sync AS portfolio_conformed_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,dimension,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
sales_segment_l2_name,sales_segment_l2_name,Sales Segment L2 Name,The Level 2 name of the sales segment.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.sales_segment_l_2_name_sync AS sales_segment_l2_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,dimension,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
publishing_division_parent,publishing_division_parent,Publishing Division Parent,The parent publishing division.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.publishing_division_parent AS publishing_division_parent FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,dimension,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
month_quarter_half,time_period_classification,Month Quarter Half,"A concatenated string representing the financial short month, financial quarter (e.g., 'Q1'), and financial half (H1/H2).",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT
  CONCAT(
    SAFE_CAST(t0.financial_short_month AS STRING),
    ' ',
    CONCAT('Q',SAFE_CAST(SAFE_CAST(t0.financial_quarter AS INT64) AS STRING)),
    ' ',
    CASE
      WHEN (SAFE_CAST(t0.financial_quarter AS INT64) >= 1 AND SAFE_CAST(t0.financial_quarter AS INT64) <= 2) THEN 'H1'
      WHEN (SAFE_CAST(t0.financial_quarter AS INT64) >= 3 AND SAFE_CAST(t0.financial_quarter AS INT64) <= 4) THEN 'H2'
      ELSE SAFE_CAST(SAFE_CAST(t0.financial_quarter AS INT64) AS STRING)
    END
  ) AS month_quarter_half
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",derived_dimension,False,low,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
dynamic_dimension_publishing_division_group,dynamic_dimension,Dynamic Dimension (Publishing Division Group),"A dynamic dimension that selects different fields based on a parameter. In the provided query, the parameter is hardcoded to '2', resulting in 'publishing_division_group'.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT
  CASE
    WHEN ('2' = '1') THEN t0.publishing_division_parent
    WHEN ('2' = '2') THEN t0.publishing_division_group
    WHEN ('2' = '3') THEN t0.publishing_division
    WHEN ('2' = '4') THEN t0.unified_publication_name
    WHEN ('2' = '5') THEN t0.classification_name
    WHEN ('2' = '6') THEN t0.agency_parent
    WHEN ('2' = '7') THEN t0.agency_group
    ELSE NULL
  END AS dynamic_dimension_publishing_division_group
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",derived_dimension,False,low,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
revenue_classification,revenue_classification,Revenue Classification,"A derived classification of revenue based on various fields like cost model type, ad type, portfolio group, and revenue group subtype.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT
  CASE
    WHEN t0.fin_adtype_name = 'XTEND' THEN 'XTEND'
    WHEN (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_group_subtype = 'DIGITAL') THEN 'PROGRAMMATIC - DIGITAL OTHER'
    WHEN t0.revenue_group_subtype = 'PROGRAMMATIC EXCHANGE' THEN 'PROGRAMMATIC - DIGITAL OTHER OFFSET'
    WHEN SAFE.LEFT(t0.cost_model_type, 3) = 'GUA' THEN 'PROGRAMMATIC - GUARANTEED'
    WHEN SAFE.LEFT(t0.cost_model_type, 3) = 'NON' THEN 'PROGRAMMATIC - OPEN EXCHANGE'
    WHEN SAFE.LEFT(t0.cost_model_type, 3) = 'PMP' THEN 'PROGRAMMATIC - PMP'
    WHEN t0.revenue_group_subtype = 'DIGITAL' THEN 'ADPT DIGITAL'
    WHEN SAFE.LEFT(t0.revenue_group_subtype, 6) = 'SUNDRY' THEN 'SUNDRY'
    ELSE t0.revenue_group_subtype
  END AS revenue_classification
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",derived_dimension,False,medium,13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
dim_product_group,product_group,Product Group,The product grouping for the advertisement.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.product_group FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.product_group,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_unified_publication_name,unified_publication_name,Unified Publication Name,The unified name of the publication where the ad appeared.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.unified_publication_name FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.unified_publication_name,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_publishing_division_parent,publishing_division_parent,Publishing Division Parent,The parent division responsible for the publication.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.publishing_division_parent FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.publishing_division_parent,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_sales_segment_gm_name_sync,sales_segment_gm_name_sync,Sales Segment GM Name Sync,The synchronized sales segment name for General Managers.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.sales_segment_gm_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.sales_segment_gm_name_sync,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_financial_short_month_mapped,financial_short_month,Financial Short Month (Mapped),"The financial month, mapped to a sortable string (e.g., '1.Jul', '2.Aug').",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT CASE WHEN t0.financial_short_month = 'Jul' THEN '1.Jul' WHEN t0.financial_short_month = 'Aug' THEN '2.Aug' WHEN t0.financial_short_month = 'Sep' THEN '3.Sep' WHEN t0.financial_short_month = 'Oct' THEN '4.Oct' WHEN t0.financial_short_month = 'Nov' THEN '5.Nov' WHEN t0.financial_short_month = 'Dec' THEN '6.Dec' WHEN t0.financial_short_month = 'Jan' THEN '7.Jan' WHEN t0.financial_short_month = 'Feb' THEN '8.Feb' WHEN t0.financial_short_month = 'Mar' THEN '9.Mar' WHEN t0.financial_short_month = 'Apr' THEN '10.Apr' WHEN t0.financial_short_month = 'May' THEN '11.May' WHEN t0.financial_short_month = 'Jun' THEN '12.Jun' ELSE NULL END AS financial_short_month_mapped FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY financial_short_month_mapped,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_financial_year,financial_year,Financial Year,The financial year of the record.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.financial_year FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.financial_year,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_financial_quarter,financial_quarter,Financial Quarter,The financial quarter of the record.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SAFE_CAST(t0.financial_quarter AS INT64) AS financial_quarter FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY financial_quarter,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_relative_fy_month_offset,relative_fy_month_offset,Relative FY Month Offset,"The offset of the financial month relative to the current period (e.g., 0 for current month, -1 for previous month).",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.relative_fy_month_offset FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.relative_fy_month_offset,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_relative_fy_year_offset,relative_fy_year_offset,Relative FY Year Offset,"The offset of the financial year relative to the current period (e.g., 0 for current year, -1 for previous year, 1 for next year).",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.relative_fy_year_offset FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.relative_fy_year_offset,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_sales_segment_l_2_name_sync,sales_segment_l_2_name_sync,Sales Segment L2 Name Sync,The synchronized Level 2 sales segment name.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT t0.sales_segment_l_2_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY t0.sales_segment_l_2_name_sync,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
dim_revenue_type_xtend_flagged,revenue_type,Revenue Type (XTEND Flagged),"The revenue type, with 'XTEND' replacing the original type if the xtend_flag is 'Y'.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT CASE WHEN t0.xtend_flag = 'Y' THEN 'XTEND' ELSE t0.revenue_type END AS revenue_type_xtend_flagged FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 GROUP BY revenue_type_xtend_flagged,dimension,False,low,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_total,gross_revenue_amount,Gross Revenue Amount (Total),The total gross revenue amount.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(t0.gross_revenue_amount) AS gross_revenue_amount_total FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_current_fy,gross_revenue_amount,Gross Revenue Amount (Current FY),The gross revenue amount for the current financial year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_amount_current_fy FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_current_fy_k,gross_revenue_amount,"Gross Revenue Amount (Current FY, K)","The gross revenue amount for the current financial year, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) AS gross_revenue_amount_current_fy_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_previous_fy,gross_revenue_amount,Gross Revenue Amount (Previous FY),The gross revenue amount for the previous financial year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_amount_previous_fy FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_previous_fy_k,gross_revenue_amount,"Gross Revenue Amount (Previous FY, K)","The gross revenue amount for the previous financial year, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) AS gross_revenue_amount_previous_fy_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_current_fy_not_future_k,gross_revenue_amount,"Gross Revenue Amount (Current FY, Not Future, K)","The gross revenue amount for the current financial year, excluding future periods, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 AND t0.is_future_period_flag = 'N' THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) AS gross_revenue_amount_current_fy_not_future_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_next_fy_k,gross_revenue_amount,"Gross Revenue Amount (Next FY, K)","The gross revenue amount for the next financial year, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) AS gross_revenue_amount_next_fy_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,False,medium,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_previous_fy_date_condition,gross_revenue_amount,"Gross Revenue Amount (Previous FY, Date Condition)","The gross revenue amount for the previous financial year, subject to a specific date condition (booking date <= 365 days prior to a fixed dashboard date).",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 AND SAFE_CAST(CASE WHEN (t0.revenue_type = 'DIGITAL' AND t0.revenue_group_subtype = 'DIGITAL' AND t0.sales_segment_l_2_name_sync = 'Digital Other' AND t0.advertiser_parent != 'DOUBLECLICK') THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-01-06 02:37:12.747676+00', 'UTC'), INTERVAL -365 DAY) THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_amount_previous_fy_date_condition FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,False,medium,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_previous_fy_date_condition_k,gross_revenue_amount,"Gross Revenue Amount (Previous FY, Date Condition, K)","The gross revenue amount for the previous financial year, subject to a specific date condition (booking date <= 365 days prior to a fixed dashboard date), in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = -1 AND SAFE_CAST(CASE WHEN (t0.revenue_type = 'DIGITAL' AND t0.revenue_group_subtype = 'DIGITAL' AND t0.sales_segment_l_2_name_sync = 'Digital Other' AND t0.advertiser_parent != 'DOUBLECLICK') THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-01-06 02:37:12.747676+00', 'UTC'), INTERVAL -365 DAY) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS gross_revenue_amount_previous_fy_date_condition_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,False,medium,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_gross_revenue_amount_current_fy_k_minus_ss_lgb_current_fy_k,gross_revenue_amount_minus_ss_lgb,"Gross Revenue (Current FY, K) - SS LGB (Current FY, K)","The difference between current financial year gross revenue and current financial year SS LGB, both in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM( (CASE WHEN t0.relative_fy_year_offset = 0 THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) - (CASE WHEN t0.relative_fy_year_offset = 0 THEN SAFE_DIVIDE(t0.ss_lgb, 1000) ELSE 0 END) ) AS gross_revenue_amount_current_fy_k_minus_ss_lgb_current_fy_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",calculated_field,False,medium,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_ss_lgb_total,ss_lgb,SS LGB (Total),The total SS LGB (Sales Segment Look-Back Gross) amount.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(t0.ss_lgb) AS ss_lgb_total FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_ss_lgb_current_fy_k,ss_lgb,"SS LGB (Current FY, K)","The SS LGB amount for the current financial year, in thousands.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN SAFE_DIVIDE(t0.ss_lgb, 1000) ELSE 0 END) AS ss_lgb_current_fy_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_ss_lgb_current_fy_negative_week_offset,ss_lgb,"SS LGB (Current FY, Negative Week Offset)",The SS LGB amount for the current financial year where the relative financial week offset is negative.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 AND t0.relative_fy_week_offset < 0 THEN t0.ss_lgb ELSE 0 END) AS ss_lgb_current_fy_negative_week_offset FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,False,medium,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_ss_lgb_current_fy_zero_week_offset_derived,ss_lgb,"SS LGB (Current FY, Zero Week Offset, Derived)","A derived SS LGB amount for the current financial year where the relative financial week offset is zero, calculated as (ss_lgb * DOW_Today) / 7.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 AND t0.relative_fy_week_offset = 0 THEN SAFE_DIVIDE((t0.ss_lgb * t0.DOW_Today), 7) ELSE 0 END) AS ss_lgb_current_fy_zero_week_offset_derived FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",calculated_field,False,medium,14,4d8074b2-17a8-48ba-babe-c536359b1f64
meas_pipeline_total,pipeline,Pipeline (Total),The total pipeline amount.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(t0.pipeline) AS pipeline_total FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,14,4d8074b2-17a8-48ba-babe-c536359b1f64
gross_revenue_excl_adj_total,gross_revenue_excl_adj,Gross Revenue Excl. Adjustment (Total),"Total gross revenue excluding adjustments, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND financial_year IN ('2025'))",measure,False,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_excl_adj_rebate3_filtered,gross_revenue_excl_adj,Gross Revenue Excl. Adjustment (Rebate 3 Filtered),"Total gross revenue excluding adjustments, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_excl_adj_rebate2_filtered,gross_revenue_excl_adj,Gross Revenue Excl. Adjustment (Rebate 2 Filtered),"Total gross revenue excluding adjustments, specifically for transactions where Rebate 2 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_2_amount != 0.000000 AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_excl_adj_account_filtered,gross_revenue_excl_adj,Gross Revenue Excl. Adjustment (Account 4039072),"Total gross revenue excluding adjustments for a specific account ('4039072'), filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND account_number = '4039072' AND financial_year IN ('2025'))",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_excl_adj_rebate3_oct_2025,gross_revenue_excl_adj,"Gross Revenue Excl. Adjustment (Rebate 3 Filtered, Oct 2025)","Total gross revenue excluding adjustments for October 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 10.000000)",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_excl_adj_rebate3_sep_2025,gross_revenue_excl_adj,"Gross Revenue Excl. Adjustment (Rebate 3 Filtered, Sep 2025)","Total gross revenue excluding adjustments for September 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 9.000000)",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
rebate_3_amount_total,rebate_3_amount,Rebate 3 Amount (Total),"Total amount of Rebate 3, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(rebate_3_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
rebate_3_amount_oct_2025,rebate_3_amount,Rebate 3 Amount (Oct 2025),"Total amount of Rebate 3 for October 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(rebate_3_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 10.000000)",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
rebate_3_amount_sep_2025,rebate_3_amount,Rebate 3 Amount (Sep 2025),"Total amount of Rebate 3 for September 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(rebate_3_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 9.000000)",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
adjustment_amount_total,adjustment_amount,Adjustment Amount (Total),"Total adjustment amount, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND financial_year IN ('2025'))",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
adjustment_amount_rebate3_filtered,adjustment_amount,Adjustment Amount (Rebate 3 Filtered),"Total adjustment amount, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025'))",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
adjustment_amount_rebate2_filtered,adjustment_amount,Adjustment Amount (Rebate 2 Filtered),"Total adjustment amount, specifically for transactions where Rebate 2 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_2_amount != 0.000000 AND financial_year IN ('2025'))",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
adjustment_amount_account_filtered,adjustment_amount,Adjustment Amount (Account 4039072),"Total adjustment amount for a specific account ('4039072'), filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND account_number = '4039072' AND financial_year IN ('2025'))",measure,False,low,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
adjustment_amount_rebate3_oct_2025,adjustment_amount,"Adjustment Amount (Rebate 3 Filtered, Oct 2025)","Total adjustment amount for October 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 10.000000)",measure,False,low,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
adjustment_amount_rebate3_sep_2025,adjustment_amount,"Adjustment Amount (Rebate 3 Filtered, Sep 2025)","Total adjustment amount for September 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(adjustment_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 9.000000)",measure,False,low,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_total,gross_revenue,Gross Revenue (Total),"Total gross revenue, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_rebate3_filtered,gross_revenue,Gross Revenue (Rebate 3 Filtered),"Total gross revenue, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_rebate2_filtered,gross_revenue,Gross Revenue (Rebate 2 Filtered),"Total gross revenue, specifically for transactions where Rebate 2 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_2_amount != 0.000000 AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_account_filtered,gross_revenue,Gross Revenue (Account 4039072),"Total gross revenue for a specific account ('4039072'), filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND account_number = '4039072' AND financial_year IN ('2025'))",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_rebate3_oct_2025,gross_revenue,"Gross Revenue (Rebate 3 Filtered, Oct 2025)","Total gross revenue for October 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 10.000000)",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
gross_revenue_rebate3_sep_2025,gross_revenue,"Gross Revenue (Rebate 3 Filtered, Sep 2025)","Total gross revenue for September 2025, specifically for transactions where Rebate 3 amount is not zero, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_3_amount != 0.000000 AND financial_year IN ('2025') AND SAFE_CAST(financial_month AS FLOAT64) = 9.000000)",measure,False,medium,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
rebate_2_amount_total,rebate_2_amount,Rebate 2 Amount (Total),"Total amount of Rebate 2, specifically for transactions where Rebate 2 amount is not zero, filtered by common dashboard criteria for 'Booked'/'Billed' status, specific publishing divisions, revenue types, and revenue group subtypes for the year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(rebate_2_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND rebate_2_amount != 0.000000 AND financial_year IN ('2025'))",measure,True,high,15,a17622e2-ad43-49cc-b3c5-19c95036fd14
total_revenue_net_by_month_source_filtered_advertiser_fy_q,total_revenue_net,"Total Revenue Net by Month and Source (Filtered by Advertiser, FY/Q)","The sum of net revenue, grouped by the adjusted financial month and source, specifically for 'The Smith Family *' advertiser, within FY25 Q2-Q4, and for specific sources (DFP, Index Exchange, Rubicon). Dates are adjusted by subtracting 6 months from the financial year/month date.",ncau-data-newsquery-prd,prstn_advertising,programmatic_weekly_master,"SELECT
  SUM(t0.revenuenet) AS total_revenue_net,
  SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) AS financial_month_adjusted,
  t0.source
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
  t0.source IN ('AdX', 'AppNexus', 'DFP', 'Index Exchange', 'InSkin', 'Kargo', 'Playground XYZ', 'PubMatic', 'Rubicon', 'Tremor')
  AND UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
  AND t0.advertiser IN ('The Smith Family *')
  AND CONCAT('FY',SUBSTR(SAFE_CAST(t0.financialyear AS STRING), 3, 2),' ',SAFE_CAST(t0.financialquarter AS STRING)) IN ('FY25 Q2', 'FY25 Q3', 'FY25 Q4')
  AND SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) IN (DATE '2024-11-01', DATE '2024-12-01', DATE '2025-01-01', DATE '2025-02-01', DATE '2025-03-01', DATE '2025-04-01', DATE '2025-05-01', DATE '2025-06-01')
  AND t0.source IN ('DFP', 'Index Exchange', 'Rubicon')
GROUP BY
  financial_month_adjusted,
  t0.source
ORDER BY
  financial_month_adjusted ASC
LIMIT 2000001;",measure,True,high,16,783f341c-8660-4e90-bab8-9bc860119cf5
total_revenue_net_by_source_filtered_transaction_type,total_revenue_net,Total Revenue Net by Source (Filtered by Transaction Type),"The sum of net revenue, grouped by source, filtered to include specific transaction types (DEAL, UFR, PG - CPD, PG - CPM, DIRECT) and a predefined list of sources.",ncau-data-newsquery-prd,prstn_advertising,programmatic_weekly_master,"SELECT
  SUM(t0.revenuenet) AS total_revenue_net,
  t0.source
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
  t0.source IN ('AdX', 'AppNexus', 'DFP', 'Index Exchange', 'InSkin', 'Kargo', 'Playground XYZ', 'PubMatic', 'Rubicon', 'Tremor')
  AND UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
GROUP BY
  t0.source
ORDER BY
  total_revenue_net DESC
LIMIT 2000001;",measure,True,high,16,783f341c-8660-4e90-bab8-9bc860119cf5
buyer_list_filtered_advertiser_fy_q_month,buyer_list,"Buyer List (Filtered by Advertiser, FY/Q, Month)","A list of unique buyers, filtered by specific transaction types, financial quarter (FY25 Q4), a specific month (May 2025), and specific advertisers ('Kmart Corporation *', 'Target Corporation *').",ncau-data-newsquery-prd,prstn_advertising,programmatic_weekly_master,"SELECT
  t0.buyer
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
  UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
  AND CONCAT('FY',SUBSTR(SAFE_CAST(t0.financialyear AS STRING), 3, 2),' ',SAFE_CAST(t0.financialquarter AS STRING)) IN ('FY25 Q4')
  AND SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) IN (DATE '2025-05-01')
  AND t0.advertiser IN ('Kmart Corporation *', 'Target Corporation *')
GROUP BY
  t0.buyer
ORDER BY
  t0.buyer DESC
LIMIT 2000001;",dimension,False,medium,16,783f341c-8660-4e90-bab8-9bc860119cf5
total_revenue_net_by_month_source_filtered_transaction_type_wide_date,total_revenue_net,"Total Revenue Net by Month and Source (Filtered by Transaction Type, Wide Date Range)","The sum of net revenue, grouped by the adjusted financial month and source, filtered by specific transaction types and a wide range of adjusted financial months (April 2023 to April 2025). Dates are adjusted by subtracting 6 months from the financial year/month date.",ncau-data-newsquery-prd,prstn_advertising,programmatic_weekly_master,"SELECT
  SUM(t0.revenuenet) AS total_revenue_net,
  SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) AS financial_month_adjusted,
  t0.source
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
  t0.source IN ('AdX', 'AppNexus', 'DFP', 'Index Exchange', 'InSkin', 'Kargo', 'Playground XYZ', 'PubMatic', 'Rubicon', 'Tremor')
  AND UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
  AND SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) IN (DATE '2023-04-01', DATE '2023-05-01', DATE '2023-06-01', DATE '2023-07-01', DATE '2023-08-01', DATE '2023-09-01', DATE '2023-10-01', DATE '2023-11-01', DATE '2023-12-01', DATE '2024-01-01', DATE '2024-02-01', DATE '2024-03-01', DATE '2024-04-01', DATE '2024-05-01', DATE '2024-06-01', DATE '2024-07-01', DATE '2024-08-01', DATE '2024-09-01', DATE '2024-10-01', DATE '2024-11-01', DATE '2024-12-01', DATE '2025-01-01', DATE '2025-02-01', DATE '2025-03-01', DATE '2025-04-01')
GROUP BY
  financial_month_adjusted,
  t0.source
ORDER BY
  financial_month_adjusted ASC
LIMIT 2000001;",measure,True,high,16,783f341c-8660-4e90-bab8-9bc860119cf5
buyer_list_filtered_advertiser_myer_fy_q_month,buyer_list,"Buyer List (Filtered by Advertiser including Myer, FY/Q, Month)","A list of unique buyers, filtered by specific transaction types, financial quarter (FY25 Q4), a specific month (May 2025), and specific advertisers ('Kmart Corporation *', 'Myer *', 'Target Corporation *'). This is a variation of the previous buyer list with an additional advertiser.",ncau-data-newsquery-prd,prstn_advertising,programmatic_weekly_master,"SELECT
  t0.buyer
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
  UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
  AND CONCAT('FY',SUBSTR(SAFE_CAST(t0.financialyear AS STRING), 3, 2),' ',SAFE_CAST(t0.financialquarter AS STRING)) IN ('FY25 Q4')
  AND SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) IN (DATE '2025-05-01')
  AND t0.advertiser IN ('Kmart Corporation *', 'Myer *', 'Target Corporation *')
GROUP BY
  t0.buyer
ORDER BY
  t0.buyer DESC
LIMIT 2000001;",dimension,False,medium,16,783f341c-8660-4e90-bab8-9bc860119cf5
total_gross_revenue_video_fy2025,total_gross_revenue,Total Gross Revenue for Video Ad Types (FY2025),"The sum of gross revenue for 'Booked' or 'Billed' transactions, specifically for video-related ad types, excluding certain internal/admin publications and 'Medium Rare Content Agency', for the financial year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.gross_revenue_amount) AS total_gross_revenue_video_fy2025 FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) AND t0.publication_name NOT IN ('Vogueliving.Admin', 'Vogue.Admin', 'ADMIN.ADV', 'ADMIN.DTM', 'ADMIN.HWT', 'ADMIN.SALES', 'ADMIN.SPORT', 'VOGUELIVING.ADMIN', 'VOGUE.ADMIN', 'Taste.Admin', 'TAUS.ADMIN', 'TASTE.ADMIN', 'STELLAR.ADMIN', 'ADMIN.TCM', 'NEWS.ADMIN', 'SKYNEWS.ADMIN', 'National Tabloid Preprint', 'News.Admin', 'Admin.DTM', 'Admin.International', 'BODYANDSOUL.ADMIN', 'Bestrecipes.Admin', 'ESCAPE.ADMIN', 'Admin.Sales', 'Admin.TCM', 'Kidspot.Admin', 'BESTRECIPES.ADMIN', 'Bodyandsoul.Admin', 'Delicious.admin', 'KIDSPOT.ADMIN', 'DELICIOUS.ADMIN', 'GQ.Admin', 'GQ.ADMIN', 'Escape.Admin', 'CODE', 'CODEBET', 'punters.com.au', 'odds.com.au', 'ODDS', 'RACENET', 'RACENET_FORMGUIDE', 'Racenet App', 'racenet.com.au', 'Sky News', 'Sky News App', 'SkyNews', 'Stockhead', 'SUDDENLY.TGG', 'SUDDENLY.SOUTH', 'SUDDENLY.QLD', 'SUDDENLY.OTHER', 'SUDDENLY.NSW', 'SUDDENLY.NORTH', 'SUDDENLY.CW', 'TABOOLA', 'Taboola', 'EdMedia', 'EDMEDIA', 'eCommerce', 'ECOMMERCEPARTNERS', 'ECOMMERCE.VOGUELIVING', 'ECOMMERCE.VOGUE', 'ECOMMERCE', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.TCM', 'ECOMMERCE.TASTE', 'ECOMMERCE.NEWS', 'ECOMMERCE.KIDSPOT', 'ECOMMERCE.GQ', 'ECOMMERCE.ESCAPE', 'ECOMMERCE.DELICIOUS') AND t0.fin_adtype_name IN ('Video (Targeted)', 'Video (Non-Targeted)', 'Video Growth (Non-Targeted)', 'Video Growth (Targeted)', 'Social Video (Targeted)', 'Social Video (Non-Targeted)') AND t0.financial_year IN ('2025'))",measure,True,high,17,f65a9149-93b4-4aa9-aef6-d12002853222
sales_segment_l2_name_filtered_adtypes,sales_segment_l2_name,Sales Segment L2 Name by Filtered Ad Types,"A dimension representing the sales segment level 2 name, filtered for 'Booked' or 'Billed' transactions, excluding 'Medium Rare Content Agency', and including various audio, events, rich media, social display, standard display, and TTIV ad types.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.sales_segment_l_2_name_sync AS sales_segment_l2_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) AND t0.fin_adtype_name IN ('Audio (Targeted)', 'Audio (Non-Targeted)', 'Events (Non-Targeted)', 'Events (Targeted)', 'Rich Media (Non-Targeted)', 'Rich Media (Targeted)', 'Social Display (Targeted)', 'Social Display (Non-Targeted)', 'Standard Display (Targeted)', 'Standard Display (Non-Targeted)', 'TTIV (Targeted)', 'TTIV (Non-Targeted)')) GROUP BY t0.sales_segment_l_2_name_sync",dimension,False,medium,17,f65a9149-93b4-4aa9-aef6-d12002853222
booking_number_content_native_fy2025_2026,booking_number,Booking Number for Content/Native Ad Types (FY2025-2026),A dimension representing unique booking numbers for content discovery and native ad types for financial years 2025 and 2026.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.booking_number AS booking_number FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.fin_adtype_name IN ('Content Discovery (Non-Targeted)', 'Content Discovery (Targeted)', 'Native (Non-Targeted)', 'Native (Targeted)') AND t0.financial_year IN ('2026', '2025')) GROUP BY t0.booking_number",dimension,False,low,17,f65a9149-93b4-4aa9-aef6-d12002853222
sort_caption_content_native_integration_fy2025,sort_caption,Sort Caption for Content/Native/Integration Ad Types (FY2025),"A dimension representing the sort caption, filtered for content discovery, content integration, and native ad types for financial year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.sort_caption AS sort_caption FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.financial_year IN ('2025') AND t0.fin_adtype_name IN ('Content Discovery (Non-Targeted)', 'Content Discovery (Targeted)', 'Content Integration (Non-Targeted)', 'Content Integration (Targeted)', 'Native (Non-Targeted)', 'Native (Targeted)')) GROUP BY t0.sort_caption",dimension,False,low,17,f65a9149-93b4-4aa9-aef6-d12002853222
adsize_name_filtered_adtypes_fy2025,adsize_name,Ad Size Name by Filtered Ad Types (FY2025),"A dimension representing the ad size name, filtered for 'Booked' or 'Billed' transactions, excluding 'Medium Rare Content Agency', and including various audio, events, native, rich media, social display, standard display, and TTIV ad types for financial year 2025.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.adsize_name AS adsize_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) AND t0.fin_adtype_name IN ('Audio (Non-Targeted)', 'Audio (Targeted)', 'Events (Non-Targeted)', 'Native (Non-Targeted)', 'Native (Targeted)', 'Rich Media (Non-Targeted)', 'Rich Media (Targeted)', 'Social Display (Non-Targeted)', 'Social Display (Targeted)', 'Standard Display (Non-Targeted)', 'Standard Display (Targeted)', 'TTIV (Targeted)', 'TTIV (Non-Targeted)') AND t0.financial_year IN ('2025')) GROUP BY t0.adsize_name",dimension,False,low,17,f65a9149-93b4-4aa9-aef6-d12002853222
total_gross_revenue_digital_fy2024_2025_nov,total_gross_revenue,"Total Gross Revenue for Digital (FY2024-2025, November)","The sum of gross revenue for 'Digital' revenue type, excluding numerous internal/admin publications, specific source systems, and certain ad types, for financial years 2024 and 2025, specifically for November (financial month 11).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.gross_revenue_amount) AS total_gross_revenue_digital_fy2024_2025_nov FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_type = 'Digital' AND t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Punters.com.au', 'odds.com.au', 'RACENET', 'Racenet App', 'SKYNEWS.ADMIN', 'SUDDENLY.CW', 'SUDDENLY.OTHER', 'SUDDENLY.TGG', 'SUPERCOACH', 'Sky News', 'Stellar.Admin', 'Stockhead', 'TAUS.ADMIN', 'Taste.Admin', 'Vogue.Admin', 'Vogueliving.Admin') AND t0.publication_name NOT IN ('Vogueliving.Admin', 'Vogue.Admin', 'ADMIN.ADV', 'ADMIN.DTM', 'ADMIN.HWT', 'ADMIN.SALES', 'ADMIN.SPORT', 'VOGUELIVING.ADMIN', 'VOGUE.ADMIN', 'Taste.Admin', 'TAUS.ADMIN', 'TASTE.ADMIN', 'STELLAR.ADMIN', 'ADMIN.TCM', 'NEWS.ADMIN', 'SKYNEWS.ADMIN', 'National Tabloid Preprint', 'News.Admin', 'Admin.DTM', 'Admin.International', 'BODYANDSOUL.ADMIN', 'Bestrecipes.Admin', 'ESCAPE.ADMIN', 'Admin.Sales', 'Admin.TCM', 'Kidspot.Admin', 'BESTRECIPES.ADMIN', 'Bodyandsoul.Admin', 'Delicious.admin', 'KIDSPOT.ADMIN', 'DELICIOUS.ADMIN', 'GQ.Admin', 'GQ.ADMIN', 'Escape.Admin', 'CODE', 'CODEBET', 'punters.com.au', 'odds.com.au', 'ODDS', 'RACENET', 'RACENET_FORMGUIDE', 'Racenet App', 'Sky News', 'Sky News App', 'SkyNews', 'Stockhead', 'SUDDENLY.TGG', 'SUDDENLY.SOUTH', 'SUDDENLY.QLD', 'SUDDENLY.OTHER', 'SUDDENLY.NSW', 'SUDDENLY.NORTH', 'SUDDENLY.CW', 'TABOOLA', 'Taboola', 'EdMedia', 'EDMEDIA', 'eCommerce', 'ECOMMERCEPARTNERS', 'ECOMMERCE.VOGUELIVING', 'ECOMMERCE.VOGUE', 'ECOMMERCE', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.TCM', 'ECOMMERCE.TASTE', 'ECOMMERCE.NEWS', 'ECOMMERCE.KIDSPOT', 'ECOMMERCE.GQ', 'ECOMMERCE.ESCAPE', 'ECOMMERCE.DELICIOUS') AND t0.source_system_code NOT IN ('LGBSS', 'LGBPUB') AND t0.booking_number NOT IN ('-1') AND t0.financial_year IN ('2025', '2024') AND (t0.fin_adtype_name NOT IN ('-', 'COLOUR MAGAZINES', 'Xtend') OR t0.fin_adtype_name IS NULL) AND SAFE_CAST(t0.financial_month AS FLOAT64) IN (11.000000))",measure,True,high,17,f65a9149-93b4-4aa9-aef6-d12002853222
gross_revenue_booked_billed_adpt_fy2025_excl_mrca_excl_near_zero_invoice_minus_1,total_gross_revenue,"Gross Revenue (Booked/Billed, ADPT, FY2025, Excl. MRCA, Excl. Zero/Near Zero, Invoice -1)","Total gross revenue for financial year 2025 from ADPT source system, for booked or billed transactions, excluding Medium Rare Content Agency, excluding near-zero amounts, and specifically for invoice number '-1'.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) AND t0.source_system_code IN ('ADPT') AND t0.invoice_number = '-1' AND NOT(t0.gross_revenue_amount BETWEEN -1.000000 AND 1.000000) AND t0.financial_year IN ('2025'))",aggregation,True,high,18,77c68c35-20ce-477a-b216-0c781d43a8ca
gross_revenue_booked_billed_multi_source_fy2025_excl_mrca_invoice_minus_1,total_gross_revenue,"Gross Revenue (Booked/Billed, PLUTO/CPQ/ADPT, FY2025, Excl. MRCA, Invoice -1)","Total gross revenue for financial year 2025 from PLUTO, CPQ, or ADPT source systems, for booked or billed transactions, excluding Medium Rare Content Agency, and specifically for invoice number '-1'.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) AND t0.invoice_number = '-1' AND t0.source_system_code IN ('PLUTO', 'CPQ', 'ADPT') AND t0.financial_year IN ('2025'))",aggregation,True,high,18,77c68c35-20ce-477a-b216-0c781d43a8ca
sum_financial_week_booked_billed_multi_source_fy2025_excl_mrca_invoice_minus_1,sum_of_financial_week,"Sum of Financial Week (Booked/Billed, PLUTO/CPQ/ADPT, FY2025, Excl. MRCA, Invoice -1)","The sum of financial week numbers for financial year 2025 from PLUTO, CPQ, or ADPT source systems, for booked or billed transactions, excluding Medium Rare Content Agency, and specifically for invoice number '-1'. (Note: Summing week numbers is an unusual aggregation, but directly reflects the source query.)",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(SAFE_CAST(t0.financial_week AS INT64)) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) AND t0.invoice_number = '-1' AND t0.source_system_code IN ('PLUTO', 'CPQ', 'ADPT') AND t0.financial_year IN ('2025'))",aggregation,False,low,18,77c68c35-20ce-477a-b216-0c781d43a8ca
record_count_finance_os_fiscal_week_202548_51,record_count,"Record Count (Finance Operating Statement, Fiscal Week 202548-51)","Total number of records in the finance operating statement for specific fiscal weeks (202548, 202549, 202550, 202551).",ncau-data-newsquery-prd,prstn_finance_persisted,finance_operating_statement,"SELECT COUNT(1) FROM `ncau-data-newsquery-prd.prstn_finance_persisted.finance_operating_statement` AS t0 WHERE t0.fiscal_week_id IN ('202548', '202549', '202550', '202551')",aggregation,False,low,18,77c68c35-20ce-477a-b216-0c781d43a8ca
distinct_data_load_datetime_non_digital,data_load_datetime_truncated,Distinct Data Load Datetime (Non-Digital Revenue),"Distinct data load datetimes, truncated to the second, for revenue transactions that are not classified as 'Digital' revenue.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT DATETIME_TRUNC(t0.data_load_datetime, SECOND) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.revenue_type NOT IN ('Digital') OR t0.revenue_type IS NULL)",dimension,False,low,18,77c68c35-20ce-477a-b216-0c781d43a8ca
sum_ss_lgb_cw_media_suddenly_publications,total_ss_lgb,"Sum of SS LGB (CW Media, SUDDENLY.CW/NORTH)",Total 'SS LGB' amount for advertiser 'CW Media Pty Ltd' across 'SUDDENLY.CW' and 'SUDDENLY.NORTH' publications.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.ss_lgb) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE (t0.advertiser_name IN ('CW Media Pty Ltd') AND t0.unified_publication_name IN ('SUDDENLY.CW', 'SUDDENLY.NORTH'))",aggregation,True,high,18,77c68c35-20ce-477a-b216-0c781d43a8ca
distinct_data_load_datetime_gl_code_9707_9655_9658,data_load_datetime_truncated,Distinct Data Load Datetime (GL Code 9707/9655/9658),"Distinct data load datetimes, truncated to the second, for transactions associated with specific GL codes (9707, 9655, 9658).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT DATETIME_TRUNC(t0.data_load_datetime, SECOND) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.unified_publication_gl_code IN ('9707', '9655', '9658')",dimension,False,low,18,77c68c35-20ce-477a-b216-0c781d43a8ca
actual_amount_base,actual_amount,Actual Amount (Base),"The base financial amount representing actuals, budgets, or forecasts, depending on the 'scenario' dimension.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT SUM(t0.Actual_Amount) AS actual_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0,measure,True,high,19,f353b933-30eb-4853-9976-0d35371db7d7
estimated_actual_amount_jan_2025,actual_amount,Estimated Actual Amount (Jan 2025),"The actual amount specifically filtered for fiscal year 2025, January, and a 'Estimate' scenario, likely representing a specific budget or forecast view.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT SUM(t0.Actual_Amount) AS estimated_actual_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 WHERE SAFE_CAST(t0.fiscal_year AS FLOAT64) = 2025.000000 AND t0.month_short_name = 'Jan' AND t0.scenario = 'Estimate',measure,True,high,19,f353b933-30eb-4853-9976-0d35371db7d7
gl_reconciliation_record_count,gl_reconciliation_record_count,GL Reconciliation Record Count,"The total number of records in the GL reconciliation dataset, often used to track volume or completeness.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_gl_reconciliation,SELECT COUNT(t0.fy_month_num) AS gl_reconciliation_record_count FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_gl_reconciliation` AS t0,measure,False,medium,19,f353b933-30eb-4853-9976-0d35371db7d7
gl_reconciliation_month_number_sum,gl_reconciliation_month_number_sum,GL Reconciliation Month Number Sum,"The sum of fiscal month numbers from the GL reconciliation dataset. This is an unusual metric, potentially used for internal Looker Studio calculations or specific data validation.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_gl_reconciliation,SELECT SUM(t0.fy_month_num) AS gl_reconciliation_month_number_sum FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_gl_reconciliation` AS t0,measure,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
os_level_4_dimension,os_level_4,OS Level 4,A categorical dimension representing an organizational structure level 4.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.os_level_4 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
os_level_5_dimension,os_level_5,OS Level 5,A categorical dimension representing an organizational structure level 5.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.os_level_5 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
os_level_6_dimension,os_level_6,OS Level 6,A categorical dimension representing an organizational structure level 6.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.os_level_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
publication_code_dimension,publication_code,Publication Code,A code identifying a specific publication.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.publication_code FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
scenario_dimension,scenario,Scenario Type,"Indicates the type of financial data, e.g., 'Actual', 'Estimate', 'Budget', 'Forecast'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.scenario FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
fiscal_year_dimension,fiscal_year,Fiscal Year,The fiscal year for the financial data.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.fiscal_year FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
month_short_name_dimension,month_short_name,Month Short Name,"The abbreviated name of the month (e.g., 'Jan', 'Feb') for financial data.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_budgets_forecasts,SELECT t0.month_short_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
gl_month_name_dimension,gl_month_name,GL Month Name,The full name of the month from the GL reconciliation dataset.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_gl_reconciliation,SELECT t0.month_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_gl_reconciliation` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
gl_fy_month_num_dimension,gl_fy_month_num,GL Fiscal Month Number,"The fiscal month number from the GL reconciliation dataset (e.g., 1 for Jan, 2 for Feb).",ncau-data-newsquery-prd,sbx_fda_corefin,dv_gl_reconciliation,SELECT t0.fy_month_num FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_gl_reconciliation` AS t0 LIMIT 1,dimension,False,low,19,f353b933-30eb-4853-9976-0d35371db7d7
revenue_gross_independent_agencies_nsw_non_guaranteed,total_revenue_gross,"Gross Revenue (Independent Agencies NSW, Non-Guaranteed)","Total gross revenue generated from 'INDEPENDENT AGENCIES NSW' portfolio parent group, excluding 'Guaranteed' transaction types.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,SELECT SUM(t0.RevenueGross) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.PortfolioParentGroup IN ('INDEPENDENT AGENCIES NSW') AND (t0.TransactionType NOT IN ('Guaranteed') OR t0.TransactionType IS NULL),measure,True,high,20,6f1c8731-02da-464f-b146-bf2947860735
revenue_gross_vic_ka_a2,total_revenue_gross,Gross Revenue (VIC KA A2),Total gross revenue generated specifically for the 'VIC KA A2' portfolio child group.,ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,SELECT SUM(t0.RevenueGross) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE t0.PortfolioChildGroup IN ('VIC KA A2'),measure,True,high,20,6f1c8731-02da-464f-b146-bf2947860735
unique_dsps_fy2025_q4_vic_nsw_amazon_may_2025_non_open_auction,unique_dsps,"Unique DSPs (FY2025 Q4, VIC/NSW, Amazon, May 2025, Non-Open Auction)","Count of distinct DSPs for FY2025 Q4, specific VIC/NSW portfolio child groups, 'Amazon.com *' advertiser, May 2025 calendar month, and excluding 'Open Auction' transaction types.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT COUNT(DISTINCT t0.DSP) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE CONCAT('FY',SAFE_CAST(t0.FinancialYear AS STRING),' - ',SAFE_CAST(t0.FinancialQuarter AS STRING)) IN ('FY2025 - Q4') AND t0.PortfolioChildGroup IN ('VIC KA C1', 'NSW CON A2', 'NSW CON A1') AND (t0.TransactionType NOT IN ('Open Auction') OR t0.TransactionType IS NULL) AND t0.Advertiser IN ('Amazon.com *') AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATETIME), MONTH) AS DATE) IN (DATE '2025-05-01')",measure,False,medium,20,6f1c8731-02da-464f-b146-bf2947860735
revenue_gross_fy2025_q4_vic_nsw_amazon_may_2025_non_open_auction,total_revenue_gross,"Gross Revenue (FY2025 Q4, VIC/NSW, Amazon, May 2025, Non-Open Auction)","Total gross revenue for FY2025 Q4, specific VIC/NSW portfolio child groups, 'Amazon.com *' advertiser, May 2025 calendar month, and excluding 'Open Auction' transaction types.",ncau-data-newsquery-prd,prstn_advertising,programmatic_fin_month,"SELECT SUM(t0.RevenueGross) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 WHERE CONCAT('FY',SAFE_CAST(t0.FinancialYear AS STRING),' - ',SAFE_CAST(t0.FinancialQuarter AS STRING)) IN ('FY2025 - Q4') AND t0.PortfolioChildGroup IN ('VIC KA C1', 'NSW CON A2', 'NSW CON A1') AND (t0.TransactionType NOT IN ('Open Auction') OR t0.TransactionType IS NULL) AND t0.Advertiser IN ('Amazon.com *') AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATETIME), MONTH) AS DATE) IN (DATE '2025-05-01')",measure,True,high,20,6f1c8731-02da-464f-b146-bf2947860735
spend_rolling_12_months_digital,spend,Spend - Rolling 12 Months (Digital),"Total advertising spend for 'Digital' media group over the last 12 months, ending on the latest available date in the dataset, grouped by month.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  DATETIME_TRUNC(SAFE_CAST(t0.date AS DATETIME), MONTH) AS month_start_date,
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_rolling_12_months_digital
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), (
              SELECT
                MAX(date)
              FROM
                adex_data
            ), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
WHERE
  SAFE_CAST(t0.date AS DATETIME) <= SAFE_CAST(t0.latest_date AS DATETIME)
  AND SAFE_CAST(t0.date AS DATETIME) > DATETIME_ADD(SAFE_CAST(t0.latest_date AS DATETIME), INTERVAL -12 MONTH)
  AND t0.Media_Group = 'Digital'
GROUP BY
  1
LIMIT 100",measure,True,high,21,e9d8a216-4950-4d30-b344-5011776edbdf
spend_current_period,spend,Spend - Current Period (Aug 2022 - Jun 2023),Total advertising spend for a fixed 'current' period (August 2022 to June 2023).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_current_period
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), ((
              SELECT
                MAX(date)
              FROM
                adex_data
            )), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
WHERE
  SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2022-08-01')
  AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2023-06-01')
LIMIT 100",measure,True,high,21,e9d8a216-4950-4d30-b344-5011776edbdf
spend_comparison_period,spend,Spend - Comparison Period (Aug 2023 - Jun 2024),Total advertising spend for a fixed 'comparison' period (August 2023 to June 2024).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_comparison_period
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY(((
              SELECT
                MIN(date)
              FROM
                adex_data
            )), ((
              SELECT
                MAX(date)
              FROM
                adex_data
            )), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
WHERE
  SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2023-08-01')
  AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2024-06-01')
LIMIT 100",measure,True,high,21,e9d8a216-4950-4d30-b344-5011776edbdf
spend_news_corp_current_period,spend_news_corp,Spend - News Corp (Current Period),Total advertising spend for 'NEWS CORP' media network during the current period (August 2022 to June 2023).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_news_corp_current_period
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), ((
              SELECT
                MAX(date)
              FROM
                adex_data
            )), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
WHERE
  SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2022-08-01')
  AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2023-06-01')
  AND t0.Media_Network = 'NEWS CORP'
LIMIT 100",measure,False,medium,21,e9d8a216-4950-4d30-b344-5011776edbdf
spend_news_corp_comparison_period,spend_news_corp,Spend - News Corp (Comparison Period),Total advertising spend for 'NEWS CORP' media network during the comparison period (August 2023 to June 2024).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_news_corp_comparison_period
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), ((
              SELECT
                MAX(date)
              FROM
                adex_data
            )), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
WHERE
  SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2023-08-01')
  AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2024-06-01')
  AND t0.Media_Network = 'NEWS CORP'
LIMIT 100",measure,False,medium,21,e9d8a216-4950-4d30-b344-5011776edbdf
spend_retail_comparison_period,spend_retail,Spend - Retail (Comparison Period),Total advertising spend for 'Retail' major category during the comparison period (August 2023 to June 2024).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_retail_comparison_period
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), ((
              SELECT
                MAX(date)
              FROM
                adex_data
            )), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
WHERE
  SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2023-08-01')
  AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2024-06-01')
  AND t0.Major_Category = 'Retail'
LIMIT 100",measure,False,medium,21,e9d8a216-4950-4d30-b344-5011776edbdf
spend_by_media_type,spend,Spend by Media Type,Total advertising spend grouped by Media Type.,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  t0.Media_Type,
  SUM(SAFE_CAST(t0.Spend AS BIGNUMERIC)) AS spend_by_media_type
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), ((
              SELECT
                MAX(date)
              FROM
                adex_data
            )), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
GROUP BY
  t0.Media_Type
LIMIT 100",measure,False,medium,21,e9d8a216-4950-4d30-b344-5011776edbdf
always_on_digital_sales_budget,always_on_digital_sales,Always-on Digital Sales (Budget),"The budgeted value for always-on digital sales for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_actuals,always_on_digital_sales,Always-on Digital Sales (Actuals),"The actual value for always-on digital sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_current_period,always_on_digital_sales,Always-on Digital Sales (Current Period),"The value for always-on digital sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_6w_rolling,always_on_digital_sales,Always-on Digital Sales (6-Week Rolling),"The sum of always-on digital sales over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_aggregated_by_week_year,always_on_digital_sales,Always-on Digital Sales (Aggregated by Week/Year),Always-on digital sales aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Always_on_Digital_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_budget,breach_sales,Breach Sales (Budget),"The budgeted value for breach sales for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_actuals,breach_sales,Breach Sales (Actuals),"The actual value for breach sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_current_period,breach_sales,Breach Sales (Current Period),"The value for breach sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_6w_rolling,breach_sales,Breach Sales (6-Week Rolling),"The sum of breach sales over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_aggregated_by_week_year,breach_sales,Breach Sales (Aggregated by Week/Year),Breach sales aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Breach_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_budget,closing_base_3rd_party,Closing Base 3rd Party (Budget),"The budgeted value for closing base 3rd party for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_actuals,closing_base_3rd_party,Closing Base 3rd Party (Actuals),"The actual value for closing base 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_current_period,closing_base_3rd_party,Closing Base 3rd Party (Current Period),"The value for closing base 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_6w_rolling,closing_base_3rd_party,Closing Base 3rd Party (6-Week Rolling),"The sum of closing base 3rd party over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_aggregated_by_week_year,closing_base_3rd_party,Closing Base 3rd Party (Aggregated by Week/Year),Closing base 3rd party aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Closing_Base_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_apls_current_period,closing_base_3rd_party_apls,Closing Base 3rd Party APLS (Current Period),"The value for closing base 3rd party APLS for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_apls_6w_rolling,closing_base_3rd_party_apls,Closing Base 3rd Party APLS (6-Week Rolling),"The sum of closing base 3rd party APLS over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_APLS_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_apls_aggregated_by_week_year,closing_base_3rd_party_apls,Closing Base 3rd Party APLS (Aggregated by Week/Year),Closing base 3rd party APLS aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Closing_Base_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_gpla_current_period,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA (Current Period),"The value for closing base 3rd party GPLA for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_gpla_6w_rolling,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA (6-Week Rolling),"The sum of closing base 3rd party GPLA over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_GPLA_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_gpla_aggregated_by_week_year,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA (Aggregated by Week/Year),Closing base 3rd party GPLA aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Closing_Base_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_consumer_current_period,closing_base_consumer,Closing Base Consumer (Current Period),"The value for closing base consumer for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_consumer_6w_rolling,closing_base_consumer,Closing Base Consumer (6-Week Rolling),"The sum of closing base consumer over a 6-week rolling period (Weeks 26-31, FY2025). Note: The underlying column is not suffixed with '_6W'.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_consumer_aggregated_by_week_year,closing_base_consumer,Closing Base Consumer (Aggregated by Week/Year),Closing base consumer aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Closing_Base_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_budget,essentials,Essentials (Budget),"The budgeted value for essentials for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_actuals,essentials,Essentials (Actuals),"The actual value for essentials for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_current_period,essentials,Essentials (Current Period),"The value for essentials for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_6w_rolling,essentials,Essentials (6-Week Rolling),"The sum of essentials over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_aggregated_by_week_year,essentials,Essentials (Aggregated by Week/Year),Essentials aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Essentials) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
failed_payment_volume_current_period,failed_payment_volume,Failed Payment Volume (Current Period),"The value for failed payment volume for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
failed_payment_volume_6w_rolling,failed_payment_volume,Failed Payment Volume (6-Week Rolling),"The sum of failed payment volume over a 6-week rolling period (Weeks 26-31, FY2025). Note: The underlying column is not suffixed with '_6W'.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
failed_payment_volume_6w_rolling_suffixed,failed_payment_volume,"Failed Payment Volume (6-Week Rolling, Suffixed)","The sum of failed payment volume over a 6-week rolling period (Weeks 26-31, FY2025), using the _6W suffixed column.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Failed_Payment_Volume_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
failed_payment_volume_aggregated_by_week_year,failed_payment_volume,Failed Payment Volume (Aggregated by Week/Year),Failed payment volume aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_budget,general_offer_sales,General Offer Sales (Budget),"The budgeted value for general offer sales for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_actuals,general_offer_sales,General Offer Sales (Actuals),"The actual value for general offer sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_current_period,general_offer_sales,General Offer Sales (Current Period),"The value for general offer sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_6w_rolling,general_offer_sales,General Offer Sales (6-Week Rolling),"The sum of general offer sales over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_aggregated_by_week_year,general_offer_sales,General Offer Sales (Aggregated by Week/Year),General offer sales aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.General_Offer_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_budget,net_cancels,Net Cancels (Budget),"The budgeted value for net cancels for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_actuals,net_cancels,Net Cancels (Actuals),"The actual value for net cancels for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_current_period,net_cancels,Net Cancels (Current Period),"The value for net cancels for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_6w_rolling,net_cancels,Net Cancels (6-Week Rolling),"The sum of net cancels over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_aggregated_by_week_year,net_cancels,Net Cancels (Aggregated by Week/Year),Net cancels aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Net_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_budget,net_growth_3rd_party,Net Growth 3rd Party (Budget),"The budgeted value for net growth 3rd party for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_actuals,net_growth_3rd_party,Net Growth 3rd Party (Actuals),"The actual value for net growth 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_current_period,net_growth_3rd_party,Net Growth 3rd Party (Current Period),"The value for net growth 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_6w_rolling,net_growth_3rd_party,Net Growth 3rd Party (6-Week Rolling),"The sum of net growth 3rd party over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_aggregated_by_week_year,net_growth_3rd_party,Net Growth 3rd Party (Aggregated by Week/Year),Net growth 3rd party aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Net_Growth_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_apls_current_period,net_growth_3rd_party_apls,Net Growth 3rd Party APLS (Current Period),"The value for net growth 3rd party APLS for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_apls_6w_rolling,net_growth_3rd_party_apls,Net Growth 3rd Party APLS (6-Week Rolling),"The sum of net growth 3rd party APLS over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_APLS_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_apls_aggregated_by_week_year,net_growth_3rd_party_apls,Net Growth 3rd Party APLS (Aggregated by Week/Year),Net growth 3rd party APLS aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Net_Growth_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_gpla_current_period,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA (Current Period),"The value for net growth 3rd party GPLA for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_gpla_6w_rolling,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA (6-Week Rolling),"The sum of net growth 3rd party GPLA over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_GPLA_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_gpla_aggregated_by_week_year,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA (Aggregated by Week/Year),Net growth 3rd party GPLA aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Net_Growth_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_budget,net_growth_consumer,Net Growth Consumer (Budget),"The budgeted value for net growth consumer for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_actuals,net_growth_consumer,Net Growth Consumer (Actuals),"The actual value for net growth consumer for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_current_period,net_growth_consumer,Net Growth Consumer (Current Period),"The value for net growth consumer for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_6w_rolling,net_growth_consumer,Net Growth Consumer (6-Week Rolling),"The sum of net growth consumer over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_aggregated_by_week_year,net_growth_consumer,Net Growth Consumer (Aggregated by Week/Year),Net growth consumer aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Net_Growth_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_budget,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party (Budget),"The budgeted value for net growth including 3rd party for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_actuals,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party (Actuals),"The actual value for net growth including 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_current_period,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party (Current Period),"The value for net growth including 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_6w_rolling,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party (6-Week Rolling),"The sum of net growth including 3rd party over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_party_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_aggregated_by_week_year,net_growth_incl_3rd_party,Net Growth Incl. 3rd Party (Aggregated by Week/Year),Net growth including 3rd party aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Net_Growth_incl_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_budget,other_sales,Other Sales (Budget),"The budgeted value for other sales for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_actuals,other_sales,Other Sales (Actuals),"The actual value for other sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_current_period,other_sales,Other Sales (Current Period),"The value for other sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_6w_rolling,other_sales,Other Sales (6-Week Rolling),"The sum of other sales over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_aggregated_by_week_year,other_sales,Other Sales (Aggregated by Week/Year),Other sales aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Other_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_budget,revenue_3rd_party,Revenue 3rd Party (Budget),"The budgeted value for 3rd party revenue for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_actuals,revenue_3rd_party,Revenue 3rd Party (Actuals),"The actual value for 3rd party revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_current_period,revenue_3rd_party,Revenue 3rd Party (Current Period),"The value for 3rd party revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_6w_rolling,revenue_3rd_party,Revenue 3rd Party (6-Week Rolling),"The sum of 3rd party revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_aggregated_by_week_year,revenue_3rd_party,Revenue 3rd Party (Aggregated by Week/Year),3rd party revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_apls_current_period,revenue_3rd_party_apls,Revenue 3rd Party APLS (Current Period),"The value for 3rd party APLS revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_apls_6w_rolling,revenue_3rd_party_apls,Revenue 3rd Party APLS (6-Week Rolling),"The sum of 3rd party APLS revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_APLS_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_apls_aggregated_by_week_year,revenue_3rd_party_apls,Revenue 3rd Party APLS (Aggregated by Week/Year),3rd party APLS revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_gpla_current_period,revenue_3rd_party_gpla,Revenue 3rd Party GPLA (Current Period),"The value for 3rd party GPLA revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_gpla_6w_rolling,revenue_3rd_party_gpla,Revenue 3rd Party GPLA (6-Week Rolling),"The sum of 3rd party GPLA revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_GPLA_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_gpla_aggregated_by_week_year,revenue_3rd_party_gpla,Revenue 3rd Party GPLA (Aggregated by Week/Year),3rd party GPLA revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_budget,revenue_campus,Revenue Campus (Budget),"The budgeted value for campus revenue for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_actuals,revenue_campus,Revenue Campus (Actuals),"The actual value for campus revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_current_period,revenue_campus,Revenue Campus (Current Period),"The value for campus revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_6w_rolling,revenue_campus,Revenue Campus (6-Week Rolling),"The sum of campus revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_aggregated_by_week_year,revenue_campus,Revenue Campus (Aggregated by Week/Year),Campus revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_Campus) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_budget,revenue_consumer,Revenue Consumer (Budget),"The budgeted value for consumer revenue for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_actuals,revenue_consumer,Revenue Consumer (Actuals),"The actual value for consumer revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_current_period,revenue_consumer,Revenue Consumer (Current Period),"The value for consumer revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_6w_rolling,revenue_consumer,Revenue Consumer (6-Week Rolling),"The sum of consumer revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_aggregated_by_week_year,revenue_consumer,Revenue Consumer (Aggregated by Week/Year),Consumer revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_budget,revenue_corp,Revenue Corp (Budget),"The budgeted value for corporate revenue for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_actuals,revenue_corp,Revenue Corp (Actuals),"The actual value for corporate revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_current_period,revenue_corp,Revenue Corp (Current Period),"The value for corporate revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_6w_rolling,revenue_corp,Revenue Corp (6-Week Rolling),"The sum of corporate revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_aggregated_by_week_year,revenue_corp,Revenue Corp (Aggregated by Week/Year),Corporate revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_Corp) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_budget,revenue_other,Revenue Other (Budget),"The budgeted value for other revenue for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_actuals,revenue_other,Revenue Other (Actuals),"The actual value for other revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_current_period,revenue_other,Revenue Other (Current Period),"The value for other revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_6w_rolling,revenue_other,Revenue Other (6-Week Rolling),"The sum of other revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_aggregated_by_week_year,revenue_other,Revenue Other (Aggregated by Week/Year),Other revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Revenue_Other) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_budget,switches,Switches (Budget),"The budgeted value for switches for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_actuals,switches,Switches (Actuals),"The actual value for switches for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_current_period,switches,Switches (Current Period),"The value for switches for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_6w_rolling,switches,Switches (6-Week Rolling),"The sum of switches over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_aggregated_by_week_year,switches,Switches (Aggregated by Week/Year),Switches aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Switches) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_budget,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (Budget),"The budgeted value for total cancels excluding 3rd party for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_actuals,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (Actuals),"The actual value for total cancels excluding 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_current_period,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (Current Period),"The value for total cancels excluding 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_6w_rolling,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (6-Week Rolling),"The sum of total cancels excluding 3rd party over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excluding_3rd_party_aggregated_by_week_year,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (Aggregated by Week/Year),Total cancels excluding 3rd party aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Total_Cancels_excluding_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_budget,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (Budget),"The budgeted value for total cancels including 3rd party for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_actuals,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (Actuals),"The actual value for total cancels including 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_current_period,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (Current Period),"The value for total cancels including 3rd party for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_6w_rolling,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (6-Week Rolling),"The sum of total cancels including 3rd party over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_including_3rd_party_aggregated_by_week_year,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (Aggregated by Week/Year),Total cancels including 3rd party aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Total_Cancels_including_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_budget,total_closing_base,Total Closing Base (Budget),"The budgeted value for total closing base for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_actuals,total_closing_base,Total Closing Base (Actuals),"The actual value for total closing base for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_current_period,total_closing_base,Total Closing Base (Current Period),"The value for total closing base for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_6w_rolling,total_closing_base,Total Closing Base (6-Week Rolling),"The sum of total closing base over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_aggregated_by_week_year,total_closing_base,Total Closing Base (Aggregated by Week/Year),Total closing base aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Total_Closing_Base) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_budget,total_revenue,Total Revenue (Budget),"The budgeted value for total revenue for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_actuals,total_revenue,Total Revenue (Actuals),"The actual value for total revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_current_period,total_revenue,Total Revenue (Current Period),"The value for total revenue for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_6w_rolling,total_revenue,Total Revenue (6-Week Rolling),"The sum of total revenue over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_aggregated_by_week_year,total_revenue,Total Revenue (Aggregated by Week/Year),Total revenue aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Total_Revenue) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_budget,total_weekly_sales,Total Weekly Sales (Budget),"The budgeted value for total weekly sales for a specific fiscal week (Week 31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_actuals,total_weekly_sales,Total Weekly Sales (Actuals),"The actual value for total weekly sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_current_period,total_weekly_sales,Total Weekly Sales (Current Period),"The value for total weekly sales for a specific fiscal week (Week 38, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_6w_rolling,total_weekly_sales,Total Weekly Sales (6-Week Rolling),"The sum of total weekly sales over a 6-week rolling period (Weeks 26-31, FY2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales_6W) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year BETWEEN 26 AND 31,aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_aggregated_by_week_year,total_weekly_sales,Total Weekly Sales (Aggregated by Week/Year),Total weekly sales aggregated by fiscal week and year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT SUM(t0.Total_Weekly_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY t0.fy_week_of_year, t0.fy_year",aggregation,True,high,22,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_amount_by_fy_week,total_amount,Total Amount by FY Week,"The sum of 'amount' grouped by fiscal year week number, representing total financial value.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS total_amount, t0.fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 GROUP BY t0.fy_year_week_number ORDER BY t0.fy_year_week_number DESC LIMIT 100;",measure,True,high,23,f7a9efeb-df3c-45c9-899d-0bcada701572
total_volume_by_fy_week,total_volume,Total Volume by FY Week,"The sum of 'volume' grouped by fiscal year week number, representing total quantity.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.volume) AS total_volume, t0.fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 GROUP BY t0.fy_year_week_number ORDER BY t0.fy_year_week_number DESC LIMIT 100;",measure,True,high,23,f7a9efeb-df3c-45c9-899d-0bcada701572
amount_revenue_type_03_by_fy_week,total_amount,Amount for Revenue Type '03' by FY Week,"The sum of 'amount' specifically for records where the 'revenue_type' starts with '03', grouped by fiscal year week number.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(CASE WHEN SAFE.LEFT(t0.revenue_type, 2) = '03' THEN t0.amount ELSE 0 END) AS amount_revenue_type_03, t0.fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 GROUP BY t0.fy_year_week_number ORDER BY t0.fy_year_week_number DESC LIMIT 100;",calculated_field,False,medium,23,f7a9efeb-df3c-45c9-899d-0bcada701572
volume_revenue_type_03_by_fy_week,total_volume,Volume for Revenue Type '03' by FY Week,"The sum of 'volume' specifically for records where the 'revenue_type' starts with '03', grouped by fiscal year week number.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(CASE WHEN SAFE.LEFT(t0.revenue_type, 2) = '03' THEN t0.volume ELSE 0 END) AS volume_revenue_type_03, t0.fy_year_week_number FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 GROUP BY t0.fy_year_week_number ORDER BY t0.fy_year_week_number DESC LIMIT 100;",calculated_field,False,medium,23,f7a9efeb-df3c-45c9-899d-0bcada701572
total_amount_by_revenue_type,total_amount,Total Amount by Revenue Type,"The sum of 'amount' grouped by the full 'revenue_type', providing a breakdown of financial value by revenue category.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS total_amount, t0.revenue_type FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 GROUP BY t0.revenue_type ORDER BY t0.revenue_type ASC LIMIT 100;",measure,True,high,23,f7a9efeb-df3c-45c9-899d-0bcada701572
latest_data_load_timestamp,data_freshness,Latest Data Load Timestamp,"The most recent timestamp indicating when the underlying data for the dashboard was loaded or refreshed, derived from multiple source tables.",ncau-data-newsquery-prd,prstn_finance_persisted,finance_operating_statement,"SELECT MIN(DATETIME_TRUNC(snap_load_time, SECOND)) AS latest_data_load_timestamp FROM (SELECT MAX(snap_load_time) AS snap_load_time FROM (SELECT datetime(max(dw_prstn_load_timestamp), 'Australia/Sydney') AS snap_load_time FROM `ncau-data-newsquery-prd.prstn_finance_persisted.finance_operating_statement` WHERE source_system_name = 'Circulation' AND scenario = 'Estimate' AND sub_source_system_name IN ('RCTI', 'THINK', 'DTI') UNION ALL SELECT datetime(max(dw_bdm_load_timestamp), 'Australia/Sydney') AS snap_load_time FROM `ncau-data-newsquery-prd.prstn_finance.v_circulation_snapshot_fct`) AS load_time) AS t0 LIMIT 1;",aggregation,False,low,23,f7a9efeb-df3c-45c9-899d-0bcada701572
spend_ty_rolling12m,total_spend,Spend (000s) - This Year (Rolling 12 Months),"Total advertising spend for the 'This Year' period, defined as the last 12 months ending on the latest available date in the dataset, expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS spend_ty_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) <= 11",measure,True,high,24,601ed0d2-e944-4189-8170-d593c8e72026
spend_ly_rolling12m,total_spend,Spend (000s) - Last Year (Rolling 12 Months),"Total advertising spend for the 'Last Year' period, defined as the 12 months prior to the 'This Year' rolling period (i.e., months 12-23 before the latest available date), expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS spend_ly_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) BETWEEN 12 AND 23",measure,True,high,24,601ed0d2-e944-4189-8170-d593c8e72026
spend_ty_calendar_year,total_spend,Spend (000s) - This Year (Calendar Year),"Total advertising spend for the current calendar year up to the latest available date, expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS spend_ty_calendar_year
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  t.date <= max_date_cte.latest_date AND t.date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(EXTRACT(YEAR FROM max_date_cte.latest_date) AS STRING),'-1-1'))",measure,False,medium,24,601ed0d2-e944-4189-8170-d593c8e72026
spend_ly_calendar_year,total_spend,Spend (000s) - Last Year (Calendar Year),"Total advertising spend for the previous calendar year, expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS spend_ly_calendar_year
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  t.date <= DATETIME_ADD(max_date_cte.latest_date, INTERVAL -1 YEAR) AND t.date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(EXTRACT(YEAR FROM max_date_cte.latest_date) - 1 AS STRING), '-1-1'))",measure,False,medium,24,601ed0d2-e944-4189-8170-d593c8e72026
spend_ty_financial_year,total_spend,Spend (000s) - This Year (Financial Year),"Total advertising spend for the current financial year (starting July 1st) up to the latest available date, expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS spend_ty_financial_year
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(financial_year) AS max_fin_year FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_fin_year_cte
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  t.date <= max_date_cte.latest_date AND t.date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(max_fin_year_cte.max_fin_year - 1 AS STRING),'-7-1'))",measure,False,medium,24,601ed0d2-e944-4189-8170-d593c8e72026
spend_ly_financial_year,total_spend,Spend (000s) - Last Year (Financial Year),"Total advertising spend for the previous financial year (starting July 1st), expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS spend_ly_financial_year
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(financial_year) AS max_fin_year FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_fin_year_cte
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  t.date <= DATETIME_ADD(max_date_cte.latest_date, INTERVAL -1 YEAR) AND t.date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(max_fin_year_cte.max_fin_year - 2 AS STRING), '-7-1'))",measure,False,medium,24,601ed0d2-e944-4189-8170-d593c8e72026
news_corp_spend_ty_rolling12m,news_corp_spend,NEWS CORP Spend (000s) - This Year (Rolling 12 Months),"Total advertising spend specifically for 'NEWS CORP' media network for the 'This Year' period (last 12 months ending on the latest available date), expressed in thousands of currency units.",ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  SUM(IF(t.Media_Network = 'NEWS CORP', SAFE_DIVIDE(t.Spend, 1000), 0)) AS news_corp_spend_ty_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) <= 11",measure,True,high,24,601ed0d2-e944-4189-8170-d593c8e72026
overall_publisher_count,publisher_count,Overall Publisher Count,The total count of distinct media networks (publishers) present in the entire dataset.,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  COUNT(DISTINCT t.Media_Network) AS overall_publisher_count
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
WHERE
  t.source = 'Adex'",measure,False,low,24,601ed0d2-e944-4189-8170-d593c8e72026
min_date_ly_rolling12m,min_date,Minimum Date - Last Year (Rolling 12 Months),The earliest date recorded within the 'Last Year' rolling 12-month period (months 12-23 before the latest available date).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  MIN(t.date) AS min_date_ly_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) BETWEEN 12 AND 23",measure,False,low,24,601ed0d2-e944-4189-8170-d593c8e72026
max_date_ly_rolling12m,max_date,Maximum Date - Last Year (Rolling 12 Months),The latest date recorded within the 'Last Year' rolling 12-month period (months 12-23 before the latest available date).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  MAX(t.date) AS max_date_ly_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) BETWEEN 12 AND 23",measure,False,low,24,601ed0d2-e944-4189-8170-d593c8e72026
min_date_ty_rolling12m,min_date,Minimum Date - This Year (Rolling 12 Months),The earliest date recorded within the 'This Year' rolling 12-month period (last 12 months ending on the latest available date).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  MIN(t.date) AS min_date_ty_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) <= 11",measure,False,low,24,601ed0d2-e944-4189-8170-d593c8e72026
max_date_ty_rolling12m,max_date,Maximum Date - This Year (Rolling 12 Months),The latest date recorded within the 'This Year' rolling 12-month period (last 12 months ending on the latest available date).,ncau-data-newsquery-prd,sbx_dcp,adex_datasource,"SELECT
  MAX(t.date) AS max_date_ty_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
WHERE
  DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) <= 11",measure,False,low,24,601ed0d2-e944-4189-8170-d593c8e72026
derived_adjusted_revenue_type,adjusted_revenue_type,Adjusted Revenue Type,"A derived categorization of revenue type, adjusting for the XTEND flag. If XTEND flag is 'Y', it's 'XTEND', otherwise it's the original revenue_type.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END AS adjusted_revenue_type FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 LIMIT 1,calculated_field,false,medium,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
derived_revenue_category,revenue_category,Revenue Category,"A further derived categorization of 'Adjusted Revenue Type' into broader categories like 'DIGITAL (excl.XTEND)', 'PRINT', or 'XTEND ONLY'.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT CASE WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'DIGITAL') THEN 'DIGITAL (excl.XTEND)' WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'PRINT') THEN 'PRINT' WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'XTEND') THEN 'XTEND ONLY' ELSE NULL END AS revenue_category FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 LIMIT 1,calculated_field,false,medium,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
unified_publication_name_filtered_digital_programmatic,unified_publication_name,Unified Publication Name (Digital/Programmatic),"A list of unique unified publication names, filtered for financial years 2024 or 2025 and specific digital/programmatic revenue group subtypes.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SAFE_CAST(t0.unified_publication_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025') AND SAFE_CAST(t0.revenue_group_subtype AS STRING) IN ('DIGITAL', 'PROGRAMMATIC EXCHANGE', 'PROGRAMMATIC SOURCE')) GROUP BY SAFE_CAST(t0.unified_publication_name AS STRING) ORDER BY SAFE_CAST(t0.unified_publication_name AS STRING) ASC LIMIT 2000001",dimension,false,low,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
revenue_group_subtype_filtered_digital_excl_xtend,revenue_group_subtype,Revenue Group Subtype (Digital excl. XTEND),"A list of unique revenue group subtypes, filtered for financial years 2024 or 2025 and where the 'Revenue Category' is 'DIGITAL (excl.XTEND)'.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SAFE_CAST(t0.revenue_group_subtype AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025') AND (CASE WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'DIGITAL') THEN 'DIGITAL (excl.XTEND)' WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'PRINT') THEN 'PRINT' WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'XTEND') THEN 'XTEND ONLY' ELSE NULL END) IN ('DIGITAL (excl.XTEND)')) GROUP BY SAFE_CAST(t0.revenue_group_subtype AS STRING) ORDER BY SAFE_CAST(t0.revenue_group_subtype AS STRING) ASC LIMIT 2000001",dimension,false,low,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
revenue_group_subtype_filtered_digital_case_insensitive,revenue_group_subtype,Revenue Group Subtype (Digital - Case Insensitive),"A list of unique revenue group subtypes, filtered for financial years 2024 or 2025 and where the 'Revenue Category' is 'digital' (case-insensitive).",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SAFE_CAST(t0.revenue_group_subtype AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025') AND LOWER(CASE WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'DIGITAL') THEN 'DIGITAL (excl.XTEND)' WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'PRINT') THEN 'PRINT' WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'XTEND') THEN 'XTEND ONLY' ELSE NULL END) IN ('digital')) GROUP BY SAFE_CAST(t0.revenue_group_subtype AS STRING) ORDER BY SAFE_CAST(t0.revenue_group_subtype AS STRING) ASC LIMIT 2000001",dimension,false,low,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
fin_adtype_name_filtered_non_print,fin_adtype_name,Financial Ad Type Name (Non-Print),"A list of unique financial ad type names, filtered for financial years 2024 or 2025 and where the 'Adjusted Revenue Type' is not 'PRINT' or is NULL.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SAFE_CAST(t0.fin_adtype_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025') AND (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END NOT IN ('PRINT') OR CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END IS NULL)) GROUP BY SAFE_CAST(t0.fin_adtype_name AS STRING) ORDER BY SAFE_CAST(t0.fin_adtype_name AS STRING) ASC LIMIT 2000001",dimension,false,low,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
min_dw_asl_load_timestamp,load_timestamp,Minimum Data Load Timestamp,"The earliest timestamp indicating when data was loaded into the ad sales performance table, truncated to the second.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT MIN(DATETIME_TRUNC(SAFE_CAST(t0.dw_asl_load_timestamp AS DATETIME), SECOND)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 LIMIT 1",aggregation,false,low,25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
current_fy_gross_revenue_raw,gross_revenue,Current FY Gross Revenue,Total gross revenue for the current financial year. This metric is displayed in raw currency units.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
current_fy_gross_revenue_thousands,gross_revenue,Current FY Gross Revenue (in Thousands),"Total gross revenue for the current financial year, expressed in thousands of currency units. This metric is displayed when a specific dashboard parameter is set.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS current_fy_gross_revenue_thousands FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
previous_fy_gross_revenue_raw,gross_revenue,Previous FY Gross Revenue,Total gross revenue for the previous financial year. This metric is displayed in raw currency units.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
previous_fy_gross_revenue_thousands,gross_revenue,Previous FY Gross Revenue (in Thousands),"Total gross revenue for the previous financial year, expressed in thousands of currency units. This metric is displayed when a specific dashboard parameter is set.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS previous_fy_gross_revenue_thousands FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,True,high,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
conditional_current_fy_gross_revenue,gross_revenue,Conditional Current FY Gross Revenue,"Gross revenue for the current financial year, conditional on either the unified publication name being one of 'OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE' OR the booking/fix date being before the previous year's reference date. This metric is displayed in raw currency units.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 0 AND UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE')) THEN t0.gross_revenue_amount WHEN (t0.relative_fy_year_offset = 0 AND (CASE WHEN (t0.revenue_type = 'DIGITAL' AND t0.revenue_group_subtype = 'DIGITAL' AND t0.sales_segment_l_2_name_sync = 'Digital Other' AND t0.advertiser_parent != 'DOUBLECLICK') THEN SAFE_CAST(t0.fix_date_lod AS DATETIME) ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-17 07:12:26.397969+00', 'Australia/Sydney'), INTERVAL -365 DAY)) THEN t0.gross_revenue_amount ELSE NULL END) AS conditional_current_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",calculated_field,False,medium,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
conditional_current_fy_gross_revenue_thousands,gross_revenue,Conditional Current FY Gross Revenue (in Thousands),"Gross revenue for the current financial year, conditional on either the unified publication name being one of 'OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE' OR the booking/fix date being before the previous year's reference date. Expressed in thousands of currency units.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 0 AND UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE')) THEN t0.gross_revenue_amount WHEN (t0.relative_fy_year_offset = 0 AND (CASE WHEN (t0.revenue_type = 'DIGITAL' AND t0.revenue_group_subtype = 'DIGITAL' AND t0.sales_segment_l_2_name_sync = 'Digital Other' AND t0.advertiser_parent != 'DOUBLECLICK') THEN SAFE_CAST(t0.fix_date_lod AS DATETIME) ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-17 07:12:26.397969+00', 'Australia/Sydney'), INTERVAL -365 DAY)) THEN t0.gross_revenue_amount ELSE NULL END, 1000)) AS conditional_current_fy_gross_revenue_thousands FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",calculated_field,False,medium,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
current_fy_gross_revenue_not_future_period_thousands,gross_revenue,"Current FY Gross Revenue (Not Future Period, in Thousands)","Gross revenue for the current financial year, excluding any amounts flagged as being for a future period, expressed in thousands of currency units.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 0 AND t0.is_future_period_flag = 'N') THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS current_fy_gross_revenue_not_future_period_thousands FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",calculated_field,False,medium,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
previous_fy_pipeline,pipeline,Previous FY Pipeline,Total pipeline amount for the previous financial year.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.pipeline ELSE 0 END) AS previous_fy_pipeline FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,True,high,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
min_dw_asl_load_timestamp,load_timestamp,Minimum Data Load Timestamp,The earliest timestamp indicating when data was loaded into the `adsales_performance` table. Useful for data freshness checks.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT MIN(DATETIME_TRUNC(t0.dw_asl_load_timestamp, SECOND)) AS min_dw_asl_load_timestamp FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",measure,False,low,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
is_digital_other_sales_segment_flag,digital_other_flag,Is Digital Other Sales Segment Flag,"A flag indicating if the sales segment L2 name sync is 'Digital Other'. Returns 1 if true, 0 if false.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT MAX(CASE WHEN t0.sales_segment_l_2_name_sync = 'Digital Other' THEN 1 ELSE 0 END) AS is_digital_other_sales_segment_flag FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,False,low,26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
total_budget_volume,total_budget_volume,Total Budget Volume,"The total budgeted volume for circulation, filtered by common dashboard criteria (Circulation, excluding Free News & Lifestyle, Food, Prestige, and for FY2025).",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(Budget_Volume) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,True,high,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
budget_volume_past_weeks,budget_volume_past_weeks,Budget Volume (Past Weeks),"The total budgeted volume for weeks prior to the current fiscal week (relative_fisc_week_number < 0), filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (relative_fisc_week_number < 0) THEN Budget_Volume ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
volume_vs_budget_variance_past_weeks,volume_vs_budget_variance_past_weeks,Volume vs. Budget Variance (Past Weeks),"The variance between actual volume and budgeted volume for weeks prior to the current fiscal week (relative_fisc_week_number < 0), filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(volume - (CASE WHEN (relative_fisc_week_number < 0) THEN Budget_Volume ELSE NULL END)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,True,high,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
total_volume,total_volume,Total Volume,"The total actual volume for circulation, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(volume) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,True,high,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
budget_amount_past_weeks,budget_amount_past_weeks,Budget Amount (Past Weeks),"The total budgeted amount for weeks prior to the current fiscal week (relative_fisc_week_number < 0), filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (relative_fisc_week_number < 0) THEN Budget_Amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
budget_amount_past_weeks_all_sales_channels,budget_amount_past_weeks,"Budget Amount (Past Weeks, All Sales Channels)","The total budgeted amount for weeks prior to the current fiscal week (relative_fisc_week_number < 0) specifically for 'ALL SALES CHANNELS', filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (relative_fisc_week_number < 0 AND UPPER(SAFE_CAST(os_level_7 AS STRING)) = 'ALL SALES CHANNELS') THEN Budget_Amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
actual_amount_ytd,actual_amount_ytd,Actual Amount YTD,"The year-to-date actual amount, calculated as the sum of Actual_Amount for fiscal weeks up to and including the current fiscal year week number, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (fy_week_of_year <= fy_year_week_number) THEN Actual_Amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,True,high,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
total_actual_amount,total_actual_amount,Total Actual Amount,"The total actual amount for circulation, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(Actual_Amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,True,high,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
volume_forecast_by_month,volume_forecast_by_month,Volume / Forecast Volume by Month,"A conditional volume metric: sums actual 'volume' for fiscal months 1-6, and 'Forecast_Volume' for fiscal months 7-12, filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (fy_month_of_year < 7) THEN volume ELSE Forecast_Volume END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
volume_forecast_by_month_all_sales_channels,volume_forecast_by_month,Volume / Forecast Volume by Month (All Sales Channels),"A conditional volume metric: sums actual 'volume' for fiscal months 1-6, and 'Forecast_Volume' for fiscal months 7-12, specifically for 'ALL SALES CHANNELS', filtered by common dashboard criteria.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (UPPER(SAFE_CAST(os_level_7 AS STRING)) = 'ALL SALES CHANNELS') THEN (CASE WHEN (fy_month_of_year < 7) THEN volume ELSE Forecast_Volume END) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND l04_publication_code <> 'Free News & Lifestyle' AND l06_publication_code NOT IN ('Food', 'Prestige') AND gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
average_daily_budget_volume,avg_daily_budget_volume,Average Daily Budget Volume,"Calculates the average daily budgeted volume. This is a highly complex metric involving nested conditional logic. It typically divides a base Budget_Volume by 6 or 7 days, but applies specific multipliers (e.g., *5, /2*5, /4*5) and overrides based on publication names ('The Sportsman', 'Weekly Times', 'PNG', 'The Australian', 'The Courier Mail'), specific fiscal weeks (26 or 40), and day of week ('M-F'). The exact logic is derived from the complex CASE statements in the source queries.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (CASE WHEN (t0.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin')) THEN '6 Day Pubs' WHEN (t0.publication_name = 'PNG') THEN 'PNG' ELSE 'Other' END) = 'PNG' THEN 0 WHEN (CASE WHEN (t0.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin')) THEN '6 Day Pubs' WHEN (t0.publication_name = 'PNG') THEN 'PNG' ELSE 'Other' END) = '6 Day Pubs' THEN SAFE_DIVIDE( (CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 26 OR DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 40) AND (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Australian' OR CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Courier Mail')) THEN (CASE WHEN (CASE WHEN (t0.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN 'M-F' WHEN (t0.day_of_week = 'Sat') THEN 'SAT' WHEN (t0.day_of_week = 'Sun') THEN 'Sun' ELSE NULL END = 'M-F') THEN (SAFE_DIVIDE(t0.Budget_Volume, 4)*5) ELSE t0.Budget_Volume END) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Sportsman') THEN (SAFE_DIVIDE(t0.Budget_Volume, 2)*5) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'Weekly Times') THEN (t0.Budget_Volume*5) WHEN (t0.publication_name = 'PNG') THEN 0 ELSE t0.Budget_Volume END), 6) ELSE SAFE_DIVIDE( (CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 26 OR DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 40) AND (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Australian' OR CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Courier Mail')) THEN (CASE WHEN (CASE WHEN (t0.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN 'M-F' WHEN (t0.day_of_week = 'Sat') THEN 'SAT' WHEN (t0.day_of_week = 'Sun') THEN 'Sun' ELSE NULL END = 'M-F') THEN (SAFE_DIVIDE(t0.Budget_Volume, 4)*5) ELSE t0.Budget_Volume END) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Sportsman') THEN (SAFE_DIVIDE(t0.Budget_Volume, 2)*5) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'Weekly Times') THEN (t0.Budget_Volume*5) WHEN (t0.publication_name = 'PNG') THEN 0 ELSE t0.Budget_Volume END), 7) END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
average_daily_actual_volume,avg_daily_actual_volume,Average Daily Actual Volume,"Calculates the average daily actual volume. This is a highly complex metric involving nested conditional logic. It typically divides a base 'volume' by 6 or 7 days, but applies specific multipliers (e.g., *5, /2*5, /4*5) and overrides based on publication names ('The Sportsman', 'Weekly Times', 'PNG', 'The Australian', 'The Courier Mail'), specific fiscal weeks (26 or 40), and day of week ('M-F'). The exact logic is derived from the complex CASE statements in the source queries.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT SUM(CASE WHEN (CASE WHEN (t0.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin')) THEN '6 Day Pubs' WHEN (t0.publication_name = 'PNG') THEN 'PNG' ELSE 'Other' END) = '6 Day Pubs' THEN SAFE_DIVIDE( (CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 26 OR DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 40) AND (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Australian' OR CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Courier Mail')) THEN (CASE WHEN (CASE WHEN (t0.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN 'M-F' WHEN (t0.day_of_week = 'Sat') THEN 'SAT' WHEN (t0.day_of_week = 'Sun') THEN 'Sun' ELSE NULL END = 'M-F') THEN (SAFE_DIVIDE(t0.volume, 5)*5) ELSE t0.volume END) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Sportsman') THEN (SAFE_DIVIDE(t0.volume, 2)*5) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'Weekly Times') THEN (t0.volume*5) WHEN (CASE WHEN (t0.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin')) THEN '6 Day Pubs' WHEN (t0.publication_name IN ('Mercury', 'Sunday Tasmanian')) THEN 'Mercury and Sunday Tas' WHEN (t0.publication_name IN ('NT News', 'Sunday Territorian')) THEN 'NT News & Sunday Territorian' WHEN (t0.publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital')) THEN 'Other' WHEN (t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)')) THEN 'The Courier Mail' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun')) THEN 'The Herald Sun' ELSE t0.publication_name END = 'PNG') THEN 0 WHEN (CASE WHEN (t0.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN 'M-F' WHEN (t0.day_of_week = 'Sat') THEN 'SAT' WHEN (t0.day_of_week = 'Sun') THEN 'Sun' ELSE NULL END = 'M-F') THEN (SAFE_DIVIDE(t0.volume, 5)*5) ELSE SAFE_DIVIDE(t0.volume, 1) END), 6) ELSE SAFE_DIVIDE( (CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 26 OR DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-05-08 23:49:20.601127+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 40) AND (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Australian' OR CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Courier Mail')) THEN (CASE WHEN (CASE WHEN (t0.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN 'M-F' WHEN (t0.day_of_week = 'Sat') THEN 'SAT' WHEN (t0.day_of_week = 'Sun') THEN 'Sun' ELSE NULL END = 'M-F') THEN (SAFE_DIVIDE(t0.volume, 5)*5) ELSE t0.volume END) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'The Sportsman') THEN (SAFE_DIVIDE(t0.volume, 2)*5) WHEN (CASE WHEN (t0.publication_name IN ('Sunday Herald Sun', 'Herald Sun')) THEN 'The Herald Sun' WHEN (t0.publication_name IN ('The Advertiser', 'Sunday Mail')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'The Sunday Mail')) THEN 'The Courier Mail' WHEN (t0.publication_name = 'The Australian') THEN 'The Australian' WHEN (t0.publication_name = 'The Sportsman') THEN 'The Sportsman' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name = 'Weekly Times') THEN 'Weekly Times' ELSE NULL END = 'Weekly Times') THEN (t0.volume*5) WHEN (CASE WHEN (t0.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin')) THEN '6 Day Pubs' WHEN (t0.publication_name IN ('Mercury', 'Sunday Tasmanian')) THEN 'Mercury and Sunday Tas' WHEN (t0.publication_name IN ('NT News', 'Sunday Territorian')) THEN 'NT News & Sunday Territorian' WHEN (t0.publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital')) THEN 'Other' WHEN (t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)')) THEN 'The Advertiser' WHEN (t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)')) THEN 'The Courier Mail' WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun')) THEN 'The Herald Sun' ELSE t0.publication_name END = 'PNG') THEN 0 WHEN (CASE WHEN (t0.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN 'M-F' WHEN (t0.day_of_week = 'Sat') THEN 'SAT' WHEN (t0.day_of_week = 'Sun') THEN 'Sun' ELSE NULL END = 'M-F') THEN (SAFE_DIVIDE(t0.volume, 5)*5) ELSE SAFE_DIVIDE(t0.volume, 1) END), 7) END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0 WHERE upper(t0.os_level_6) = 'CIRCULATION' AND t0.l04_publication_code <> 'Free News & Lifestyle' AND t0.l06_publication_code NOT IN ('Food', 'Prestige') AND t0.gl_hierarchy_code = 'FY2025'",measure,False,medium,27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
financial_year_sundry_adsales_overlay,financial_year,Financial Year (Sundry Adsales Overlay),Distinct financial years where the revenue group subtype is 'SUNDRY ADSALES OVERLAY'. Used for filtering or selecting relevant financial periods.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT financial_year FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE revenue_group_subtype = 'SUNDRY ADSALES OVERLAY',dimension,False,low,28,3ee20092-1897-49b7-8bcd-4157d5f816eb
gross_revenue_amount_nova_entertainment_2025,gross_revenue_amount,"Gross Revenue Amount (Nova Entertainment, FY2025)","Total gross revenue for 'Nova Entertainment Pty Ltd' in Financial Year 2025, excluding 'PRODUCTION' style, across 'DIGITAL', 'PRINT', and 'SUNDRY ADSALES OVERLAY' revenue types, broken down by financial year and numerical month.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT financial_year, (CASE WHEN financial_short_month = 'Jul' THEN 1 WHEN financial_short_month = 'Aug' THEN 2 WHEN financial_short_month = 'Sep' THEN 3 WHEN financial_short_month = 'Oct' THEN 4 WHEN financial_short_month = 'Nov' THEN 5 WHEN financial_short_month = 'Dec' THEN 6 WHEN financial_short_month = 'Jan' THEN 7 WHEN financial_short_month = 'Feb' THEN 8 WHEN financial_short_month = 'Mar' THEN 9 WHEN financial_short_month = 'Apr' THEN 10 WHEN financial_short_month = 'May' THEN 11 WHEN financial_short_month = 'Jun' THEN 12 ELSE NULL END) AS financial_month_num, SUM(gross_revenue_amount) AS gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE style_name != 'PRODUCTION' AND advertiser_name = 'Nova Entertainment Pty Ltd' AND financial_year = '2025' AND revenue_group_subtype IN ('DIGITAL', 'PRINT', 'SUNDRY ADSALES OVERLAY') GROUP BY financial_year, financial_month_num",measure,True,high,28,3ee20092-1897-49b7-8bcd-4157d5f816eb
revenue_group_subtype_2025,revenue_group_subtype,Revenue Group Subtype (FY2025),Distinct revenue group subtypes available for Financial Year 2025. Used for filtering or selecting revenue categories.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT revenue_group_subtype FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE financial_year = '2025',dimension,False,low,28,3ee20092-1897-49b7-8bcd-4157d5f816eb
gross_revenue_amount_digital_filtered_weeks,gross_revenue_amount,"Gross Revenue Amount (Digital, Filtered Weeks)","Total gross revenue for 'DIGITAL' revenue group subtype, excluding 'PRODUCTION' style, specific internal/admin publications, and financial weeks 47-52 (or NULL weeks), for Financial Years 2024 and 2025, broken down by financial ad type name, financial year, and financial week.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT fin_adtype_name, financial_year, SAFE_CAST(financial_week AS INT64) AS financial_week_num, SUM(gross_revenue_amount) AS gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE style_name != 'PRODUCTION' AND unified_publication_name NOT IN ('Admin.Sales', 'Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Qantas Travel Insider', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'Stockhead', 'TAUS.ADMIN', 'Taste.Admin', 'Vogue.Admin', 'Vogueliving.Admin', 'TOOWOOMBACUSTOM', 'odds.com.au', 'Shortlyster Managed Service NWN', 'Shortlyster Managed Service', 'Shortlyster Managed Service NQN', 'Shortlyster Managed Service GAD', 'SUDDENLY.TGG', 'SUDDENLY.CW', 'SUDDENLY.NORTH') AND financial_year IN ('2025', '2024') AND revenue_group_subtype = 'DIGITAL' AND (SAFE_CAST(financial_week AS INT64) NOT IN (47, 48, 49, 50, 51, 52) OR financial_week IS NULL) GROUP BY fin_adtype_name, financial_year, financial_week_num",measure,True,high,28,3ee20092-1897-49b7-8bcd-4157d5f816eb
financial_week_digital_2024,financial_week,"Financial Week (Digital, FY2024)",Distinct financial weeks for 'DIGITAL' revenue group subtype in Financial Year 2024. Used for filtering or selecting specific weeks.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT SAFE_CAST(financial_week AS INT64) AS financial_week FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE financial_year = '2024' AND revenue_group_subtype = 'DIGITAL',dimension,False,low,28,3ee20092-1897-49b7-8bcd-4157d5f816eb
revenue_group_subtype_filtered_weeks,revenue_group_subtype,Revenue Group Subtype (Filtered Weeks),"Distinct revenue group subtypes for Financial Years 2024 and 2025, excluding financial weeks 47-52 (or NULL weeks). Used for filtering or selecting revenue categories with specific week exclusions.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT revenue_group_subtype FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE financial_year IN ('2025', '2024') AND (SAFE_CAST(financial_week AS INT64) NOT IN (47, 48, 49, 50, 51, 52) OR financial_week IS NULL)",dimension,False,low,28,3ee20092-1897-49b7-8bcd-4157d5f816eb
dim_current_portfolio_owner,dim_portfolio_owner,Current Portfolio Conformed Owner,"The full name of the current owner of the conformed portfolio, defaulting to 'VACANT' if null, for 'Contra' advertisers.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_weekly,"SELECT IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY current_portfolio_conformed_owner_full LIMIT 10;",dimension,false,low,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
dim_portfolio_owner_filtered_by_industry_gm,dim_portfolio_owner,"Portfolio Owner (Contra, Renee Sycamore)",The portfolio owner filtered for 'Contra' industry pillar and 'Renee Sycamore' sales segment GM.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT current_portfolio_conformed_owner_full FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(nca_industry_pillar AS STRING) = 'Contra' AND SAFE_CAST(sales_segment_gm_name AS STRING) IN ('Renee Sycamore') GROUP BY current_portfolio_conformed_owner_full LIMIT 10;,dimension,false,low,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_amount,gross_revenue_amount,Gross Revenue Amount,"The total gross revenue amount, filtered for 'Contra' advertisers and specific transaction statuses/types.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) LIMIT 1;",measure,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_by_account_group_and_dimensions,gross_revenue_amount,Gross Revenue by Account Group and Key Dimensions,"Gross revenue amount grouped by advertiser name, calendar year month, financial month number, financial short month, financial year, portfolio conformed name, revenue type, and a special 'CTR_2023_AFL Sports...' account group.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT t0.advertiser_name, t0.calendar_year_month, t0.financial_month_no, t0.financial_short_month, t0.financial_year, t0.portfolio_conformed_name_current, t0.revenue_type, CASE WHEN (CASE WHEN (SAFE_CAST(t0.adpoint_account_number AS STRING) IN ('13019', '52246', '18387')) THEN 'ctr1' ELSE SAFE_CAST(t0.adpoint_account_number AS STRING) END = 'ctr1') THEN 'CTR_2023_AFL Sports CTR_2023_Sydney Swans CTR_2023_GWS Giants' ELSE SAFE_CAST(t0.advertiser_name AS STRING) END AS account_group, SUM(t0.gross_revenue_amount) AS gross_revenue_amount FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 GROUP BY t0.advertiser_name, t0.calendar_year_month, t0.financial_month_no, t0.financial_short_month, t0.financial_year, t0.portfolio_conformed_name_current, t0.revenue_type, account_group LIMIT 10;",aggregation,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
dim_account_status_asl,dim_account_status,Account Status (ASL),"Status of the account (Open/Closed) based on its presence in `contra_sheet_data` with 'Closed' status, for 'Contra' advertisers.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY status_asl LIMIT 10;",dimension,false,medium,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_minus_1,gross_revenue_amount_fy_offset,Gross Revenue (FY -1),"Gross revenue for the financial year offset by -1 (previous financial year), filtered by 'Open' status and 'Lou Barrett' GM.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) = -1 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_minus_1 FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') AND SAFE_CAST(t0.sales_segment_gm_name AS STRING) IN ('Lou Barrett') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_minus_2_or_less,gross_revenue_amount_fy_offset,Gross Revenue (FY -2 or less),"Gross revenue for financial years offset by -2 or less (older financial years), filtered by 'Open' status and 'Lou Barrett' GM.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) < -1 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_minus_2_or_less FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') AND SAFE_CAST(t0.sales_segment_gm_name AS STRING) IN ('Lou Barrett') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy,gross_revenue_amount_fy_offset,Gross Revenue (Current FY),"Gross revenue for the current financial year (offset 0), filtered by 'Open' status and 'Lou Barrett' GM.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) = 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_current FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') AND SAFE_CAST(t0.sales_segment_gm_name AS STRING) IN ('Lou Barrett') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_plus_1_or_more,gross_revenue_amount_fy_offset,Gross Revenue (FY +1 or more),"Gross revenue for financial years offset by +1 or more (future financial years), filtered by 'Open' status and 'Lou Barrett' GM.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) > 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_plus_1_or_more FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') AND SAFE_CAST(t0.sales_segment_gm_name AS STRING) IN ('Lou Barrett') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_total_fy_past,gross_revenue_amount_fy_offset,Gross Revenue (Total Past FY),"Total gross revenue for all past financial years (offset < 0), filtered by 'Open' status and 'Lou Barrett' GM.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) < 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_past FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') AND SAFE_CAST(t0.sales_segment_gm_name AS STRING) IN ('Lou Barrett') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_digital,gross_revenue_amount_by_revenue_type,Gross Revenue (Digital),"Gross revenue specifically for 'Digital' revenue type, filtered by 'Open' status and 'Lou Barrett' GM.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(revenue_type AS STRING) = 'Digital' THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_digital FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') AND SAFE_CAST(t0.sales_segment_gm_name AS STRING) IN ('Lou Barrett') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_minus_1_open_accounts,gross_revenue_amount_fy_offset,Gross Revenue (FY -1) for Open Accounts,"Gross revenue for the financial year offset by -1 (previous financial year), filtered by 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) = -1 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_minus_1 FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_minus_2_or_less_open_accounts,gross_revenue_amount_fy_offset,Gross Revenue (FY -2 or less) for Open Accounts,"Gross revenue for financial years offset by -2 or less (older financial years), filtered by 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) < -1 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_minus_2_or_less FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_open_accounts,gross_revenue_amount_fy_offset,Gross Revenue (Current FY) for Open Accounts,"Gross revenue for the current financial year (offset 0), filtered by 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) = 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_current FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_current_fy_plus_1_or_more_open_accounts,gross_revenue_amount_fy_offset,Gross Revenue (FY +1 or more) for Open Accounts,"Gross revenue for financial years offset by +1 or more (future financial years), filtered by 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) > 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_plus_1_or_more FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_total_fy_past_open_accounts,gross_revenue_amount_fy_offset,Gross Revenue (Total Past FY) for Open Accounts,"Total gross revenue for all past financial years (offset < 0), filtered by 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS BIGNUMERIC) < 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_fy_past FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
gross_revenue_digital_open_accounts,gross_revenue_amount_by_revenue_type,Gross Revenue (Digital) for Open Accounts,"Gross revenue specifically for 'Digital' revenue type, filtered by 'Open' status.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(revenue_type AS STRING) = 'Digital' THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_digital FROM ( SELECT financial_year, CAST(financial_month AS int) AS financial_month_no, financial_short_month, calendar_year_month, sales_segment_gm_name, portfolio_conformed_name_current, IFNULL(current_portfolio_conformed_owner_full_name_current, 'VACANT') AS current_portfolio_conformed_owner_full, advertiser_name, adpoint_account_number, revenue_type, relative_fy_year_offset, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`) THEN 'Y' ELSE 'N' END AS sheet_account_flag, CASE WHEN adpoint_account_number IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END AS status_asl, sum(gross_revenue_amount) AS gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) GROUP BY ALL ) AS t0 WHERE SAFE_CAST(t0.status_asl AS STRING) IN ('Open') LIMIT 1;",calculated_field,true,high,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
count_of_accounts_by_advertiser_name,count_of_accounts,Count of Accounts by Specific Advertiser Names,Counts the number of occurrences of account_number and adpoint_account_number pairs for a specific list of advertiser names.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SAFE_CAST(account_number AS STRING), SAFE_CAST(adpoint_account_number AS STRING), COUNT(1) AS account_count FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(advertiser_name AS STRING) IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia') GROUP BY SAFE_CAST(account_number AS STRING), SAFE_CAST(adpoint_account_number AS STRING) ORDER BY account_count DESC LIMIT 10;",aggregation,false,low,29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
scenario_dimension,scenario,Scenario,Represents the specific type or category of digital subscription scenario.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT DISTINCT SAFE_CAST(scenario AS STRING) AS scenario FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` LIMIT 1000;,dimension,false,medium,30,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
total_records_count,total_records,Total Records,"The total number of records or rows in the digital subscriptions dataset, representing the overall volume of data.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(1) AS total_records FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`;,measure,false,low,30,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
records_by_scenario_count,records_by_scenario,Records by Scenario,"The count of records for each distinct digital subscription scenario, providing a breakdown of data volume by scenario type.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SAFE_CAST(scenario AS STRING) AS scenario, COUNT(1) AS records_count FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` GROUP BY scenario;",aggregation,false,medium,30,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
add_volume,volume,Added Volume,The volume of new subscriptions or additions recorded.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT add_volume FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,false,medium,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
category_name,category,Category Name,The name of the category associated with the subscription or financial record.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT category_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,dimension,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
closing_base,base_count,Closing Base,The total base count at the end of a given period.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT closing_base FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,true,high,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
earned_amount,revenue,Earned Amount,The revenue amount earned for a specific period.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT earned_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,true,high,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
fiscal_week_id,fiscal_week,Fiscal Week ID,"The unique identifier for a fiscal week, typically in YYYYWW format.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT fiscal_week_id FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,dimension,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
gl_publication_code,publication_code,GL Publication Code,The General Ledger publication code associated with the financial entry.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT gl_publication_code FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,dimension,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
opening_base,base_count,Opening Base,The total base count at the beginning of a given period.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT opening_base FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,false,medium,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
red_volume,volume,Reduced Volume,The volume of cancelled subscriptions or reductions recorded.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT red_volume FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,false,medium,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
transfer_in,transfer_volume,Transfer In Volume,The volume of subscriptions or items transferred into a specific category or entity.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT transfer_in FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
transfer_out,transfer_volume,Transfer Out Volume,The volume of subscriptions or items transferred out of a specific category or entity.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT transfer_out FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`,measure,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
gl_acc,gl_account,GL Account,The General Ledger account code.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_gr_digsubs_estimate,SELECT gl_acc FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_gr_digsubs_estimate`,dimension,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
channel,channel,Channel,The distribution or sales channel for circulation.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_circulation_actuals,SELECT channel FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_circulation_actuals`,dimension,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
home_del_charge,charge_amount,Home Delivery Charge,The charge amount for home delivery services.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_circulation_actuals,SELECT home_del_charge FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_circulation_actuals`,measure,false,medium,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
returns_credit_amount,credit_amount,Returns Credit Amount,The credit amount issued for returned items or services.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_circulation_actuals,SELECT returns_credit_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_circulation_actuals`,measure,false,medium,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
rev_adjust,revenue_adjustment,Revenue Adjustment,An adjustment made to the revenue figures.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_circulation_actuals,SELECT rev_adjust FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_circulation_actuals`,measure,false,medium,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
state,state,State,The geographical state associated with the circulation data.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_circulation_actuals,SELECT state FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_circulation_actuals`,dimension,false,low,31,23c8b213-a9f0-4158-b8fa-bff14425abb5
closing_base_fy2025_wk38,closing_base,"Closing Base (Fiscal Week 38, FY2025)","The total number of digital subscriptions at the end of Fiscal Week 38 for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric is derived from the 'ClosingBase' column where the 'table_union_source' is 'bmasnap_close', 'SC - CODE Manual APLS', or 'SC Manual APLS'.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.ClosingBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS') AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
opening_base_fy2025_wk38,opening_base,"Opening Base (Fiscal Week 38, FY2025)","The total number of digital subscriptions at the beginning of Fiscal Week 38 for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric is derived from the 'OpeningBase' column where the 'table_union_source' is 'bmasnap_open'.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.OpeningBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND t0.table_union_source = 'bmasnap_open' AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
net_change_fy2025_wk38,net_change,"Net Change (Fiscal Week 38, FY2025)","The net change in digital subscriptions (Closing Base - Opening Base) for Fiscal Week 38, Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.ClosingBase AS BIGNUMERIC) - SAFE_CAST(t0.OpeningBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS', 'bmasnap_open') AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",calculated_field,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
earned_amount_fy2025,earned_amount,Earned Amount (Fiscal Year 2025),"The total earned amount for digital subscriptions in Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). Includes amounts from 'nfmanualhist' (for FY <= 2024) and 'subsnapfact' (for FY > 2024) table union sources.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist' THEN SAFE_CAST(t0.NFEarnedAmount AS BIGNUMERIC) WHEN t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact' THEN SAFE_CAST(t0.EarnedAmount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
earned_amount_ytd_fy2025,earned_amount,Earned Amount YTD (Fiscal Year 2025),"The total earned amount for digital subscriptions year-to-date (Fiscal Week 1 to 22) in Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric is derived from the 'EarnedAmount' column where the 'table_union_source' is 'subsnapfact'.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN t0.fy_year = 2025 AND t0.fy_week_of_year <= 22 AND t0.table_union_source = 'subsnapfact' THEN SAFE_CAST(t0.EarnedAmount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
forecast_total_acquisitions_fy2025,total_acquisition,Forecast Total Acquisitions (Fiscal Year 2025),"The total number of forecasted digital subscription acquisitions for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric dynamically selects between actual 'TotalAcquisition' (YTD, up to fiscal week 22) and 'ForecastAddsQty' (for weeks after 22).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN t0.fy_year = 2025 AND t0.fy_week_of_year <= 22 THEN SAFE_CAST(t0.TotalAcquisition AS BIGNUMERIC) WHEN t0.fy_year = 2025 AND t0.fy_week_of_year > 22 THEN SAFE_CAST(t0.ForecastAddsQty AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
forecast_total_cancellations_fy2025,total_cancellation,Forecast Total Cancellations (Fiscal Year 2025),"The total number of forecasted digital subscription cancellations for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric dynamically selects between actual 'TotalCancellation' (YTD, up to fiscal week 22) and 'ForecastCancelsQty' (for weeks after 22).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN t0.fy_year = 2025 AND t0.fy_week_of_year <= 22 THEN SAFE_CAST(t0.TotalCancellation AS BIGNUMERIC) WHEN t0.fy_year = 2025 AND t0.fy_week_of_year > 22 THEN SAFE_CAST(t0.ForecastCancelsQty AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,True,high,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
budget_closing_base_fy2025_wk38,closing_base,"Budget Closing Base (Fiscal Week 38, FY2025)","The budgeted number of digital subscriptions at the end of Fiscal Week 38 for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.BudgetClosingBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
budget_opening_base_fy2025_wk38,opening_base,"Budget Opening Base (Fiscal Week 38, FY2025)","The budgeted number of digital subscriptions at the beginning of Fiscal Week 38 for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.BudgetOpeningBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
budget_earned_amount_fy2025,earned_amount,Budget Earned Amount (Fiscal Year 2025),"The total budgeted earned amount for digital subscriptions in Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.BudgetEarnedAmount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
ny_budget_closing_base_fy2025_wk38,closing_base,"NY Budget Closing Base (Fiscal Week 38, FY2025)","The next year's budgeted number of digital subscriptions at the end of Fiscal Week 38 for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.NYBudgetClosingBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
ny_budget_opening_base_fy2025_wk38,opening_base,"NY Budget Opening Base (Fiscal Week 38, FY2025)","The next year's budgeted number of digital subscriptions at the beginning of Fiscal Week 38 for Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.NYBudgetOpeningBase AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 38 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
ny_budget_earned_amount_fy2025,earned_amount,NY Budget Earned Amount (Fiscal Year 2025),"The next year's budgeted earned amount for digital subscriptions in Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(SAFE_CAST(t0.NYBudgetEarnedAmount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
forecast_closing_base_fy2025,closing_base,Forecast Closing Base (Fiscal Year 2025),"The forecasted number of digital subscriptions at the end of Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric dynamically selects between actual 'ClosingBase' (YTD, up to fiscal week 22) and 'ForecastClosingBase' (for weeks after 22).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN t0.fy_year = 2025 AND t0.fy_week_of_year <= 22 THEN SAFE_CAST(t0.ClosingBase AS BIGNUMERIC) WHEN t0.fy_year = 2025 AND t0.fy_week_of_year > 22 THEN SAFE_CAST(t0.ForecastClosingBase AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
forecast_opening_base_fy2025,opening_base,Forecast Opening Base (Fiscal Year 2025),"The forecasted number of digital subscriptions at the beginning of Fiscal Year 2025, for 'Digital Recognition' mastheads not classified as 'Discontinued', and associated with specific billing systems/rate plans (App Store, Google Play, SWG, Apple Store). This metric dynamically selects between actual 'OpeningBase' (YTD, up to fiscal week 22) and 'ForecastOpeningBase' (for weeks after 22).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN t0.fy_year = 2025 AND t0.fy_week_of_year <= 22 AND t0.table_union_source = 'bmasnap_open' THEN SAFE_CAST(t0.OpeningBase AS BIGNUMERIC) WHEN t0.fy_year = 2025 AND t0.fy_week_of_year > 22 THEN SAFE_CAST(t0.ForecastOpeningBase AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE t0.fy_year = 2025 AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros' WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.dw_billing_system_code IN ('APLP', 'APLS', 'GPLA', 'SWG')) THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Podcasts') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Apple Store') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Google Play') THEN true WHEN (t0.table_union_source = 'budgetforecast' AND t0.rate_plan_group_name = 'Subscribe with Google (SWG)') THEN true ELSE false END) = true",measure,False,medium,32,d05b3d29-4437-4ee5-987a-e0109eb9590e
revenue_net_by_transaction_type_grouped,total_revenue_net,Total Revenue Net by Transaction Type Group,"Total net revenue categorized by a custom grouping of transaction types (Guaranteed, Deal, Open Auction, or original type). This metric is crucial for understanding revenue distribution across different programmatic deal types.",ncau-data-newsquery-prd,prstn_advertising,programmatic_60_day_view,"SELECT
  CASE
    WHEN (t0.TransactionType = 'AG' OR t0.TransactionType = 'PG - CPM' OR t0.TransactionType = 'PG - CPD') THEN 'Guaranteed'
    WHEN (t0.TransactionType = 'Deal' OR t0.TransactionType = 'pmp' OR t0.TransactionType = 'PMP_DEAL' OR t0.TransactionType = 'UFR') THEN 'Deal'
    WHEN (t0.TransactionType = 'Open Auction' OR t0.TransactionType = 'RTB' OR t0.TransactionType = 'Unknown') THEN 'Open Auction'
    ELSE SAFE_CAST(t0.TransactionType AS STRING)
  END AS TransactionType_Grouped,
  SUM(t0.RevenueNet) AS Total_Revenue_Net
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
GROUP BY TransactionType_Grouped
LIMIT 100",measure,True,high,33,b15d856f-e3ce-4991-bf2a-92395390524f
revenue_net_by_product_type,total_revenue_net,Total Revenue Net by Product Type,Total net revenue categorized by the product type. This helps in analyzing revenue performance across different product offerings.,ncau-data-newsquery-prd,prstn_advertising,programmatic_60_day_view,"SELECT
  t0.ProductType,
  SUM(t0.RevenueNet) AS Total_Revenue_Net
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
GROUP BY t0.ProductType
LIMIT 100",measure,True,high,33,b15d856f-e3ce-4991-bf2a-92395390524f
ssp_date_formatted_mmdd,ssp_date,SSP Date (MMDD Format),"The SSP Date formatted as MonthDay (e.g., 0207 for Feb 7th), used for time-series grouping or filtering, particularly for rolling period analysis where the year is less relevant than the day of the year.",ncau-data-newsquery-prd,prstn_advertising,programmatic_60_day_view,"SELECT
  SAFE_CAST(FORMAT_DATETIME('%m%d', SAFE_CAST(t0.SSPDate AS DATETIME)) AS INT64) AS SSPDate_MMDD
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
GROUP BY SSPDate_MMDD
ORDER BY SSPDate_MMDD ASC
LIMIT 100",dimension,False,medium,33,b15d856f-e3ce-4991-bf2a-92395390524f
gross_revenue_current_fy,gross_revenue,Gross Revenue (Current Financial Year),Total gross revenue for the current financial year.,ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_current_fy FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,True,high,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_previous_fy,gross_revenue,Gross Revenue (Previous Financial Year),Total gross revenue for the previous financial year.,ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_previous_fy FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,True,high,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_previous_fy_same_period,gross_revenue,Gross Revenue (Previous Financial Year Same Period),"Gross revenue for the previous financial year up to the same period (date) as the current year, based on booking line created date.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 AND SAFE_CAST(t0.booking_line_created_date AS DATE) <= (CURRENT_DATE('Australia/Sydney') - INTERVAL 365 DAY) THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_previous_fy_same_period FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,medium,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_previous_fy_conditional_month_offset,gross_revenue,Gross Revenue (Previous Financial Year Conditional on Month Offset),"Gross revenue for the previous financial year, where the calculation switches between total previous FY revenue and previous FY same period revenue based on whether the financial month offset is more than 12 months in the past.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_month_offset AS INT64) < -12 THEN (CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 THEN t0.gross_revenue_amount ELSE 0 END) ELSE (CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 AND SAFE_CAST(t0.booking_line_created_date AS DATE) <= (CURRENT_DATE('Australia/Sydney') - INTERVAL 365 DAY) THEN t0.gross_revenue_amount ELSE 0 END) END) AS gross_revenue_previous_fy_conditional_month_offset FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,medium,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_current_cal_q4_ms_not_other_xtend_n,gross_revenue_segmented,"Gross Revenue (Current Cal Year Q4, Managed Service Not Other, Xtend N)","Gross revenue for the current calendar year, Q4, for accounts with Managed Service Flag not 'Other' and Xtend Flag 'N'.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_cal_year_offset AS INT64) = 0 AND SAFE_CAST(t0.calendar_quarter AS INT64) = 4 AND t0.Managed_Service_Fl != 'Other' AND t0.xtend_flag = 'N' THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_current_cal_q4_ms_not_other_xtend_n FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,low,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_prev_fy_q1_ms_other_xtend_n,gross_revenue_segmented,"Gross Revenue (Previous FY Q1, Managed Service Other, Xtend N)","Gross revenue for the previous financial year, Q1, for accounts with Managed Service Flag 'Other' and Xtend Flag 'N'.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 AND SAFE_CAST(t0.financial_quarter AS INT64) = 1 AND t0.Managed_Service_Fl = 'Other' AND t0.xtend_flag = 'N' THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_prev_fy_q1_ms_other_xtend_n FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,low,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_current_cal_xtend_y,gross_revenue_segmented,"Gross Revenue (Current Calendar Year, Xtend Y)",Gross revenue for the current calendar year for accounts with Xtend Flag 'Y'.,ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_cal_year_offset AS INT64) = 0 AND t0.xtend_flag = 'Y' THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_current_cal_xtend_y FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,low,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_prev_cal_q2_ms_not_other_xtend_n,gross_revenue_segmented,"Gross Revenue (Previous Calendar Year Q2, Managed Service Not Other, Xtend N)","Gross revenue for the previous calendar year, Q2, for accounts with Managed Service Flag not 'Other' and Xtend Flag 'N'.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_cal_year_offset AS INT64) = -1 AND SAFE_CAST(t0.calendar_quarter AS INT64) = 2 AND t0.Managed_Service_Fl != 'Other' AND t0.xtend_flag = 'N' THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_prev_cal_q2_ms_not_other_xtend_n FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,low,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_current_fy_q2_xtend_y,gross_revenue_segmented,"Gross Revenue (Current Financial Year Q2, Xtend Y)","Gross revenue for the current financial year, Q2, for accounts with Xtend Flag 'Y'.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = 0 AND SAFE_CAST(t0.financial_quarter AS INT64) = 2 AND t0.xtend_flag = 'Y' THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_current_fy_q2_xtend_y FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,False,low,34,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_amount_difference_excluding_min_week,gross_amount_difference,Gross Amount Difference (Excluding Min Week),"The sum of gross amount differences from the revenue movement table, excluding records where the movement financial week is the minimum week for that account.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(t0.GROSS_AMOUNT_DIFF) AS gross_amount_difference_excluding_min_week FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE SAFE_CAST(t0.movement_financial_week AS INT64) != SAFE_CAST(t0.min_week AS INT64),measure,True,high,34,fed70b12-c274-4cde-9920-592ca4c4dab0
actual_amount_fy25_total_rev_exp_news_media_wk40_by_dims,actual_amount,"Actual Amount (FY2025, Total Revenue/Expenses, News Media, Week 40) by Dimensions","Total actual financial amount for FY2025, categorized as Total Revenue or Total Expenses, specifically for News Media Publishing, for fiscal week 40, broken down by fiscal week, print/digital flag, L12 publication code, OS Level 6, OS Level 9, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_6 AS STRING) AS os_level_6,
  SAFE_CAST(os.os_level_9 AS STRING) AS os_level_9,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Actual_Amount AS BIGNUMERIC)) AS actual_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
budget_amount_fy25_total_rev_exp_news_media_wk40_by_dims,budget_amount,"Budget Amount (FY2025, Total Revenue/Expenses, News Media, Week 40) by Dimensions","Total budget financial amount for FY2025, categorized as Total Revenue or Total Expenses, specifically for News Media Publishing, for fiscal week 40, broken down by fiscal week, print/digital flag, L12 publication code, OS Level 6, OS Level 9, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_6 AS STRING) AS os_level_6,
  SAFE_CAST(os.os_level_9 AS STRING) AS os_level_9,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Budget_Amount AS BIGNUMERIC)) AS budget_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
forecast_amount_fy25_total_rev_exp_news_media_wk40_by_dims,forecast_amount,"Forecast Amount (FY2025, Total Revenue/Expenses, News Media, Week 40) by Dimensions","Total forecast financial amount for FY2025, categorized as Total Revenue or Total Expenses, specifically for News Media Publishing, for fiscal week 40, broken down by fiscal week, print/digital flag, L12 publication code, OS Level 6, OS Level 9, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_6 AS STRING) AS os_level_6,
  SAFE_CAST(os.os_level_9 AS STRING) AS os_level_9,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Forecast_Amount AS BIGNUMERIC)) AS forecast_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
record_count_by_os_level_5,record_count,Record Count by OS Level 5,"Count of records grouped by OS Level 5, providing a breakdown of data volume across this dimension.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(os.os_level_5 AS STRING) AS os_level_5,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
GROUP BY
  1",measure,False,medium,35,b1c5901f-a535-42eb-870d-05cc025f7c27
fiscal_year_wk40_41_dimension,fiscal_year,Fiscal Year (Weeks 40-41),Distinct fiscal years for which data exists for fiscal weeks 40 or 41.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT DISTINCT
  SAFE_CAST(calendar.fy_year AS INT) AS fiscal_year
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
WHERE
  SAFE_CAST(calendar.fy_week_of_year AS INT) IN (40, 41)",dimension,False,low,35,b1c5901f-a535-42eb-870d-05cc025f7c27
actual_amount_fy25_total_rev_exp_wk40_by_dims,actual_amount,"Actual Amount (FY2025, Total Revenue/Expenses, Week 40) by Dimensions","Total actual financial amount for FY2025, categorized as Total Revenue or Total Expenses, for fiscal week 40, broken down by fiscal week, print/digital flag, L12 publication code, OS Level 5, OS Level 9, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_5 AS STRING) AS os_level_5,
  SAFE_CAST(os.os_level_9 AS STRING) AS os_level_9,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Actual_Amount AS BIGNUMERIC)) AS actual_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
actual_amount_fy25_total_rev_exp_news_media_wk40_circ_sub_cont_lic_by_dims,actual_amount,"Actual Amount (FY2025, Total Revenue/Expenses, News Media, Week 40, Circulation/Subscription/Content Licensing) by Dimensions","Total actual financial amount for FY2025, categorized as Total Revenue or Total Expenses, specifically for News Media Publishing, for fiscal week 40, and further filtered by OS Level 6 categories (Circulation, Subscription, Content Licensing), broken down by fiscal week, print/digital flag, L12 publication code, OS Level 6, OS Level 7, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_6 AS STRING) AS os_level_6,
  SAFE_CAST(os.os_level_7 AS STRING) AS os_level_7,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Actual_Amount AS BIGNUMERIC)) AS actual_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
  AND SAFE_CAST(os.os_level_6 AS STRING) IN ('Circulation', 'Subscription', 'Content Licensing')
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
budget_amount_fy25_total_rev_exp_news_media_wk40_circ_sub_cont_lic_by_dims,budget_amount,"Budget Amount (FY2025, Total Revenue/Expenses, News Media, Week 40, Circulation/Subscription/Content Licensing) by Dimensions","Total budget financial amount for FY2025, categorized as Total Revenue or Total Expenses, specifically for News Media Publishing, for fiscal week 40, and further filtered by OS Level 6 categories (Circulation, Subscription, Content Licensing), broken down by fiscal week, print/digital flag, L12 publication code, OS Level 6, OS Level 7, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_6 AS STRING) AS os_level_6,
  SAFE_CAST(os.os_level_7 AS STRING) AS os_level_7,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Budget_Amount AS BIGNUMERIC)) AS budget_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
  AND SAFE_CAST(os.os_level_6 AS STRING) IN ('Circulation', 'Subscription', 'Content Licensing')
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
forecast_amount_fy25_total_rev_exp_news_media_wk40_circ_sub_cont_lic_by_dims,forecast_amount,"Forecast Amount (FY2025, Total Revenue/Expenses, News Media, Week 40, Circulation/Subscription/Content Licensing) by Dimensions","Total forecast financial amount for FY2025, categorized as Total Revenue or Total Expenses, specifically for News Media Publishing, for fiscal week 40, and further filtered by OS Level 6 categories (Circulation, Subscription, Content Licensing), broken down by fiscal week, print/digital flag, L12 publication code, OS Level 6, OS Level 7, and publication name.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  SAFE_CAST(pub.is_print_digital_flag AS STRING) AS is_print_digital_flag,
  SAFE_CAST(pub.l12_publication_code AS STRING) AS l12_publication_code,
  SAFE_CAST(os.os_level_6 AS STRING) AS os_level_6,
  SAFE_CAST(os.os_level_7 AS STRING) AS os_level_7,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SUM(SAFE_CAST(os.Forecast_Amount AS BIGNUMERIC)) AS forecast_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) = 40
  AND SAFE_CAST(os.os_level_6 AS STRING) IN ('Circulation', 'Subscription', 'Content Licensing')
GROUP BY
  1, 2, 3, 4, 5, 6",measure,True,high,35,b1c5901f-a535-42eb-870d-05cc025f7c27
fiscal_year_wk40_dimension,fiscal_year,Fiscal Year (Week 40),Distinct fiscal years for which data exists for fiscal week 40.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT DISTINCT
  SAFE_CAST(calendar.fy_year AS INT) AS fiscal_year
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
WHERE
  SAFE_CAST(calendar.fy_week_of_year AS INT) = 40",dimension,False,low,35,b1c5901f-a535-42eb-870d-05cc025f7c27
total_gross_revenue_2024_2025_greyhound,total_gross_revenue,"Total Gross Revenue (2024-2025 FY, Greyhound Racing Victoria)","The sum of gross revenue amounts for advertising sales, specifically for 'Greyhound Racing Victoria' for calendar years 2024 and 2025, with billed or booked transactions, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(t0.gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.calendar_year IN ('2024', '2025') AND t0.advertiser_name IN ('Greyhound Racing Victoria')",measure,True,high,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
sum_of_calendar_month_values_all_years,sum_of_calendar_month_values,Sum of Calendar Month Values,"The sum of numerical representations of calendar months, for all years, with billed or booked transactions, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes. This metric's business utility is unclear and may indicate a misconfiguration or a highly specific, unusual tracking method.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(SAFE_CAST(t0.calendar_month AS FLOAT64)) AS sum_of_calendar_month_values FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print')",measure,False,low,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
publication_name_202_financial_year,publication_name,Publication Name (202x FY),"Distinct publication names for financial year '202x' (likely 2020 or 2021), with billed or booked revenue, excluding 'Medium Rare Content Agency'.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.publication_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.financial_year IN ('202')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
calendar_month_filtered_puig,calendar_month,"Calendar Month (Filtered for PUIG, excluding 2022)","Distinct calendar months, excluding 2022, for specific advertisers ('INTERNAL PUIG Oceania', 'PUIG Oceania'), with billed or booked revenue, excluding 'Medium Rare Content Agency', and 'Digital' or 'Print' revenue subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.calendar_month FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND (t0.calendar_year NOT IN ('2022') OR t0.calendar_year IS NULL) AND t0.advertiser_name IN ('INTERNAL PUIG Oceania', 'PUIG Oceania')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
calendar_year_all_filtered,calendar_year,Calendar Year (All Filtered),"Distinct calendar years for billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.calendar_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
financial_month_2024_2025,financial_month,Financial Month (2024-2025 FY),"Distinct financial months for financial years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.financial_month FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.financial_year IN ('2024', '2025')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
financial_year_2024_2025,financial_year,Financial Year (2024-2025 FY),"Distinct financial years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.financial_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.financial_year IN ('2024', '2025')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
advertiser_group_2024_2025,advertiser_group,Advertiser Group (2024-2025 FY),"Distinct advertiser groups for financial years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.advertiser_group FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.financial_year IN ('2024', '2025')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
advertiser_name_greyhound_2024_2025,advertiser_name,"Advertiser Name (Greyhound, 2024-2025 FY)","Distinct advertiser names, specifically 'Greyhound Racing Victoria', for calendar years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.advertiser_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.calendar_year IN ('2024', '2025') AND t0.advertiser_name IN ('Greyhound Racing Victoria')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
booking_number_greyhound_2024_2025,booking_number,"Booking Number (Greyhound, 2024-2025 FY)","Distinct booking numbers for 'Greyhound Racing Victoria' for calendar years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.booking_number FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.calendar_year IN ('2024', '2025') AND t0.advertiser_name IN ('Greyhound Racing Victoria')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
revenue_type_greyhound_2024_2025,revenue_type,"Revenue Type (Greyhound, 2024-2025 FY)","Distinct revenue types for 'Greyhound Racing Victoria' for calendar years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.revenue_type FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.calendar_year IN ('2024', '2025') AND t0.advertiser_name IN ('Greyhound Racing Victoria')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
source_unified_publication_name_greyhound_2024_2025,source_unified_publication_name,"Source Unified Publication Name (Greyhound, 2024-2025 FY)","Distinct source unified publication names for 'Greyhound Racing Victoria' for calendar years 2024 and 2025, with billed or booked revenue, excluding 'Medium Rare Content Agency' and focusing on 'Digital' or 'Print' revenue group subtypes.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT t0.source_unified_publication_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') AND t0.calendar_year IN ('2024', '2025') AND t0.advertiser_name IN ('Greyhound Racing Victoria')",dimension,False,medium,36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
total_subscriptions_digital_all_mastheads,total_subscriptions,Total Digital Subscriptions (All Mastheads),"Counts the total number of digital subscriptions across all mastheads, excluding 'Discontinued' mastheads. (Note: Original SQL summed a week number, likely a Looker Studio misconfiguration; this metric assumes a count of records was intended).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition',measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
fiscal_week_month_label_2025,fiscal_week_month_label,Fiscal Week and Month Label (FY2025),"A concatenated string representing the fiscal year, week number, and corresponding month for FY2025. (Note: The date is fixed in the original query, so this will always return the same string).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT MIN(CONCAT('FY ','2025',' Week ',SAFE_CAST(DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AS STRING),' (',CASE WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 4) THEN 'July' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 9) THEN 'August' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 13) THEN 'September' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 17) THEN 'October' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 22) THEN 'November' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 26) THEN 'December' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 30) THEN 'January' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 35) THEN 'February' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 39) THEN 'March' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 43) THEN 'April' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 48) THEN 'May' WHEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-03-23 04:54:02.058726+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 53) THEN 'June' ELSE NULL END,')') FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued'",dimension,False,low,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
comparison_type_budget,comparison_type_budget_forecast_yoy,Comparison Type (Budget),"Indicates the comparison type, specifically 'BUD' (Budget).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT MIN(CASE WHEN (1 = 1) THEN 'BUD' WHEN (1 = 2) THEN 'FCT' WHEN (1 = 3) THEN 'YOY' WHEN (1 = 4) THEN 'BUD NY' ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition',dimension,False,low,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
comparison_type_forecast,comparison_type_budget_forecast_yoy,Comparison Type (Forecast),"Indicates the comparison type, specifically 'FCT' (Forecast).",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT MIN(CASE WHEN (2 = 1) THEN 'BUD' WHEN (2 = 2) THEN 'FCT' WHEN (2 = 3) THEN 'YOY' WHEN (2 = 4) THEN 'BUD NY' ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition',dimension,False,low,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
gross_cancellations_label,acquisition_cancellation_type,Gross Cancellations Label,Label indicating 'Gross Cancellations'.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT MIN(CASE WHEN (1 = 1) THEN 'Gross Cancellations' WHEN (1 = 2) THEN 'Net Cancellations' ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition',dimension,False,low,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
gross_acquisitions_label,acquisition_cancellation_type,Gross Acquisitions Label,Label indicating 'Gross Acquisitions'.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT MIN(CASE WHEN (1 = 1) THEN 'Gross Acquisitions' WHEN (1 = 2) THEN 'Net Acquisitions' ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition',dimension,False,low,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
opening_base_total,opening_base,Total Opening Base,The total opening base value for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.OpeningBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
closing_base_total,closing_base,Total Closing Base,The total closing base value for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.ClosingBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
earned_amount_total,earned_amount,Total Earned Amount,The total earned amount for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.EarnedAmount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
budget_opening_base_total,budget_opening_base,Total Budget Opening Base,The total budgeted opening base value for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.BudgetOpeningBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
budget_closing_base_total,budget_closing_base,Total Budget Closing Base,The total budgeted closing base value for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.BudgetClosingBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
budget_earned_amount_total,budget_earned_amount,Total Budget Earned Amount,The total budgeted earned amount for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.BudgetEarnedAmount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
ny_budget_opening_base_total,ny_budget_opening_base,Total Next Year Budget Opening Base,The total budgeted opening base value for the next fiscal year for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.NYBudgetOpeningBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
ny_budget_closing_base_total,ny_budget_closing_base,Total Next Year Budget Closing Base,The total budgeted closing base value for the next fiscal year for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.NYBudgetClosingBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
ny_budget_earned_amount_total,ny_budget_earned_amount,Total Next Year Budget Earned Amount,The total budgeted earned amount for the next fiscal year for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.NYBudgetEarnedAmount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
forecast_opening_base_total,forecast_opening_base,Total Forecast Opening Base,The total forecasted opening base value for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.ForecastOpeningBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
forecast_closing_base_total,forecast_closing_base,Total Forecast Closing Base,The total forecasted closing base value for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.ForecastClosingBase) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
forecast_budget_earned_amount_total,forecast_budget_earned_amount,Total Forecast Budget Earned Amount,The total forecasted budgeted earned amount for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.ForecastBudgetEarnedAmount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
nf_earned_amount_total,nf_earned_amount,Total NF Earned Amount,The total NF (Non-Financial?) earned amount for digital subscriptions.,ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(t0.NFEarnedAmount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0,measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
budget_opening_base_fy2025_metros,budget_opening_base,"Budget Opening Base (FY2025, Metros)","The sum of Budget Opening Base for Fiscal Year 2025, specifically for 'Metros' masthead group and 'Digital Recognition' type.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025) THEN t0.BudgetOpeningBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'The Australian') THEN '01.The Australian' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Metros') THEN '02.Metros' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Regionals') THEN '03.Regionals' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Others') THEN '04.Others' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Deep Niche Publications') THEN '05.Deep Niche Publications' ELSE NULL END) IN ('02.Metros'),measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
closing_base_fy2025_bmasnap_close_metros,closing_base,"Closing Base (FY2025, BMA Snapshot Close, Metros)","The sum of Closing Base for Fiscal Year 2025, specifically from 'bmasnap_close' or similar table union sources, for 'Metros' masthead group and 'Digital Recognition' type.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'The Australian') THEN '01.The Australian' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Others') THEN '04.Others' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Deep Niche Publications') THEN '05.Deep Niche Publications' ELSE NULL END) IN ('02.Metros')",measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
earned_amount_nf_or_base_conditional_metros,earned_amount,"Earned Amount (NF or Base, Conditional, Metros)","The sum of NFEarnedAmount (if fy_year <= 2024 and table_union_source is 'nfmanualhist') or EarnedAmount (if fy_year > 2024 and table_union_source is 'subsnapfact'), for 'Metros' masthead group and 'Digital Recognition' type.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN ((t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') OR (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact')) THEN t0.NFEarnedAmount WHEN ((t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') OR (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact')) THEN t0.EarnedAmount ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'The Australian') THEN '01.The Australian' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Others') THEN '04.Others' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Deep Niche Publications') THEN '05.Deep Niche Publications' ELSE NULL END) IN ('02.Metros'),measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
closing_base_or_forecast_by_week_fy2025_metros,closing_base,"Closing Base or Forecast Closing Base (FY2025, by Week, Metros)","The sum of Closing Base for FY2025 and weeks up to 22, or Forecast Closing Base for FY2025 and weeks after 22, for 'Metros' masthead group and 'Digital Recognition' type.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year <= 22) THEN t0.ClosingBase WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year > 22) THEN t0.ForecastClosingBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) != 'Discontinued' AND (CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' AND (CASE WHEN (CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'The Australian') THEN '01.The Australian' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Others') THEN '04.Others' WHEN ((CASE WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others' ELSE 'Discontinued' END) = 'Deep Niche Publications') THEN '05.Deep Niche Publications' ELSE NULL END) IN ('02.Metros'),measure,True,high,37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
day_of_week_formatted,day_of_week,Day of Week (Formatted),"The day of the week, formatted with leading spaces for specific sorting or display purposes in the dashboard.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT CASE WHEN SAFE_CAST(dow AS STRING) = 'Monday' THEN 'Monday' WHEN SAFE_CAST(dow AS STRING) = 'Tuesday' THEN ' Tuesday' WHEN SAFE_CAST(dow AS STRING) = 'Wednesday' THEN '  Wednesday' WHEN SAFE_CAST(dow AS STRING) = 'Thursday' THEN '   Thursday' WHEN SAFE_CAST(dow AS STRING) = 'Friday' THEN '    Friday' WHEN SAFE_CAST(dow AS STRING) = 'Saturday' THEN '     Saturday' WHEN SAFE_CAST(dow AS STRING) = 'Sunday' THEN '      Sunday' ELSE NULL END FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,calculated_field,False,low,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
account_number,account_number,Account Number,Unique identifier for an account.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(account_number AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
financial_year_selected,year_selection,Financial Year (Selected),"The financial year, used as a filter or dimension. This specific metric represents the financial year when the 'Fin' parameter is active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(financial_year AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
calendar_year_selected,year_selection,Calendar Year (Selected),"The calendar year, used as a filter or dimension. This specific metric represents the calendar year when the 'Fin' parameter is not active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(calendar_year AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,low,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
portfolio_group_name_current_selected,portfolio_group_name,Portfolio Group Name (Current),"The current name of the portfolio group, used as a filter or dimension. This specific metric represents the current name when the 'Curr' parameter is active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(portfolio_group_name_current AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
portfolio_group_name_sync_selected,portfolio_group_name,Portfolio Group Name (Sync),"The synchronized name of the portfolio group, used as a filter or dimension. This specific metric represents the synchronized name when the 'Curr' parameter is not active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(portfolio_group_name_sync AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,low,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
portfolio_parent_group_name_current_selected,portfolio_parent_group_name,Portfolio Parent Group Name (Current),"The current name of the parent portfolio group, used as a filter or dimension. This specific metric represents the current name when the 'Curr' parameter is active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(portfolio_parent_group_name_current AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
portfolio_parent_group_name_sync_selected,portfolio_parent_group_name,Portfolio Parent Group Name (Sync),"The synchronized name of the parent portfolio group, used as a filter or dimension. This specific metric represents the synchronized name when the 'Curr' parameter is not active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(portfolio_parent_group_name_sync AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,low,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
revenue_type_xtend,revenue_type,Revenue Type (with XTEND),"The type of revenue, with 'XTEND' as a specific category if the 'xtend_flag' is 'Y'.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT CASE WHEN SAFE_CAST(xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(revenue_type AS STRING) END FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,calculated_field,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
unified_publication_name,unified_publication_name,Unified Publication Name,The standardized name of the publication.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(unified_publication_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
advertiser_name,advertiser_name,Advertiser Name,The name of the advertiser.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(advertiser_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
financial_short_month_selected,month_selection,Financial Short Month (Selected),"The short name of the financial month (e.g., 'Jan', 'Feb'), used as a filter or dimension. This specific metric represents the financial month when the 'Fin' parameter is active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(financial_short_month AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
calendar_short_month_selected,month_selection,Calendar Short Month (Selected),"The short name of the calendar month (e.g., 'Jan', 'Feb'), used as a filter or dimension. This specific metric represents the calendar month when the 'Fin' parameter is not active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(calendar_month_short_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,low,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
employee_name,employee_name,Employee Name,The name of the employee associated with the record.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(employee_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
portfolio_conformed_name_current_selected,portfolio_conformed_name,Portfolio Conformed Name (Current),"The current conformed name of the portfolio, used as a filter or dimension. This specific metric represents the current name when the 'Curr' parameter is active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(portfolio_conformed_name_current AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
portfolio_conformed_name_sync_selected,portfolio_conformed_name,Portfolio Conformed Name (Sync),"The synchronized conformed name of the portfolio, used as a filter or dimension. This specific metric represents the synchronized name when the 'Curr' parameter is not active.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(portfolio_conformed_name_sync AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,low,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
publication_date,publication_date,Publication Date,The date of publication.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(publication_date AS DATE) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
agency_group,agency_group,Agency Group,The group name of the agency.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(agency_group AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` LIMIT 1000,dimension,False,medium,38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
total_gross_revenue_amount,gross_revenue_amount,Total Gross Revenue Amount,"The total sum of gross revenue generated from advertising sales, typically before any deductions or adjustments.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) LIMIT 1",measure,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
total_net_revenue_amount,net_revenue,Total Net Revenue Amount,"The total sum of net revenue generated from advertising sales, after any deductions or adjustments.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(net_revenue) AS total_net_revenue FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) LIMIT 1",measure,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
ad_type_classification_dimension,ad_type_classification,Ad Type Classification,"A classification of ad types based on the adsize_name, categorizing them into 'Sponsorship', 'Production', or 'Media'.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT CASE WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$')) THEN 'Sponsorship' WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$')) THEN 'Production' ELSE 'Media' END AS ad_type FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) LIMIT 10",calculated_field,False,medium,39,e83da1de-4227-43e6-bcc6-73051c66914b
gross_revenue_by_ad_type,gross_revenue_amount,Gross Revenue by Ad Type,"Total gross revenue broken down by the classified ad type (Sponsorship, Production, Media).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) AS gross_revenue, CASE WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$')) THEN 'Sponsorship' WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$')) THEN 'Production' ELSE 'Media' END AS ad_type FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) GROUP BY ad_type ORDER BY gross_revenue DESC LIMIT 10",aggregation,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
gross_revenue_by_source_publication,gross_revenue_amount,Gross Revenue by Source Publication,Total gross revenue attributed to each source unified publication name.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) AS gross_revenue, source_unified_publication_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) GROUP BY source_unified_publication_name ORDER BY gross_revenue DESC LIMIT 10",aggregation,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
gross_revenue_by_transaction_status,gross_revenue_amount,Gross Revenue by Revenue Transaction Status,"Total gross revenue categorized by the status of the revenue transaction (e.g., 'Actual', 'Forecast').",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) AS gross_revenue, revenue_transaction_status FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) GROUP BY revenue_transaction_status ORDER BY gross_revenue DESC LIMIT 10",aggregation,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
gross_revenue_by_financial_year,gross_revenue_amount,Gross Revenue by Financial Year,Total gross revenue aggregated by financial year.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) AS gross_revenue, financial_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) GROUP BY financial_year ORDER BY financial_year DESC LIMIT 10",aggregation,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
gross_revenue_by_financial_year_month,gross_revenue_amount,Gross Revenue by Financial Year Month,Total gross revenue aggregated by financial year and month number.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_amount) AS gross_revenue, financial_year, fy_year_month_number FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE relative_fy_year_offset IN (-1, 0, 1) GROUP BY financial_year, fy_year_month_number ORDER BY financial_year DESC, fy_year_month_number DESC LIMIT 10",aggregation,True,high,39,e83da1de-4227-43e6-bcc6-73051c66914b
actual_amount_by_publication_group_current_week,actual_amount,Actual Amount by Publication Group (Current Week),"The total actual amount for the current fiscal week, grouped by major publication categories. Excludes 'Other' publication group and specific regional/lifestyle publications. Limited to 'All Sales Channels'.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN publication_name IN ('The Australian') THEN ' The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    ELSE '        Other'
  END AS publication_group,
  SUM(Actual_Amount) AS total_actual_amount
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-05-28') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND os_level_7 = 'All Sales Channels'
  AND CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN '      Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN publication_name IN ('The Australian') THEN ' The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    ELSE '        Other'
  END != '        Other'
  AND (CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END NOT IN ('Advertiser', 'Cairns Post', 'Courier Mail', 'Ed Media', 'Food', 'Gold Coast Bulletin', 'Group Support', 'Mackay', 'Northern Territory') OR CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IS NULL)
GROUP BY
  publication_group
LIMIT 10;",measure,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_current_week_all_sales_channels,actual_amount,"Actual Amount (Current Week, All Sales Channels)","The total actual amount for the current fiscal week, specifically for 'All Sales Channels', excluding certain publications.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(Actual_Amount) AS total_actual_amount
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-23') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_7 = 'All Sales Channels'
LIMIT 1;",measure,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
volume_current_week_all_sales_channels,volume,"Volume (Current Week, All Sales Channels)","The total volume for the current fiscal week, specifically for 'All Sales Channels', excluding certain publications.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(volume) AS total_volume
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-23') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_7 = 'All Sales Channels'
LIMIT 1;",measure,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_volume_7day_avg_by_pub_group_subscriptions,budget_volume_derived,"Budget Volume (7-day Avg, by Pub Group, Subscriptions)","The 7-day average of budget volume, categorized by publication group, specifically for 'Subscriptions' sales channel, excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_10
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = 'PNG' THEN 0
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Budget_Volume, 6)
    ELSE SAFE_DIVIDE(Budget_Volume, 7)
  END) AS total_budget_volume_7day_avg
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-17') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_10 = 'Subscriptions'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Magazine (NSW)', 'Sunday Magazine (VIC)', 'Sunshine Coast', 'Sydney Suburbans', 'The Herald Sun', 'Weekly Times')
GROUP BY
  CASE WHEN os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail' ELSE os_level_10 END
LIMIT 10;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_volume_6day_avg_by_pub_group_subscriptions,budget_volume_derived,"Budget Volume (6-day Avg, by Pub Group, Subscriptions)","The 6-day average of budget volume, categorized by publication group, specifically for 'Subscriptions' sales channel, excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_10
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = 'PNG' THEN 0
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Budget_Volume, 6)
    ELSE SAFE_DIVIDE(Budget_Volume, 7)
  END) AS total_budget_volume_6day_avg
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-17') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_10 = 'Subscriptions'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Magazine (NSW)', 'Sunday Magazine (VIC)', 'Sunshine Coast', 'Sydney Suburbans', 'The Herald Sun', 'Weekly Times')
GROUP BY
  CASE WHEN os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail' ELSE os_level_10 END
LIMIT 10;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_volume_7day_avg_by_pub_group_subscriptions_alt_calc,budget_volume_derived,"Budget Volume (7-day Avg, by Pub Group, Subscriptions, Alt Calc)","An alternative calculation of the 7-day average of budget volume, categorized by publication group, specifically for 'Subscriptions' sales channel, excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_10
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = 'PNG' THEN 0
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Budget_Volume, 6)
    ELSE SAFE_DIVIDE(Budget_Volume, 7)
  END) AS total_budget_volume_7day_avg_alt
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-17') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_10 = 'Subscriptions'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Magazine (NSW)', 'Sunday Magazine (VIC)', 'Sunshine Coast', 'Sydney Suburbans', 'The Herald Sun', 'Weekly Times')
GROUP BY
  CASE WHEN os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail' ELSE os_level_10 END
LIMIT 10;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_volume_6day_avg_by_pub_group_subscriptions_alt_calc,budget_volume_derived,"Budget Volume (6-day Avg, by Pub Group, Subscriptions, Alt Calc)","An alternative calculation of the 6-day average of budget volume, categorized by publication group, specifically for 'Subscriptions' sales channel, excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_10
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Budget_Volume, 6)
    ELSE SAFE_DIVIDE(Budget_Volume, 7)
  END) AS total_budget_volume_6day_avg_alt
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-17') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_10 = 'Subscriptions'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Magazine (NSW)', 'Sunday Magazine (VIC)', 'Sunshine Coast', 'Sydney Suburbans', 'The Herald Sun', 'Weekly Times')
GROUP BY
  CASE WHEN os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail' ELSE os_level_10 END
LIMIT 10;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_volume_7day_avg_by_pub_group_subscriptions_alt_calc_2,budget_volume_derived,"Budget Volume (7-day Avg, by Pub Group, Subscriptions, Alt Calc 2)","A second alternative calculation of the 7-day average of budget volume, categorized by publication group, specifically for 'Subscriptions' sales channel, excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_10
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = 'PNG' THEN 0
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Budget_Volume, 6)
    ELSE SAFE_DIVIDE(Budget_Volume, 7)
  END) AS total_budget_volume_7day_avg_alt2
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-17') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_10 = 'Subscriptions'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Magazine (NSW)', 'Sunday Magazine (VIC)', 'Sunshine Coast', 'Sydney Suburbans', 'The Herald Sun', 'Weekly Times')
GROUP BY
  CASE WHEN os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail' ELSE os_level_10 END
LIMIT 10;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_by_publication_group_current_week,budget_amount,Budget Amount by Publication Group (Current Week),"The total budget amount for the current fiscal week, grouped by major publication categories. Limited to 'All Sales Channels' and excludes 'Other', 'Weekly Times', and 'Regionals' publication groups.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG') THEN '      Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN publication_name IN ('The Australian') THEN ' The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    WHEN publication_name IN ('Weekly Times') THEN '       Weekly Times'
    ELSE '        Other'
  END AS publication_group,
  SUM(Budget_Amount) AS total_budget_amount
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-05-27') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND os_level_7 = 'All Sales Channels'
  AND CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG') THEN '      Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN publication_name IN ('The Australian') THEN ' The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    WHEN publication_name IN ('Weekly Times') THEN '       Weekly Times'
    ELSE '        Other'
  END != '        Other'
  AND CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG') THEN '      Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN publication_name IN ('The Australian') THEN ' The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    WHEN publication_name IN ('Weekly Times') THEN '       Weekly Times'
    ELSE '        Other'
  END != '       Weekly Times'
  AND CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG') THEN '      Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN '     The Advertiser'
    WHEN publication_name IN ('The Australian') THEN ' The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN '    The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN '   The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN '  The Herald Sun'
    WHEN publication_name IN ('Weekly Times') THEN '       Weekly Times'
    ELSE '        Other'
  END != '      Regionals'
GROUP BY
  publication_group
LIMIT 10;",measure,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
volume_7day_avg_by_pub_group_all_sales_channels,volume_derived,"Volume (7-day Avg, by Pub Group, All Sales Channels)","The 7-day average of total volume, categorized by publication group, specifically for 'All Sales Channels', excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = 'PNG' THEN 0
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(volume, 6)
    ELSE SAFE_DIVIDE(volume, 7)
  END) AS total_volume_7day_avg
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-04') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_7 = 'All Sales Channels'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times')
LIMIT 1;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
volume_6day_avg_by_pub_group_all_sales_channels,volume_derived,"Volume (6-day Avg, by Pub Group, All Sales Channels)","The 6-day average of total volume, categorized by publication group, specifically for 'All Sales Channels', excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(volume, 6)
    ELSE SAFE_DIVIDE(volume, 7)
  END) AS total_volume_6day_avg
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-04') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_7 = 'All Sales Channels'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times')
LIMIT 1;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
publication_count_by_group_advertiser,publication_count,Publication Count by Group (Advertiser),"Counts the number of records for publications categorized under 'Advertiser' group, primarily used for filtering or dimension validation.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  COUNT(1) AS record_count,
  '(Actual Vs Budget Vs PY)' AS metric_type_label
FROM
  OSandFACT
WHERE
  CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    WHEN publication_name IN ('Sunday Tasmanian', 'Mercury') THEN 'Mercury'
    ELSE publication_name
  END = 'Advertiser'
GROUP BY
  metric_type_label
LIMIT 1;",aggregation,False,low,40,2104a3f5-9424-4087-a928-e67fecae789a
budget_volume_6day_avg_by_pub_group_subscriptions_alt_calc_2,budget_volume_derived,"Budget Volume (6-day Avg, by Pub Group, Subscriptions, Alt Calc 2)","A second alternative calculation of the 6-day average of budget volume, categorized by publication group, specifically for 'Subscriptions' sales channel, excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_10
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Budget_Volume, 6)
    ELSE SAFE_DIVIDE(Budget_Volume, 7)
  END) AS total_budget_volume_6day_avg_alt2
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-17') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_10 = 'Subscriptions'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Magazine (NSW)', 'Sunday Magazine (VIC)', 'Sunshine Coast', 'Sydney Suburbans', 'The Herald Sun', 'Weekly Times')
GROUP BY
  CASE WHEN os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail' ELSE os_level_10 END
LIMIT 10;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
forecast_volume_7day_avg_by_pub_group_all_sales_channels,forecast_volume_derived,"Forecast Volume (7-day Avg, by Pub Group, All Sales Channels)","The 7-day average of forecast volume, categorized by publication group, specifically for 'All Sales Channels', excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = 'PNG' THEN 0
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Forecast_Volume, 6)
    ELSE SAFE_DIVIDE(Forecast_Volume, 7)
  END) AS total_forecast_volume_7day_avg
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-04') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_7 = 'All Sales Channels'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times')
LIMIT 1;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
forecast_volume_6day_avg_by_pub_group_all_sales_channels,forecast_volume_derived,"Forecast Volume (6-day Avg, by Pub Group, All Sales Channels)","The 6-day average of forecast volume, categorized by publication group, specifically for 'All Sales Channels', excluding certain publications. Complex derivation based on publication type and day of week.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    calendar.day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE
    WHEN CASE
      WHEN publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE publication_name
    END = '6 Day Pubs' THEN SAFE_DIVIDE(Forecast_Volume, 6)
    ELSE SAFE_DIVIDE(Forecast_Volume, 7)
  END) AS total_forecast_volume_6day_avg
FROM
  OSandFACT
WHERE
  fy_year_week_number = (2025 * 100) + DATETIME_DIFF(SAFE_CAST(DATE('2025-06-04') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)
  AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
  AND os_level_7 = 'All Sales Channels'
  AND CASE
    WHEN publication_name IN ('NT News', 'Sunday Territorian') THEN 'Northern Territory'
    WHEN publication_name IN ('', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Others'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE publication_name
  END IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times')
LIMIT 1;",calculated_field,True,high,40,2104a3f5-9424-4087-a928-e67fecae789a
adpoint_account_dimension,account_mapping_dimension,Adpoint Account,The unique identifier for an account within the Adpoint system.,ncau-data-newsquery-prd,asl_advertising,v_asl_gbaba_act_xref,SELECT t0.Adpoint_Account FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1,dimension,False,high,41,258a722d-9b6e-45df-ba00-1b9954ec36b2
genera_booking_account_dimension,account_mapping_dimension,Genera Booking Account,The unique identifier for an account within the Genera Booking system.,ncau-data-newsquery-prd,asl_advertising,v_asl_gbaba_act_xref,SELECT t0.Genera_Booking_Account FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1,dimension,False,medium,41,258a722d-9b6e-45df-ba00-1b9954ec36b2
medium_rare_debtor_account_dimension,account_mapping_dimension,Medium Rare Debtor Account,The unique identifier for a debtor account within the Medium Rare system.,ncau-data-newsquery-prd,asl_advertising,v_asl_gbaba_act_xref,SELECT t0.Medium_Rare_Debtor_Account FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1,dimension,False,medium,41,258a722d-9b6e-45df-ba00-1b9954ec36b2
national_debtor_account_dimension,account_mapping_dimension,National Debtor Account,The unique identifier for a debtor account at the national level.,ncau-data-newsquery-prd,asl_advertising,v_asl_gbaba_act_xref,SELECT t0.National_Debtor_Account FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1,dimension,False,medium,41,258a722d-9b6e-45df-ba00-1b9954ec36b2
last_update_time_metadata,data_freshness_metadata,Last Update Time,"The last time the underlying `gbaba_act_xref` table was modified, indicating data freshness.",sdm_advertisingexternals,__TABLES__,__TABLES__,"SELECT CAST(FORMAT_DATETIME('%F %X', datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"")) AS STRING) AS last_update_time FROM `sdm_advertisingexternals.__TABLES__` WHERE table_id = ""gbaba_act_xref"" LIMIT 1",dimension,False,medium,41,258a722d-9b6e-45df-ba00-1b9954ec36b2
current_fy_gross_revenue_qld_digital_police_union,gross_revenue_current_fy,Current FY Gross Revenue (QLD Digital Police Union),"Total gross revenue for the current financial year, specifically for QLD Consortium A1 / Direct A1 portfolios, Digital ad types, and the QLDGOVT QUEENSLAND POLICE UNION advertiser group.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.portfolio_conformed_name_current IN ('QLD CON A1', 'QLD DIRECT A1') AND (CASE WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC' ELSE t0.revenue_group_subtype END) IN ('DIGITAL') AND t0.advertiser_group IN ('QLDGOVT QUEENSLAND POLICE UNION')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
current_fy_gross_revenue_k_qld_digital_police_union,gross_revenue_current_fy_k,Current FY Gross Revenue (k) (QLD Digital Police Union),"Total gross revenue for the current financial year, in thousands, specifically for QLD Consortium A1 / Direct A1 portfolios, Digital ad types, and the QLDGOVT QUEENSLAND POLICE UNION advertiser group.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS current_fy_gross_revenue_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.portfolio_conformed_name_current IN ('QLD CON A1', 'QLD DIRECT A1') AND (CASE WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC' ELSE t0.revenue_group_subtype END) IN ('DIGITAL') AND t0.advertiser_group IN ('QLDGOVT QUEENSLAND POLICE UNION')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
previous_fy_gross_revenue_qld_digital_police_union,gross_revenue_previous_fy,Previous FY Gross Revenue (QLD Digital Police Union),"Total gross revenue for the previous financial year, specifically for QLD Consortium A1 / Direct A1 portfolios, Digital ad types, and the QLDGOVT QUEENSLAND POLICE UNION advertiser group.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.portfolio_conformed_name_current IN ('QLD CON A1', 'QLD DIRECT A1') AND (CASE WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC' ELSE t0.revenue_group_subtype END) IN ('DIGITAL') AND t0.advertiser_group IN ('QLDGOVT QUEENSLAND POLICE UNION')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
previous_fy_gross_revenue_k_qld_digital_police_union,gross_revenue_previous_fy_k,Previous FY Gross Revenue (k) (QLD Digital Police Union),"Total gross revenue for the previous financial year, in thousands, specifically for QLD Consortium A1 / Direct A1 portfolios, Digital ad types, and the QLDGOVT QUEENSLAND POLICE UNION advertiser group.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS previous_fy_gross_revenue_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.portfolio_conformed_name_current IN ('QLD CON A1', 'QLD DIRECT A1') AND (CASE WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC' ELSE t0.revenue_group_subtype END) IN ('DIGITAL') AND t0.advertiser_group IN ('QLDGOVT QUEENSLAND POLICE UNION')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
filtered_current_fy_gross_revenue_qld_digital_police_union,gross_revenue_filtered_current_fy,Filtered Current FY Gross Revenue (QLD Digital Police Union),"Gross revenue for the current financial year, filtered by specific publication types OR specific date/revenue type conditions, for QLD Consortium A1 / Direct A1 portfolios, Digital ad types, and the QLDGOVT QUEENSLAND POLICE UNION advertiser group.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN (CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-20 01:24:50.169003+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END IS NULL) THEN 0 ELSE CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-20 01:24:50.169003+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END END) AS filtered_current_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.portfolio_conformed_name_current IN ('QLD CON A1', 'QLD DIRECT A1') AND (CASE WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC' ELSE t0.revenue_group_subtype END) IN ('DIGITAL') AND t0.advertiser_group IN ('QLDGOVT QUEENSLAND POLICE UNION')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
filtered_current_fy_gross_revenue_k_qld_digital_police_union,gross_revenue_filtered_current_fy_k,Filtered Current FY Gross Revenue (k) (QLD Digital Police Union),"Gross revenue for the current financial year, in thousands, filtered by specific publication types OR specific date/revenue type conditions, for QLD Consortium A1 / Direct A1 portfolios, Digital ad types, and the QLDGOVT QUEENSLAND POLICE UNION advertiser group.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-20 01:24:50.169003+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END IS NULL) THEN 0 ELSE CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-20 01:24:50.169003+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END END, 1000)) AS filtered_current_fy_gross_revenue_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.portfolio_conformed_name_current IN ('QLD CON A1', 'QLD DIRECT A1') AND (CASE WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC' ELSE t0.revenue_group_subtype END) IN ('DIGITAL') AND t0.advertiser_group IN ('QLDGOVT QUEENSLAND POLICE UNION')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
current_fy_gross_revenue_consortium_qld,gross_revenue_current_fy,Current FY Gross Revenue (Consortium QLD),"Total gross revenue for the current financial year, specifically for the 'Consortium QLD' sales segment.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.sales_segment_l_2_name IN ('Consortium QLD'),measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
current_fy_gross_revenue_k_consortium_qld,gross_revenue_current_fy_k,Current FY Gross Revenue (k) (Consortium QLD),"Total gross revenue for the current financial year, in thousands, specifically for the 'Consortium QLD' sales segment.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS current_fy_gross_revenue_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.sales_segment_l_2_name IN ('Consortium QLD')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
previous_fy_gross_revenue_consortium_qld,gross_revenue_previous_fy,Previous FY Gross Revenue (Consortium QLD),"Total gross revenue for the previous financial year, specifically for the 'Consortium QLD' sales segment.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.sales_segment_l_2_name IN ('Consortium QLD'),measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
previous_fy_gross_revenue_k_consortium_qld,gross_revenue_previous_fy_k,Previous FY Gross Revenue (k) (Consortium QLD),"Total gross revenue for the previous financial year, in thousands, specifically for the 'Consortium QLD' sales segment.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS previous_fy_gross_revenue_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.sales_segment_l_2_name IN ('Consortium QLD')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
filtered_current_fy_gross_revenue_consortium_qld,gross_revenue_filtered_current_fy,Filtered Current FY Gross Revenue (Consortium QLD),"Gross revenue for the current financial year, filtered by specific publication types OR specific date/revenue type conditions, specifically for the 'Consortium QLD' sales segment.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(CASE WHEN (CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-23 10:00:32.354880+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END IS NULL) THEN 0 ELSE CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-23 10:00:32.354880+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END END) AS filtered_current_fy_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.sales_segment_l_2_name IN ('Consortium QLD')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
filtered_current_fy_gross_revenue_k_consortium_qld,gross_revenue_filtered_current_fy_k,Filtered Current FY Gross Revenue (k) (Consortium QLD),"Gross revenue for the current financial year, in thousands, filtered by specific publication types OR specific date/revenue type conditions, specifically for the 'Consortium QLD' sales segment.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-23 10:00:32.354880+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END IS NULL) THEN 0 ELSE CASE WHEN ((t0.relative_fy_year_offset = 0) AND (UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE'))) THEN t0.gross_revenue_amount WHEN ((t0.relative_fy_year_offset = 0) AND (SAFE_CAST(CASE WHEN ((t0.revenue_type = 'DIGITAL') AND (t0.revenue_group_subtype = 'DIGITAL') AND (t0.sales_segment_l_2_name_sync = 'Digital Other') AND (t0.advertiser_parent != 'DOUBLECLICK')) THEN t0.fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-06-23 10:00:32.354880+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN t0.gross_revenue_amount ELSE NULL END END, 1000)) AS filtered_current_fy_gross_revenue_k FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.sales_segment_l_2_name IN ('Consortium QLD')",measure,True,high,42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
sc_acquisitions_specific_rate_plans_2025_q1,distinct_sc_acquisitions,"SuperCoach Acquisitions (Specific Rate Plans, Q1-Q2 2025)","Count of distinct SuperCoach subscription acquisitions for specific rate plans ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12') between January 21, 2025, and June 30, 2025.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_movement,"SELECT COUNT(DISTINCT subscription_id_src) AS sc_acquisitions_specific_rate_plans_2025_q1
FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE '2025-01-21'
    AND movement_datetime < DATETIME_ADD(DATE '2025-06-30', INTERVAL 1 DAY)
    AND sold_in_rate_plan_code IN ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12');",aggregation,True,high,43,6e8b534b-485a-48dd-842d-13dc6bebb01a
sc_acquisitions_by_source_masthead_2024_q3,distinct_sc_acquisitions,"SuperCoach Acquisitions by Source Masthead (Specific Rate Plans, Q3 2024)","Count of distinct SuperCoach subscription acquisitions for specific rate plans ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12') between July 1, 2024, and August 19, 2024, broken down by the first two characters of the 'sold_in_source_code' (Source Masthead).",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_movement,"SELECT
    SUBSTR(sold_in_source_code, 1, 2) AS SourceMasthead,
    COUNT(DISTINCT subscription_id_src) AS sc_acquisitions_by_source_masthead_2024_q3
FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE '2024-07-01'
    AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY)
    AND sold_in_rate_plan_code IN ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12')
GROUP BY 1;",aggregation,True,high,43,6e8b534b-485a-48dd-842d-13dc6bebb01a
sc_acquisitions_total_2024_q3,distinct_sc_acquisitions,Total SuperCoach Acquisitions (Q3 2024),"Total count of distinct SuperCoach subscription acquisitions between July 1, 2024, and August 19, 2024.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_movement,"SELECT COUNT(DISTINCT subscription_id_src) AS sc_acquisitions_total_2024_q3
FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE '2024-07-01'
    AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY);",aggregation,True,high,43,6e8b534b-485a-48dd-842d-13dc6bebb01a
sc_acquisitions_detailed_subscriber_breakdown_2024_q3,distinct_sc_acquisitions,"SuperCoach Acquisitions by Source (Specific Subscriber, Q3 2024)","Count of distinct SuperCoach subscription acquisitions for specific rate plans ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12') between July 1, 2024, and August 19, 2024, for a specific subscriber (ID 2452260), filtered by 'CS' Source Masthead and 'CSWEB_WBN1332_f' sold-in source code.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_movement,"SELECT
    SUBSTR(sold_in_source_code, 1, 2) AS SourceMasthead,
    sold_in_source_code,
    COUNT(DISTINCT subscription_id_src) AS sc_acquisitions_detailed_subscriber_breakdown_2024_q3
FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE '2024-07-01'
    AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY)
    AND sold_in_rate_plan_code IN ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12')
    AND subscriber_id_src = 2452260
    AND SUBSTR(sold_in_source_code, 1, 2) IN ('CS')
    AND sold_in_source_code IN ('CSWEB_WBN1332_f')
GROUP BY 1, 2;",aggregation,False,medium,43,6e8b534b-485a-48dd-842d-13dc6bebb01a
list_distinct_subscribers,distinct_subscribers,List of Distinct Subscriber IDs,A list of all distinct subscriber IDs present in the v_subscription_movement table.,ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_movement,"SELECT DISTINCT subscriber_id_src AS distinct_subscriber_id
FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`;",dimension,False,low,43,6e8b534b-485a-48dd-842d-13dc6bebb01a
sc_acquisitions_by_source_masthead_for_subscriber_2024_q3,distinct_sc_acquisitions,"SuperCoach Acquisitions by Source Masthead (Specific Subscriber, Q3 2024)","Count of distinct SuperCoach subscription acquisitions for specific rate plans ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12') between July 1, 2024, and August 19, 2024, for a specific subscriber (ID 2452260), filtered by 'CS' Source Masthead.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_movement,"SELECT
    SUBSTR(sold_in_source_code, 1, 2) AS SourceMasthead,
    COUNT(DISTINCT subscription_id_src) AS sc_acquisitions_by_source_masthead_for_subscriber_2024_q3
FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE '2024-07-01'
    AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY)
    AND sold_in_rate_plan_code IN ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12')
    AND subscriber_id_src = 2452260
    AND SUBSTR(sold_in_source_code, 1, 2) IN ('CS')
GROUP BY 1;",aggregation,False,medium,43,6e8b534b-485a-48dd-842d-13dc6bebb01a
advertiser_name_general,advertiser_name,Advertiser Name (General Filter),"Lists distinct advertiser names based on general dashboard filters (billed/booked revenue, excluding Medium Rare Content Agency, non-null financial year).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.advertiser_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') GROUP BY t0.advertiser_name",dimension,False,low,44,705edcb5-737a-4600-b1a7-11870177f97a
advertiser_name_2024_calendar_year,advertiser_name,Advertiser Name (2024 Calendar Year),"Lists distinct advertiser names for the 2024 calendar year, based on general dashboard filters (billed/booked revenue, excluding Medium Rare Content Agency, non-null financial year).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.advertiser_name FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.calendar_year IN ('2024') GROUP BY t0.advertiser_name",dimension,False,low,44,705edcb5-737a-4600-b1a7-11870177f97a
data_load_datetime_2025_oct_financial,data_load_datetime,Data Load Datetime (2025 Oct Financial Period),"Shows the data load timestamps, truncated to the second, for records pertaining to the October 2025 financial period, applying general dashboard filters.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT DATETIME_TRUNC(t0.data_load_datetime, SECOND) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.financial_year IN ('2025') AND t0.financial_short_month IN ('Oct') GROUP BY DATETIME_TRUNC(t0.data_load_datetime, SECOND)",dimension,False,low,44,705edcb5-737a-4600-b1a7-11870177f97a
programmatic_gross_revenue_by_cost_model_fy_fm,total_gross_revenue,"Programmatic Gross Revenue by Cost Model, FY, FM","Calculates the sum of gross revenue for programmatic transactions, broken down by cost model type, financial year, and financial month, specifically for PLUTO source system and 2025 financial year.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.cost_model_type, t0.financial_year, SAFE_CAST(t0.financial_month AS FLOAT64) AS financial_month_float, SUM(t0.gross_revenue_amount) AS total_gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_type_level2 = 'Programmatic' AND t0.revenue_group_subtype IN ('Programmatic Source', 'Digital') AND t0.source_system_code = 'PLUTO' AND t0.cost_model_type IN ('PMP', 'Non-Guaranteed') AND t0.financial_year IN ('2025') GROUP BY t0.cost_model_type, t0.financial_year, financial_month_float",measure,True,high,44,705edcb5-737a-4600-b1a7-11870177f97a
cost_model_type_2025_fy,cost_model_type,Cost Model Type (2025 Financial Year),"Lists distinct cost model types for transactions in the 2025 financial year, applying general dashboard filters.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.cost_model_type FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.financial_year IN ('2025') GROUP BY t0.cost_model_type",dimension,False,low,44,705edcb5-737a-4600-b1a7-11870177f97a
programmatic_gross_revenue_foxtel_2025_fy,total_gross_revenue,"Programmatic Gross Revenue (Foxtel, 2025 FY)","Calculates the sum of gross revenue for programmatic transactions specifically for 'Foxtel Management Pty Ltd' in the 2025 financial year, from the PLUTO source system.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT t0.financial_year, SUM(t0.gross_revenue_amount) AS total_gross_revenue_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_type_level2 = 'Programmatic' AND t0.revenue_group_subtype IN ('Programmatic Source', 'Digital') AND t0.advertiser_name = 'Foxtel Management Pty Ltd' AND t0.source_system_code = 'PLUTO' AND t0.financial_year IN ('2025') GROUP BY t0.financial_year",measure,True,high,44,705edcb5-737a-4600-b1a7-11870177f97a
