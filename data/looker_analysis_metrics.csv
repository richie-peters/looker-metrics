metric_id,base_metric_id,metric_name,business_description,gcp_project_name,dataset_name,table_name,sql_logic,metric_type,is_kpi,business_criticality,response_id,dashboard_id
total_allocated_revenue_gst_exclusive_jun25_sum,total_allocated_revenue_gst_exclusive,Total Allocated Revenue (GST Exclusive) - June 2025,"The total amount of revenue allocated to the specified reporting period (June 2025), excluding GST. This is calculated by prorating the payment base amount over the allocation period.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_Jun25,"SELECT SUM(t0.should_be_allocated_to_revenue_gst_exclusive) AS total_allocated_revenue_gst_exclusive FROM (WITH core AS (SELECT *, greatest(allocation_start_date, DATE '2025-06-09') AS week_prorata_allocation_start, least(allocation_end_date, DATE '2025-06-15') AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25` WHERE '2025-06-09' BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN '2025-06-09' AND '2025-06-15') OR (allocation_end_date BETWEEN '2025-06-09' AND '2025-06-15')), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT * FROM core_2) AS t0",measure,True,high,0,be4575e4-3850-46e2-9ba9-73a4393c5d2a
total_allocated_revenue_gst_exclusive_recurring_sum_rounded,total_allocated_revenue_gst_exclusive,Total Allocated Revenue (GST Exclusive) - Recurring (Rounded),"The total amount of revenue allocated to the dynamic reporting period, excluding GST, rounded to 2 decimal places. This is calculated by prorating the payment base amount over the allocation period for recurring revenue.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,"SELECT SUM(ROUND(((date_diff(least(allocation_end_date, PARSE_DATE(""%Y%m%d"", @DS_END_DATE)), greatest(allocation_start_date, PARSE_DATE(""%Y%m%d"", @DS_START_DATE)), day) + 1) / installment_allocation_days * payment_base_amount) / 1.1, 2)) AS total_allocated_revenue_gst_exclusive FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` WHERE (PARSE_DATE(""%Y%m%d"", @DS_START_DATE) BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE)) OR (allocation_end_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE)))",measure,True,high,0,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_record_count_mar25_rate_plan,unearned_revenue_record_count,Count of Unearned Revenue Records by Rate Plan - March 2025,"The total number of unearned revenue records (allocations) for the specified period (March 2025), grouped by rate plan code and filtered for positive GST exclusive revenue.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_mar25,"SELECT COUNT(1) AS unearned_revenue_record_count, t0.rate_plan_code FROM (WITH core AS (SELECT *, greatest(allocation_start_date, DATE '2025-02-10') AS week_prorata_allocation_start, least(allocation_end_date, DATE '2025-02-16') AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25` WHERE '2025-02-16' BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN '2025-02-10' AND '2025-02-16') OR (allocation_end_date BETWEEN '2025-02-10' AND '2025-02-16')), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, earned_rev_dollars, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT * FROM core_2) AS t0 WHERE t0.week_prorata_allocation_start = DATE '2025-02-10' AND t0.week_prorata_allocation_end = DATE '2025-02-16' AND t0.should_be_allocated_to_revenue_gst_exclusive > 0.000000 AND t0.rate_plan_code IN ('TA_PB_WKNCON19M12') GROUP BY t0.rate_plan_code",aggregation,False,medium,0,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_record_count_recurring_masthead,unearned_revenue_record_count,Count of Unearned Revenue Records by Masthead - Recurring,"The total number of unearned revenue records (allocations) for the dynamic reporting period, grouped by masthead for recurring revenue.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_recurring,"SELECT COUNT(1) AS unearned_revenue_record_count, t0.masthead FROM (WITH core AS (SELECT *, greatest(allocation_start_date, PARSE_DATE(""%Y%m%d"", @DS_START_DATE)) AS week_prorata_allocation_start, least(allocation_end_date, PARSE_DATE(""%Y%m%d"", @DS_END_DATE)) AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring` WHERE PARSE_DATE(""%Y%m%d"", @DS_START_DATE) BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE)) OR (allocation_end_date BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE))), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT * FROM core_2) AS t0 GROUP BY t0.masthead",aggregation,False,medium,0,be4575e4-3850-46e2-9ba9-73a4393c5d2a
unearned_revenue_record_count_jun25_masthead_filtered,unearned_revenue_record_count,Count of Unearned Revenue Records by Masthead - June 2025 (Filtered by Order ID),"The total number of unearned revenue records (allocations) for the specified period (June 2025), grouped by masthead and filtered by a specific subscription order ID.",ncau-data-newsquery-sit,qvr_consumer,fin_unearned_revenue_Jun25,"SELECT COUNT(1) AS unearned_revenue_record_count, t0.masthead FROM (WITH core AS (SELECT *, greatest(allocation_start_date, DATE '2025-06-09') AS week_prorata_allocation_start, least(allocation_end_date, DATE '2025-06-15') AS week_prorata_allocation_end FROM `ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25` WHERE '2025-06-09' BETWEEN allocation_start_date AND allocation_end_date OR (allocation_start_date BETWEEN '2025-06-09' AND '2025-06-15') OR (allocation_end_date BETWEEN '2025-06-09' AND '2025-06-15')), core_2 AS (SELECT * EXCEPT (should_be_allocated_to_revenue_gst_inclusive, should_be_allocated_to_revenue, fy_week_of_year, fy_year, allocation_end_date_ext), (date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount AS should_be_allocated_to_revenue_gst_inclusive, ((date_diff(week_prorata_allocation_end, week_prorata_allocation_start, day) + 1) / installment_allocation_days * payment_base_amount) / 1.1 AS should_be_allocated_to_revenue_gst_exclusive FROM core) SELECT * FROM core_2) AS t0 WHERE t0.subscription_order_id_src = 961289025 GROUP BY t0.masthead",aggregation,False,medium,0,be4575e4-3850-46e2-9ba9-73a4393c5d2a
total_payment_base_amount_fp_all_trans,total_payment_base_amount,Total Payment Base Amount - All Transactions,"The sum of the base payment amounts from all transactions, joined with derived subscription status and filtered for the latest attempt and contract-related offers.",ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,"SELECT SUM(t0.payment_base_amount) AS total_payment_base_amount, t0.creation_date, t0.masthead, t0.offer_category_group_name, t0.offer_category_name, t0.payment_seq, t0.payment_seq_status_desc_derived, t0.rate_plan_code, t0.subscriber_id_src, t0.subscription_id_src, t0.subscription_order_id_src FROM (WITH contracts_in_scope_active_and_cancelled AS (SELECT DISTINCT dw_subscription_id, dw_rate_plan_id, term_period_name, 'active' AS subscription_status, date(null) AS cancellation_date, masthead, rate_plan_code, offer_category_name, offer_category_group_name FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base` WHERE offer_category_group_name = 'Contract' AND lower(offer_category_name) NOT LIKE '%upfront%' AND subscription_status_code = 'active' UNION ALL SELECT DISTINCT dw_subscription_id, dw_rate_plan_id, term_period_name, 'cancelled' AS subscription_status, report_date AS cancellation_date, masthead, rate_plan_code, offer_category_name, offer_category_group_name FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` WHERE offer_category_group_name = 'Contract' AND lower(offer_category_name) NOT LIKE '%upfront%' AND subscription_movement_count_type = 'cancellation' AND report_date > '2022-07-01'), contracts_in_scope_active_cancelled_inactivenotcancelled AS (SELECT * FROM contracts_in_scope_active_and_cancelled UNION ALL SELECT DISTINCT dw_subscription_id, dw_rate_plan_id, term_period_name, 'inactive not cancelled - contract in the past' AS subscription_status, date(null) AS cancellation_date, masthead, rate_plan_code, offer_category_name, offer_category_group_name FROM (SELECT *, row_number() OVER (PARTITION BY dw_subscription_id, dw_rate_plan_id ORDER BY date(dw_effective_start_datetime) DESC) AS xrank FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base`) WHERE offer_category_group_name = 'Contract' AND lower(offer_category_name) NOT LIKE '%upfront%' AND dw_subscription_id NOT IN (SELECT DISTINCT dw_subscription_id FROM contracts_in_scope_active_and_cancelled) AND xrank = 1) SELECT a.*, b.subscription_status FROM `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` AS a JOIN contracts_in_scope_active_cancelled_inactivenotcancelled AS b ON a.dw_subscription_id = b.dw_subscription_id AND a.dw_rate_plan_id = b.dw_rate_plan_id) AS t0 WHERE t0.latest_attempt_flag = 'Y' GROUP BY t0.creation_date, t0.masthead, t0.offer_category_group_name, t0.offer_category_name, t0.payment_seq, t0.payment_seq_status_desc_derived, t0.rate_plan_code, t0.subscriber_id_src, t0.subscription_id_src, t0.subscription_order_id_src",measure,False,medium,0,be4575e4-3850-46e2-9ba9-73a4393c5d2a
total_circulation_value,total_circulation_value,Total Circulation Value (Amount or Volume),"The total value of circulation, which can represent either financial amount or physical volume, depending on user selection via a dashboard parameter.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,SELECT SUM(CASE WHEN ('Amount' = 'Amount') THEN t0.amount WHEN ('Amount' = 'Volume') THEN t0.volume ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0,aggregation,true,high,1,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
total_amount_by_revenue_type_filtered_by_year_and_type_01,total_circulation_value,"Total Circulation Amount by Revenue Type (FY 2025, Type '01')","The total financial amount of circulation, grouped by revenue type, specifically for fiscal year 2025 and revenue types starting with '01'. This is a specific view of the total circulation value.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS total_amount, t0.revenue_type FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 WHERE SAFE_CAST(FLOOR(SAFE_DIVIDE(t0.fy_year_week_number, 100)) AS BIGNUMERIC) = 2025.000000 AND SAFE.LEFT(t0.revenue_type, 2) = '01' GROUP BY t0.revenue_type",aggregation,true,high,1,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
total_amount_by_fiscal_week_and_revenue_type_filtered_by_type_02_and_specific_weeks,total_circulation_value,"Total Circulation Amount by Fiscal Week & Revenue Type (Type '02', Specific Weeks)","The total financial amount of circulation, grouped by fiscal year week number and revenue type, specifically for revenue types starting with '02' and a predefined list of fiscal weeks and revenue types. This is a specific view of the total circulation value.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT t0.fy_year_week_number, SUM(t0.amount) AS total_amount, t0.revenue_type FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 WHERE SAFE.LEFT(t0.revenue_type, 2) = '02' AND t0.fy_year_week_number IN (202511, 202512, 202513, 202514, 202515, 202516, 202517, 202518, 202519, 202520, 202521, 202522, 202523, 202524, 202525, 202526, 202527, 202528, 202529, 202530, 202531, 202532, 202533, 202534, 202535, 202536, 202537) AND t0.revenue_type IN ('02 - snapshot - DTI Charges & Volume', '02 - snapshot - THINK - print subs revenue', '02 - snapshot - RCTI Charges & Volume', '02 - snapshot - RCTI - rev rec charge', '02 - snapshot - DTI - rev rec charge', '02 - snapshot - DTI - unmigrated print subs revenue') GROUP BY t0.fy_year_week_number, t0.revenue_type",aggregation,true,high,1,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
total_amount_by_revenue_type_filtered_by_type_02,total_circulation_value,Total Circulation Amount by Revenue Type (Type '02'),"The total financial amount of circulation, grouped by revenue type, specifically for revenue types starting with '02'. This is a specific view of the total circulation value.",ncau-data-newsquery-prd,asl_finance,v_asl_circulation_dq_check,"SELECT SUM(t0.amount) AS total_amount, t0.revenue_type FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0 WHERE SAFE.LEFT(t0.revenue_type, 2) = '02' GROUP BY t0.revenue_type",aggregation,true,high,1,c32d96e5-38f4-48a8-9b70-3d89a83f03aa
gross_adds_budget,gross_adds,Gross Adds (Budget),"Total number of new subscriptions or customers acquired, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.Gross_Adds) AS Gross_Adds
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
net_adds_budget,net_adds,Net Adds (Budget),"Total number of net new subscriptions or customers (Gross Adds minus Gross Cancels), based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.Net_Adds) AS Net_Adds
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
gross_cancels_budget,gross_cancels,Gross Cancels (Budget),"Total number of subscriptions or customers cancelled, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_churn_budget_forecast,"SELECT
  SUM(t0.Gross_Cancels) AS Gross_Cancels
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
net_cancels_budget,net_cancels,Net Cancels (Budget),"Total number of net cancellations, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_churn_budget_forecast,"SELECT
  SUM(t0.Net_Cancels) AS Net_Cancels
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
opening_base_consumer_budget,opening_base_consumer,Opening Base Consumer (Budget),"The number of consumer subscriptions at the beginning of a period, based on budget figures.",ncau-data-newsquery-prd,prstn_finance,v_subscription_budget_forecast_fct,"SELECT
  SUM(t0.Opening_Base_Consumer) AS Opening_Base_Consumer
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
closing_base_consumer_budget,closing_base_consumer,Closing Base Consumer (Budget),"The number of consumer subscriptions at the end of a period, based on budget figures.",ncau-data-newsquery-prd,prstn_finance,v_subscription_budget_forecast_fct,"SELECT
  SUM(t0.Closing_Base_Consumer) AS Closing_Base_Consumer
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_consumer_budget,revenue_consumer,Consumer Revenue (Budget),"Total revenue generated from consumer subscriptions, based on budget figures.",ncau-data-newsquery-prd,prstn_finance,v_subscription_budget_forecast_fct,"SELECT
  SUM(t0.Revenue_Consumer) AS Revenue_Consumer
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
cancels_3rd_pt_budget,cancels_3rd_pt,3rd Party Cancels (Budget),"Cancellations related to 3rd party platforms, based on budget figures.",ncau-data-newsquery-prd,prstn_finance,v_subscription_budget_forecast_fct,"SELECT
  SUM(t0.Cancels_3rd_PT) AS Cancels_3rd_PT
FROM
  (
    WITH
      acquisition_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL',
                  'BAU GENERAL OFFER', 'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Gross_Adds,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET ADDS' AND channel IN ('BAU ALWAYS ON DIGITAL', 'BAU GENERAL OFFER',
                  'BREACH', 'APLS', 'GPLA', 'OTHERS', 'PRES', 'PERFORMANCE MEDIA', 'MARKETING') THEN bundle_qty
              END), 0) AS Net_Adds
        FROM
          (
            SELECT
              year_id,
              week_id,
              masthead,
              scenario,
              transaction_type,
              UPPER(package_type) AS package_type,
              UPPER(channel) AS channel,
              bundle_qty,
              dw_partition_date,
              ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
                UPPER(channel)
                ORDER BY dw_partition_date DESC) AS RN
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
            WHERE
              (scenario = 'BUDGET' AND dw_partition_date >= '2025-02-06' AND transaction_type IN ('GROSS ADDS', 'NET ADDS') AND
              year_id = 2026 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM',
                'WT'))
          )
        WHERE
          RN = 1
        GROUP BY 1, 2, 3
      ),
      churn_budget AS (
        SELECT
          year_id AS fy_year,
          week_id AS fy_week_of_year,
          masthead,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'GROSS CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Gross_Cancels,
          ROUND(SUM(
              CASE
                WHEN scenario = 'BUDGET' AND transaction_type = 'NET CHURN' AND UPPER(package_type) IN ('BUNDLE 7 DAY',
                  'BUNDLE WEEKEND', 'DIGITAL', 'ESSENTIALS', '3RD PARTY & OTHERS') THEN bundle_qty
                ELSE 0
              END), 0) AS Net_Cancels
        FROM
          (
            SELECT
              *,
              RANK() OVER (PARTITION BY year_id,
                CASE
                  WHEN scenario LIKE '%BUDGET%' THEN 'Budget'
                  WHEN scenario LIKE '%FORECAST' THEN 'Forecast'
                END
                ORDER BY dw_partition_date DESC) AS scenario_vers,
              RANK() OVER (
                ORDER BY year_id DESC) AS year_rank
            FROM
              `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast`
            WHERE
              dw_partition_date >= '2024-07-15'
          )
        WHERE
          scenario_vers = 1 AND year_rank = 1 AND transaction_type IN ('GROSS CHURN', 'NET CHURN') AND year_id >
          2024 AND masthead IN ('TA', 'AA', 'CM', 'DT', 'HS', 'CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM', 'WT')
        GROUP BY year_id, week_id, masthead
      ),
      closingbase_revenuebudget AS (
        SELECT
          fy_year,
          fy_week_of_year,
          CASE
            WHEN gl_publication_code = '101' THEN 'TA'
            WHEN gl_publication_code = '111' THEN 'DT'
            WHEN gl_publication_code = '302' THEN 'HS'
            WHEN gl_publication_code = '307' THEN 'WT'
            WHEN gl_publication_code = '351' THEN 'GA'
            WHEN gl_publication_code = '401' THEN 'CM'
            WHEN gl_publication_code = '460' THEN 'CP'
            WHEN gl_publication_code = '490' THEN 'TB'
            WHEN gl_publication_code = '501' THEN 'AA'
            WHEN gl_publication_code = '5253' THEN 'TC'
            WHEN gl_publication_code = '685' THEN 'GC'
            WHEN gl_publication_code = '851' THEN 'TM'
            WHEN gl_publication_code = '962' THEN 'NT'
          END AS masthead,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' THEN closing_base_count
                ELSE 0
              END), 0) AS Total_Closing_Base_F,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Consumer', '3rd Party and Others') AND
                rate_plan_group_name NOT LIKE '%The Wine Club%' THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Consumer,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('Corporate/B2B', 'Campus', 'Education') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_B2B,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN closing_base_count
                ELSE 0
              END), 0) AS Closing_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN opening_base_count
                ELSE 0
              END), 0) AS Opening_Base_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('The Wine Club', 'Apple Store', 'Google Play',
                  'Subscribe with Google (SWG)') THEN revenue_amount
                ELSE 0
              END), 0) AS Revenue_Other,
          ROUND(SUM(
              CASE
                WHEN scenario_name = 'FY26 Budget F0 Final' AND category_name IN ('3rd Party Platform', '3rd Party and Others',
                  '3rd Party & Others', 'Apple Store', 'Google Play', 'Subscribe with Google (SWG)', 'Press Reader') THEN cancellation_count
                ELSE 0
              END), 0) AS Cancels_3rd_PT
        FROM
          `ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct` AS budgetforecast
          LEFT JOIN
          `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS calen
          ON budgetforecast.fiscal_week_id = calen.fy_year_week_number AND calen.day_name = 'Sunday'
        WHERE
          fy_year = 2026 AND scenario_version_code = 'P' AND scenario_name IN ('FY 25 Budget Jul', 'FY26 Budget F0 Final') AND
          gl_publication_code IN ('101', '111', '302', '307', '351', '401', '460', '490', '501', '5253', '685',
            '851', '962')
        GROUP BY 1, 2, 3
      )
    SELECT
      abud.fy_year,
      abud.fy_week_of_year,
      abud.masthead,
      Gross_Adds,
      Net_Adds,
      Gross_Cancels,
      Net_Cancels,
      Closing_Base_Consumer,
      Opening_Base_Consumer,
      Revenue_Consumer,
      Cancels_3rd_PT
    FROM
      acquisition_budget AS abud
      LEFT JOIN
      churn_budget AS cbud
      ON abud.fy_year = cbud.fy_year AND abud.fy_week_of_year = cbud.fy_week_of_year AND abud.masthead = cbud.masthead
      LEFT JOIN
      closingbase_revenuebudget AS crbud
      ON abud.fy_year = crbud.fy_year AND abud.fy_week_of_year = crbud.fy_week_of_year AND abud.masthead =
        crbud.masthead
  ) AS t0
WHERE
  (CASE WHEN ('All Mastheads' = 'All Mastheads') THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END)) THEN true WHEN ('All Mastheads' = (CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END)) THEN true ELSE NULL END) = true",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
gross_adds_net_adds_channel_bau_always_on_digital,gross_adds_by_channel,Gross Adds (BAU Always On Digital Channel),"Gross Adds specifically from the 'BAU Always on Digital' channel, for the 'GROSS ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Gross_Adds_BAU_Always_On_Digital
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'GROSS ADDS'
  AND t0.channel = 'BAU Always on Digital'
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
gross_adds_net_adds_channel_apls_gpla_pres,gross_adds_by_channel,Gross Adds (APLS/GPLA/PRES Channels),"Gross Adds specifically from 'APLS', 'GPLA', or 'PRES' channels, for the 'GROSS ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Gross_Adds_APLS_GPLA_PRES
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'GROSS ADDS'
  AND t0.channel IN ('APLS', 'GPLA', 'PRES')
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
gross_adds_net_adds_channel_others_pres,gross_adds_by_channel,Gross Adds (Others/PRES Channels),"Gross Adds specifically from 'Others' or 'PRES' channels, for the 'GROSS ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Gross_Adds_Others_PRES
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'GROSS ADDS'
  AND t0.channel IN ('Others', 'PRES')
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
gross_adds_net_adds_channel_breach,gross_adds_by_channel,Gross Adds (Breach Channel),"Gross Adds specifically from the 'Breach' channel, for the 'GROSS ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Gross_Adds_Breach
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'GROSS ADDS'
  AND t0.channel = 'Breach'
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
gross_adds_net_adds_channel_bau_general_offer_marketing,gross_adds_by_channel,Gross Adds (BAU General Offer/Marketing Channels),"Gross Adds specifically from 'BAU General Offer' or 'Marketing' channels, for the 'GROSS ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Gross_Adds_BAU_General_Offer_Marketing
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'GROSS ADDS'
  AND t0.channel IN ('BAU General Offer', 'Marketing')
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_adds_net_adds_channel_bau_always_on_digital,net_adds_by_channel,Net Adds (BAU Always On Digital Channel),"Net Adds specifically from the 'BAU Always on Digital' channel, for the 'NET ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Net_Adds_BAU_Always_On_Digital
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'NET ADDS'
  AND t0.channel = 'BAU Always on Digital'
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_adds_net_adds_channel_apls_gpla_pres,net_adds_by_channel,Net Adds (APLS/GPLA/PRES Channels),"Net Adds specifically from 'APLS', 'GPLA', or 'PRES' channels, for the 'NET ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Net_Adds_APLS_GPLA_PRES
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'NET ADDS'
  AND t0.channel IN ('APLS', 'GPLA', 'PRES')
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_adds_net_adds_channel_others_pres,net_adds_by_channel,Net Adds (Others/PRES Channels),"Net Adds specifically from 'Others' or 'PRES' channels, for the 'NET ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Net_Adds_Others_PRES
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'NET ADDS'
  AND t0.channel IN ('Others', 'PRES')
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_adds_net_adds_channel_breach,net_adds_by_channel,Net Adds (Breach Channel),"Net Adds specifically from the 'Breach' channel, for the 'NET ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Net_Adds_Breach
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'NET ADDS'
  AND t0.channel = 'Breach'
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_adds_net_adds_channel_bau_general_offer_marketing,net_adds_by_channel,Net Adds (BAU General Offer/Marketing Channels),"Net Adds specifically from 'BAU General Offer' or 'Marketing' channels, for the 'NET ADDS' transaction type, based on budget figures.",ncau-data-newsquery-prd,prstn_consumer_views,v_consumer_acquisition_budget_forecast,"SELECT
  SUM(t0.bundle_qty) AS Net_Adds_BAU_General_Offer_Marketing
FROM
  (
    SELECT
      *,
      ROW_NUMBER() OVER (PARTITION BY year_id, week_id, masthead, scenario, transaction_type, UPPER(package_type),
        UPPER(channel)
        ORDER BY dw_partition_date DESC) AS RN
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast`
  ) AS t0
WHERE
  t0.RN = 1
  AND t0.transaction_type = 'NET ADDS'
  AND t0.channel IN ('BAU General Offer', 'Marketing')
  AND t0.year_id = 2026
  AND t0.masthead IN ('WT', 'TM', 'TB', 'TA', 'NT', 'GC', 'HS', 'GA', 'DT', 'CP', 'CM', 'AA', 'TC')
  AND t0.scenario = 'BUDGET'",measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_other_budget,revenue_other,Revenue Other (Budget),"Revenue from 'Other' categories, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_consumer_budget_scorecard,revenue_consumer,Consumer Revenue (Budget - Scorecard),"Total revenue generated from consumer subscriptions, based on budget figures from the scorecard table.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
total_cancels_excluding_3rd_party_budget,total_cancels_excluding_3rd_party,Total Cancels Excluding 3rd Party (Budget),"Total cancellations excluding those from 3rd party platforms, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_3rd_party_budget,revenue_3rd_party,Revenue 3rd Party (Budget),"Revenue generated from 3rd party platforms, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_3rd_party_gpla_budget,revenue_3rd_party_gpla,Revenue 3rd Party GPLA (Budget),"Revenue generated from 3rd party GPLA (Google Play) platforms, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_GPLA_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
closing_base_3rd_party_gpla_budget,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA (Budget),"Closing base count for 3rd party GPLA (Google Play) subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_GPLA_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
total_revenue_budget,total_revenue,Total Revenue (Budget),"Overall total revenue, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_3rd_party_apls_budget,revenue_3rd_party_apls,Revenue 3rd Party APLS (Budget),"Revenue generated from 3rd party APLS (Apple Store) platforms, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_APLS_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
total_cancels_including_3rd_party_budget,total_cancels_including_3rd_party,Total Cancels Including 3rd Party (Budget),"Total cancellations including those from 3rd party platforms, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
closing_base_3rd_party_budget,closing_base_3rd_party,Closing Base 3rd Party (Budget),"Closing base count for all 3rd party subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_campus_budget,revenue_campus,Revenue Campus (Budget),"Revenue generated from campus subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
total_weekly_sales_budget,total_weekly_sales,Total Weekly Sales (Budget),"Total sales volume on a weekly basis, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
net_growth_incl_3rd_party_budget,net_growth_incl_3rd_party,Net Growth Including 3rd Party (Budget),"Net growth in subscriptions including 3rd party, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
essentials_budget,essentials,Essentials (Budget),"Sales volume for 'Essentials' category, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
revenue_corp_budget,revenue_corp,Revenue Corporate (Budget),"Revenue generated from corporate subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_growth_3rd_party_gpla_budget,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA (Budget),"Net growth in 3rd party GPLA (Google Play) subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_GPLA_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
closing_base_3rd_party_apls_budget,closing_base_3rd_party_apls,Closing Base 3rd Party APLS (Budget),"Closing base count for 3rd party APLS (Apple Store) subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_APLS_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
other_sales_budget,other_sales,Other Sales (Budget),"Sales volume for 'Other' categories, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_growth_consumer_budget,net_growth_consumer,Net Growth Consumer (Budget),"Net growth in consumer subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
general_offer_sales_budget,general_offer_sales,General Offer Sales (Budget),"Sales volume from general offers, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
total_closing_base_budget,total_closing_base,Total Closing Base (Budget),"Overall total closing base count for all subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
always_on_digital_sales_budget,always_on_digital_sales,Always On Digital Sales (Budget),"Sales volume from 'Always On Digital' campaigns, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
switches_budget,switches,Switches (Budget),"Number of subscription switches, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_growth_3rd_party_budget,net_growth_3rd_party,Net Growth 3rd Party (Budget),"Net growth in 3rd party subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
breach_sales_budget,breach_sales,Breach Sales (Budget),"Sales volume from 'Breach' category, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_growth_3rd_party_apls_budget,net_growth_3rd_party_apls,Net Growth 3rd Party APLS (Budget),"Net growth in 3rd party APLS (Apple Store) subscriptions, based on budget figures.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_APLS_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,False,medium,2,28082293-c836-46f0-83f8-b5ce909cd051
net_cancels_budget_scorecard,net_cancels,Net Cancels (Budget - Scorecard),"Total net cancellations, based on budget figures from the scorecard table.",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels_B) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE TRUE,measure,True,high,2,28082293-c836-46f0-83f8-b5ce909cd051
scenario_type_dimension,scenario_type,Scenario Type,Indicates whether the data represents 'Budget' or 'Forecast' figures.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT CASE WHEN ('BUD' = 'FCT') THEN 'Forecast' WHEN ('BUD' = 'BUD') THEN 'Budget' ELSE NULL END AS Scenario_Type FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` LIMIT 1,dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
masthead_group_states_and_community,masthead_group,Masthead Group: States and Community,Categorization of mastheads into 'States and Community' group.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (t0.masthead = 'TA') THEN 'The Australian and Prestige' ELSE NULL END AS Masthead_Group FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 LIMIT 1",dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
masthead_group_metro,masthead_group,Masthead Group: Metro,Categorization of mastheads into 'Metro' group.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT CASE WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE NULL END AS Masthead_Group FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 LIMIT 1",dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
masthead_name,masthead_name,Masthead Name,"Specific name of the masthead (e.g., 'The Australian', 'Daily Telegraph').",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' WHEN (t0.masthead = 'GA') THEN 'Geelong Advertiser' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'TB') THEN 'Townsville Bulletin' WHEN (t0.masthead = 'TC') THEN 'Toowoomba Chronicles' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'AA') THEN 'The Advertiser' ELSE NULL END AS Masthead_Name FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 LIMIT 1,dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
fy_week_of_year,fy_week_of_year,Fiscal Week of Year,The fiscal week number within the fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` LIMIT 1,dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
fy_year,fy_year,Fiscal Year,The fiscal year.,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT fy_year FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` LIMIT 1,dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
week_label_fy_2026_herald_sun,week_label,Week Label (FY2026 Herald Sun),"A concatenated string representing the fiscal year, week number, and masthead for a specific date (July 23, 2025).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,"SELECT CONCAT('FY','2026',' ','Week ',SAFE_CAST(CASE WHEN (EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-23 02:37:14.144508+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-23 02:37:14.144508+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2025-07-02T00:00:00' AS DATETIME), WEEK) - 1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-23 02:37:14.144508+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2025-07-02T00:00:00' AS DATETIME), WEEK) END AS STRING),' | ','Herald Sun') AS Week_Label FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` LIMIT 1",dimension,False,low,2,28082293-c836-46f0-83f8-b5ce909cd051
conformed_owner_full_contra_renee,conformed_owner_full,"Conformed Owner (Contra, Renee Sycamore)",Lists the full names of current portfolio conformed owners for accounts classified under 'Contra' industry pillar and managed by 'Renee Sycamore'.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT DISTINCT SAFE_CAST(current_portfolio_conformed_owner_full AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(nca_industry_pillar AS STRING) = 'Contra' AND SAFE_CAST(sales_segment_gm_name AS STRING) = 'Renee Sycamore' LIMIT 10,dimension,false,low,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
total_gross_revenue_open_ctr,total_gross_revenue,Total Gross Revenue (Open Contra Accounts),"The sum of gross revenue amounts for accounts that are 'Open' and match specific 'Contra' related criteria, excluding certain cost models, transaction statuses, and publication types.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(SAFE_CAST(gross_revenue_amount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,true,high,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
digital_revenue_open_ctr,digital_revenue,Digital Revenue (Open Contra Accounts),"The sum of gross revenue amounts specifically for 'Digital' revenue types, filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(revenue_type AS STRING) = 'Digital' THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,false,medium,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
print_revenue_open_ctr,print_revenue,Print Revenue (Open Contra Accounts),"The sum of gross revenue amounts specifically for 'Print' revenue types, filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(revenue_type AS STRING) = 'Print' THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,false,medium,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
revenue_last_fy_open_ctr,revenue_by_fy_offset,"Gross Revenue (Last Fiscal Year, Open Contra Accounts)","The sum of gross revenue amounts for the last fiscal year (relative_fy_year_offset = -1), filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) = -1 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,false,medium,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
revenue_older_fys_open_ctr,revenue_by_fy_offset,"Gross Revenue (Older Fiscal Years, Open Contra Accounts)","The sum of gross revenue amounts for fiscal years older than the last fiscal year (relative_fy_year_offset < -1), filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) < -1 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,false,low,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
revenue_current_fy_open_ctr,revenue_by_fy_offset,"Gross Revenue (Current Fiscal Year, Open Contra Accounts)","The sum of gross revenue amounts for the current fiscal year (relative_fy_year_offset = 0), filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) = 0 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,true,high,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
revenue_future_fys_open_ctr,revenue_by_fy_offset,"Gross Revenue (Future Fiscal Years, Open Contra Accounts)","The sum of gross revenue amounts for future fiscal years (relative_fy_year_offset > 0), filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) > 0 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,false,low,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
revenue_past_fys_open_ctr,revenue_by_fy_offset,"Gross Revenue (Past Fiscal Years, Open Contra Accounts)","The sum of gross revenue amounts for all past fiscal years (relative_fy_year_offset < 0), filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) < 0 THEN SAFE_CAST(gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open'",measure,false,medium,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
adpoint_account_number_grouped,adpoint_account_number,Adpoint Account Number (Grouped Contra),"Adpoint account numbers, with specific 'CTR' related accounts grouped under 'ctr1', filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT DISTINCT CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN ('13019', '52246', '18387') THEN 'ctr1' ELSE SAFE_CAST(adpoint_account_number AS STRING) END FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open' LIMIT 10",dimension,false,medium,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
advertiser_name_grouped_contra,advertiser_name,Advertiser Name (Grouped Contra),"Advertiser names, with specific 'CTR' related accounts grouped under a consolidated name, filtered for 'Open' contra accounts and other specific criteria.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client_daily,"SELECT DISTINCT CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN ('13019', '52246', '18387') THEN 'CTR_2023_AFL Sports CTR_2023_Sydney Swans CTR_2023_GWS Giants' ELSE SAFE_CAST(advertiser_name AS STRING) END FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr' AND SAFE_CAST(adpoint_account_number AS STRING) != '20696' AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange') AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-'))) AND (CASE WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (SELECT DISTINCT NMBS_T_Number FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data` WHERE SAFE_CAST(Status AS STRING) = 'Closed') THEN 'Closed' ELSE 'Open' END) = 'Open' LIMIT 10",dimension,false,medium,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
record_count_specific_contra_advertisers,record_count,Record Count for Specific Contra Advertisers,Counts the number of records for a predefined list of specific 'Contra' advertisers.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT COUNT(1) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(advertiser_name AS STRING) IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia')",measure,false,low,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
account_number_specific_contra,account_number,Account Number (Specific Contra Advertisers),Lists unique account numbers associated with a predefined list of specific 'Contra' advertisers.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DISTINCT SAFE_CAST(account_number AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(advertiser_name AS STRING) IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia') LIMIT 10",dimension,false,low,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
adpoint_account_number_specific_contra,adpoint_account_number,Adpoint Account Number (Specific Contra Advertisers),Lists unique adpoint account numbers associated with a predefined list of specific 'Contra' advertisers.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DISTINCT SAFE_CAST(adpoint_account_number AS STRING) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE SAFE_CAST(advertiser_name AS STRING) IN ('CTR_2023_AFL SPORT', 'CTR_2023_GWS GIANTS', 'CTR_2023_SYDNEY SWANS', 'CTR_2025_Greater Western Sydney Giants', 'CTR_2025_Raising Literacy Australia') LIMIT 10",dimension,false,low,3,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
service_model_dimension,service_model,Service Model,Categorization of service delivery models used for grouping and filtering data.,ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT DISTINCT service_model FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` LIMIT 100,dimension,False,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
fiscal_month_id_dimension,fiscal_month_id,Fiscal Month ID,"Unique identifier for fiscal months in YYYYMM format, used for time-based filtering and grouping.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT DISTINCT SAFE_CAST(fiscal_month_id AS STRING) AS fiscal_month_id FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` ORDER BY fiscal_month_id DESC LIMIT 100,dimension,False,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
business_unit_code_dimension,business_unit_code,Business Unit Code,"Code identifying different business units, used for cost allocation analysis.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_bu_cost,SELECT DISTINCT business_unit_code FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_bu_cost` LIMIT 100,dimension,False,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_2nd_margin_rev_sum,total_2nd_margin_rev,Total 2nd Margin Revenue,The aggregated revenue from the second margin calculation.,ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(total_2nd_margin_rev) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model`,measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_2nd_margin_rev_sum_historical_filtered,total_2nd_margin_rev,"Total 2nd Margin Revenue (Historical, Filtered Service Model)","The aggregated revenue from the second margin calculation for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(t0.total_2nd_margin_rev) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
sales_cost_sum,sales_cost,Total Sales Cost,The aggregated cost associated with sales activities.,ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(sales_cost) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model`,measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
sales_cost_sum_historical_filtered,sales_cost,"Total Sales Cost (Historical, Filtered Service Model)","The aggregated cost associated with sales activities for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(t0.sales_cost) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_after_exclusion_sum,revenue_served_after_exclusion,Total Revenue Served After Exclusion,The aggregated revenue served after specific exclusions have been applied.,ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(revenue_served_after_exclusion) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model`,measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_after_exclusion_sum_historical_filtered,revenue_served_after_exclusion,"Total Revenue Served After Exclusion (Historical, Filtered Service Model)","The aggregated revenue served after specific exclusions for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(t0.revenue_served_after_exclusion) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_other_margin_rev_sum,total_other_margin_rev,Total Other Margin Revenue,The aggregated revenue from other margin calculations.,ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(total_other_margin_rev) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model`,measure,True,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_other_margin_rev_sum_historical_filtered,total_other_margin_rev,"Total Other Margin Revenue (Historical, Filtered Service Model)","The aggregated revenue from other margin calculations for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(t0.total_other_margin_rev) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,True,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_count,target_cost_to_serve_percentage,Count of Target Cost To Serve Percentage,"The count of records with a target cost to serve percentage for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT COUNT(t0.target_cost_to_serve_percentage) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,False,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_sum,target_cost_to_serve_percentage,Sum of Target Cost To Serve Percentage,"The sum of target cost to serve percentages for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(t0.target_cost_to_serve_percentage) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
target_cost_to_serve_percentage_avg,target_cost_to_serve_percentage,Average Target Cost To Serve Percentage,"The average target percentage for cost to serve, calculated for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT AVG(t0.target_cost_to_serve_percentage) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),calculated_field,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
revenue_served_sum_historical_filtered,revenue_served,"Total Revenue Served (Historical, Filtered Service Model)","The aggregated total revenue served for historical fiscal months, excluding 'V1. Hybrid' service model.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_service_model,SELECT SUM(t0.revenue_served) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) < SAFE_CAST(t0.current_fiscal_month_id AS STRING) AND t0.service_model != 'V1. Hybrid'),measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
allocated_cost_sum_by_bu,allocated_cost,Total Allocated Cost by Business Unit,The aggregated cost allocated to each business unit.,ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_bu_cost,"SELECT SUM(t0.allocated_cost) AS total_allocated_cost, t0.business_unit_code FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_bu_cost` AS t0 GROUP BY t0.business_unit_code",measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
product_revenue_sum_filtered,product_revenue,Total Product Revenue (Filtered),"The aggregated revenue generated from product sales, filtered by specific fiscal months and service models.",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_product,"SELECT SUM(t0.product_revenue) AS total_product_revenue, SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_product` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY SAFE_CAST(t0.fiscal_month_id AS STRING), t0.service_model",measure,True,high,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
other_additional_margin_min_filtered,other_additional_margin,Minimum Other Additional Margin (Filtered),"The minimum value of other additional margin, filtered by specific fiscal months and service models. (Note: MIN aggregation might indicate a specific display requirement rather than a typical margin metric).",ncau-data-newsquery-prd,sbx_fda_noncorefin,cost_to_serve_product,"SELECT MIN(t0.other_additional_margin) AS min_other_additional_margin, SAFE_CAST(t0.fiscal_month_id AS STRING) AS fiscal_month_id, t0.service_model FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_product` AS t0 WHERE (SAFE_CAST(t0.fiscal_month_id AS STRING) IN ('202401', '202402', '202403', '202404', '202405', '202406', '202407', '202408', '202409', '202410', '202411', '202412', '202501', '202502', '202503', '202504', '202505', '202506', '202507') AND t0.service_model IN ('E1.F2F Key Accounts', 'E2. F2F Agency', 'E3. Direct', 'N1. New Business F2F', 'N2. New Business Virtual', 'Other', 'V2. Transactional', 'V3. Self Service', 'V4. Account Managed')) GROUP BY SAFE_CAST(t0.fiscal_month_id AS STRING), t0.service_model",measure,False,medium,4,c44e51ad-f0c4-4a5e-bb7c-e0044deaa278
total_earned_amount_filtered_classification_publication,earned_amount,Total Earned Amount (Filtered by Classification & Publication),"The total earned amount after excluding specific classification levels (e.g., complimentary, free trials) and limited to 'News Media Publishing' publication. This represents core revenue.",ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    SUM(t0.earned_amount) AS total_earned_amount
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.classification_level_1_description AS STRING) NOT IN ('Complimentary', 'Free Staff', 'Free Trials')
    AND SAFE_CAST(t0.classification_level_2_description AS STRING) NOT IN ('Brand Registration', 'Business', 'Cafe', 'CAFE', 'Caf', 'CLIENT', 'Complimentary', 'DIGITAL', 'Digital Bundle', 'Education', 'Existing Subscribers', 'Free Staff', 'Free to Paid', 'Free Trials', 'Group Activation', 'Home Delivery', 'Library', 'Metered Access', 'Miscellaneous', 'Staff', 'TAB', 'Unknown', 'VIP Access')
    AND SAFE_CAST(t0.L03_publication_name AS STRING) = 'News Media Publishing'",aggregation,true,high,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
total_earned_amount_filtered_current_fiscal_weeks,earned_amount,"Total Earned Amount (Filtered, Current Fiscal Weeks)","The total earned amount for the current fiscal weeks (e.g., 202601-202604), after excluding specific classification levels and limited to 'News Media Publishing' publication.",ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    SUM(t0.earned_amount) AS total_earned_amount
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.classification_level_1_description AS STRING) NOT IN ('Complimentary', 'Free Staff', 'Free Trials')
    AND SAFE_CAST(t0.classification_level_2_description AS STRING) NOT IN ('Brand Registration', 'Business', 'Cafe', 'CAFE', 'Caf', 'CLIENT', 'Complimentary', 'DIGITAL', 'Digital Bundle', 'Education', 'Existing Subscribers', 'Free Staff', 'Free to Paid', 'Free Trials', 'Group Activation', 'Home Delivery', 'Library', 'Metered Access', 'Miscellaneous', 'Staff', 'TAB', 'Unknown', 'VIP Access')
    AND SAFE_CAST(t0.L03_publication_name AS STRING) = 'News Media Publishing'
    AND SAFE_CAST(t0.fiscal_week_id AS INT64) IN (202601, 202602, 202603, 202604)",aggregation,true,high,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
total_earned_amount_filtered_estimate_prior_fiscal_weeks,earned_amount,"Total Earned Amount (Filtered, Estimate Scenario, Prior Fiscal Weeks)","The total earned amount for the 'Estimate' scenario and prior fiscal weeks (e.g., 202501-202504), after excluding specific classification levels and limited to 'News Media Publishing' publication.",ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT
    SUM(t0.earned_amount) AS total_earned_amount
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.classification_level_1_description AS STRING) NOT IN ('Complimentary', 'Free Staff', 'Free Trials')
    AND SAFE_CAST(t0.classification_level_2_description AS STRING) NOT IN ('Brand Registration', 'Business', 'Cafe', 'CAFE', 'Caf', 'CLIENT', 'Complimentary', 'DIGITAL', 'Digital Bundle', 'Education', 'Existing Subscribers', 'Free Staff', 'Free to Paid', 'Free Trials', 'Group Activation', 'Home Delivery', 'Library', 'Metered Access', 'Miscellaneous', 'Staff', 'TAB', 'Unknown', 'VIP Access')
    AND SAFE_CAST(t0.L03_publication_name AS STRING) = 'News Media Publishing'
    AND SAFE_CAST(t0.fiscal_week_id AS INT64) IN (202501, 202502, 202503, 202504)
    AND SAFE_CAST(t0.scenario AS STRING) IN ('Estimate')",aggregation,true,high,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
distinct_gl_publication_code_true_up,gl_publication_code,Distinct GL Publication Code (True Up Adjustment),A list of unique GL publication codes associated with 'True Up Adjustment' scenarios for a specific fiscal week.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT DISTINCT
    SAFE_CAST(t0.gl_publication_code AS STRING) AS gl_publication_code
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.fiscal_week_id AS INT64) IN (202504)
    AND SAFE_CAST(t0.scenario AS STRING) IN ('True Up Adjustment')",dimension,false,medium,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
distinct_gl_publication_code_estimate,gl_publication_code,Distinct GL Publication Code (Estimate Scenario),A list of unique GL publication codes associated with 'Estimate' scenarios.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT DISTINCT
    SAFE_CAST(t0.gl_publication_code AS STRING) AS gl_publication_code
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.scenario AS STRING) IN ('Estimate')",dimension,false,medium,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
distinct_scenario_by_fiscal_week,scenario,Distinct Scenario (by Fiscal Week),A list of unique scenarios available for a given fiscal week.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT DISTINCT
    SAFE_CAST(t0.scenario AS STRING) AS scenario
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.fiscal_week_id AS INT64) IN (202504)",dimension,false,low,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
distinct_l03_publication_name_estimate,L03_publication_name,Distinct L03 Publication Name (Estimate Scenario),A list of unique L03 publication names associated with 'Estimate' scenarios for a specific fiscal period.,ncau-data-newsquery-prd,prstn_finance,v_subscription_snapshot_fct,"SELECT DISTINCT
    SAFE_CAST(t0.L03_publication_name AS STRING) AS L03_publication_name
FROM
    `ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct` AS t0
WHERE
    SAFE_CAST(t0.fiscal_week_id AS INT64) IN (202501, 202502, 202503, 202504)
    AND SAFE_CAST(t0.scenario AS STRING) IN ('Estimate')",dimension,false,medium,5,e380f99e-2ef3-40ec-a3ec-bc35491cc0bb
total_lgr_npv_filtered,total_lgr,Total LGR (Net Present Value Filtered),"The sum of LGR (Likely Gross Revenue or similar financial metric) for records where either the current or prior year's PV flag is 'NPV', the fiscal month offset is non-negative, and LGR is not zero. This represents revenue contributing to Net Present Value calculations.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT SUM(SAFE_CAST(t0.LGR AS BIGNUMERIC)) AS total_lgr FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE (t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') AND SAFE_CAST(t0.relative_fy_month_offset AS BIGNUMERIC) >= 0 AND SAFE_CAST(t0.LGR AS BIGNUMERIC) != 0.000000,aggregation,True,high,6,7ada02b8-e93e-41d8-9a7e-05013ff81247
sum_relative_fy_month_offset_npv_filtered,sum_relative_fy_month_offset,Sum of Relative Fiscal Month Offset (NPV Filtered),"The sum of the relative fiscal month offset for records where either the current or prior year's PV flag is 'NPV', the fiscal month offset is non-negative, and LGR is not zero. The exact business meaning of summing this offset is unclear without further context, but it's included in the dashboard's primary query.",ncau-data-newsquery-prd,asl_finance_derived,adsales_npv,SELECT SUM(SAFE_CAST(t0.relative_fy_month_offset AS BIGNUMERIC)) AS sum_relative_fy_month_offset FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_npv` AS t0 WHERE (t0.CURR_PV_FLAG = 'NPV' OR t0.STLY_PV_FLAG = 'NPV') AND SAFE_CAST(t0.relative_fy_month_offset AS BIGNUMERIC) >= 0 AND SAFE_CAST(t0.LGR AS BIGNUMERIC) != 0.000000,aggregation,False,low,6,7ada02b8-e93e-41d8-9a7e-05013ff81247
data_load_datetime_second_truncated,data_load_datetime,Data Load Datetime (Second Truncated),"The timestamp indicating when the data was loaded, truncated to the second, used for time-based analysis or filtering.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DATETIME_TRUNC(t0.data_load_datetime, SECOND) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0",dimension,False,low,7,4114bd43-f752-4628-9b6c-1941b3c0d962
unified_publication_name_fy24_25_filtered,unified_publication_name,"Unified Publication Name (FY24/25, Excl. Admin/Ecomm)","The name of the unified publication, specifically filtered for financial years 2024 and 2025, and excluding a predefined list of administrative, e-commerce, and subscription-related publication names.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT t0.unified_publication_name FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE (t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') AND t0.financial_year IN ('2024', '2025')) GROUP BY t0.unified_publication_name",dimension,False,medium,7,4114bd43-f752-4628-9b6c-1941b3c0d962
digital_gross_revenue_fy24_25_filtered,gross_revenue_amount,"Digital Gross Revenue (FY24/25, Filtered Ad Type/Pub)","The total gross revenue specifically for 'DIGITAL' revenue types, for financial years 2024 and 2025, excluding certain ad types and a predefined list of administrative/e-commerce publication names. This represents a key performance indicator for digital campaign revenue.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE (t0.revenue_type = 'DIGITAL' AND t0.financial_year >= '2024' AND t0.fin_adtype_name NOT IN ('Xtend', 'Unruly (Non-Targeted)', 'Taboola', 'SUDDENLY (Non-Targeted)', 'Finda', 'Events (Non-Targeted)', 'Edmedia', 'Display', 'Creatives', 'Classified', '-') AND t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') AND t0.financial_year IN ('2024', '2025'))",measure,True,high,7,4114bd43-f752-4628-9b6c-1941b3c0d962
financial_year_filtered_pub,financial_year,Financial Year (Excl. Admin/Ecomm Pub),"The financial year, filtered to exclude a predefined list of administrative, e-commerce, and subscription-related publication names, used for year-over-year comparisons or filtering.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT t0.financial_year FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE t0.unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') GROUP BY t0.financial_year",dimension,False,medium,7,4114bd43-f752-4628-9b6c-1941b3c0d962
total_revenue_budget_weekly_courier_mail_fy2025,total_revenue,"Total Revenue (Budget, Weekly, Courier Mail, FY2025)","Total budgeted revenue for the specified fiscal week and 'Courier Mail' masthead in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Total_Revenue_B AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND masthead = 'Courier Mail' AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-11') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_revenue_actual_weekly_all_mastheads_fy2025,total_revenue,"Total Revenue (Actual, Weekly, All Mastheads, FY2025)","Total actual or forecast revenue for the specified fiscal week across all mastheads in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Total_Revenue AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-10') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_weekly_sales_budget_weekly_courier_mail_fy2025,total_weekly_sales,"Total Weekly Sales (Budget, Weekly, Courier Mail, FY2025)","Total budgeted weekly sales for the specified fiscal week and 'Courier Mail' masthead in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Total_Weekly_Sales_B AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND masthead = 'Courier Mail' AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-11') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_weekly_sales_actual_weekly_all_mastheads_fy2025,total_weekly_sales,"Total Weekly Sales (Actual, Weekly, All Mastheads, FY2025)","Total actual or forecast weekly sales for the specified fiscal week across all mastheads in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Total_Weekly_Sales AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-10') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_closing_base_budget_weekly_courier_mail_fy2025,total_closing_base,"Total Closing Base (Budget, Weekly, Courier Mail, FY2025)","Total budgeted closing base for the specified fiscal week and 'Courier Mail' masthead in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Total_Closing_Base_B AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND masthead = 'Courier Mail' AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-11') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
total_closing_base_actual_weekly_all_mastheads_fy2025,total_closing_base,"Total Closing Base (Actual, Weekly, All Mastheads, FY2025)","Total actual or forecast closing base for the specified fiscal week across all mastheads in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Total_Closing_Base AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-10') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_incl_3rd_party_budget_weekly_courier_mail_fy2025,net_growth_incl_3rd_party,"Net Growth Incl. 3rd Party (Budget, Weekly, Courier Mail, FY2025)","Budgeted net growth including 3rd party for the specified fiscal week and 'Courier Mail' masthead in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Net_Growth_incl_3rd_Party_B AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND masthead = 'Courier Mail' AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-11') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
net_growth_incl_3rd_party_actual_weekly_all_mastheads_fy2025,net_growth_incl_3rd_party,"Net Growth Incl. 3rd Party (Actual, Weekly, All Mastheads, FY2025)","Actual or forecast net growth including 3rd party for the specified fiscal week across all mastheads in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Net_Growth_incl_3rd_Party AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-10') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_consumer_budget_weekly_courier_mail_fy2025,revenue_consumer,"Revenue Consumer (Budget, Weekly, Courier Mail, FY2025)","Budgeted consumer revenue for the specified fiscal week and 'Courier Mail' masthead in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Revenue_Consumer_B AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND masthead = 'Courier Mail' AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-11') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
revenue_consumer_actual_weekly_all_mastheads_fy2025,revenue_consumer,"Revenue Consumer (Actual, Weekly, All Mastheads, FY2025)","Actual or forecast consumer revenue for the specified fiscal week across all mastheads in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Revenue_Consumer AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-10') LIMIT 1);,measure,True,high,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
failed_payment_volume_actual_weekly_all_mastheads_fy2025,failed_payment_volume,"Failed Payment Volume (Actual, Weekly, All Mastheads, FY2025)","Actual or forecast volume of failed payments for the specified fiscal week across all mastheads in FY2025, as derived from the forecast version of the scorecard.",ncau-data-newsquery-prd,sbx_fda_noncorefin,masthead_scorecard_forecast_version,SELECT SUM(SAFE_CAST(Failed_Payment_Volume AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` WHERE SAFE_CAST(calendar_date AS DATE) = DATE('2025-03-10') LIMIT 1);,measure,False,medium,8,5e3be025-a96e-4f5d-8172-dfef07e60f6d
dw_asl_load_timestamp_min,dw_asl_load_timestamp,Earliest Data Load Timestamp,"The earliest timestamp indicating when the ad sales performance data was loaded into the system, truncated to the second. Used for data freshness checks.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT MIN(DATETIME_TRUNC(t0.dw_asl_load_timestamp, SECOND)) AS earliest_load_timestamp FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",aggregation,false,low,9,dd0544cd-634f-43bd-a385-158c78dace66
publication_group_calculated,publication_group,Publication Group (Calculated),"A categorized grouping of unified publication names based on predefined business rules. Categories include 'At Home', 'Body & Soul', 'Escape', 'Real Estate', 'Stellar/Binge', 'Weekend Magazine', and 'Others'. This is a derived dimension used for filtering and analysis.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END",calculated_field,false,low,9,dd0544cd-634f-43bd-a385-158c78dace66
publishing_division_group_filtered,publishing_division_group,Publishing Division Group (Filtered by Publication Group),"The primary publishing division group associated with an ad sale, filtered to exclude 'Others' from the calculated 'Publication Group'. Used for dashboard filters or breakdowns.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT t0.publishing_division_group FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END) != 'Others'",dimension,false,low,9,dd0544cd-634f-43bd-a385-158c78dace66
financial_quarter_filtered_by_publication_group,financial_quarter,Financial Quarter (Filtered by Publication Group),"The financial quarter in which an ad sale occurred, cast to an integer, filtered to exclude 'Others' from the calculated 'Publication Group'. Used for dashboard filters or breakdowns.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT SAFE_CAST(t0.financial_quarter AS INT64) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END) != 'Others'",dimension,false,low,9,dd0544cd-634f-43bd-a385-158c78dace66
publication_group_itself_filtered,publication_group,Publication Group (Selected and Filtered),"The calculated 'Publication Group' itself, filtered to exclude 'Others'. This is used when the dashboard directly displays or filters by the categorized publication group names.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END) != 'Others'",dimension,false,low,9,dd0544cd-634f-43bd-a385-158c78dace66
financial_quarter_filtered_by_publication_group_weekend_may,financial_quarter,"Financial Quarter (Filtered by Publication Group, Weekend Magazine, May)","The financial quarter in which an ad sale occurred, cast to an integer, with additional filters for 'Weekend Magazine' publication group and 'May' financial short month. This represents a more specific slice of the data for analysis.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT DISTINCT SAFE_CAST(t0.financial_quarter AS INT64) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END) != 'Others' AND (CASE WHEN (t0.unified_publication_name IN ('Home NSW', 'Home SA')) THEN 'At Home' WHEN (t0.unified_publication_name IN ('Body + Soul - NSW', 'Body + Soul - QLD', 'Body + Soul - SA', 'Body + Soul - TAS', 'Body + Soul - VIC')) THEN 'Body & Soul' WHEN (t0.unified_publication_name IN ('Escape NSW', 'Escape QLD', 'Escape SA', 'Escape TAS', 'Escape VIC')) THEN 'Escape' WHEN (t0.unified_publication_name IN ('Courier-Mail Real Estate', 'Developing QLD', 'DT Real Estate', 'Herald Sun Real Estate', 'New Homes SA', 'SA Real Estate')) THEN 'Real Estate' WHEN (t0.unified_publication_name IN ('Stellar - NSW', 'Stellar - QLD', 'Stellar - SA', 'Stellar - Vic', 'TV Guide NSW', 'TV Guide QLD', 'TV Guide SA', 'TV Guide VIC')) THEN 'Stellar/Binge' WHEN (t0.unified_publication_name IN ('QWeekend Magazine', 'SA Weekend', 'SydneyWeekend', 'VWeekend')) THEN 'Weekend Magazine' ELSE 'Others' END) IN ('Weekend Magazine') AND t0.financial_short_month IN ('May')",dimension,false,low,9,dd0544cd-634f-43bd-a385-158c78dace66
total_acquisitions,total_acquisitions,Total Acquisitions,The total count of new acquisitions.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.acquisition_count) FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,measure,True,high,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_free_to_paid_conversions,total_free_to_paid_conversions,Total Free-to-Paid Conversions,The total count of free subscribers converting to paid.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.free_to_paid_conversion_count) FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,measure,True,high,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_30day_reactivations,total_30day_reactivations,Total 30-Day Reactivations,The total count of reactivated subscribers within 30 days.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.reactivation_30day_acquisition_count) FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,measure,True,high,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
total_switch_acquisitions,total_switch_acquisitions,Total Switch Acquisitions,The total count of subscribers acquired through a switch offer.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,SELECT SUM(t0.switch_acquisition_count) FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0,measure,True,high,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
dim_customer_type_grouping,dim_customer_type,Customer Type Grouping,"Categorization of subscribers into groups like Consumer, Campus, Corporate, Staff, Corporate IP, or Education based on their classification_level_2.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END AS customer_type_grouping FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0",dimension,False,medium,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
dim_business_type,dim_business_type,Business Type (B2C/B2B),"Categorization of subscribers into B2C (Business-to-Consumer), B2B (Business-to-Business), or Others based on their customer type grouping.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END IN ('Consumer', 'Gift Receiver')) THEN 'B2C' WHEN (CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B' ELSE 'Others' END AS business_type FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0",dimension,False,high,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
dim_masthead_region_grouping,dim_masthead_region,Masthead Region Grouping,"Categorization of mastheads into regions like The Australian, Metro, Regionals, Other Publications, Deep Niche Publications, or Exclude.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (t0.masthead = 'WT') THEN 'Other Publications' WHEN (t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (t0.masthead IS NULL) THEN 'check' ELSE 'Exclude' END AS masthead_region_grouping FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0",dimension,False,medium,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
dim_subscription_type,dim_subscription_type,Subscription Type (Digital/Print),Categorization of subscriptions into Digital Subscriptions or Print Subscriptions based on delivery medium type and subscriber email flag.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0",dimension,False,medium,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
dim_product_category,dim_product_category,"Product Category (Core Consumer, B2B, Deep Niche)","High-level categorization of products into Core Consumer, B2B, Deep Niche Products, or 'Check for New Products' based on various product attributes and classifications.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    CASE
        WHEN ((clmn25_ = 'Print 7 Day') OR (CONCAT(SAFE_CAST(clmn12_ AS STRING),' ',SAFE_CAST(clmn20_ AS STRING)) = 'Bundle 7 day and Other') OR (CASE WHEN (clmn25_ = 'Bundle Only') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Bundle Weekend') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Bundle Weekend Only') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Digital') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Digital Only') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Essentials') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Print 7 Day') THEN TRUE ELSE FALSE END) OR (CONCAT(SAFE_CAST(clmn12_ AS STRING),' ',SAFE_CAST(clmn20_ AS STRING)) = 'Print 7 day and Other') OR (CASE WHEN (clmn25_ = 'Print Weekend') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Print Weekend Only') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = '3rd Party and Others') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = '3rd Party and Other') THEN TRUE ELSE FALSE END)) THEN 'Core Consumer'
        WHEN ((CASE WHEN (clmn25_ = 'Campus') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Corporate') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Corporate excluding IP') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Corporate IP') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'IP Access') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'SMB') THEN TRUE ELSE FALSE END)) THEN 'B2B'
        WHEN ((CASE WHEN (clmn25_ = 'Null') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Apple Podcast: Crime X') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Code') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Education') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Not Available 7 Day') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Print Only') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Punters') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Racenet') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Supercoach Plus') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Taste Online') THEN TRUE ELSE FALSE END) OR (CASE WHEN (clmn25_ = 'Wine Club') THEN TRUE ELSE FALSE END)) THEN 'Deep Niche Products'
        ELSE 'Check for New Products'
    END AS product_category
FROM (
    SELECT
        CASE WHEN (clmn19_ = 'B2B') THEN clmn11_ WHEN (clmn16_ = 'Deep Niche Publications') THEN clmn15_ WHEN (clmn5_ = 'WINE') THEN 'Wine Club' WHEN (clmn1_ = 'Offplatform - Paid') THEN '3rd Party and Other' WHEN (clmn10_ IN ('budfor_cancel', 'budfor_acq')) THEN clmn0_ WHEN (clmn11_ = 'Consumer') THEN clmn24_ WHEN (clmn11_ = 'Education') THEN clmn11_ ELSE clmn11_ END AS clmn25_,
        clmn0_, clmn1_, clmn2_, clmn3_, clmn4_, clmn5_, clmn6_, clmn7_, clmn8_, clmn9_, clmn10_, clmn11_, clmn12_, clmn13_, clmn14_, clmn15_, clmn16_, clmn17_, clmn18_, clmn19_, clmn20_, clmn21_, clmn22_, clmn23_, clmn24_
    FROM (
        SELECT
            CASE WHEN (clmn2_ = 'Essentials') THEN 'Essentials' WHEN (clmn12_ = 'Digital') THEN 'Digital' ELSE clmn23_ END AS clmn24_,
            clmn0_, clmn1_, clmn2_, clmn3_, clmn4_, clmn5_, clmn6_, clmn7_, clmn8_, clmn9_, clmn10_, clmn11_, clmn12_, clmn13_, clmn14_, clmn15_, clmn16_, clmn17_, clmn18_, clmn19_, clmn20_, clmn21_, clmn22_, clmn23_
        FROM (
            SELECT
                CONCAT(SAFE_CAST(clmn12_ AS STRING),' ',SAFE_CAST(clmn20_ AS STRING)) AS clmn23_,
                clmn0_, clmn1_, clmn2_, clmn3_, clmn4_, clmn5_, clmn6_, clmn7_, clmn8_, clmn9_, clmn10_, clmn11_, clmn12_, clmn13_, clmn14_, clmn15_, clmn16_, clmn17_, clmn18_, clmn19_, clmn20_
            FROM (
                SELECT
                    CASE WHEN (clmn11_ IN ('Consumer', 'Gift Receiver')) THEN 'B2C' WHEN (clmn11_ IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B' ELSE 'Others' END AS clmn19_,
                    CASE WHEN (clmn4_ = 'Not Available') THEN 'Only' WHEN (clmn14_ OR clmn13_) THEN 'Weekend' ELSE '7 Day' END AS clmn20_,
                    clmn0_, clmn1_, clmn2_, clmn3_, clmn4_, clmn5_, clmn6_, clmn7_, clmn8_, clmn9_, clmn10_, clmn11_, clmn12_, clmn13_, clmn14_, clmn15_, clmn16_, clmn17_, clmn18_
                FROM (
                    SELECT
                        CASE WHEN (t0.classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer' WHEN (t0.classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus' WHEN (t0.classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP' WHEN (t0.classification_level_2 = 'Free Staff') THEN 'Staff' WHEN (t0.classification_level_2 = 'IP Access') THEN 'Corporate IP' WHEN (t0.classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education' ELSE NULL END AS clmn11_,
                        CASE WHEN (t0.delivery_medium_type = 'Not Available') THEN 'Digital' ELSE t0.delivery_medium_type END AS clmn12_,
                        (t0.delivery_schedule_group = 'Weekend (2 Days)') AS clmn13_,
                        (t0.delivery_schedule_group = 'Weekend (1 Day)') AS clmn14_,
                        CASE WHEN (t0.masthead = 'AA') THEN 'The Advertiser' WHEN (t0.masthead = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.masthead = 'CM') THEN 'Courier Mail' WHEN (t0.masthead = 'CP') THEN 'Cairns Post' WHEN (t0.masthead = 'CS') THEN 'Code' WHEN (t0.masthead = 'DT') THEN 'Daily Telegraph' WHEN (t0.masthead = 'GA') THEN 'Geelong' WHEN (t0.masthead = 'GC') THEN 'Gold Coast' WHEN (t0.masthead = 'HS') THEN 'Herald Sun' WHEN (t0.masthead = 'NT') THEN 'NT News' WHEN (t0.masthead = 'NW') THEN 'News.com.au' WHEN (t0.masthead = 'PU') THEN 'Punters' WHEN (t0.masthead = 'RN') THEN 'Racenet' WHEN (t0.masthead = 'SC') THEN 'Supercoach Plus' WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead = 'TB') THEN 'Townsville' WHEN (t0.masthead = 'TC') THEN 'Toowoomba' WHEN (t0.masthead = 'TM') THEN 'The Mercury' WHEN (t0.masthead = 'TS') THEN 'Taste Online' WHEN (t0.masthead = 'WT') THEN 'Weekly Times' ELSE NULL END AS clmn15_,
                        CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (t0.masthead = 'WT') THEN 'Other Publications' WHEN (t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (t0.masthead IS NULL) THEN 'check' ELSE 'Exclude' END AS clmn16_,
                        CASE WHEN (t0.masthead = 'TA') THEN 'The Australian' WHEN (t0.masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals' WHEN (t0.masthead = 'WT') THEN 'Other Publications' WHEN (t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications' WHEN (t0.masthead IS NULL) THEN 'check' ELSE 'Exclude' END AS clmn17_,
                        CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) AS clmn18_,
                        t0.budfor_product AS clmn0_, t0.classification_level_1 AS clmn1_, t0.classification_level_2 AS clmn2_, t0.delivery_medium_type AS clmn3_, t0.delivery_schedule_group AS clmn4_, t0.dw_billing_system_code AS clmn5_, t0.fy_year AS clmn6_, t0.masthead AS clmn7_, t0.subscriber_has_email_flag AS clmn8_, t0.subscription_movement_count_sub_type AS clmn9_, t0.table_nm AS clmn10_
                    FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
                )
            )
        )
    )
)",dimension,False,high,10,0e05b4ce-cb33-488a-8537-b9e68a844e2e
distinct_subscribers_by_gateway_standard_paid,distinct_subscribers_latest_attempt,Distinct Subscribers by Payment Gateway (Standard Paid),"Counts the number of unique subscribers who had their latest payment attempt (within the last 60 days) classified as 'Standard Paid', broken down by payment gateway. This metric is crucial for understanding payment gateway performance for standard paid subscriptions.",ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,"SELECT
  t0.payment_gateway,
  COUNT(DISTINCT t0.subscriber_id_src) AS distinct_subscribers
FROM (
  WITH
    driver AS (
      SELECT
        subscriber_id_src,
        subscription_id_src,
        max(tran_date) AS latest_tran_date
      FROM
        `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans`
      WHERE
        tran_date BETWEEN `current_date`() - 60 AND `current_date`()
      GROUP BY 1, 2
    )
  SELECT
    b.payment_gateway,
    b.subscriber_id_src,
    b.subscription_classification_type
  FROM
    driver AS a
    JOIN
    `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` AS b
    ON a.subscriber_id_src = b.subscriber_id_src AND a.subscription_id_src = b.subscription_id_src AND a.latest_tran_date = b.tran_date
  WHERE
    b.latest_attempt_flag = 'Y'
) AS t0
WHERE t0.subscription_classification_type = 'Standard Paid'
GROUP BY t0.payment_gateway",measure,True,high,11,da5dcd47-2e80-45e8-94b8-5b71d81182f5
distinct_subscribers_standard_paid_other_gateways,distinct_subscribers_latest_attempt,"Distinct Subscribers (Standard Paid, Other Gateways)","Counts the number of unique subscribers who had their latest payment attempt (within the last 60 days) classified as 'Standard Paid' and processed by a payment gateway *not* in the specified list (Stripe, B-Point, PayPal, Bpay, Australia Post), or where the gateway is null. This metric helps identify the volume of transactions handled by less common or uncategorized payment methods.",ncau-data-newsquery-sit,qvr_consumer,fp_all_trans,"SELECT
  COUNT(DISTINCT t0.subscriber_id_src) AS distinct_subscribers
FROM (
  WITH
    driver AS (
      SELECT
        subscriber_id_src,
        subscription_id_src,
        max(tran_date) AS latest_tran_date
      FROM
        `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans`
      WHERE
        tran_date BETWEEN `current_date`() - 60 AND `current_date`()
      GROUP BY 1, 2
    )
  SELECT
    b.payment_gateway,
    b.subscriber_id_src,
    b.subscription_classification_type
  FROM
    driver AS a
    JOIN
    `ncau-data-newsquery-sit.qvr_consumer.fp_all_trans` AS b
    ON a.subscriber_id_src = b.subscriber_id_src AND a.subscription_id_src = b.subscription_id_src AND a.latest_tran_date = b.tran_date
  WHERE
    b.latest_attempt_flag = 'Y'
) AS t0
WHERE
  t0.subscription_classification_type = 'Standard Paid'
  AND (t0.payment_gateway NOT IN ('Stripe', 'B-Point', 'PayPal', 'Bpay', 'Australia Post') OR t0.payment_gateway IS NULL)",measure,True,high,11,da5dcd47-2e80-45e8-94b8-5b71d81182f5
earned_amount_current_fy_wk42_digital_recognition,earned_amount,"Earned Amount (Current FY Week 42, Digital Recognition)","The sum of earned revenue for the current fiscal year (2025), week 42, specifically for 'Digital Recognition' subscriptions and excluding 'Discontinued' mastheads, sourced from 'subsnapfact'.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT
  SUM(
    CASE
      WHEN (base.fy_year = 2025 AND base.fy_week_of_year = 42 AND base.table_union_source = 'subsnapfact')
      THEN base.EarnedAmount
      ELSE NULL
    END
  ) AS earned_amount_current_fy_wk42_digital_recognition
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS base
WHERE
  (
    CASE
      WHEN (base.delivery_medium_type = 'Print') THEN 'Print Recognition'
      WHEN (
        CASE
          WHEN (base.subscriber_has_email_flag = 'subsnapfact') THEN 'Y'
          WHEN (base.classification_level_1_description = 'Standard Paid' AND base.delivery_medium_type = 'Bundle') THEN base.subscriber_has_email_flag
          ELSE 'Y'
        END
      ) = 'N' THEN 'Print Recognition'
      ELSE 'Digital Recognition'
    END
  ) = 'Digital Recognition'
  AND
  (
    CASE
      WHEN (base.gl_publication_code = '101' OR base.gl_publication_code = '100' OR base.masthead_code = 'TA') THEN 'The Australian'
      WHEN (base.gl_publication_code = '401' OR base.gl_publication_code = '402' OR base.gl_publication_code = '36' OR base.masthead_code = 'CM') THEN 'Courier Mail'
      WHEN (base.gl_publication_code = '110' OR base.gl_publication_code = '111' OR base.gl_publication_code = '32' OR base.masthead_code = 'DT') THEN 'Daily Telegraph'
      WHEN (base.gl_publication_code = '301' OR base.gl_publication_code = '303' OR base.gl_publication_code = '63' OR base.masthead_code = 'HS') THEN 'Herald Sun'
      WHEN (base.gl_publication_code = '500' OR base.gl_publication_code = '501' OR base.gl_publication_code = '560' OR base.masthead_code = 'AA') THEN 'The Advertiser'
      WHEN (base.gl_publication_code = '450' OR base.gl_publication_code = '460' OR base.masthead_code = 'CP') THEN 'Cairns Post'
      WHEN (base.gl_publication_code = '350' OR base.gl_publication_code = '351' OR base.masthead_code = 'GA') THEN 'Geelong'
      WHEN (base.gl_publication_code = '670' OR base.gl_publication_code = '685' OR base.masthead_code = 'GC') THEN 'Gold Coast'
      WHEN (base.gl_publication_code = '961' OR base.gl_publication_code = '963' OR base.gl_publication_code = '962' OR base.masthead_code = 'NT') THEN 'NT News'
      WHEN (base.gl_publication_code = '850' OR base.gl_publication_code = '851' OR base.gl_publication_code = '852' OR base.masthead_code = 'TM') THEN 'The Mercury'
      WHEN (base.gl_publication_code = '5053' OR base.gl_publication_code = '5253' OR base.masthead_code = 'TC') THEN 'Toowoomba'
      WHEN (base.gl_publication_code = '475' OR base.gl_publication_code = '490' OR base.masthead_code = 'TB') THEN 'Townsville'
      WHEN (base.gl_publication_code = '305' OR base.gl_publication_code = '307' OR base.masthead_code = 'WT') THEN 'Weekly Times'
      WHEN (base.gl_publication_code = '9001' OR base.masthead_code = 'CS') THEN 'Code'
      WHEN (base.gl_publication_code = '8821' OR base.gl_publication_code = 'Punters.com.au' OR base.masthead_code = 'PU') THEN 'Punters'
      WHEN (base.gl_publication_code = '8822' OR base.gl_publication_code = 'Racenet' OR base.masthead_code = 'RN') THEN 'Racenet'
      WHEN (base.gl_publication_code = '9653' OR base.masthead_code = 'SC') THEN 'Supercoach Plus'
      WHEN (base.gl_publication_code = '9600' OR base.masthead_code = 'TS') THEN 'Taste Online'
      WHEN (base.gl_publication_code = '9003' OR base.gl_publication_code = '9003' OR base.masthead_code = 'AP') THEN 'Apple Podcast: Crime X'
      WHEN (base.gl_publication_code = '103' OR base.masthead_code = 'The Oz') THEN 'The Oz'
      WHEN (base.gl_publication_code = '9000' OR base.gl_publication_code = '9000' OR base.masthead_code = 'NW') THEN 'news.com.au'
      WHEN (base.gl_publication_code = '121') THEN 'Others'
      WHEN (base.gl_publication_code = '9002' OR base.masthead_code = 'BG') THEN 'Brain Games'
      WHEN (base.gl_publication_code = '9504' OR base.gl_publication_code = '9514' OR base.gl_publication_code = '9556' OR base.gl_publication_code = '9558' OR base.gl_publication_code = '9560' OR base.gl_publication_code = '9603' OR base.gl_publication_code = '9623') THEN 'Others'
      WHEN (base.gl_publication_code = '9644') THEN 'Suddenly'
      WHEN (base.gl_publication_code = '9903') THEN 'News Corporate'
      WHEN (base.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
      ELSE NULL
    END
  ) != 'Discontinued'",measure,True,high,12,449b9707-f939-42e1-b6f5-11998369f473
earned_amount_previous_fy_wk42_digital_recognition,earned_amount,"Earned Amount (Previous FY Week 42, Digital Recognition)","The sum of earned revenue (NFEarnedAmount) for the previous fiscal year (2024), week 42, specifically for 'Digital Recognition' subscriptions and excluding 'Discontinued' mastheads, sourced from 'nfmanualhist'.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT
  SUM(
    CASE
      WHEN (base.fy_year = 2024 AND base.fy_week_of_year = 42 AND base.table_union_source = 'nfmanualhist')
      THEN base.NFEarnedAmount
      ELSE 0
    END
  ) AS earned_amount_previous_fy_wk42_digital_recognition
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS base
WHERE
  (
    CASE
      WHEN (base.delivery_medium_type = 'Print') THEN 'Print Recognition'
      WHEN (
        CASE
          WHEN (base.subscriber_has_email_flag = 'subsnapfact') THEN 'Y'
          WHEN (base.classification_level_1_description = 'Standard Paid' AND base.delivery_medium_type = 'Bundle') THEN base.subscriber_has_email_flag
          ELSE 'Y'
        END
      ) = 'N' THEN 'Print Recognition'
      ELSE 'Digital Recognition'
    END
  ) = 'Digital Recognition'
  AND
  (
    CASE
      WHEN (base.gl_publication_code = '101' OR base.gl_publication_code = '100' OR base.masthead_code = 'TA') THEN 'The Australian'
      WHEN (base.gl_publication_code = '401' OR base.gl_publication_code = '402' OR base.gl_publication_code = '36' OR base.masthead_code = 'CM') THEN 'Courier Mail'
      WHEN (base.gl_publication_code = '110' OR base.gl_publication_code = '111' OR base.gl_publication_code = '32' OR base.masthead_code = 'DT') THEN 'Daily Telegraph'
      WHEN (base.gl_publication_code = '301' OR base.gl_publication_code = '303' OR base.gl_publication_code = '63' OR base.masthead_code = 'HS') THEN 'Herald Sun'
      WHEN (base.gl_publication_code = '500' OR base.gl_publication_code = '501' OR base.gl_publication_code = '560' OR base.masthead_code = 'AA') THEN 'The Advertiser'
      WHEN (base.gl_publication_code = '450' OR base.gl_publication_code = '460' OR base.masthead_code = 'CP') THEN 'Cairns Post'
      WHEN (base.gl_publication_code = '350' OR base.gl_publication_code = '351' OR base.masthead_code = 'GA') THEN 'Geelong'
      WHEN (base.gl_publication_code = '670' OR base.gl_publication_code = '685' OR base.masthead_code = 'GC') THEN 'Gold Coast'
      WHEN (base.gl_publication_code = '961' OR base.gl_publication_code = '963' OR base.gl_publication_code = '962' OR base.masthead_code = 'NT') THEN 'NT News'
      WHEN (base.gl_publication_code = '850' OR base.gl_publication_code = '851' OR base.gl_publication_code = '852' OR base.masthead_code = 'TM') THEN 'The Mercury'
      WHEN (base.gl_publication_code = '5053' OR base.gl_publication_code = '5253' OR base.masthead_code = 'TC') THEN 'Toowoomba'
      WHEN (base.gl_publication_code = '475' OR base.gl_publication_code = '490' OR base.masthead_code = 'TB') THEN 'Townsville'
      WHEN (base.gl_publication_code = '305' OR base.gl_publication_code = '307' OR base.masthead_code = 'WT') THEN 'Weekly Times'
      WHEN (base.gl_publication_code = '9001' OR base.masthead_code = 'CS') THEN 'Code'
      WHEN (base.gl_publication_code = '8821' OR base.gl_publication_code = 'Punters.com.au' OR base.masthead_code = 'PU') THEN 'Punters'
      WHEN (base.gl_publication_code = '8822' OR base.gl_publication_code = 'Racenet' OR base.masthead_code = 'RN') THEN 'Racenet'
      WHEN (base.gl_publication_code = '9653' OR base.masthead_code = 'SC') THEN 'Supercoach Plus'
      WHEN (base.gl_publication_code = '9600' OR base.masthead_code = 'TS') THEN 'Taste Online'
      WHEN (base.gl_publication_code = '9003' OR base.gl_publication_code = '9003' OR base.masthead_code = 'AP') THEN 'Apple Podcast: Crime X'
      WHEN (base.gl_publication_code = '103' OR base.masthead_code = 'The Oz') THEN 'The Oz'
      WHEN (base.gl_publication_code = '9000' OR base.gl_publication_code = '9000' OR base.masthead_code = 'NW') THEN 'news.com.au'
      WHEN (base.gl_publication_code = '121') THEN 'Others'
      WHEN (base.gl_publication_code = '9002' OR base.masthead_code = 'BG') THEN 'Brain Games'
      WHEN (base.gl_publication_code = '9504' OR base.gl_publication_code = '9514' OR base.gl_publication_code = '9556' OR base.gl_publication_code = '9558' OR base.gl_publication_code = '9560' OR base.gl_publication_code = '9603' OR base.gl_publication_code = '9623') THEN 'Others'
      WHEN (base.gl_publication_code = '9644') THEN 'Suddenly'
      WHEN (base.gl_publication_code = '9903') THEN 'News Corporate'
      WHEN (base.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
      ELSE NULL
    END
  ) != 'Discontinued'",measure,True,high,12,449b9707-f939-42e1-b6f5-11998369f473
forecast_budget_earned_amount_current_fy_wk42_digital_recognition,forecast_budget_earned_amount,"Forecast Budget Earned Amount (Current FY Week 42, Digital Recognition)","The sum of forecast budget earned amount for the current fiscal year (2025), week 42, specifically for 'Digital Recognition' subscriptions and excluding 'Discontinued' mastheads.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT
  SUM(
    CASE
      WHEN (base.fy_year = 2025 AND base.fy_week_of_year = 42)
      THEN base.ForecastBudgetEarnedAmount
      ELSE NULL
    END
  ) AS forecast_budget_earned_amount_current_fy_wk42_digital_recognition
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS base
WHERE
  (
    CASE
      WHEN (base.delivery_medium_type = 'Print') THEN 'Print Recognition'
      WHEN (
        CASE
          WHEN (base.subscriber_has_email_flag = 'subsnapfact') THEN 'Y'
          WHEN (base.classification_level_1_description = 'Standard Paid' AND base.delivery_medium_type = 'Bundle') THEN base.subscriber_has_email_flag
          ELSE 'Y'
        END
      ) = 'N' THEN 'Print Recognition'
      ELSE 'Digital Recognition'
    END
  ) = 'Digital Recognition'
  AND
  (
    CASE
      WHEN (base.gl_publication_code = '101' OR base.gl_publication_code = '100' OR base.masthead_code = 'TA') THEN 'The Australian'
      WHEN (base.gl_publication_code = '401' OR base.gl_publication_code = '402' OR base.gl_publication_code = '36' OR base.masthead_code = 'CM') THEN 'Courier Mail'
      WHEN (base.gl_publication_code = '110' OR base.gl_publication_code = '111' OR base.gl_publication_code = '32' OR base.masthead_code = 'DT') THEN 'Daily Telegraph'
      WHEN (base.gl_publication_code = '301' OR base.gl_publication_code = '303' OR base.gl_publication_code = '63' OR base.masthead_code = 'HS') THEN 'Herald Sun'
      WHEN (base.gl_publication_code = '500' OR base.gl_publication_code = '501' OR base.gl_publication_code = '560' OR base.masthead_code = 'AA') THEN 'The Advertiser'
      WHEN (base.gl_publication_code = '450' OR base.gl_publication_code = '460' OR base.masthead_code = 'CP') THEN 'Cairns Post'
      WHEN (base.gl_publication_code = '350' OR base.gl_publication_code = '351' OR base.masthead_code = 'GA') THEN 'Geelong'
      WHEN (base.gl_publication_code = '670' OR base.gl_publication_code = '685' OR base.masthead_code = 'GC') THEN 'Gold Coast'
      WHEN (base.gl_publication_code = '961' OR base.gl_publication_code = '963' OR base.gl_publication_code = '962' OR base.masthead_code = 'NT') THEN 'NT News'
      WHEN (base.gl_publication_code = '850' OR base.gl_publication_code = '851' OR base.gl_publication_code = '852' OR base.masthead_code = 'TM') THEN 'The Mercury'
      WHEN (base.gl_publication_code = '5053' OR base.gl_publication_code = '5253' OR base.masthead_code = 'TC') THEN 'Toowoomba'
      WHEN (base.gl_publication_code = '475' OR base.gl_publication_code = '490' OR base.masthead_code = 'TB') THEN 'Townsville'
      WHEN (base.gl_publication_code = '305' OR base.gl_publication_code = '307' OR base.masthead_code = 'WT') THEN 'Weekly Times'
      WHEN (base.gl_publication_code = '9001' OR base.masthead_code = 'CS') THEN 'Code'
      WHEN (base.gl_publication_code = '8821' OR base.gl_publication_code = 'Punters.com.au' OR base.masthead_code = 'PU') THEN 'Punters'
      WHEN (base.gl_publication_code = '8822' OR base.gl_publication_code = 'Racenet' OR base.masthead_code = 'RN') THEN 'Racenet'
      WHEN (base.gl_publication_code = '9653' OR base.masthead_code = 'SC') THEN 'Supercoach Plus'
      WHEN (base.gl_publication_code = '9600' OR base.masthead_code = 'TS') THEN 'Taste Online'
      WHEN (base.gl_publication_code = '9003' OR base.gl_publication_code = '9003' OR base.masthead_code = 'AP') THEN 'Apple Podcast: Crime X'
      WHEN (base.gl_publication_code = '103' OR base.masthead_code = 'The Oz') THEN 'The Oz'
      WHEN (base.gl_publication_code = '9000' OR base.gl_publication_code = '9000' OR base.masthead_code = 'NW') THEN 'news.com.au'
      WHEN (base.gl_publication_code = '121') THEN 'Others'
      WHEN (base.gl_publication_code = '9002' OR base.masthead_code = 'BG') THEN 'Brain Games'
      WHEN (base.gl_publication_code = '9504' OR base.gl_publication_code = '9514' OR base.gl_publication_code = '9556' OR base.gl_publication_code = '9558' OR base.gl_publication_code = '9560' OR base.gl_publication_code = '9603' OR base.gl_publication_code = '9623') THEN 'Others'
      WHEN (base.gl_publication_code = '9644') THEN 'Suddenly'
      WHEN (base.gl_publication_code = '9903') THEN 'News Corporate'
      WHEN (base.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
      ELSE NULL
    END
  ) != 'Discontinued'",measure,True,high,12,449b9707-f939-42e1-b6f5-11998369f473
no_time_volume_sc,no_time_volume,No Time Volume (SuperCoach Plus),Sum of No Time Volume for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(No_Time_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
failed_payment_volume_sc,failed_payment_volume,Failed Payment Volume (SuperCoach Plus),Sum of Failed Payment Volume for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
price_volume_sc,price_volume,Price Volume (SuperCoach Plus),Sum of Price Volume for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Price_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,medium,13,61cc5171-703d-44b5-acd7-e9db7cf81778
total_cancels_sc,total_cancels,Total Cancels (SuperCoach Plus),Sum of Total Cancels for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
revenue_3rd_party_gpla_sc,revenue_3rd_party_gpla,Revenue 3rd Party GPLA (SuperCoach Plus),Sum of 3rd Party GPLA Revenue for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Revenue_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
total_revenue_sc,total_revenue,Total Revenue (SuperCoach Plus),Sum of Total Revenue for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Revenue) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
closing_base_3rd_party_sc,closing_base_3rd_party,Closing Base 3rd Party (SuperCoach Plus),Sum of Closing Base 3rd Party for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Closing_Base_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
closing_base_3rd_party_apls_sc,closing_base_3rd_party_apls,Closing Base 3rd Party APLS (SuperCoach Plus),Sum of Closing Base 3rd Party APLS for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Closing_Base_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
closing_base_3rd_party_gpla_sc,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA (SuperCoach Plus),Sum of Closing Base 3rd Party GPLA for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Closing_Base_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
total_closing_base_sc,total_closing_base,Total Closing Base (SuperCoach Plus),Sum of Total Closing Base for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Closing_Base) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_incl_3rd_party_sc,net_growth_incl_3rd_party,Net Growth incl 3rd Party (SuperCoach Plus),Sum of Net Growth including 3rd Party for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_incl_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_3rd_party_sc,net_growth_3rd_party,Net Growth 3rd Party (SuperCoach Plus),Sum of Net Growth 3rd Party for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_3rd_party_apls_sc,net_growth_3rd_party_apls,Net Growth 3rd Party APLS (SuperCoach Plus),Sum of Net Growth 3rd Party APLS for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
net_growth_3rd_party_gpla_sc,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA (SuperCoach Plus),Sum of Net Growth 3rd Party GPLA for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Growth_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
breach_sales_sc,breach_sales,Breach Sales (SuperCoach Plus),Sum of Breach Sales for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Breach_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,medium,13,61cc5171-703d-44b5-acd7-e9db7cf81778
always_on_digital_sales_sc,always_on_digital_sales,Always On Digital Sales (SuperCoach Plus),Sum of Always On Digital Sales for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Always_on_Digital_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,medium,13,61cc5171-703d-44b5-acd7-e9db7cf81778
general_offer_sales_sc,general_offer_sales,General Offer Sales (SuperCoach Plus),Sum of General Offer Sales for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(General_Offer_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,medium,13,61cc5171-703d-44b5-acd7-e9db7cf81778
other_sales_sc,other_sales,Other Sales (SuperCoach Plus),Sum of Other Sales for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Other_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,medium,13,61cc5171-703d-44b5-acd7-e9db7cf81778
acquisition_3rd_party_sc,acquisition_3rd_party,Acquisition 3rd Party (SuperCoach Plus),Sum of 3rd Party Acquisitions for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Acquisition_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
acquisition_3rd_party_apls_sc,acquisition_3rd_party_apls,Acquisition 3rd Party APLS (SuperCoach Plus),Sum of 3rd Party APLS Acquisitions for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Acquisition_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
acquisition_3rd_party_gpla_sc,acquisition_3rd_party_gpla,Acquisition 3rd Party GPLA (SuperCoach Plus),Sum of 3rd Party GPLA Acquisitions for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Acquisition_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
total_weekly_sales_sc,total_weekly_sales,Total Weekly Sales (SuperCoach Plus),Sum of Total Weekly Sales for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Total_Weekly_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
switches_sc,switches,Switches (SuperCoach Plus),Sum of Switches for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Switches) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,False,medium,13,61cc5171-703d-44b5-acd7-e9db7cf81778
net_cancels_sc,net_cancels,Net Cancels (SuperCoach Plus),Sum of Net Cancels for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Net_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
revenue_3rd_party_sc,revenue_3rd_party,Revenue 3rd Party (SuperCoach Plus),Sum of 3rd Party Revenue for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Revenue_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
revenue_3rd_party_apls_sc,revenue_3rd_party_apls,Revenue 3rd Party APLS (SuperCoach Plus),Sum of 3rd Party APLS Revenue for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT SUM(Revenue_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',measure,True,high,13,61cc5171-703d-44b5-acd7-e9db7cf81778
count_fy_year_rows_sc,count_fy_year_rows,Count of FY Year Rows (SuperCoach Plus),Count of rows grouped by FY Year for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT COUNT(fy_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',aggregation,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
count_fy_week_rows_sc,count_fy_week_rows,Count of FY Week Rows (SuperCoach Plus),Count of rows grouped by FY Week for SuperCoach Plus masthead.,ncau-data-newsquery-prd,asl_finance_derived,consumer_deepniche_scorecard,SELECT COUNT(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard` WHERE masthead = 'SC',aggregation,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
fy_week_of_year_calendar,fy_week_of_year,FY Week of Year,Fiscal Week of Year from the calendar dimension.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1,dimension,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
fy_year_calendar,fy_year,FY Year,Fiscal Year from the calendar dimension.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1,dimension,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
iso_week_start_date,iso_week_start_date,ISO Week Start Date,The start date of the ISO week for a given calendar date.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(t0c0d2.calendar_date AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1",dimension,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
calendar_calculated_field_1,calendar_calculated_field,Calendar Calculated Field 1 (Constant),"A complex calculated field derived from fixed calendar dates and differences, likely representing a constant parameter like a week offset.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1",calculated_field,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
calendar_calculated_field_2,calendar_calculated_field,Calendar Calculated Field 2 (Weekly/Date Range Flag),"A boolean flag indicating if the current week/year matches a specific 'Weekly' or 'Date Range' condition, based on calendar dimensions and fixed date parameters.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN ('Weekly' = 'Weekly') THEN ((t0c0d2.fy_week_of_year = (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END)) AND (t0c0d2.fy_year = 2025)) WHEN ('Weekly' = 'Date Range') THEN ((t0c0d2.fy_week_of_year >= (CASE WHEN (0 = 0) THEN 1 ELSE 0 END)) AND (t0c0d2.fy_week_of_year <= (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END)) AND (t0c0d2.fy_year >= (2025-1)) AND (t0c0d2.fy_year <= (2025-1))) ELSE NULL END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1",calculated_field,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
calendar_calculated_field_3,calendar_calculated_field,Calendar Calculated Field 3 (Complex Date Logic),"A highly complex boolean flag involving multiple nested conditions, fixed dates, and calendar dimensions, likely used for advanced date filtering or comparison logic within the dashboard.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN ((CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END) <= 5) THEN (CASE WHEN (((t0c0d2.fy_year = (2025-1)) AND (0 = 3)) OR ((t0c0d2.fy_year = 2025) AND (0 = 1)) OR ((t0c0d2.fy_year = 2025) AND (0 = 4)) OR ((t0c0d2.fy_year = 2025) AND (0 = 5)) OR ((t0c0d2.fy_year = 2025) AND (0 = 2))) THEN 'TRUE' ELSE NULL END) ELSE (CASE WHEN ((t0c0d2.fy_year = 2025) AND (t0c0d2.fy_week_of_year <= (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END)) AND (t0c0d2.fy_week_of_year >= ((CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END) - 5))) THEN 'TRUE' ELSE NULL END) END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1",calculated_field,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
calendar_calculated_field_4,calendar_calculated_field,Calendar Calculated Field 4 (Weekly/Date Range Flag),"A boolean flag indicating if the current week/year matches a specific 'Weekly' or 'Date Range' condition, based on calendar dimensions and fixed date parameters.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN ('Weekly' = 'Weekly') THEN ((t0c0d2.fy_week_of_year = (CASE WHEN (0 = 0) THEN 1 ELSE 0 END)) AND (t0c0d2.fy_year = (2025-1))) WHEN ('Weekly' = 'Date Range') THEN ((t0c0d2.fy_week_of_year >= (CASE WHEN (0 = 0) THEN 1 ELSE 0 END)) AND (t0c0d2.fy_week_of_year <= (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END)) AND (t0c0d2.fy_year >= (2025-1)) AND (t0c0d2.fy_year <= (2025-1))) ELSE NULL END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1",calculated_field,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
calendar_calculated_field_5,calendar_calculated_field,Calendar Calculated Field 5 (Complex Date Logic),"A highly complex boolean flag involving multiple nested conditions, fixed dates, and calendar dimensions, likely used for advanced date filtering or comparison logic within the dashboard.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN ('Weekly' = 'Weekly') THEN ((CASE WHEN ((CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END) <= 5) THEN (CASE WHEN (((t0c0d2.fy_year = (2025-1)) AND (0 = 3)) OR ((t0c0d2.fy_year = 2025) AND (0 = 1)) OR ((t0c0d2.fy_year = 2025) AND (0 = 4)) OR ((t0c0d2.fy_year = 2025) AND (0 = 5)) OR ((t0c0d2.fy_year = 2025) AND (0 = 2))) THEN 'TRUE' ELSE NULL END) ELSE (CASE WHEN ((t0c0d2.fy_year = 2025) AND (t0c0d2.fy_week_of_year <= (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END)) AND (t0c0d2.fy_week_of_year >= ((CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END) - 5))) THEN 'TRUE' ELSE NULL END)) = 'TRUE') WHEN ('Weekly' = 'Date Range') THEN ((t0c0d2.fy_week_of_year >= (CASE WHEN (0 = 0) THEN 1 ELSE 0 END)) AND (t0c0d2.fy_week_of_year <= (CASE WHEN (0 = 0) THEN (CASE WHEN ((EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney'))) - 1) <= 2) THEN (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)-1) ELSE DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-07-08 05:29:00.926550+00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) ELSE 0 END)) AND (t0c0d2.fy_year >= (2025-1)) AND (t0c0d2.fy_year <= (2025-1))) ELSE NULL END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 LIMIT 1",calculated_field,False,low,13,61cc5171-703d-44b5-acd7-e9db7cf81778
budget_earned_amount_2025_week_38,budget_earned_amount,"Budget Earned Amount (FY25, Week 38)","The budgeted earned amount for fiscal year 2025, week 38, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 38)
            THEN t0.BudgetEarnedAmount
            ELSE 0
        END
    ) AS budget_earned_amount_2025_week_38
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
closing_base_2025_week_38,closing_base,"Closing Base (FY25, Week 38)","The closing base value for fiscal year 2025, week 38, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 38)
            THEN t0.ClosingBase
            ELSE 0
        END
    ) AS closing_base_2025_week_38
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
opening_base_2025_week_38,opening_base,"Opening Base (FY25, Week 38)","The opening base value for fiscal year 2025, week 38, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 38)
            THEN t0.OpeningBase
            ELSE 0
        END
    ) AS opening_base_2025_week_38
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
earned_amount_2025_week_38,earned_amount,"Earned Amount (FY25, Week 38)","The actual earned amount for fiscal year 2025, week 38, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 38)
            THEN t0.EarnedAmount
            ELSE 0
        END
    ) AS earned_amount_2025_week_38
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
net_change_base_2024_week_38,net_change_in_base,"Net Change in Base (FY24, Week 38)","The net change in base (ClosingBase - OpeningBase) for fiscal year 2024, week 38, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2024 AND t0.fy_week_of_year = 38)
            THEN (t0.ClosingBase - t0.OpeningBase)
            ELSE 0
        END
    ) AS net_change_base_2024_week_38
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,False,medium,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
closing_base_2025_week_36,closing_base,"Closing Base (FY25, Week 36)","The closing base value for fiscal year 2025, week 36, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36)
            THEN t0.ClosingBase
            ELSE 0
        END
    ) AS closing_base_2025_week_36
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
opening_base_2025_week_36,opening_base,"Opening Base (FY25, Week 36)","The opening base value for fiscal year 2025, week 36, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36)
            THEN t0.OpeningBase
            ELSE 0
        END
    ) AS opening_base_2025_week_36
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
earned_amount_2025_week_36,earned_amount,"Earned Amount (FY25, Week 36)","The actual earned amount for fiscal year 2025, week 36, for digital subscriptions not discontinued and with digital recognition.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    SUM(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36)
            THEN t0.EarnedAmount
            ELSE 0
        END
    ) AS earned_amount_2025_week_36
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",measure,True,high,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
data_present_2025_week_36,data_presence_flag,"Data Present (FY25, Week 36)","A flag indicating if data exists for fiscal year 2025, week 36, for digital subscriptions not discontinued and with digital recognition. Returns 1 if present, 0 otherwise.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    MAX(
        CASE
            WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 36)
            THEN 1
            ELSE 0
        END
    ) AS data_present_2025_week_36
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.masthead_group != 'Discontinued'
    AND t0.finance_recognition = 'Digital Recognition'",calculated_field,False,low,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
cancellation_type_dimension,dashboard_control_field,Cancellation Type Selector,"A dashboard control field allowing selection of cancellation types, currently hardcoded to 'Gross Cancellations' in the provided query.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    CASE WHEN (1 = 1) THEN 'Gross Cancellations' WHEN (1 = 2) THEN 'Net Cancellations' ELSE NULL END AS cancellation_type_selector
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0",dimension,False,low,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
budget_forecast_type_dimension,dashboard_control_field,Budget/Forecast Type Selector,"A dashboard control field allowing selection of budget/forecast types, currently hardcoded to 'BUD' in the provided query.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    CASE WHEN (1 = 1) THEN 'BUD' WHEN (1 = 2) THEN 'FCT' WHEN (1 = 3) THEN 'YOY' WHEN (1 = 4) THEN 'BUD NY' ELSE NULL END AS budget_forecast_type_selector
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0",dimension,False,low,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
date_view_type_dimension,dashboard_control_field,Date View Type Selector,"A dashboard control field allowing selection of date aggregation and view types (e.g., Week to Date, Month to Date, Budget View, Forecast View), currently hardcoded to 'Week to Date & Budget View' in the provided query.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT
    CASE
        WHEN (TRUE AND TRUE) THEN 'Week to Date & Budget View'
        WHEN (TRUE AND FALSE) THEN 'Week to Date & Forecast View'
        WHEN (TRUE AND FALSE) THEN 'Week to Date & Year on Year View'
        WHEN (TRUE AND FALSE) THEN 'Week to Date & NY Budget View'
        WHEN (FALSE AND TRUE) THEN 'Month to Date & Budget View'
        WHEN (FALSE AND FALSE) THEN 'Month to Date & Forecast View'
        WHEN (FALSE AND FALSE) THEN 'Week to Date & Year on Year View'
        WHEN (FALSE AND FALSE) THEN 'Month to Date & NY Budget View'
        WHEN (FALSE AND TRUE) THEN 'Quarter to Date & Budget View'
        WHEN (FALSE AND FALSE) THEN 'Quarter to Date & Forecast View'
        WHEN (FALSE AND FALSE) THEN 'Quarter to Date & Year on Year View'
        WHEN (FALSE AND FALSE) THEN 'Quarter to Date & NY Budget View'
        WHEN (FALSE AND TRUE) THEN 'Year to Date & Budget View'
        WHEN (FALSE AND FALSE) THEN 'Year to Date & Forecast View'
        WHEN (FALSE AND FALSE) THEN 'Year to Date & Year on Year View'
        WHEN (FALSE AND FALSE) THEN 'Year to Date & NY Budget View'
        ELSE NULL
    END AS date_view_type_selector
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0",dimension,False,low,14,bb49fa78-5abe-4e68-a9c1-8172a832e724
dim_fy_week_of_year,fiscal_week_of_year,Fiscal Week of Year,"The numerical representation of the fiscal week within its respective fiscal year, used for time-based filtering and grouping.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1,dimension,False,medium,15,a1c16d3b-d19a-4abd-b96c-7a87580815db
dim_fy_week_of_year_name,fiscal_week_of_year_name,Fiscal Week Name,"The descriptive name of the fiscal week within its respective fiscal year (e.g., 'Week 1', 'Week 2'), used for display purposes.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_week_of_year_name FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1,dimension,False,medium,15,a1c16d3b-d19a-4abd-b96c-7a87580815db
dim_fy_year,fiscal_year,Fiscal Year,"The fiscal year associated with a given calendar date, used for high-level time-based analysis.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1,dimension,False,medium,15,a1c16d3b-d19a-4abd-b96c-7a87580815db
calc_iso_week_start_date,iso_week_start_date,ISO Week Start Date,"The start date of the ISO week derived from the calendar date, typically a Monday. Used for weekly aggregation and filtering.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(calendar_date AS DATETIME), ISOWEEK) AS DATE) AS iso_week_start_date FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1",calculated_field,False,medium,15,a1c16d3b-d19a-4abd-b96c-7a87580815db
total_gross_revenue,gross_revenue,Total Gross Revenue,The sum of all gross revenue amounts.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(t0.gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,False,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
current_year_gross_revenue,gross_revenue,Current Year Gross Revenue,The sum of gross revenue amounts for the current fiscal year (relative_fy_year_offset = 0).,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
previous_year_gross_revenue,gross_revenue,Previous Year Gross Revenue,The sum of gross revenue amounts for the previous fiscal year (relative_fy_year_offset = -1).,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
next_year_gross_revenue,gross_revenue,Next Year Gross Revenue,The sum of gross revenue amounts for the next fiscal year (relative_fy_year_offset = 1).,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,False,medium,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
previous_year_gross_revenue_stly,gross_revenue,Previous Year Gross Revenue STLY,The sum of gross revenue amounts for the previous fiscal year where the 'stly_flag' is 'Y'.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN (t0.relative_fy_year_offset = -1 AND t0.stly_flag = 'Y') THEN t0.gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
current_year_gross_revenue_month_filtered,gross_revenue,Current Year Gross Revenue (Month Filtered),"The sum of gross revenue amounts for the current fiscal year, filtered for relative_fy_month_offset > -1.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN (t0.relative_fy_month_offset > -1 AND t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,False,medium,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
total_pub_lgb,pub_lgb,Total Pub LGB,The sum of all pub_lgb amounts.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(t0.pub_lgb) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,measure,False,medium,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
current_year_pub_lgb,pub_lgb,Current Year Pub LGB,The sum of pub_lgb amounts for the current fiscal year (relative_fy_year_offset = 0).,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.pub_lgb ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
pub_lgb_month_filtered,pub_lgb,Pub LGB (Month Filtered),The sum of pub_lgb amounts filtered for relative_fy_month_offset > -1.,ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT SUM(CASE WHEN t0.relative_fy_month_offset > -1 THEN t0.pub_lgb ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0,calculated_field,False,low,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
financial_year_dimension,financial_year,Financial Year,"The financial year, used as a dimension or filter, specifically where relative_fy_month_offset is 0.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,SELECT DISTINCT t0.financial_year FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE t0.relative_fy_month_offset = 0 ORDER BY t0.financial_year DESC,dimension,False,low,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
total_gross_revenue_k,gross_revenue,Total Gross Revenue (k),"The sum of all gross revenue amounts, divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(t0.gross_revenue_amount, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,False,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
current_year_gross_revenue_k,gross_revenue,Current Year Gross Revenue (k),"The sum of gross revenue amounts for the current fiscal year (relative_fy_year_offset = 0), divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
previous_year_gross_revenue_k,gross_revenue,Previous Year Gross Revenue (k),"The sum of gross revenue amounts for the previous fiscal year (relative_fy_year_offset = -1), divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
next_year_gross_revenue_k,gross_revenue,Next Year Gross Revenue (k),"The sum of gross revenue amounts for the next fiscal year (relative_fy_year_offset = 1), divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,False,medium,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
previous_year_gross_revenue_stly_k,gross_revenue,Previous Year Gross Revenue STLY (k),"The sum of gross revenue amounts for the previous fiscal year where the 'stly_flag' is 'Y', divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = -1 AND t0.stly_flag = 'Y') THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
current_year_gross_revenue_month_filtered_k,gross_revenue,"Current Year Gross Revenue (Month Filtered, k)","The sum of gross revenue amounts for the current fiscal year, filtered for relative_fy_month_offset > -1, divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_month_offset > -1 AND t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,False,medium,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
total_pub_lgb_k,pub_lgb,Total Pub LGB (k),"The sum of all pub_lgb amounts, divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(t0.pub_lgb, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,False,medium,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
current_year_pub_lgb_k,pub_lgb,Current Year Pub LGB (k),"The sum of pub_lgb amounts for the current fiscal year (relative_fy_year_offset = 0), divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.pub_lgb ELSE 0 END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,True,high,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
pub_lgb_month_filtered_k,pub_lgb,"Pub LGB (Month Filtered, k)","The sum of pub_lgb amounts filtered for relative_fy_month_offset > -1, divided by 1000.",ncau-data-newsquery-prd,asl_finance_derived,adsales_performance,"SELECT SUM(SAFE_DIVIDE(CASE WHEN t0.relative_fy_month_offset > -1 THEN t0.pub_lgb ELSE NULL END, 1000)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0",ratio,False,low,16,0aff66b8-3b9d-4830-96ec-abef5f7eb7ef
total_records_os_circulation_202548,total_records_os_data_load,"Total Records Count (OS Data Load - Circulation, FW 202548)","The total number of records loaded from the 'Circulation' source system for fiscal week '202548' on a specific load date (2025-06-04), as captured by the OS data load check.",ncau-data-newsquery-prd,finance_monthend_checks,v_os_data_load_check,"SELECT SUM(t0.records_count) FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_os_data_load_check` AS t0 WHERE t0.dw_prstn_load_datetime >= DATE '2025-06-04' AND t0.dw_prstn_load_datetime < DATETIME_ADD(DATE '2025-06-04', INTERVAL 1 DAY) AND t0.fiscal_week_id IN ('202548') AND t0.source_system_name IN ('Circulation')",measure,True,high,17,2dfb1b58-42eb-44cb-b550-66469ae7df3c
total_rows_jde_20250429,total_rows_jde_data_load,Total Rows (JDE Data Load - 2025-04-29),"The total number of rows loaded into the JDE system on a specific partition date (2025-04-29), as captured by the JDE data load check.",ncau-data-newsquery-prd,finance_monthend_checks,v_jde_data_load_check,"SELECT SUM(t0.total_rows) FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_jde_data_load_check` AS t0 WHERE PARSE_DATE('%Y%m%d', SAFE_CAST(t0.partition_id AS STRING)) >= DATE '2025-04-29' AND PARSE_DATE('%Y%m%d', SAFE_CAST(t0.partition_id AS STRING)) <= DATE '2025-04-29'",measure,True,high,17,2dfb1b58-42eb-44cb-b550-66469ae7df3c
distinct_scenarios_os_20250429,distinct_scenarios_os_data_load,Distinct Scenarios Count (OS Data Load - 2025-04-29),"The count of unique scenarios observed in the OS data load on a specific load date (2025-04-29), indicating the variety of data types or processes involved.",ncau-data-newsquery-prd,finance_monthend_checks,v_os_data_load_check,"SELECT COUNT(DISTINCT t0.scenario) FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_os_data_load_check` AS t0 WHERE t0.dw_prstn_load_datetime >= DATE '2025-04-29' AND t0.dw_prstn_load_datetime < DATETIME_ADD(DATE '2025-04-29', INTERVAL 1 DAY)",measure,True,high,17,2dfb1b58-42eb-44cb-b550-66469ae7df3c
total_tables_monitored,total_tables,Total Tables Monitored,The total count of finance data tables being monitored by the health app.,your-gcp-project-id,bdm_finance,__TABLES__,"SELECT
  COUNT(t0.table_id) AS total_tables_monitored
FROM (
  WITH
    table_list AS (
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'external_sundry_expenses_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_budget_forecast_fct' AS tableid UNION ALL
      SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_balance_fct' AS tableid UNION ALL
      SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_transaction_fct' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_account_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_business_unit_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_company_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_department_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_ledger_type_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_party_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_publication_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_responsibility_unit_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_type_dim' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_snapshot_fct' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_snapshot_fct' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'offplatform_subscription_revenue_fct' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_snapshot_fct' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'content_licensing_snapshot_fct' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'expense_depreciation_snapshot_fct' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'finance_gaap_adjustment' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'sundry_revenue_snapshot_fct' AS tableid
    ),
    table_update_list AS (
      SELECT
        dataset_id,
        table_id,
        datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
        row_count,
        size_bytes / power(2, 30) AS size_gb,
        table_list.update_frequency
      FROM
        `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
        JOIN
        table_list
        ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
    ),
    load_stats AS (
      SELECT
        dataset_id,
        table_id,
        last_update_time,
        row_count,
        size_gb,
        update_frequency,
        `current_datetime`(""Australia/Sydney"") AS time_now,
        datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
        `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency, 'Y', 'N') AS delayed
      FROM
        table_update_list
    ),
    alert_sts AS (
      SELECT
        *,
        CASE
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) > update_frequency THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND (updated_minutes_ago - update_frequency) > 30 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND (updated_minutes_ago - update_frequency) > 1440 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <= update_frequency THEN -1
          WHEN row_count = 0 THEN -3
          ELSE 0
        END AS alert_status
      FROM
        load_stats
    )
  SELECT
    table_id,
    CASE
      WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"", ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
      ELSE alert_status
    END AS alert_status_final
  FROM
    alert_sts
) AS t0
LIMIT 1",aggregation,True,high,18,8f848270-688f-4455-82a6-3bc9a7d39cce
tables_ok_or_excluded,tables_status_ok_or_excluded,Tables OK or Excluded from Critical Alerts,"The count of finance data tables that are either up-to-date (OK) or are manually excluded from critical delay alerts (e.g., budget/forecast tables).",your-gcp-project-id,bdm_finance,__TABLES__,"SELECT
  COUNT(CASE WHEN t0.alert_status_final IN (0, -1) THEN t0.table_id ELSE NULL END) AS tables_ok_or_excluded
FROM (
  WITH
    table_list AS (
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'external_sundry_expenses_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_budget_forecast_fct' AS tableid UNION ALL
      SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_budget_forecast_fct' AS tableid UNION ALL
      SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_balance_fct' AS tableid UNION ALL
      SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_transaction_fct' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_account_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_business_unit_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_company_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_department_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_ledger_type_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_party_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_publication_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_responsibility_unit_profisee_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_dim' AS tableid UNION ALL
      SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_type_dim' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_snapshot_fct' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_snapshot_fct' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'offplatform_subscription_revenue_fct' AS tableid UNION ALL
      SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_snapshot_fct' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'content_licensing_snapshot_fct' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'expense_depreciation_snapshot_fct' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'finance_gaap_adjustment' AS tableid UNION ALL
      SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'sundry_revenue_snapshot_fct' AS tableid
    ),
    table_update_list AS (
      SELECT
        dataset_id,
        table_id,
        datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
        row_count,
        size_bytes / power(2, 30) AS size_gb,
        table_list.update_frequency
      FROM
        `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
        JOIN
        table_list
        ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
    ),
    load_stats AS (
      SELECT
        dataset_id,
        table_id,
        last_update_time,
        row_count,
        size_gb,
        update_frequency,
        `current_datetime`(""Australia/Sydney"") AS time_now,
        datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
        `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency, 'Y', 'N') AS delayed
      FROM
        table_update_list
    ),
    alert_sts AS (
      SELECT
        *,
        CASE
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) > update_frequency THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND (updated_minutes_ago - update_frequency) > 30 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND (updated_minutes_ago - update_frequency) > 1440 THEN -2
          WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <= update_frequency THEN -1
          WHEN row_count = 0 THEN -3
          ELSE 0
        END AS alert_status
      FROM
        load_stats
    )
  SELECT
    table_id,
    CASE
      WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"", ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
      ELSE alert_status
    END AS alert_status_final
  FROM
    alert_sts
) AS t0
LIMIT 1",aggregation,True,high,18,8f848270-688f-4455-82a6-3bc9a7d39cce
total_agency_commission_digital_billed_booked_adpt_std,total_agency_commission,"Total Agency Commission (Digital, Billed/Booked, Adpoint, Standard)","The sum of agency commission amounts for digital revenue transactions that are either 'Billed' or 'Booked', originating from the 'Adpoint' system with a 'Standard' record type, starting from 2022-01-01.",asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT SUM(agency_commission_amount) FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",measure,True,high,19,5515c1c6-18fe-449d-b621-d47631023320
total_revenue_gross_plus_adjustment_digital_billed_booked_adpt_std,total_revenue,"Total Revenue (Gross + Adjustment, Digital, Billed/Booked, Adpoint, Standard)","The sum of gross revenue (excluding adjustments) plus adjustment amounts for digital revenue transactions that are either 'Billed' or 'Booked', originating from the 'Adpoint' system with a 'Standard' record type, starting from 2022-01-01.",asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT SUM(gross_revenue_ex_adj_amount + adjustment_amount) FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",measure,True,high,19,5515c1c6-18fe-449d-b621-d47631023320
data_load_datetime_truncated_dimension,data_load_datetime,Data Load Datetime (Truncated to Second),"The timestamp indicating when the data record was loaded, truncated to the nearest second. Used for tracking data freshness or specific load instances.",asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT DATETIME_TRUNC(data_load_datetime, SECOND) FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,low,19,5515c1c6-18fe-449d-b621-d47631023320
calendar_year_dimension,calendar_year,Calendar Year,The calendar year associated with the revenue transaction.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT calendar_year FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
calendar_month_dimension,calendar_month,Calendar Month,The calendar month number (1-12) associated with the revenue transaction.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT calendar_month FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
financial_year_dimension,financial_year,Financial Year,The financial year associated with the revenue transaction.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT financial_year FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
financial_month_dimension,financial_month,Financial Month,The financial month number associated with the revenue transaction.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT financial_month FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
advertiser_name_dimension,advertiser_name,Advertiser Name,The name of the advertiser associated with the booking line.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT advertiser_name FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
agency_name_dimension,agency_name,Agency Name,The name of the agency associated with the booking line.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT agency_name FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
booking_line_number_dimension,booking_line_number,Booking Line Number,The unique identifier for a specific line item within a booking.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT booking_line_number FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
booking_number_dimension,booking_number,Booking Number,The unique identifier for the overall booking.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT booking_number FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
publication_name_dimension,publication_name,Publication Name,The name of the publication where the advertisement was placed.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT publication_name FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
publishing_division_dimension,publishing_division,Publishing Division,The publishing division responsible for the advertisement.,asl_advertising,asl_advertising,v_adsales_revenue_client,"SELECT DISTINCT publishing_division FROM `asl_advertising.v_adsales_revenue_client` WHERE reporting_date >= '2022-01-01' AND record_type_code = 'STD' AND source_system_code = 'ADPT' AND revenue_transaction_status IN ('Billed', 'Booked') AND revenue_type = 'Digital'",dimension,False,medium,19,5515c1c6-18fe-449d-b621-d47631023320
current_week_budget_opening_base_fy2025,budget_opening_base,Current Week Budget Opening Base (FY2025),"The opening base value from the budget for the current fiscal week of FY2025, specifically for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN t0.BudgetOpeningBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_budget_earned_amount_fy2025,budget_earned_amount,Current Week Budget Earned Amount (FY2025),"The earned amount from the budget for the current fiscal week of FY2025, specifically for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN ((t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) AND (t0.fy_year = 2025)) THEN t0.BudgetEarnedAmount ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_ny_budget_opening_base_fy2025,ny_budget_opening_base,Current Week Next Year Budget Opening Base (FY2025),"The opening base value from the next year's budget for the current fiscal week of FY2025, specifically for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN t0.NYBudgetOpeningBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_ny_budget_closing_base_fy2025,ny_budget_closing_base,Current Week Next Year Budget Closing Base (FY2025),"The closing base value from the next year's budget for the current fiscal week of FY2025, specifically for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN t0.NYBudgetClosingBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_closing_base_fy2025_specific_sources,closing_base,"Current Week Closing Base (FY2025, Specific Sources)","The closing base value for the current fiscal week of FY2025, specifically from 'bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS' sources, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN (CASE WHEN (t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_flexible_earned_amount_fy2024,earned_amount,Current Week Flexible Earned Amount (FY2024),"The earned amount for the current fiscal week of FY2024, using NFEarnedAmount for FY<=2024 (nfmanualhist) or EarnedAmount for FY>2024 (subsnapfact), for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = t0.fy_week_of_year) AND (2024 = t0.fy_year)) THEN (CASE WHEN (t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount WHEN (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END) ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_budget_closing_base_fy2025,budget_closing_base,Current Week Budget Closing Base (FY2025),"The closing base value from the budget for the current fiscal week of FY2025, specifically for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN t0.BudgetClosingBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_ny_budget_earned_amount_fy2025,ny_budget_earned_amount,Current Week Next Year Budget Earned Amount (FY2025),"The earned amount from the next year's budget for the current fiscal week of FY2025, specifically for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = t0.fy_week_of_year) AND (t0.fy_year = 2025)) THEN t0.NYBudgetEarnedAmount ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_opening_base_fy2025_bmasnap_open,opening_base,"Current Week Opening Base (FY2025, 'bmasnap_open')","The opening base value for the current fiscal week of FY2025, specifically from 'bmasnap_open' source, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN (CASE WHEN (t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END) ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_closing_base_fy2025_conditional,closing_base,"Current Week Closing Base (FY2025, Conditional on Week)","The closing base for the current fiscal week of FY2025, using actual ClosingBase if week <= 22, else ForecastClosingBase, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AND t0.fy_week_of_year <= 22) THEN (CASE WHEN (t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AND t0.fy_week_of_year > 22) THEN t0.ForecastClosingBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_earned_amount_fy2025_conditional,earned_amount,"Current Week Earned Amount (FY2025, Conditional on Week)","The earned amount for the current fiscal week of FY2025, using Flexible Earned Amount if week <= 22, else ForecastBudgetEarnedAmount, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN ((DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = t0.fy_week_of_year) AND (t0.fy_year = 2025) AND t0.fy_week_of_year <= 22) THEN (CASE WHEN (t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount WHEN (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END) WHEN ((DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = t0.fy_week_of_year) AND (t0.fy_year = 2025) AND t0.fy_week_of_year > 22) THEN t0.ForecastBudgetEarnedAmount ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
last_week_opening_base_fy2025_bmasnap_open,opening_base,"Last Week Opening Base (FY2025, 'bmasnap_open')","The opening base value for the previous fiscal week of FY2025, specifically from 'bmasnap_open' source, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = (CASE WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 1) THEN 52 ELSE (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) END)) THEN (CASE WHEN (t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END) ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
last_week_closing_base_fy2025_specific_sources,closing_base,"Last Week Closing Base (FY2025, Specific Sources)","The closing base value for the previous fiscal week of FY2025, specifically from 'bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS' sources, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = (CASE WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 1) THEN 52 ELSE (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) END)) THEN (CASE WHEN (t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
last_week_flexible_earned_amount_fy2025,earned_amount,Last Week Flexible Earned Amount (FY2025),"The earned amount for the previous fiscal week of FY2025, using NFEarnedAmount for FY<=2024 (nfmanualhist) or EarnedAmount for FY>2024 (subsnapfact), for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = (CASE WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) = 1) THEN 52 ELSE (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) END)) THEN (CASE WHEN (t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount WHEN (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END) ELSE NULL END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_closing_base_fy2024_specific_sources,closing_base,"Current Week Closing Base (FY2024, Specific Sources)","The closing base value for the current fiscal week of FY2024, specifically from 'bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS' sources, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2024 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK)) THEN (CASE WHEN (t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,False,medium,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
current_week_opening_base_fy2025_conditional,opening_base,"Current Week Opening Base (FY2025, Conditional on Week)","The opening base for the current fiscal week of FY2025, using actual OpeningBase if week <= 22, else ForecastOpeningBase, for digital recognition and Metros masthead group.",ncau-data-newsquery-prd,sbx_fda_corefin,dt_digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AND t0.fy_week_of_year <= 22) THEN (CASE WHEN (t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END) WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = DATETIME_DIFF(SAFE_CAST(DATE('2025-03-14', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AND t0.fy_week_of_year > 22) THEN t0.ForecastOpeningBase ELSE 0 END) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0 WHERE (NOT (t0.delivery_medium_type = 'Print') AND (t0.subscriber_has_email_flag = 'Y' OR (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle')) AND (t0.masthead_group != 'Discontinued' AND t0.masthead_group = 'Metros'))",measure,True,high,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
fiscal_week_month_dimension,fiscal_time_dimension,Fiscal Week (Month),"A dimension representing the fiscal week and corresponding fiscal month, derived from a specific date parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT CONCAT('FY ','2025',' Week ',SAFE_CAST(DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AS STRING),' (',SAFE_CAST(CASE WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 4) THEN 'July' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 9) THEN 'August' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 13) THEN 'September' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 17) THEN 'October' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 22) THEN 'November' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 26) THEN 'December' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 30) THEN 'January' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 35) THEN 'February' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 39) THEN 'March' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 43) THEN 'April' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 48) THEN 'May' WHEN (DATETIME_DIFF(SAFE_CAST(DATE('2025-03-23', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= 53) THEN 'June' ELSE NULL END AS STRING),')') FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1",dimension,False,low,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
comparison_type_budget_forecast_yoy,comparison_type,Comparison Type (Budget/Forecast/YOY),"A dimension indicating the type of comparison being made (e.g., Budget, Forecast, Year-over-Year). Value is determined by a dashboard parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT CASE WHEN (1 = 1) THEN 'BUD' WHEN (1 = 2) THEN 'FCT' WHEN (1 = 3) THEN 'YOY' WHEN (1 = 4) THEN 'BUD NY' ELSE NULL END FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1,dimension,False,low,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
comparison_type_last_period,comparison_type,Comparison Type (Last Week/Month/Quarter/Year),"A dimension indicating the type of comparison being made against a previous period (e.g., Last Week, Last Month, Last Quarter, Last Year). Value is determined by a dashboard parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT CASE WHEN (1 = 1) THEN 'vs LW' WHEN (1 = 2) THEN 'vs LM' WHEN (1 = 3) THEN 'vs LQ' WHEN (1 = 4) THEN 'vs LY' ELSE NULL END FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1,dimension,False,low,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
metric_type_cancellations,metric_type,Metric Type (Cancellations),"A dimension indicating the type of cancellation metric selected (e.g., Gross Cancellations, Net Cancellations). Value is determined by a dashboard parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT CASE WHEN (1 = 1) THEN 'Gross Cancellations' WHEN (1 = 2) THEN 'Net Cancellations' ELSE NULL END FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1,dimension,False,low,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
metric_type_acquisitions,metric_type,Metric Type (Acquisitions),"A dimension indicating the type of acquisition metric selected (e.g., Gross Acquisitions, Net Acquisitions). Value is determined by a dashboard parameter.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT CASE WHEN (1 = 1) THEN 'Gross Acquisitions' WHEN (1 = 2) THEN 'Net Acquisitions' ELSE NULL END FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1,dimension,False,low,20,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
closing_base_3rd_party_v_current_week,closing_base_3rd_party_v,Closing Base 3rd Party (V) - Current Week,"The closing base for 3rd party subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_v_current_week,total_closing_base_v,Total Closing Base (V) - Current Week,"The total closing base for all subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_v_current_week,revenue_consumer_v,Revenue Consumer (V) - Current Week,"Revenue generated from consumer subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_v_current_week,revenue_3rd_party_v,Revenue 3rd Party (V) - Current Week,"Revenue generated from 3rd party subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_v_current_week,revenue_corp_v,Revenue Corp (V) - Current Week,"Revenue generated from corporate subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_v_current_week,revenue_campus_v,Revenue Campus (V) - Current Week,"Revenue generated from campus subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_v_current_week,revenue_other_v,Revenue Other (V) - Current Week,"Revenue generated from other sources, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_revenue_v_current_week,total_revenue_v,Total Revenue (V) - Current Week,"Total revenue from all sources, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Revenue_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_v_current_week,net_growth_incl_3rd_party_v,Net Growth incl. 3rd Party (V) - Current Week,"Net growth in subscriptions including 3rd party, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_v_current_week,net_growth_consumer_v,Net Growth Consumer (V) - Current Week,"Net growth in consumer subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_v_current_week,net_growth_3rd_party_v,Net Growth 3rd Party (V) - Current Week,"Net growth in 3rd party subscriptions, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_v_current_week,breach_sales_v,Breach Sales (V) - Current Week,"Sales related to breaches, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_v_current_week,always_on_digital_sales_v,Always-on Digital Sales (V) - Current Week,"Always-on digital sales, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_v_current_week,general_offer_sales_v,General Offer Sales (V) - Current Week,"Sales from general offers, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_v_current_week,other_sales_v,Other Sales (V) - Current Week,"Sales from other sources, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_v_current_week,total_weekly_sales_v,Total Weekly Sales (V) - Current Week,"Total sales for the week, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_v_current_week,essentials_v,Essentials (V) - Current Week,"Essential sales volume, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_v_current_week,switches_v,Switches (V) - Current Week,"Number of subscription switches, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_incl_3rd_party_v_current_week,total_cancels_incl_3rd_party_v,Total Cancels incl. 3rd Party (V) - Current Week,"Total cancellations including 3rd party, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excl_3rd_party_v_current_week,total_cancels_excl_3rd_party_v,Total Cancels excl. 3rd Party (V) - Current Week,"Total cancellations excluding 3rd party, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_v_current_week,net_cancels_v,Net Cancels (V) - Current Week,"Net cancellations, versioned, for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels_V) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
failed_payment_volume_current_week,failed_payment_volume,Failed Payment Volume - Current Week,Volume of failed payments for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Failed_Payment_Volume) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_consumer_current_week,closing_base_consumer,Closing Base Consumer - Current Week,The closing base for consumer subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_gpla_current_week,net_growth_3rd_party_gpla,Net Growth 3rd Party GPLA - Current Week,"Net growth for 3rd party subscriptions (GPLA), for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
breach_sales_current_week,breach_sales,Breach Sales - Current Week,Sales related to breaches for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Breach_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
always_on_digital_sales_current_week,always_on_digital_sales,Always-on Digital Sales - Current Week,Always-on digital sales for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Always_on_Digital_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
general_offer_sales_current_week,general_offer_sales,General Offer Sales - Current Week,Sales from general offers for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.General_Offer_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
other_sales_current_week,other_sales,Other Sales - Current Week,Sales from other sources for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Other_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_incl_3rd_party_current_week,net_growth_incl_3rd_party,Net Growth incl. 3rd Party - Current Week,Net growth in subscriptions including 3rd party for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_incl_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_weekly_sales_current_week,total_weekly_sales,Total Weekly Sales - Current Week,Total sales for the week for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Weekly_Sales) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_consumer_current_week,net_growth_consumer,Net Growth Consumer - Current Week,Net growth in consumer subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
essentials_current_week,essentials,Essentials - Current Week,Essential sales volume for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Essentials) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_growth_3rd_party_current_week,net_growth_3rd_party,Net Growth 3rd Party - Current Week,Net growth in 3rd party subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Growth_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
switches_current_week,switches,Switches - Current Week,Number of subscription switches for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Switches) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_incl_3rd_party_current_week,total_cancels_incl_3rd_party,Total Cancels incl. 3rd Party - Current Week,Total cancellations including 3rd party for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_including_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_cancels_excl_3rd_party_current_week,total_cancels_excl_3rd_party,Total Cancels excl. 3rd Party - Current Week,Total cancellations excluding 3rd party for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Cancels_excluding_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
net_cancels_current_week,net_cancels,Net Cancels - Current Week,Net cancellations for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Net_Cancels) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_current_week,closing_base_3rd_party,Closing Base 3rd Party - Current Week,The closing base for 3rd party subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_apls_current_week,closing_base_3rd_party_apls,Closing Base 3rd Party APLS - Current Week,"The closing base for 3rd party subscriptions (APLS), for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
closing_base_3rd_party_gpla_current_week,closing_base_3rd_party_gpla,Closing Base 3rd Party GPLA - Current Week,"The closing base for 3rd party subscriptions (GPLA), for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Closing_Base_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
total_closing_base_current_week,total_closing_base,Total Closing Base - Current Week,The total closing base for all subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Total_Closing_Base) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_consumer_current_week,revenue_consumer,Revenue Consumer - Current Week,Revenue generated from consumer subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Consumer) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,True,high,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_current_week,revenue_3rd_party,Revenue 3rd Party - Current Week,Revenue generated from 3rd party subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_apls_current_week,revenue_3rd_party_apls,Revenue 3rd Party APLS - Current Week,"Revenue generated from 3rd party subscriptions (APLS), for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_APLS) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_3rd_party_gpla_current_week,revenue_3rd_party_gpla,Revenue 3rd Party GPLA - Current Week,"Revenue generated from 3rd party subscriptions (GPLA), for the current fiscal week of 2025 (Week 37).",ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_3rd_Party_GPLA) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,medium,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_corp_current_week,revenue_corp,Revenue Corp - Current Week,Revenue generated from corporate subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Corp) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_campus_current_week,revenue_campus,Revenue Campus - Current Week,Revenue generated from campus subscriptions for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Campus) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
revenue_other_current_week,revenue_other,Revenue Other - Current Week,Revenue generated from other sources for the current fiscal week of 2025 (Week 37).,ncau-data-newsquery-prd,asl_finance_derived,consumer_masthead_scorecard,SELECT SUM(t0.Revenue_Other) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE t0.fy_year = 2025 AND t0.fy_week_of_year = 37,measure,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
fiscal_week_of_year,fiscal_week_of_year,Fiscal Week of Year,The fiscal week number within the fiscal year from the calendar dimension table.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT t0c0d2.fy_week_of_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 GROUP BY t0c0d2.fy_week_of_year LIMIT 1,dimension,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
fiscal_year,fiscal_year,Fiscal Year,The fiscal year from the calendar dimension table.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,SELECT t0c0d2.fy_year FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 GROUP BY t0c0d2.fy_year LIMIT 1,dimension,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
calculated_fiscal_week,calculated_fiscal_week,Calculated Fiscal Week,A calculated fiscal week number based on a fixed reference date (2025-03-30) and day of week logic.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN (EXTRACT(DAYOFWEEK FROM TIMESTAMP('2025-03-30')) - 1 <= 2) THEN DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1 ELSE DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` LIMIT 1",calculated_field,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
current_fiscal_week_flag,current_fiscal_week_flag,Current Fiscal Week Flag,A boolean flag indicating if the row corresponds to the current fiscal week (Week 37) and year (FY2025) based on the dashboard's fixed date logic.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN (t0c0d2.fy_week_of_year = (CASE WHEN (EXTRACT(DAYOFWEEK FROM TIMESTAMP('2025-03-30')) - 1 <= 2) THEN DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1 ELSE DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) AND t0c0d2.fy_year = 2025) THEN 'TRUE' ELSE 'FALSE' END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 GROUP BY t0c0d2.fy_week_of_year, t0c0d2.fy_year LIMIT 1",filter,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
fiscal_week_start_date,fiscal_week_start_date,Fiscal Week Start Date,"The start date of the ISO week for the fiscal calendar, derived from the calendar date.",ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(t0c0d2.calendar_date AS DATETIME), ISOWEEK) AS DATE) FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 GROUP BY SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(t0c0d2.calendar_date AS DATETIME), ISOWEEK) AS DATE) LIMIT 1",dimension,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
last_5_fiscal_weeks_flag,last_5_fiscal_weeks_flag,Last 5 Fiscal Weeks Flag,A boolean flag indicating if the row falls within the last 5 fiscal weeks up to the current fiscal week (Week 37) of 2025.,ncau-data-newsquery-prd,prstn_finance,calendar_dim,"SELECT CASE WHEN (t0c0d2.fy_year = 2025 AND t0c0d2.fy_week_of_year <= (CASE WHEN (EXTRACT(DAYOFWEEK FROM TIMESTAMP('2025-03-30')) - 1 <= 2) THEN DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1 ELSE DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) AND t0c0d2.fy_week_of_year >= (CASE WHEN (EXTRACT(DAYOFWEEK FROM TIMESTAMP('2025-03-30')) - 1 <= 2) THEN DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1 ELSE DATETIME_DIFF(SAFE_CAST('2025-03-30' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) END) - 5) THEN 'TRUE' ELSE 'FALSE' END FROM `ncau-data-newsquery-prd.prstn_finance.calendar_dim` AS t0c0d2 GROUP BY t0c0d2.fy_year, t0c0d2.fy_week_of_year LIMIT 1",filter,False,low,21,57d87efe-c112-4d42-be1b-045f0c8ca73e
data_load_datetime_filtered_by_fy24_25,data_load_datetime,Data Load Datetime (FY24-25),"The timestamp when data was loaded, filtered for financial years 2024 and 2025. Used primarily for date range selection in the dashboard.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DATETIME_TRUNC(data_load_datetime, SECOND) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE financial_year IN ('2024', '2025') LIMIT 100;",dimension,false,low,22,f502f44a-e283-405f-ab8f-6a641edb4194
gross_revenue_travel_services_fy25,gross_revenue_amount,Gross Revenue - Travel Services (FY25),Total gross revenue specifically for the 'Travel Services' industry pillar in financial year 2025.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE financial_year = '2025' AND nca_industry_pillar IN ('Travel Services') LIMIT 1;,measure,true,high,22,f502f44a-e283-405f-ab8f-6a641edb4194
unified_publication_name_filtered_fy24_25,unified_publication_name,Unified Publication Name (Filtered FY24-25),"Distinct names of unified publications, excluding a long list of administrative or non-relevant entries, for financial years 2024 and 2025. Used for filtering and breakdown.",ncau-data-newsquery-prd,asl_finance_derived_archive,details_dashboard_archive_FY25_T,"SELECT DISTINCT unified_publication_name FROM `ncau-data-newsquery-prd.asl_finance_derived_archive.details_dashboard_archive_FY25_T` WHERE financial_year IN ('2024', '2025') AND unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') LIMIT 100;",dimension,false,medium,22,f502f44a-e283-405f-ab8f-6a641edb4194
data_load_datetime_filtered_by_fy26,data_load_datetime,Data Load Datetime (FY26),"The timestamp when data was loaded, filtered specifically for financial year 2026. Used for date range selection.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DATETIME_TRUNC(data_load_datetime, SECOND) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE financial_year IN ('2026') LIMIT 100;",dimension,false,low,22,f502f44a-e283-405f-ab8f-6a641edb4194
gross_revenue_digital_fy24_filtered_adtype_pub,gross_revenue_amount,"Gross Revenue - Digital (FY24, Filtered Ad Type & Pub)","Total gross revenue for 'DIGITAL' revenue type in financial year 2024, excluding specific ad types and unified publication names.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE revenue_type = 'DIGITAL' AND financial_year = '2024' AND fin_adtype_name NOT IN ('Xtend', 'Unruly (Non-Targeted)', 'Taboola', 'SUDDENLY (Non-Targeted)', 'Finda', 'Events (Non-Targeted)', 'Edmedia', 'Display', 'Creatives', 'Classified', '-') AND unified_publication_name NOT IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'CodeBet', 'CODE', 'null', 'Digital Subscription_NTN', 'Digital Subscription_TWM', 'Delicious.admin', 'ECOMMERCE.BODYANDSOUL', 'ECOMMERCE.VOGUE', 'EdMedia', 'Escape eCommerce', 'Escape.Admin', 'RACENET', 'SKYNEWS.ADMIN', 'Sky News', 'Stellar.Admin', 'TAUS.STOCKHEAD', 'TAUS.ADMIN', 'TOOWOOMBACUSTOM', 'Taboola', 'Taste.Admin', 'Unknown', 'Vogue.Admin', 'Vogueliving.Admin', 'Xtend', 'eCommerce.GQ', 'eCommerce.Kidspot', 'eCommerce', 'odds.com.au', 'Digital Subscription_NQN', 'Digital Subscription_CNS', 'Bodyandsoul.Admin', 'eCommerce.Delicious', 'ECOMMERCE.VOGUELIVING', 'eCommerce.Taste', 'GQ.Admin', 'Kidspot.Admin', 'News.Admin', 'Rea.Audience', 'Rea.Content', 'Punters.com.au', 'Unruly') LIMIT 1;",measure,true,high,22,f502f44a-e283-405f-ab8f-6a641edb4194
fin_adtype_name_filtered_fy24_25,fin_adtype_name,Financial Ad Type Name (FY24-25),"Distinct financial ad type names, filtered for financial years 2024 and 2025. Used for filtering and breakdown.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT DISTINCT fin_adtype_name FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` WHERE financial_year IN ('2024', '2025') LIMIT 100;",dimension,false,medium,22,f502f44a-e283-405f-ab8f-6a641edb4194
record_count_subs_rateplangroup_check_by_fiscal_week,record_count,Record Count by Fiscal Week (Subs Rate Plan Group Check),"Counts the number of records in the 'v_subs_rateplangroup_check' view, grouped by fiscal week, likely for data volume and completeness checks related to subscription rate plans.",ncau-data-newsquery-prd,finance_monthend_checks,v_subs_rateplangroup_check,"SELECT fiscal_week_id, COUNT(1) AS records_in_week FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_subs_rateplangroup_check` GROUP BY fiscal_week_id ORDER BY fiscal_week_id DESC LIMIT 100;",aggregation,false,medium,23,712ca6fe-b491-4a01-af6e-1495fb3c7d12
total_revenue_persisted_os_nulls_check,total_revenue,Total Revenue (Persisted OS Nulls Check),"Calculates the sum of 'rev' (revenue) from the 'v_persisted_os_nulls_Check' view. This metric is likely used as part of a data quality check to ensure revenue figures are present and valid, especially in the context of 'persisted OS nulls'.",ncau-data-newsquery-prd,finance_monthend_checks,v_persisted_os_nulls_Check,SELECT SUM(rev) AS total_revenue FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check`;,measure,false,high,23,712ca6fe-b491-4a01-af6e-1495fb3c7d12
distinct_fiscal_months_missing_bus_check,distinct_fiscal_months,Distinct Fiscal Months (Missing Bus Check),Lists the distinct fiscal month IDs present in the 'v_missing_Bus_check' view. This is likely used to identify if data for all expected fiscal months is present or if there are gaps in the business data.,ncau-data-newsquery-prd,finance_monthend_checks,v_missing_Bus_check,SELECT DISTINCT fiscal_month_id FROM `ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check` ORDER BY fiscal_month_id DESC LIMIT 100;,dimension,false,medium,23,712ca6fe-b491-4a01-af6e-1495fb3c7d12
record_count_by_source_system,record_count,Record Count by Source System,"Counts the number of records or transactions, grouped by the source system from which the data originated.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  t1.source_system_name,
  COUNT(1) AS Record_Count_by_Source_System
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t1
GROUP BY
  t1.source_system_name
LIMIT 100",aggregation,False,medium,24,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_base,actual_amount,Total Actual Amount,Represents the sum of actual financial amounts recorded in the system.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t1.Actual_Amount) AS Total_Actual_Amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t1
LIMIT 1",measure,True,high,24,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_by_source_system,actual_amount,Total Actual Amount by Source System,"The sum of actual financial amounts, broken down by the source system.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  t1.source_system_name,
  SUM(t1.Actual_Amount) AS Total_Actual_Amount_by_Source_System
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t1
GROUP BY
  t1.source_system_name
LIMIT 100",measure,True,high,24,d7412673-0af1-4efe-8374-ca475b001fb6
total_actual_amount_by_fiscal_year_and_source_system,actual_amount,Total Actual Amount by Fiscal Year and Source System,"The sum of actual financial amounts, broken down by fiscal year and the source system.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  t1.source_system_name,
  t2.fy_year,
  SUM(t1.Actual_Amount) AS Total_Actual_Amount_by_Fiscal_Year_and_Source_System
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t1
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS t2
  ON SAFE_CAST(t1.fiscal_week_id AS INT64) = SAFE_CAST(t2.fy_year_week_number AS INT64)
GROUP BY
  t1.source_system_name,
  t2.fy_year
LIMIT 100",measure,True,high,24,d7412673-0af1-4efe-8374-ca475b001fb6
budget_volume_past_weeks_dti_excluded,budget_volume,"Budget Volume (Past Weeks, DTI Free Copies Excluded)","The sum of budgeted volume for fiscal weeks prior to the current week, excluding 'DTI Free Copies' from OS Level 8 and records where the standardized publication name is null.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Budget_Volume,
    os.relative_fisc_week_number,
    os.os_level_8,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE WHEN BaseData.relative_fisc_week_number < 0 THEN BaseData.Budget_Volume ELSE NULL END) AS budget_volume_past_weeks
FROM
  BaseData
WHERE
  BaseData.os_level_8 != 'DTI Free Copies'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,False,medium,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
actual_volume_minus_past_budget_volume_dti_excluded,actual_volume_variance,Actual Volume minus Past Budget Volume (DTI Free Copies Excluded),"The sum of actual volume minus the budgeted volume for fiscal weeks prior to the current week, excluding 'DTI Free Copies' from OS Level 8 and records where the standardized publication name is null.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.volume,
    os.Budget_Volume,
    os.relative_fisc_week_number,
    os.os_level_8,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(BaseData.volume - (CASE WHEN BaseData.relative_fisc_week_number < 0 THEN BaseData.Budget_Volume ELSE NULL END)) AS actual_volume_minus_past_budget_volume
FROM
  BaseData
WHERE
  BaseData.os_level_8 != 'DTI Free Copies'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",calculated_field,False,medium,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
total_actual_volume_dti_excluded,actual_volume,Total Actual Volume (DTI Free Copies Excluded),"The sum of actual volume, excluding 'DTI Free Copies' from OS Level 8 and records where the standardized publication name is null.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.volume,
    os.os_level_8,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(BaseData.volume) AS total_actual_volume
FROM
  BaseData
WHERE
  BaseData.os_level_8 != 'DTI Free Copies'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,True,high,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
total_budget_volume_retail,budget_volume,Total Budget Volume (Retail Sales Channels),The sum of budgeted volume for records categorized under 'Retail' sales channels and where the standardized publication name is not null.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Budget_Volume,
    os.os_level_10,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(BaseData.Budget_Volume) AS total_budget_volume
FROM
  BaseData
WHERE
  BaseData.sales_channel_group = 'Retail'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,True,high,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
budget_amount_past_weeks_retail,budget_amount,"Budget Amount (Past Weeks, Retail Sales Channels)","The sum of budgeted amount for fiscal weeks prior to the current week, filtered for 'Retail' sales channels and non-null standardized publication names.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Budget_Amount,
    os.relative_fisc_week_number,
    os.os_level_10,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE WHEN BaseData.relative_fisc_week_number < 0 THEN BaseData.Budget_Amount ELSE 0 END) AS budget_amount_past_weeks
FROM
  BaseData
WHERE
  BaseData.sales_channel_group = 'Retail'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,False,medium,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
budget_amount_past_weeks_all_sales_channels_retail,budget_amount,"Budget Amount (Past Weeks, All Sales Channels, Retail)","The sum of budgeted amount for fiscal weeks prior to the current week, specifically for 'ALL SALES CHANNELS' within OS Level 7, filtered for 'Retail' sales channels and non-null standardized publication names.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Budget_Amount,
    os.relative_fisc_week_number,
    os.os_level_7,
    os.os_level_10,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE WHEN UPPER(SAFE_CAST(BaseData.os_level_7 AS STRING)) = 'ALL SALES CHANNELS' THEN (CASE WHEN BaseData.relative_fisc_week_number < 0 THEN BaseData.Budget_Amount ELSE 0 END) ELSE 0 END) AS budget_amount_past_weeks_all_sales_channels
FROM
  BaseData
WHERE
  BaseData.sales_channel_group = 'Retail'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,False,medium,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
actual_amount_fiscal_week_40_onwards_retail,actual_amount,"Actual Amount (Fiscal Week 40 Onwards, Retail Sales Channels)","The sum of actual amount for fiscal weeks from week 40 onwards (based on a hardcoded dashboard date of 2025-04-15, which is fiscal week 40), filtered for 'Retail' sales channels and non-null standardized publication names. Note: The original query labels this as 'YTD' but the logic calculates 'from week 40 onwards'.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Actual_Amount,
    calendar.fy_year_week_number,
    os.os_level_10,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE WHEN DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) <= BaseData.fy_year_week_number THEN BaseData.Actual_Amount ELSE 0 END) AS actual_amount_fiscal_week_40_onwards
FROM
  BaseData
WHERE
  BaseData.sales_channel_group = 'Retail'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,True,high,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
total_actual_amount_retail,actual_amount,Total Actual Amount (Retail Sales Channels),"The sum of actual amount, filtered for 'Retail' sales channels and non-null standardized publication names.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Actual_Amount,
    os.os_level_10,
    pub.publication_name,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(BaseData.Actual_Amount) AS total_actual_amount
FROM
  BaseData
WHERE
  BaseData.sales_channel_group = 'Retail'
  AND BaseData.publication_name_standardized_full IS NOT NULL;",measure,True,high,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
avg_daily_budget_volume_complex_retail,avg_daily_budget_volume,"Average Daily Budget Volume (Complex, Retail Sales Channels)","A complex calculation of average daily budgeted volume, adjusted based on publication type (e.g., 'PNG', '6 Day Pubs', 'The Sportsman', 'Weekly Times') and day of week grouping ('M-F'), filtered for 'Retail' sales channels and non-null standardized publication names.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Budget_Volume,
    os.day_of_week,
    pub.publication_name,
    os.os_level_10,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group,
    CASE
      WHEN pub.publication_name IN ('Sunday Herald Sun', 'Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Advertiser', 'Sunday Mail') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Courier Mail', 'The Sunday Mail') THEN 'The Courier Mail'
      WHEN pub.publication_name = 'The Australian' THEN 'The Australian'
      WHEN pub.publication_name = 'The Sportsman' THEN 'The Sportsman'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Weekly Times' THEN 'Weekly Times'
      ELSE NULL
    END AS publication_name_standardized_for_specific_pubs,
    CASE
      WHEN pub.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN pub.publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN pub.publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE pub.publication_name
    END AS publication_group_type,
    CASE
      WHEN os.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry') THEN 'M-F'
      WHEN os.day_of_week = 'Sat' THEN 'SAT'
      WHEN os.day_of_week = 'Sun' THEN 'Sun'
      ELSE NULL
    END AS day_of_week_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
),
CalculatedData AS (
  SELECT
    *,
    (EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney'))) - 1) AS current_day_of_week_num,
    DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AS current_fiscal_week_diff,
    (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) AS current_fiscal_week_num_minus_1
  FROM BaseData
),
IntermediateCalculations AS (
  SELECT
    *,
    (current_fiscal_week_num_minus_1) AS clmn52_,
    (publication_name_standardized_for_specific_pubs = 'The Courier Mail') AS is_courier_mail,
    (publication_name_standardized_for_specific_pubs = 'The Australian') AS is_the_australian,
    (current_fiscal_week_num_minus_1 = 26) AS clmn57_,
    (current_fiscal_week_num_minus_1 = 40) AS clmn58_,
    (current_fiscal_week_num_minus_1 = fy_week_of_year) AS clmn59_,
    (is_the_australian OR is_courier_mail) AS clmn63_,
    (clmn57_ OR clmn58_) AS clmn64_,
    (Budget_Volume * 5) AS clmn80_,
    (SAFE_DIVIDE(Budget_Volume, 4) * 5) AS clmn81_,
    (SAFE_DIVIDE(Budget_Volume, current_fiscal_week_num_minus_1) * 5) AS clmn82_,
    (SAFE_DIVIDE(Budget_Volume, (current_fiscal_week_num_minus_1 * 5)) * 5) AS clmn83_,
    SAFE_DIVIDE(Budget_Volume, current_fiscal_week_num_minus_1) AS clmn84_,
    (SAFE_DIVIDE(Budget_Volume, 2) * 5) AS clmn85_,
    CASE WHEN (day_of_week_group = 'M-F') THEN (SAFE_DIVIDE(Budget_Volume, 4) * 5) ELSE Budget_Volume END AS clmn86_
  FROM CalculatedData
),
FinalCalculations AS (
  SELECT
    *,
    CASE
      WHEN (clmn64_ AND clmn63_) THEN clmn86_
      WHEN (publication_name_standardized_for_specific_pubs = 'The Sportsman') THEN clmn85_
      WHEN (publication_name_standardized_for_specific_pubs = 'Weekly Times') THEN clmn80_
      WHEN (publication_group_type = 'PNG') THEN 0
      ELSE Budget_Volume
    END AS clmn88_
  FROM IntermediateCalculations
)
SELECT
  SUM(
    CASE
      WHEN (publication_group_type = 'PNG') THEN 0
      WHEN (publication_group_type = '6 Day Pubs') THEN SAFE_DIVIDE(clmn88_, 6)
      ELSE SAFE_DIVIDE(clmn88_, 7)
    END
  ) AS avg_daily_budget_volume_complex
FROM
  FinalCalculations
WHERE
  sales_channel_group = 'Retail'
  AND publication_name_standardized_full IS NOT NULL;",calculated_field,False,medium,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
avg_daily_actual_volume_complex_retail,avg_daily_actual_volume,"Average Daily Actual Volume (Complex, Retail Sales Channels)","A complex calculation of average daily actual volume, adjusted based on publication type (e.g., '6 Day Pubs', 'The Sportsman', 'Weekly Times', 'PNG') and day of week grouping ('M-F'), filtered for 'Retail' sales channels and non-null standardized publication names.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH BaseData AS (
  SELECT
    os.Budget_Volume,
    os.volume,
    os.day_of_week,
    pub.publication_name,
    os.os_level_10,
    calendar.fy_week_of_year,
    calendar.fy_year_week_number,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    CASE
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
      WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
      WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
      WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
      WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
      WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
      WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
      WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
      ELSE NULL
    END AS publication_name_standardized_full,
    CASE
      WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
      WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
      WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
      WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
      ELSE 'Unspec Channel'
    END AS sales_channel_group,
    CASE
      WHEN pub.publication_name IN ('Sunday Herald Sun', 'Herald Sun') THEN 'The Herald Sun'
      WHEN pub.publication_name IN ('The Advertiser', 'Sunday Mail') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Courier Mail', 'The Sunday Mail') THEN 'The Courier Mail'
      WHEN pub.publication_name = 'The Australian' THEN 'The Australian'
      WHEN pub.publication_name = 'The Sportsman' THEN 'The Sportsman'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name = 'Weekly Times' THEN 'Weekly Times'
      ELSE NULL
    END AS publication_name_standardized_for_specific_pubs,
    CASE
      WHEN pub.publication_name IN ('Cairns Post', 'Geelong Advertiser', 'Gold Coast Bulletin', 'The Australian', 'Toowoomba', 'Townsville Bulletin') THEN '6 Day Pubs'
      WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury and Sunday Tas'
      WHEN pub.publication_name IN ('NT News', 'Sunday Territorian') THEN 'NT News & Sunday Territorian'
      WHEN pub.publication_name IN ('Other', 'Brisbane Other', 'Cairns Post Digital', 'Corporate', 'Geelong Advertiser Digital', 'Gold Coast Bulletin Digital', 'Gold Coast Other', 'Herald Sun Digital', 'Melbourne Other', 'Mercury Digital', 'News Xtend', 'NIMs', 'NT News Digital', 'NT Other', 'Perth Now Digital', 'Sydney Other', 'The Australian Digital', 'The Courier Mail Digital', 'The Daily Telegraph Digital', 'The Weekend Australian Mag', 'Townsville Bulletin Digital', 'Transformation', 'Weekly Times Digital') THEN 'Other'
      WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
      WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
      WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
      WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
      ELSE pub.publication_name
    END AS publication_group_type,
    CASE
      WHEN os.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry') THEN 'M-F'
      WHEN os.day_of_week = 'Sat' THEN 'SAT'
      WHEN os.day_of_week = 'Sun' THEN 'Sun'
      ELSE NULL
    END AS day_of_week_group
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = calendar.fy_year_week_number AND control.period_name IN ('CP', 'PY')
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
),
CalculatedData AS (
  SELECT
    *,
    (EXTRACT(DAYOFWEEK FROM TIMESTAMP(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney'))) - 1) AS current_day_of_week_num,
    DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AS current_fiscal_week_diff,
    (DATETIME_DIFF(SAFE_CAST(DATE(TIMESTAMP '2025-04-15 04:14:20.297382+00', 'Australia/Sydney') AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) - 1) AS current_fiscal_week_num_minus_1
  FROM BaseData
),
IntermediateCalculations AS (
  SELECT
    *,
    (current_fiscal_week_num_minus_1) AS clmn52_,
    (publication_name_standardized_for_specific_pubs = 'The Courier Mail') AS is_courier_mail,
    (publication_name_standardized_for_specific_pubs = 'The Australian') AS is_the_australian,
    (current_fiscal_week_num_minus_1 = 26) AS clmn57_,
    (current_fiscal_week_num_minus_1 = 40) AS clmn58_,
    (current_fiscal_week_num_minus_1 = fy_week_of_year) AS clmn59_,
    (is_the_australian OR is_courier_mail) AS clmn63_,
    (clmn57_ OR clmn58_) AS clmn64_,
    (SAFE_DIVIDE(Budget_Volume, (current_fiscal_week_num_minus_1 * 2)) * 5) AS clmn79_,
    (SAFE_DIVIDE(Budget_Volume, current_fiscal_week_num_minus_1) * 5) AS clmn82_,
    (SAFE_DIVIDE(Budget_Volume, (current_fiscal_week_num_minus_1 * 5)) * 5) AS clmn83_,
    SAFE_DIVIDE(Budget_Volume, current_fiscal_week_num_minus_1) AS clmn84_,
    CASE WHEN (day_of_week_group = 'M-F') THEN (SAFE_DIVIDE(Budget_Volume, (current_fiscal_week_num_minus_1 * 5)) * 5) ELSE SAFE_DIVIDE(Budget_Volume, current_fiscal_week_num_minus_1) END AS clmn87_
  FROM CalculatedData
),
FinalCalculations AS (
  SELECT
    *,
    CASE
      WHEN (is_the_australian OR is_courier_mail) THEN clmn87_
      WHEN (publication_name_standardized_for_specific_pubs = 'The Sportsman') THEN clmn79_
      WHEN (publication_name_standardized_for_specific_pubs = 'Weekly Times') THEN clmn82_
      WHEN (publication_group_type = 'PNG') THEN 0
      WHEN (day_of_week_group = 'M-F') THEN clmn83_
      ELSE clmn84_
    END AS clmn89_
  FROM IntermediateCalculations
)
SELECT
  SUM(
    CASE
      WHEN (publication_group_type = '6 Day Pubs') THEN SAFE_DIVIDE(clmn89_, 6)
      ELSE SAFE_DIVIDE(clmn89_, 7)
    END
  ) AS avg_daily_actual_volume_complex
FROM
  FinalCalculations
WHERE
  sales_channel_group = 'Retail'
  AND publication_name_standardized_full IS NOT NULL;",calculated_field,False,medium,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
os_level_8_dimension,os_level_8,OS Level 8,"A categorical dimension representing a specific level within the operational structure, often used for filtering or grouping data.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT DISTINCT os.os_level_8 FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os WHERE upper(os.os_level_6) = 'CIRCULATION' AND os.l04_publication_code <> 'Free News & Lifestyle' AND os.l06_publication_code NOT IN ('Food', 'Prestige') AND os.gl_hierarchy_code = 'FY2025' ORDER BY os.os_level_8 DESC LIMIT 100;",dimension,False,low,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
fiscal_quarter_dimension,fiscal_quarter,Fiscal Quarter,"The fiscal quarter of the year, derived from the calendar dimension.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT calendar.fy_quarter_of_year FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number WHERE upper(os.os_level_6) = 'CIRCULATION' AND os.gl_hierarchy_code = 'FY2025' LIMIT 100;,dimension,False,low,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
publication_state_region_dimension,publication_state_region,Publication State/Region,A derived dimension grouping publications by their respective Australian state or territory.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT DISTINCT
  CASE
    WHEN CASE WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser' WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times' WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun' WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph' WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle' WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin' WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB' WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser' WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post' WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast' WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail' WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury' WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News' WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury' ELSE NULL END = 'The Daily Telegraph' THEN ' NSW'
    WHEN CASE WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser' WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times' WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun' WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph' WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle' WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin' WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB' WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser' WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post' WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast' WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail' WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury' WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News' WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury' ELSE NULL END IN ('The Herald Sun', 'Geelong Advertiser', 'Weekly Times') THEN '  VIC'
    WHEN CASE WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser' WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times' WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun' WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph' WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle' WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin' WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB' WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser' WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post' WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast' WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail' WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury' WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News' WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury' ELSE NULL END = 'The Advertiser' THEN '   SA'
    WHEN CASE WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser' WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times' WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun' WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph' WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle' WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin' WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB' WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser' WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post' WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast' WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail' WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury' WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News' WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury' ELSE NULL END IN ('Courier Mail', 'Cairns Post', 'GCB', 'Townsville Bulletin', 'The Chronicle', 'Daily Mercury', 'Sunshine Coast') THEN '     QLD'
    WHEN CASE WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser' WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times' WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun' WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph' WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle' WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin' WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB' WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser' WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post' WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast' WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail' WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury' WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News' WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury' ELSE NULL END = 'Northern Territory News' THEN '      NT'
    WHEN CASE WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser' WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times' WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun' WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph' WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle' WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin' WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB' WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser' WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post' WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast' WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail' WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury' WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News' WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury' ELSE NULL END = 'Mercury' THEN '    TAS'
    ELSE NULL
  END AS publication_state_region
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
WHERE
  upper(os.os_level_6) = 'CIRCULATION'
  AND os.l04_publication_code <> 'Free News & Lifestyle'
  AND os.l06_publication_code NOT IN ('Food', 'Prestige')
  AND os.gl_hierarchy_code = 'FY2025'
LIMIT 100;",dimension,False,low,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
publication_name_standardized_dimension,publication_name_standardized,Publication Name (Standardized),"A standardized name for publications, consolidating various source names into common titles.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT DISTINCT
  CASE
    WHEN pub.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
    WHEN pub.publication_name IN ('Weekly Times') THEN 'Weekly Times'
    WHEN pub.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    WHEN pub.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN pub.publication_name = 'Toowoomba' THEN 'The Chronicle'
    WHEN pub.publication_name = 'Townsville Bulletin' THEN 'Townsville Bulletin'
    WHEN pub.publication_name = 'Gold Coast Bulletin' THEN 'GCB'
    WHEN pub.publication_name = 'Geelong Advertiser' THEN 'Geelong Advertiser'
    WHEN pub.publication_name = 'Cairns Post' THEN 'Cairns Post'
    WHEN pub.publication_name = 'Sunshine Coast' THEN 'Sunshine Coast'
    WHEN pub.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'Courier Mail'
    WHEN pub.publication_name IN ('Mercury', 'Sunday Tasmanian') THEN 'Mercury'
    WHEN pub.publication_name IN ('Sunday Territorian', 'NT News') THEN 'Northern Territory News'
    WHEN pub.publication_name = 'Mackay' THEN 'Daily Mercury'
    ELSE NULL
  END AS publication_name_standardized
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
WHERE
  upper(os.os_level_6) = 'CIRCULATION'
  AND os.l04_publication_code <> 'Free News & Lifestyle'
  AND os.l06_publication_code NOT IN ('Food', 'Prestige')
  AND os.gl_hierarchy_code = 'FY2025'
LIMIT 100;",dimension,False,low,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
sales_channel_group_dimension,sales_channel_group,Sales Channel Group,"A derived dimension categorizing sales channels into broader groups like 'Retail', 'Alternative Channels', 'Newsagencies', 'Subscriptions', or 'Unspec Channel'.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT DISTINCT
  CASE
    WHEN os.os_level_10 IN ('Convenience Stores / Service Stations', 'Newsagencies', 'Supermarkets') THEN 'Retail'
    WHEN os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels') THEN 'Alternative Channels'
    WHEN os.os_level_10 IN ('Agent & Dist') THEN 'Newsagencies'
    WHEN os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub') THEN 'Subscriptions'
    ELSE 'Unspec Channel'
  END AS sales_channel_group
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
WHERE
  upper(os.os_level_6) = 'CIRCULATION'
  AND os.l04_publication_code <> 'Free News & Lifestyle'
  AND os.l06_publication_code NOT IN ('Food', 'Prestige')
  AND os.gl_hierarchy_code = 'FY2025'
LIMIT 100;",dimension,False,low,25,6a26c78f-0070-4fb3-88b8-691ee4a4485a
os_level_4_dimension,os_level_dimension,OS Level 4,"A dimension representing the fourth level of the organizational structure, typically used for filtering or grouping external financial data.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_externals,SELECT t0.os_level_4 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Jan' GROUP BY t0.os_level_4 LIMIT 100,dimension,False,medium,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
os_level_6_dimension,os_level_dimension,OS Level 6,"A dimension representing the sixth level of the organizational structure, used for filtering or grouping monthly expenses or revenue data.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,SELECT t0.os_level_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Apr' GROUP BY t0.os_level_6 LIMIT 100,dimension,False,medium,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
os_level_3_dimension,os_level_dimension,OS Level 3,"A dimension representing the third level of the organizational structure, used for filtering or grouping aggregated financial actuals.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_asl_FCT_finance_os_agg_with_hierarchy,"SELECT t0.os_level_3 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_asl_FCT_finance_os_agg_with_hierarchy` AS t0 WHERE SUBSTR(SAFE_CAST(t0.fiscal_week_id AS STRING), 1, 4) = '2025' GROUP BY t0.os_level_3 LIMIT 100",dimension,False,medium,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
is_print_digital_flag_dimension,print_digital_flag,Is Print Digital Flag,"A flag indicating whether a financial entry is related to print or digital operations, used for segmentation in external reporting.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_externals,SELECT t0.is_print_digital_flag FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals` AS t0 WHERE t0.fiscal_year = 2025 GROUP BY t0.is_print_digital_flag LIMIT 100,dimension,False,medium,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
month_short_name_dimension,month_dimension,Month Short Name,"The abbreviated name of the month, used for time-based filtering and grouping in financial reports.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_MER_externals,SELECT t0.month_short_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals` AS t0 WHERE t0.fiscal_year = 2025 GROUP BY t0.month_short_name LIMIT 100,dimension,False,low,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
total_tm1_net_revenue,total_tm1_net_revenue,Total TM1 Net Revenue,"The sum of net revenue figures as reported in the TM1 financial system, used for reconciliation against actuals.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT SUM(t0.TM1_Net_Revenue) AS total_tm1_net_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') AND SAFE_CAST(t0.fiscal_year AS BIGNUMERIC) = 2025.000000 AND t0.month_short_name = 'Aug' LIMIT 1",measure,True,high,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
total_tableau_actual_revenue,total_tableau_actual_revenue,Total Tableau Actual Revenue,"The sum of actual revenue figures as reported in Tableau, used for reconciliation against TM1 figures.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT SUM(t0.Tableau_Actual) AS total_tableau_actual_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') AND SAFE_CAST(t0.fiscal_year AS BIGNUMERIC) = 2025.000000 AND t0.month_short_name = 'Aug' LIMIT 1",measure,True,high,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
revenue_variance_tableau_vs_tm1,revenue_variance,Revenue Variance (Tableau vs TM1),"The difference between Tableau Actual Revenue and TM1 Net Revenue, indicating discrepancies in reported revenue figures.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_revenue,"SELECT SUM(t0.Tableau_Actual - t0.TM1_Net_Revenue) AS revenue_variance FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue` AS t0 WHERE SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$') AND SAFE_CAST(t0.fiscal_year AS BIGNUMERIC) = 2025.000000 AND t0.month_short_name = 'Aug' LIMIT 1",calculated_field,True,high,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
total_actual_amount_os_aggregated,total_actual_amount_os_agg,Total Actual Amount (OS Aggregated),"The sum of actual financial amounts aggregated by organizational structure levels, typically used for overall financial performance tracking.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_asl_FCT_finance_os_agg_with_hierarchy,"SELECT SUM(t0.Actual_Amount) AS total_actual_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_asl_FCT_finance_os_agg_with_hierarchy` AS t0 WHERE SUBSTR(SAFE_CAST(t0.fiscal_week_id AS STRING), 1, 4) = '2025' LIMIT 1",measure,True,high,26,906ca8a7-1733-4a1a-b2f5-2660551f3d3a
add_volume_pbf_subscriptions,add_volume,Added Volume,Volume added to subscriptions within the specified fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT add_volume FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,False,medium,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
category_name_pbf_subscriptions,category_name,Subscription Category Name,Name of the subscription category.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT category_name FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
closing_base_pbf_subscriptions,closing_base,Closing Base,The closing base value for subscriptions at the end of the fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT closing_base FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,True,high,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
earned_amount_pbf_subscriptions,earned_amount,Earned Amount,The amount earned from subscriptions within the specified fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT earned_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,True,high,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
fiscal_week_id_pbf_subscriptions,fiscal_week_id,Fiscal Week ID,Identifier for the fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT fiscal_week_id FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
gl_publication_code_pbf_subscriptions,gl_publication_code,GL Publication Code,General Ledger publication code associated with the subscription.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT gl_publication_code FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
opening_base_pbf_subscriptions,opening_base,Opening Base,The opening base value for subscriptions at the start of the fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT opening_base FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,True,high,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
red_volume_pbf_subscriptions,red_volume,Reduced Volume,Volume reduced from subscriptions within the specified fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT red_volume FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,False,medium,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
transfer_in_pbf_subscriptions,transfer_in,Transfer In Volume,Volume transferred into subscriptions within the specified fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT transfer_in FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,False,medium,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
transfer_out_pbf_subscriptions,transfer_out,Transfer Out Volume,Volume transferred out of subscriptions within the specified fiscal week.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tm1_pbf_subscriptions,SELECT transfer_out FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` WHERE fiscal_week_id IN (202535),measure,False,medium,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_record_count,record_count,Business Unit Record Count,Count of records in the GL Business Unit Dimension table.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT COUNT(1) FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,aggregation,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_code_dim,business_unit_code,Business Unit Code,Unique code for a business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT business_unit_code FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_name_dim,business_unit_name,Business Unit Name,Name of the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT business_unit_name FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_status_dim,business_unit_status,Business Unit Status,"Current status of the business unit (e.g., active, inactive).",ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT business_unit_status FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
business_unit_type_code_dim,business_unit_type_code,Business Unit Type Code,Code indicating the type of business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT business_unit_type_code FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
company_number_dim,company_number,Company Number,The company number associated with the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT company_number FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
department_dim,department,Department,The department name associated with the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT department FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
legacy_reporting_group_dim,legacy_reporting_group,Legacy Reporting Group,The legacy reporting group for the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT legacy_reporting_group FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
publication_group_dim,publication_group,Publication Group,The publication group associated with the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT publication_group FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
publication_number_dim,publication_number,Publication Number,The publication number associated with the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT publication_number FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
reporting_group_dim,reporting_group,Reporting Group,The reporting group for the business unit.,ncau-data-newsquery-prd,dap_tm1,gl_business_unit_dim,SELECT reporting_group FROM `ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim`,dimension,False,low,27,23c8b213-a9f0-4158-b8fa-bff14425abb5
product_revenue_total,product_revenue,Total Product Revenue,The sum of all product revenue recorded in the system.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Product_Revenue) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0,measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1,expense,Expense (Margin Level 1),The sum of expenses specifically categorized under Margin Level '1'.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,SELECT SUM(t0.Expense) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE SAFE_CAST(t0.Margin_Level AS STRING) = '1',measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_or_2,expense,Expense (Margin Level 1 or 2),The sum of expenses categorized under Margin Level '1' or '2'.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(t0.Expense) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2')",measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_or_3,expense,"Expense (Margin Level 1, 2, or 3)","The sum of expenses categorized under Margin Level '1', '2', or '3'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(t0.Expense) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3')",measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_3_or_4,expense,"Expense (Margin Level 1, 2, 3, or 4)","The sum of expenses categorized under Margin Level '1', '2', '3', or '4'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(t0.Expense) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4')",measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_margin_level_1_2_3_4_or_5,expense,"Expense (Margin Level 1, 2, 3, 4, or 5)","The sum of expenses categorized under Margin Level '1', '2', '3', '4', or '5'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(t0.Expense) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5')",measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
expense_total_all_margin_levels,expense,Total Expense (All Margin Levels),"The sum of all expenses across Margin Levels '1' through '6', representing the total recorded expense.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_exclude_product_l3_and_l4,"SELECT SUM(t0.Expense) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` AS t0 WHERE SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5', '6')",measure,True,high,28,a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d
actual_amount_q1,actual_amount,Actual Amount (Q1 Context),"Total actual revenue/amount, filtered by specific retail sales channels (Convenience Stores / Service Stations, Supermarkets, Newsagencies) and fiscal week 202601, within the FY2025 hierarchy. This metric represents the raw actual amount.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(Actual_Amount) AS actual_amount_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_q1,actual_amount,Actual Amount (Thousands) (Q1 Context),"Total actual revenue/amount in thousands, filtered by specific retail sales channels (Convenience Stores / Service Stations, Supermarkets, Newsagencies) and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(SAFE_DIVIDE(Actual_Amount, 1000)) AS actual_amount_k_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_mf_q1,actual_amount,Actual Amount (Thousands) - Weekdays (Q1 Context),"Total actual revenue/amount in thousands for Monday-Friday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN SAFE_DIVIDE(os.Actual_Amount, 1000) ELSE NULL END) AS actual_amount_k_mf_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_sat_q1,actual_amount,Actual Amount (Thousands) - Saturday (Q1 Context),"Total actual revenue/amount in thousands for Saturday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week = 'Sat') THEN SAFE_DIVIDE(os.Actual_Amount, 1000) ELSE NULL END) AS actual_amount_k_sat_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_k_sun_q1,actual_amount,Actual Amount (Thousands) - Sunday (Q1 Context),"Total actual revenue/amount in thousands for Sunday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week = 'Sun') THEN SAFE_DIVIDE(os.Actual_Amount, 1000) ELSE NULL END) AS actual_amount_k_sun_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_fy_week1_q1,budget_amount,Budget Amount FY Week 1 (Q1 Context),"Total budget amount for Fiscal Week 1, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (fy_week_of_year = 1) THEN Budget_Amount ELSE 0 END) AS budget_amount_fy_week1_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_fy_week1_k_q1,budget_amount,Budget Amount FY Week 1 (Thousands) (Q1 Context),"Total budget amount in thousands for Fiscal Week 1, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN Budget_Amount ELSE 0 END, 1000)) AS budget_amount_fy_week1_k_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_fy_week1_k_all_channels_q1,budget_amount,Budget Amount FY Week 1 (Thousands) - All Sales Channels (Q1 Context),"Total budget amount in thousands for Fiscal Week 1, specifically for 'ALL SALES CHANNELS', filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.os_level_7 = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN Budget_Amount ELSE 0 END, 1000) ELSE 0 END) AS budget_amount_fy_week1_k_all_channels_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_fy_week1_k_mf_q1,budget_amount,Budget Amount FY Week 1 (Thousands) - Weekdays (Q1 Context),"Total budget amount in thousands for Fiscal Week 1 for Monday-Friday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN Budget_Amount ELSE 0 END, 1000) ELSE NULL END) AS budget_amount_fy_week1_k_mf_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_fy_week1_k_sat_q1,budget_amount,Budget Amount FY Week 1 (Thousands) - Saturday (Q1 Context),"Total budget amount in thousands for Fiscal Week 1 for Saturday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week = 'Sat') THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN Budget_Amount ELSE 0 END, 1000) ELSE NULL END) AS budget_amount_fy_week1_k_sat_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
budget_amount_fy_week1_k_sun_q1,budget_amount,Budget Amount FY Week 1 (Thousands) - Sunday (Q1 Context),"Total budget amount in thousands for Fiscal Week 1 for Sunday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week = 'Sun') THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN Budget_Amount ELSE 0 END, 1000) ELSE NULL END) AS budget_amount_fy_week1_k_sun_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_vs_budget_fy_week1_k_mf_q1,actual_vs_budget,Actual vs Budget FY Week 1 (Thousands) - Weekdays (Q1 Context),"Difference between Actual Amount and Budget Amount (both in thousands) for Fiscal Week 1, specifically for 'ALL SALES CHANNELS' and Monday-Friday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN (SAFE_DIVIDE(os.Actual_Amount, 1000) - CASE WHEN (os.os_level_7 = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN os.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END) AS actual_vs_budget_fy_week1_k_mf_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_vs_budget_fy_week1_k_sat_q1,actual_vs_budget,Actual vs Budget FY Week 1 (Thousands) - Saturday (Q1 Context),"Difference between Actual Amount and Budget Amount (both in thousands) for Fiscal Week 1, specifically for 'ALL SALES CHANNELS' and Saturday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week = 'Sat') THEN (SAFE_DIVIDE(os.Actual_Amount, 1000) - CASE WHEN (os.os_level_7 = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN os.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END) AS actual_vs_budget_fy_week1_k_sat_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_vs_budget_fy_week1_k_sun_q1,actual_vs_budget,Actual vs Budget FY Week 1 (Thousands) - Sunday (Q1 Context),"Difference between Actual Amount and Budget Amount (both in thousands) for Fiscal Week 1, specifically for 'ALL SALES CHANNELS' and Sunday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week = 'Sun') THEN (SAFE_DIVIDE(os.Actual_Amount, 1000) - CASE WHEN (os.os_level_7 = 'ALL SALES CHANNELS') THEN SAFE_DIVIDE(CASE WHEN (fy_week_of_year = 1) THEN os.Budget_Amount ELSE 0 END, 1000) ELSE NULL END) ELSE NULL END) AS actual_vs_budget_fy_week1_k_sun_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
volume_k_mf_q1,volume,Volume (Thousands) - Weekdays (Q1 Context),"Total volume in thousands for Monday-Friday, filtered by specific retail sales channels and fiscal week 202601, within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(CASE WHEN (os.day_of_week IN ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Weekday Entry')) THEN SAFE_DIVIDE(os.volume, 1000) ELSE NULL END) AS volume_k_mf_q1
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      (os_level_10 = 'Convenience Stores / Service Stations' OR os_level_10 = 'Supermarkets' OR os_level_10 = 'Newsagencies')
      AND fy_year_week_number = 202601
  )",measure,false,medium,29,2104a3f5-9424-4087-a928-e67fecae789a
actual_amount_q2,actual_amount,Actual Amount (Q2 Context),"Total actual revenue/amount, filtered by fiscal year 2026, excluding specific publications ('Weekly Times', 'Sunshine Coast', 'Mackay'), and for 'All Sales Channels', within the FY2025 hierarchy. This metric represents the raw actual amount.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(Actual_Amount) AS actual_amount_q2
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      fy_year = 2026
      AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
      AND os_level_7 = 'All Sales Channels'
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
volume_q2,volume,Volume (Q2 Context),"Total volume, filtered by fiscal year 2026, excluding specific publications ('Weekly Times', 'Sunshine Coast', 'Mackay'), and for 'All Sales Channels', within the FY2025 hierarchy.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH
  OSandFACT_Base AS (
    SELECT
      os.Actual_Amount,
      os.Budget_Amount,
      os.Forecast_Amount,
      os.Last_Year_Actual_Amount,
      os.volume,
      os.os_level_10,
      os.os_level_7,
      os.os_level_6,
      os.gl_publication_code,
      pub.l04_publication_code,
      pub.l06_publication_code,
      os.gl_hierarchy_code,
      calendar.fy_week_of_year,
      calendar.fy_year_week_number,
      os.day_of_week,
      pub.publication_name,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SUM(volume) AS volume_q2
FROM
  OSandFACT_Base
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
  AND (
      fy_year = 2026
      AND publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay')
      AND os_level_7 = 'All Sales Channels'
  )",measure,true,high,29,2104a3f5-9424-4087-a928-e67fecae789a
gross_revenue,gross_revenue,Gross Revenue,The total gross revenue amount recorded for a given period or dimension.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  SUM(SAFE_CAST(main.gross_revenue_amount AS BIGNUMERIC)) AS gross_revenue
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
LIMIT 1;",measure,True,high,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
current_fy_gross_revenue,gross_revenue,Current Financial Year Gross Revenue,The gross revenue amount for the current financial year (relative_fy_year_offset = 0).,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  SUM(CASE WHEN SAFE_CAST(main.relative_fy_year_offset AS INT64) = 0 THEN SAFE_CAST(main.gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) AS current_fy_gross_revenue
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
LIMIT 1;",measure,True,high,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
previous_fy_gross_revenue,gross_revenue,Previous Financial Year Gross Revenue,The gross revenue amount for the previous financial year (relative_fy_year_offset = -1).,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  SUM(CASE WHEN SAFE_CAST(main.relative_fy_year_offset AS INT64) = -1 THEN SAFE_CAST(main.gross_revenue_amount AS BIGNUMERIC) ELSE 0 END) AS previous_fy_gross_revenue
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
LIMIT 1;",measure,False,medium,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
total_target,total_target,Total Target,The total target amount set for sales teams or revenue types.,ncau-data-newsquery-prd,sbx_dcp,Progo_Streaming_Tgt,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  SUM(SAFE_CAST(main.Target AS BIGNUMERIC)) AS total_target
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
LIMIT 1;",measure,True,high,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
rev_type,rev_type,Revenue Type,"Categorization of revenue based on publication name or ad type (e.g., 'TUBI', 'VIDEO', 'OTHER').",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"SELECT
  CASE
    WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
    WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
    ELSE 'OTHER'
  END AS Rev_Type
FROM
  `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
GROUP BY 1
LIMIT 10;",dimension,False,medium,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
team,team,Team,The sales or reporting team associated with the revenue or target.,ncau-data-newsquery-prd,sbx_dcp,Progo_Streaming_Tgt,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group AND temp.financial_month = CAST(tgt_1.Month_Num AS STRING)
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt AS tgt_2
    WHERE
      Type IS NOT null
  )
SELECT
  main.Team
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
WHERE
  main.Rev_Type IN ('VIDEO', 'TUBI')
GROUP BY
  main.Team
LIMIT 10;",dimension,False,medium,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
advertiser_group,advertiser_group,Advertiser Group,The group to which an advertiser belongs.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.advertiser_group
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
WHERE
  main.Rev_Type IN ('VIDEO', 'TUBI') AND main.Target_team_flag = 'Target Only'
GROUP BY
  main.advertiser_group
LIMIT 10;",dimension,False,low,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
portfolio_parent_group_name_sync,portfolio_parent_group_name_sync,Portfolio Parent Group Name (Sync),The synchronized parent group name for a portfolio.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.portfolio_parent_group_name_sync
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
WHERE
  main.Rev_Type IN ('VIDEO', 'TUBI') AND main.Target_team_flag = 'Target Only'
GROUP BY
  main.portfolio_parent_group_name_sync
LIMIT 10;",dimension,False,low,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
unified_publication_name,unified_publication_name,Unified Publication Name,The standardized name of the publication.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.unified_publication_name
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
WHERE
  main.Rev_Type IN ('VIDEO', 'TUBI') AND main.Target_team_flag = 'Target Only'
GROUP BY
  main.unified_publication_name
LIMIT 10;",dimension,False,low,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
target_team_flag,target_team_flag,Target Team Flag,Indicates if a team is a 'Target Only' team or 'Non-Target Team' based on its presence in the team_list.,ncau-data-newsquery-prd,sbx_dcp,Progo_Streaming_Tgt,"WITH
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      Team
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
    UNION ALL
    SELECT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.Progo_Streaming_Tgt
    WHERE
      Type IS NOT null
  )
SELECT
  CASE
    WHEN team_list.Team IS NOT null THEN 'Target Only'
    ELSE 'Non-Target Team'
  END AS Target_team_flag
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
GROUP BY 1
LIMIT 10;",dimension,False,medium,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
advertiser_parent,advertiser_parent,Advertiser Parent,The parent company or entity of an advertiser.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,"WITH
  temp AS (
    SELECT
      *,
      CASE
        WHEN unified_publication_name LIKE 'TUBI%' THEN 'TUBI'
        WHEN `LEFT`(upper(fin_adtype_name), 5) = 'VIDEO' THEN 'VIDEO'
        ELSE 'OTHER'
      END AS Rev_Type
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.details_dashboard
  ),
  team_list AS (
    SELECT DISTINCT
      Team
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming
    WHERE
      Type IS NOT null
  ),
  main AS (
    SELECT
      temp.*,
      tgt_1.Team,
      null AS Target,
      'Data' AS source
    FROM
      temp
      LEFT JOIN
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_1
      ON temp.portfolio_group_name_sync = tgt_1.Portfolio_Group
    UNION ALL
    SELECT
      null AS source_system_code, null AS sales_segment_gm_name_sync, null AS current_portfolio_group_owner_full_name_sync, null AS current_portfolio_conformed_owner_full_name_sync, null AS current_portfolio_group_owner_full, null AS current_portfolio_conformed_owner_full, null AS publisher_vertical, null AS data_load_datetime, null AS relative_day_offset, null AS sales_segment_gm_name, null AS nca_industry_pillar, null AS revenue_type, null AS revenue_group_subtype, null AS fin_adtype_name, null AS cost_model_type, null AS xtend_flag, null AS adsize_name, null AS pos_page_achieved, null AS account_number, null AS advertiser_name, null AS advertiser_group, null AS advertiser_parent, null AS crm_account_number, null AS agency_name, null AS agency_group, null AS agency_parent, null AS booking_number, null AS booking_name, null AS booking_line_number, null AS booking_line_created_date, null AS insertion_name, null AS sort_caption, null AS classification_name, null AS reporting_date, null AS portfolio_group_name_current, null AS portfolio_conformed_name_current, null AS portfolio_parent_group_name_current, null AS portfolio_group_name_sync, null AS portfolio_conformed_name_sync, null AS portfolio_parent_group_name_sync, null AS unified_publication_name, null AS employee_name, null AS financial_year,
      CASE Month_Num WHEN 1 THEN '1' WHEN 2 THEN '1' WHEN 3 THEN '1' WHEN 4 THEN '2' WHEN 5 THEN '2' WHEN 6 THEN '2' WHEN 7 THEN '3' WHEN 8 THEN '3' WHEN 9 THEN '3' WHEN 10 THEN '4' WHEN 11 THEN '4' WHEN 12 THEN '4' END AS financial_quarter,
      null AS financial_week,
      CAST(tgt_2.Month_Num AS string) AS financial_month,
      CASE Month_Num WHEN 1 THEN 'Jul' WHEN 2 THEN 'Aug' WHEN 3 THEN 'Sep' WHEN 4 THEN 'Oct' WHEN 5 THEN 'Nov' WHEN 6 THEN 'Dec' WHEN 7 THEN 'Jan' WHEN 8 THEN 'Feb' WHEN 9 THEN 'Mar' WHEN 10 THEN 'Apr' WHEN 11 THEN 'May' WHEN 12 THEN 'Jun' END AS financial_short_month,
      null AS relative_fy_year_offset, null AS relative_fy_month_offset, null AS relative_cal_year_offset, null AS calendar_year, null AS calendar_week, null AS calendar_month, null AS calendar_month_short_name, null AS dow, null AS revenue_group_level_2_name, null AS publication_date, null AS revenue_category, null AS publishing_division_group, null AS adpoint_account_number, null AS FPE, null AS gross_revenue_amount, null AS gross_revenue_ex_adj_amount, null AS adjustment_amount, null AS col_cms_finance, null AS system_price_amount, null AS gross_less_agency_commission_amount, null AS dw_asl_load_timestamp,
      tgt_2.Type AS Rev_Type,
      tgt_2.Team AS Team,
      tgt_2.Target AS Target,
      'Rep Target' AS source
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.progo_target_streaming AS tgt_2
    WHERE
      Month_Num IS NOT null
  )
SELECT
  main.advertiser_parent
FROM
  main
  LEFT JOIN
  team_list
  ON main.Team = team_list.Team
WHERE
  main.Rev_Type IN ('VIDEO', 'TUBI') AND main.Target_team_flag = 'Target Only'
GROUP BY
  main.advertiser_parent
LIMIT 10;",dimension,False,low,30,9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588
gross_revenue_current_year,gross_revenue,Gross Revenue (Current Year),"Total gross revenue for the current fiscal year (relative_fy_year_offset = 0), excluding programmatic exchange revenue. This metric is derived from the 'ia' table.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_current_year FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,true,high,31,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_previous_year,gross_revenue,Gross Revenue (Previous Year),"Total gross revenue for the previous fiscal year (relative_fy_year_offset = -1), excluding programmatic exchange revenue. This metric is derived from the 'ia' table.",ncau-data-newsquery-prd,sbx_dcp,ia,SELECT SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_previous_year FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL,measure,true,high,31,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_revenue_prior_year_adjusted,gross_revenue,Gross Revenue (Prior Year Adjusted),"Gross revenue from the prior year, adjusted based on specific date and fiscal month offsets. This metric captures revenue from more than 12 months ago or from the previous year, depending on complex date logic involving `relative_fy_month_offset` and `booking_line_created_date` relative to a hardcoded 'current date' minus 365 days. Excludes programmatic exchange revenue.",ncau-data-newsquery-prd,sbx_dcp,ia,"SELECT SUM(CASE WHEN t0.relative_fy_month_offset < -12 THEN (CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) ELSE (CASE WHEN (t0.relative_fy_year_offset = -1 AND SAFE_CAST(t0.booking_line_created_date AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-05-23 01:19:32.916346+00', 'Australia/Sydney'), INTERVAL -365 DAY)) THEN t0.gross_revenue_amount ELSE 0 END) END) AS gross_revenue_prior_year_adjusted FROM `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0 WHERE t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL",measure,false,medium,31,fed70b12-c274-4cde-9920-592ca4c4dab0
gross_amount_difference,gross_amount_difference,Gross Amount Difference,"The difference in gross amounts, excluding data from the current financial week (where `movement_financial_week` equals `min_week`). This metric is derived from the 'revenue_movement' table.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(t0.GROSS_AMOUNT_DIFF) AS gross_amount_difference FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0 WHERE NOT (SAFE_CAST(t0.movement_financial_week AS INT64) = SAFE_CAST(t0.min_week AS INT64)),measure,true,high,31,fed70b12-c274-4cde-9920-592ca4c4dab0
closing_base_sunday_latest_week,closing_base,Closing Base (Sunday Flag 'Y') - Latest Week of Year,"The total subscription count for the latest fiscal week of each fiscal year, specifically for subscriptions marked with a 'Sunday' flag. Filtered for 'Standard Paid', 'Other Paid', 'Offplatform - Paid' classifications and 'Digital' or 'Bundle' delivery medium types.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  SUM(CASE WHEN bma.sunday_flag = 'Y' THEN bma.subscription_count ELSE NULL END) AS closing_base_sunday_latest_week
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_consumer_views.v_customer_segment_mapping` AS customer
  ON bma.classification_level_1 = customer.classification_level_1 AND bma.classification_level_2 = customer.classification_level_2
WHERE
  bma.fy_year >= 2012
  AND bma.fy_year <= 2024
  AND bma.classification_level_1 IN ('Standard Paid', 'Other Paid', 'Offplatform - Paid')
  AND CAST(bma.fy_year AS STRING) || CAST(bma.fy_week_of_year AS STRING) IN (
    SELECT
      CAST(fy_year AS STRING) || CAST(MAX(fy_week_of_year) AS STRING)
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg`
    GROUP BY fy_year
  )
  AND bma.delivery_medium_type IN ('Digital', 'Bundle')",measure,True,high,32,d828e66e-2476-4e31-91af-3a202a45f99d
acquisition_count_latest_week,acquisition_count,Acquisition Count - Latest Week of Year,"The total count of acquisitions for the latest fiscal week of each fiscal year. Filtered for 'Standard Paid', 'Other Paid', 'Offplatform - Paid' classifications and 'Digital' or 'Bundle' delivery medium types.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  SUM(bma.acquisition_count) AS acquisition_count_latest_week
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_consumer_views.v_customer_segment_mapping` AS customer
  ON bma.classification_level_1 = customer.classification_level_1 AND bma.classification_level_2 = customer.classification_level_2
WHERE
  bma.fy_year >= 2012
  AND bma.fy_year <= 2024
  AND bma.classification_level_1 IN ('Standard Paid', 'Other Paid', 'Offplatform - Paid')
  AND CAST(bma.fy_year AS STRING) || CAST(bma.fy_week_of_year AS STRING) IN (
    SELECT
      CAST(fy_year AS STRING) || CAST(MAX(fy_week_of_year) AS STRING)
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg`
    GROUP BY fy_year
  )
  AND bma.delivery_medium_type IN ('Digital', 'Bundle')",measure,True,high,32,d828e66e-2476-4e31-91af-3a202a45f99d
acquisition_count_full_year,acquisition_count,Acquisition Count - Full Year,"The total count of acquisitions for all weeks within each fiscal year. Filtered for 'Standard Paid', 'Other Paid', 'Offplatform - Paid' classifications and 'Digital' or 'Bundle' delivery medium types.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  SUM(bma.acquisition_count) AS acquisition_count_full_year
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_consumer_views.v_customer_segment_mapping` AS customer
  ON bma.classification_level_1 = customer.classification_level_1 AND bma.classification_level_2 = customer.classification_level_2
WHERE
  bma.fy_year >= 2012
  AND bma.fy_year <= 2024
  AND bma.classification_level_1 IN ('Standard Paid', 'Other Paid', 'Offplatform - Paid')
  AND bma.delivery_medium_type IN ('Digital', 'Bundle')",measure,True,high,32,d828e66e-2476-4e31-91af-3a202a45f99d
product_dimension_consumer_view,product_dimension,Product Dimension (Consumer View),"Categorization of products based on customer segment, masthead, billing system, classification levels, and delivery medium/schedule. Used for consumer-centric reporting.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  CASE
    WHEN customer.customer_segment_group = 'B2B' THEN customer.customer_segment
    WHEN bma.masthead = 'AP' THEN 'Apple Podcast: Crime X'
    WHEN bma.masthead = 'CS' THEN 'Code'
    WHEN bma.masthead = 'PU' THEN 'Punters'
    WHEN bma.masthead = 'RN' THEN 'Racenet'
    WHEN bma.masthead = 'SC' THEN 'SuperCoach'
    WHEN bma.masthead = 'TS' THEN 'Taste Online'
    WHEN bma.dw_billing_system_code = 'WINE' THEN 'Wine Club'
    WHEN bma.classification_level_1 = 'Offplatform - Paid' THEN '3rd Party and Other'
    WHEN customer.customer_segment_group = 'B2C' THEN
    CASE
      WHEN bma.classification_level_2 = 'Essentials' THEN 'Essentials'
      WHEN bma.delivery_medium_type = 'Digital' THEN 'Digital'
      ELSE CONCAT(bma.delivery_medium_type, ' ',
        CASE
          WHEN bma.delivery_schedule_group IN ('budgetforecast', 'budgetforecast_grosscan', 'budgetforecast_netacq',
            'budgetforecast_netcan', 'nfmanualhist', 'Not Available', 'shadowbudget') THEN bma.delivery_schedule_group
          WHEN bma.delivery_schedule_group IN ('Weekend (1 Day)', 'Weekend (2 Days)') THEN 'Weekend'
          WHEN bma.delivery_schedule_group IN ('6 Days', '7 Days', 'Weekday (1 Day)', 'Weekday (1 Day) & Weekend (1 Day)',
            'Weekday (1 Day) & Weekend (2 Days)', 'Weekday (2 Days) & Weekend (2 Days)', 'Weekday (5 Days)', 'Weekday (2 Days) & Weekend (1 Day)',
            'Weekday (3 Days) & Weekend (1 Day)') THEN '7 Day'
          ELSE NULL
        END)
    END
    WHEN customer.customer_segment = 'Education' THEN customer.customer_segment
    ELSE customer.customer_segment
  END AS Product_Dimension
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_consumer_views.v_customer_segment_mapping` AS customer
  ON bma.classification_level_1 = customer.classification_level_1 AND bma.classification_level_2 = customer.classification_level_2
LIMIT 1",dimension,False,medium,32,d828e66e-2476-4e31-91af-3a202a45f99d
masthead_grouping_consumer_view,masthead_grouping,Masthead Grouping (Consumer View),"Categorization of mastheads into groups like 'The Australian', 'Metro', 'Regional', 'Others', 'Deep Niche Publications', or 'Discontinued/Excluded'.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  CASE
    WHEN bma.masthead = 'TA' THEN 'The Australian'
    WHEN bma.masthead IN ('AA', 'CM', 'DT', 'HS') THEN 'Metro'
    WHEN bma.masthead IN ('CP', 'GA', 'GC', 'NT', 'TB', 'TC', 'TM') THEN 'Regional'
    WHEN bma.masthead = 'WT' THEN 'Others'
    WHEN bma.masthead IN ('AP', 'CS', 'PU', 'RN', 'SC', 'TS') THEN 'Deep Niche Publications'
    ELSE 'Discontinued/Excluded'
  END AS Masthead_Grouping
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
LIMIT 1",dimension,False,medium,32,d828e66e-2476-4e31-91af-3a202a45f99d
product_grouping_finance_view,product_grouping,Product Grouping (Finance View),"High-level categorization of products for finance reporting, grouping into 'Consumer', 'B2B', or 'Deep Niche Products'. This dimension is derived from a complex set of conditions across multiple finance-related tables (v_subscription_snapshot_fct, v_subscription_budget_forecast_fct, digital_subscriptions). The 'derived_product_name' in the subquery represents an intermediate product classification.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT
  CASE
    WHEN (derived_product_name IN ('Digital', 'Essentials', 'Bundle 7 Day', 'Bundle Weekend', '3rd Party & Others')) THEN 'Consumer'
    WHEN (derived_product_name IN ('Campus', 'Corporate IP', 'Corporate excluding IP')) THEN 'B2B'
    WHEN (derived_product_name IN ('Supercoach Plus', 'Code', 'Taste Online', 'Apple Podcast: Crime X', 'Education', 'Wine Club', 'Racenet', 'Punters', 'Others')) THEN 'Deep Niche Products'
    ELSE NULL
  END AS Product_Grouping_Finance
FROM (
  SELECT
    CASE
      WHEN SAFE_CAST(t0.delivery_medium_type AS STRING) = 'Digital' THEN 'Digital'
      WHEN SAFE_CAST(t0.classification_level_2_description AS STRING) = 'Essentials' THEN 'Essentials'
      WHEN SAFE_CAST(t0.classification_level_1_description AS STRING) = 'Offplatform - Paid' THEN '3rd Party & Others'
      WHEN SAFE_CAST(t0.customer_segment AS STRING) = 'Education' THEN 'Education'
      WHEN SAFE_CAST(t0.dw_billing_system_code AS STRING) = 'WINE' THEN 'Wine Club'
      WHEN SAFE_CAST(t0.masthead_code AS STRING) = 'CS' THEN 'Code'
      WHEN SAFE_CAST(t0.rate_plan_group_name AS STRING) = 'Corporate' THEN 'Corporate excluding IP'
      ELSE 'Other' -- Placeholder for other complex derivations
    END AS derived_product_name
  FROM
    `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
  WHERE
    t0.fy_year = 2023
  LIMIT 1
) AS subquery_for_derived_product_name
LIMIT 1",dimension,False,high,32,d828e66e-2476-4e31-91af-3a202a45f99d
fy_year_dimension,fy_year,Fiscal Year,The fiscal year dimension.,ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,SELECT SAFE_CAST(fy_year AS INT64) AS fy_year FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` LIMIT 1,dimension,False,low,32,d828e66e-2476-4e31-91af-3a202a45f99d
delivery_medium_type_dimension,delivery_medium_type,Delivery Medium Type,"The type of delivery medium for subscriptions (e.g., Digital, Bundle, Print).",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,SELECT SAFE_CAST(delivery_medium_type AS STRING) AS delivery_medium_type FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` LIMIT 1,dimension,False,low,32,d828e66e-2476-4e31-91af-3a202a45f99d
fy_year_sum_artifact,fy_year_sum,Fiscal Year Sum (Looker Studio Artifact),"An unusual metric that sums the fiscal year. This is likely a Looker Studio artifact or misconfiguration, as summing years typically doesn't yield a meaningful business value.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  SUM(bma.fy_year) AS fy_year_sum_artifact
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
WHERE
  bma.fy_year >= 2012
  AND bma.fy_year <= 2024
  AND bma.classification_level_1 IN ('Standard Paid', 'Other Paid', 'Offplatform - Paid')
  AND CAST(bma.fy_year AS STRING) || CAST(bma.fy_week_of_year AS STRING) IN (
    SELECT
      CAST(fy_year AS STRING) || CAST(MAX(fy_week_of_year) AS STRING)
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg`
    GROUP BY fy_year
  )
  AND bma.delivery_medium_type IN ('Digital', 'Bundle')",measure,False,low,32,d828e66e-2476-4e31-91af-3a202a45f99d
fy_year_count_artifact,fy_year_count,Fiscal Year Count (Looker Studio Artifact),"An unusual metric that counts the fiscal year. This is likely a Looker Studio artifact or misconfiguration, as counting years typically doesn't yield a meaningful business value, unless it's counting distinct years.",ncau-data-newsquery-prd,prstn_consumer_views,v_subscription_base_movement_agg,"SELECT
  COUNT(bma.fy_year) AS fy_year_count_artifact
FROM
  `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg` AS bma
WHERE
  bma.fy_year >= 2012
  AND bma.fy_year <= 2024
  AND bma.classification_level_1 IN ('Standard Paid', 'Other Paid', 'Offplatform - Paid')
  AND CAST(bma.fy_year AS STRING) || CAST(bma.fy_week_of_year AS STRING) IN (
    SELECT
      CAST(fy_year AS STRING) || CAST(MAX(fy_week_of_year) AS STRING)
    FROM
      `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg`
    GROUP BY fy_year
  )
  AND bma.delivery_medium_type IN ('Digital', 'Bundle')",measure,False,low,32,d828e66e-2476-4e31-91af-3a202a45f99d
advertiser_name_dim,advertiser_name,Advertiser Name,The name of the advertiser associated with the booking.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SAFE_CAST(t0.advertiser_name AS STRING) AS advertiser_name FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,dimension,False,medium,33,70ed3b92-987b-479b-9ed7-d2903bd2787e
booking_number_dim,booking_number,Booking Number,Unique identifier for a specific booking.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SAFE_CAST(t0.booking_number AS STRING) AS booking_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,dimension,False,medium,33,70ed3b92-987b-479b-9ed7-d2903bd2787e
calendar_period_derived,period_type,Period Type (Calendar),"A derived field indicating the period type is 'Calendar Period', based on a hardcoded value.",ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT CASE WHEN ('Cal' = 'Cal') THEN 'Calendar Period' ELSE NULL END AS period_type FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,calculated_field,False,low,33,70ed3b92-987b-479b-9ed7-d2903bd2787e
dw_asl_load_timestamp_dim,load_timestamp,Data Warehouse Load Timestamp,Timestamp when the data was loaded into the data warehouse.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SAFE_CAST(t0.dw_asl_load_timestamp AS TIMESTAMP) AS dw_asl_load_timestamp FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,dimension,False,low,33,70ed3b92-987b-479b-9ed7-d2903bd2787e
account_number_dim,account_number,Account Number,The account number associated with the advertiser.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SAFE_CAST(t0.account_number AS STRING) AS account_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,dimension,False,medium,33,70ed3b92-987b-479b-9ed7-d2903bd2787e
crm_account_number_dim,crm_account_number,CRM Account Number,The CRM account number associated with the advertiser.,ncau-data-newsquery-prd,asl_finance_derived,details_dashboard,SELECT SAFE_CAST(t0.crm_account_number AS STRING) AS crm_account_number FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0,dimension,False,medium,33,70ed3b92-987b-479b-9ed7-d2903bd2787e
gross_revenue_amount_digital_adpt_billed_booked_guaranteed_2024,total_gross_revenue,"Gross Revenue (Digital, ADPT, Billed/Booked, Guaranteed, 2024)","Total gross revenue for digital revenue type from ADPT source system, with transaction status billed or booked, for guaranteed cost model type in calendar year 2024, excluding 'Medium Rare Content Agency' publishing division.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(gross_revenue_amount) AS gross_revenue_amount
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
  AND source_publishing_division != 'Medium Rare Content Agency'
  AND SAFE_CAST(calendar_year AS STRING) IN ('2024')
  AND cost_model_type IN ('Guaranteed');",measure,true,high,34,38809f41-7138-4b94-94d1-ae919b2d9517
agency_commission_amount_digital_adpt_billed_booked_guaranteed_2024,total_agency_commission,"Agency Commission (Digital, ADPT, Billed/Booked, Guaranteed, 2024)","Total agency commission for digital revenue type from ADPT source system, with transaction status billed or booked, for guaranteed cost model type in calendar year 2024, excluding 'Medium Rare Content Agency' publishing division.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  SUM(agency_commission_amount) AS agency_commission_amount
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND record_type_code = 'STD'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
  AND source_publishing_division != 'Medium Rare Content Agency'
  AND SAFE_CAST(calendar_year AS STRING) IN ('2024')
  AND cost_model_type IN ('Guaranteed');",measure,true,high,34,38809f41-7138-4b94-94d1-ae919b2d9517
data_load_datetime_dimension,data_load_datetime,Data Load Datetime,"Timestamp indicating when the data was loaded, often used for time-series analysis or data freshness checks.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT DATETIME_TRUNC(data_load_datetime, SECOND) AS data_load_datetime
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY data_load_datetime DESC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
calendar_year_dimension,calendar_year,Calendar Year,"The calendar year of the transaction, used for filtering and grouping.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT calendar_year
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY calendar_year ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
financial_year_dimension,financial_year,Financial Year,"The financial year of the transaction, used for filtering and grouping.",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT financial_year
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY financial_year ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
revenue_transaction_status_dimension,revenue_transaction_status,Revenue Transaction Status,"The status of the revenue transaction (e.g., Billed, Booked).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT revenue_transaction_status
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY revenue_transaction_status ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
revenue_type_dimension,revenue_type,Revenue Type,"The type of revenue (e.g., Digital).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT revenue_type
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
ORDER BY revenue_type ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
source_system_code_dimension,source_system_code,Source System Code,"The code of the source system (e.g., ADPT).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT source_system_code
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND revenue_type = 'Digital'
ORDER BY source_system_code ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
record_type_code_dimension,record_type_code,Record Type Code,"The code indicating the type of record (e.g., STD).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT record_type_code
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY record_type_code ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
calendar_month_name_dimension,calendar_month_name,Calendar Month Name,"The full name of the calendar month (e.g., January).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT calendar_month_name
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY calendar_month_name ASC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
unified_publication_name_dimension,unified_publication_name,Unified Publication Name,The name of the unified publication.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT unified_publication_name
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY unified_publication_name ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
cost_model_type_dimension,cost_model_type,Cost Model Type,"The type of cost model (e.g., Guaranteed).",ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT cost_model_type
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY cost_model_type ASC
LIMIT 100;",dimension,false,medium,34,38809f41-7138-4b94-94d1-ae919b2d9517
advertiser_name_dimension,advertiser_name,Advertiser Name,The name of the advertiser.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT advertiser_name
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY advertiser_name ASC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
booking_line_number_dimension,booking_line_number,Booking Line Number,Unique identifier for a booking line item.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT booking_line_number
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY booking_line_number ASC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
booking_number_dimension,booking_number,Booking Number,Unique identifier for a booking.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT booking_number
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY booking_number ASC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
calendar_month_int_dimension,calendar_month,Calendar Month (Numeric),The numeric representation of the calendar month.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT SAFE_CAST(calendar_month AS INT64) AS calendar_month
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY calendar_month ASC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
source_publishing_division_dimension,source_publishing_division,Source Publishing Division,The publishing division from which the revenue originated.,ncau-data-newsquery-prd,asl_advertising,v_adsales_revenue_client,"SELECT
  DISTINCT source_publishing_division
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  SAFE_CAST(financial_year AS STRING) BETWEEN '2023' AND '2026'
  AND revenue_transaction_status IN ('Billed', 'Booked')
  AND source_system_code = 'ADPT'
  AND revenue_type = 'Digital'
ORDER BY source_publishing_division ASC
LIMIT 100;",dimension,false,low,34,38809f41-7138-4b94-94d1-ae919b2d9517
actual_amount_ytd_fy2025_wk46,actual_amount,Actual Amount (YTD FY2025 up to Week 46),"Total actual amount for fiscal year 2025 up to and including fiscal week 46, divided by 1000. This metric is filtered for 'CIRCULATION' related data, excluding 'Free News & Lifestyle', 'Food', and 'Prestige' publications, and specifically for FY2025.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    calendar.fy_year,
    calendar.fy_year_week_number
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(SAFE_DIVIDE(Actual_Amount, 1000))
FROM
  OSandFACT
WHERE
  fy_year = 2025 AND fy_year_week_number <= 202546;",measure,True,high,35,aca2f032-b796-49a2-89fe-781ca947aa33
actual_volume,actual_volume,Actual Volume,"Total actual volume, divided by 1000. This metric is filtered for 'CIRCULATION' related data, excluding 'Free News & Lifestyle', 'Food', and 'Prestige' publications, and specifically for FY2025.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(SAFE_DIVIDE(volume, 1000))
FROM
  OSandFACT;",measure,True,high,35,aca2f032-b796-49a2-89fe-781ca947aa33
actual_amount_current_week_filtered,actual_amount,"Actual Amount (Current Week, All Sales Channels, Specific Publication Groups)","Total actual amount for the current fiscal week (derived from '2025-05-28'), specifically for 'All Sales Channels' and excluding 'Other' publication groups. This metric is filtered for 'CIRCULATION' related data, excluding 'Free News & Lifestyle', 'Food', and 'Prestige' publications, and specifically for FY2025.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    calendar.fy_year_week_number,
    pub.publication_code,
    pub.publication_name
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(Actual_Amount)
FROM
  OSandFACT
WHERE
  os_level_7 = 'All Sales Channels'
  AND (CASE WHEN (publication_code = 'Post Courier') THEN 'PNG' ELSE publication_name END) NOT IN (
    'Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News',
    'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times',
    'Advertiser', 'Sunday Mail (SA)', 'The Australian', 'Courier Mail', 'Sunday Mail (QLD)',
    'The Daily Telegraph', 'The Sunday Telegraph', 'Herald Sun', 'Sunday Herald Sun'
  ) IS FALSE
  AND fy_year_week_number = ((2025 * 100) + DATETIME_DIFF(SAFE_CAST('2025-05-28' AS DATETIME), SAFE_CAST('2024-07-03' AS DATETIME), WEEK));",measure,True,high,35,aca2f032-b796-49a2-89fe-781ca947aa33
blended_amount_current_week_filtered,blended_amount,"Blended Amount (Actuals + Forecast) (Current Week, All Sales Channels, Specific Publication Groups)","A blended metric of Actuals and Forecast amounts for the current fiscal week (derived from '2025-05-28'), specifically for 'All Sales Channels' and excluding 'Other' publication groups. The blending logic is simplified to use Actuals for fiscal months 1-3 and Forecast for all subsequent months within the fiscal year. This metric is filtered for 'CIRCULATION' related data, excluding 'Free News & Lifestyle', 'Food', and 'Prestige' publications, and specifically for FY2025.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    calendar.fy_year_week_number,
    calendar.fy_month_of_year,
    pub.publication_code,
    pub.publication_name
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE WHEN fy_month_of_year < 4 THEN Actual_Amount ELSE Forecast_Amount END)
FROM
  OSandFACT
WHERE
  os_level_7 = 'All Sales Channels'
  AND (CASE WHEN (publication_code = 'Post Courier') THEN 'PNG' ELSE publication_name END) NOT IN (
    'Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News',
    'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times',
    'Advertiser', 'Sunday Mail (SA)', 'The Australian', 'Courier Mail', 'Sunday Mail (QLD)',
    'The Daily Telegraph', 'The Sunday Telegraph', 'Herald Sun', 'Sunday Herald Sun'
  ) IS FALSE
  AND fy_year_week_number = ((2025 * 100) + DATETIME_DIFF(SAFE_CAST('2025-05-28' AS DATETIME), SAFE_CAST('2024-07-03' AS DATETIME), WEEK));",measure,True,high,35,aca2f032-b796-49a2-89fe-781ca947aa33
blended_amount_all_sales_channels_current_week_filtered,blended_amount_all_sales_channels,"Blended Amount (Actuals + Forecast) for 'All Sales Channels' (Current Week, Specific Publication Groups)","A specific variation of the blended amount, explicitly calculating the sum of the blended amount only for 'All Sales Channels' within the metric's definition, in addition to the outer dashboard filters. Given the outer filters, this metric is functionally identical to 'Blended Amount (Actuals + Forecast) (Current Week, All Sales Channels, Specific Publication Groups)'. This metric is filtered for 'CIRCULATION' related data, excluding 'Free News & Lifestyle', 'Food', and 'Prestige' publications, and specifically for FY2025.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"WITH OSandFACT AS (
  SELECT
    os.*,
    calendar.fy_year_week_number,
    calendar.fy_month_of_year,
    pub.publication_code,
    pub.publication_name
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  SUM(CASE WHEN os_level_7 = 'All Sales Channels' THEN (CASE WHEN fy_month_of_year < 4 THEN Actual_Amount ELSE Forecast_Amount END) ELSE 0 END)
FROM
  OSandFACT
WHERE
  os_level_7 = 'All Sales Channels'
  AND (CASE WHEN (publication_code = 'Post Courier') THEN 'PNG' ELSE publication_name END) NOT IN (
    'Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News',
    'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times',
    'Advertiser', 'Sunday Mail (SA)', 'The Australian', 'Courier Mail', 'Sunday Mail (QLD)',
    'The Daily Telegraph', 'The Sunday Telegraph', 'Herald Sun', 'Sunday Herald Sun'
  ) IS FALSE
  AND fy_year_week_number = ((2025 * 100) + DATETIME_DIFF(SAFE_CAST('2025-05-28' AS DATETIME), SAFE_CAST('2024-07-03' AS DATETIME), WEEK));",measure,False,medium,35,aca2f032-b796-49a2-89fe-781ca947aa33
gross_amount_diff_total,gross_amount_diff,Total Gross Amount Difference,"The total difference in gross amount for revenue movements, representing the core financial value.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(t0.GROSS_AMOUNT_DIFF) FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,measure,True,high,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_digital,gross_amount_diff,Gross Amount Diff - Digital Revenue,The total gross amount difference specifically for revenue movements categorized as 'DIGITAL' revenue type.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(CASE WHEN t0.revenue_type = 'DIGITAL' THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,measure,False,medium,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
gross_amount_diff_print,gross_amount_diff,Gross Amount Diff - Print Revenue,The total gross amount difference specifically for revenue movements categorized as 'PRINT' revenue type.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT SUM(CASE WHEN t0.revenue_type = 'PRINT' THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,measure,False,medium,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_revenue_category,revenue_category,Revenue Category,"A categorized grouping of revenue based on xtend flag, programmatic indicators, digital sub-type, or sundry classification. This is a derived dimension.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,"SELECT CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' WHEN ((SAFE.LEFT(t0.revenue_sub_type, 3) = 'PRO') OR ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_sub_type = 'DIGITAL'))) THEN 'PROGRAMMATIC' WHEN (t0.revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL' WHEN (SAFE.LEFT(t0.revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY' ELSE t0.revenue_sub_type END AS revenue_category FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0",calculated_field,False,medium,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_advertiser_group_cleaned,advertiser_group_cleaned,Advertiser Group (Cleaned),"The advertiser group, with NULL values replaced by 'Nah' for consistent reporting. This is a derived dimension.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT CASE WHEN (t0.advertiser_group IS NULL) THEN 'Nah' ELSE t0.advertiser_group END AS advertiser_group_cleaned FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,calculated_field,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_movement_date_parsed,movement_date_parsed,Movement Date (Parsed),"The movement date parsed from financial year and short month, assuming the first day of the month. This is a derived date dimension.",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,"SELECT PARSE_DATE('%Y-%b-%d', CONCAT(SAFE_CAST(t0.financial_year AS STRING),'-',SAFE_CAST(t0.financial_short_month AS STRING),'-1')) AS movement_date_parsed FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0",calculated_field,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_advertiser_parent,advertiser_parent,Advertiser Parent,The parent advertiser entity.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.advertiser_parent FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_booking_line_id,booking_line_id,Booking Line ID,Unique identifier for a booking line item.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.booking_line_id FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_booking_number,booking_number,Booking Number,Identifier for the overall booking.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.booking_number FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_movement_date,movement_date,Movement Date,The date of the revenue movement.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.movement_date FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_portfolio_group_name_sync,portfolio_group_name_sync,Portfolio Group Name (Sync),Synchronized name of the portfolio group.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.portfolio_group_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_portfolio_parent_group_name_sync,portfolio_parent_group_name_sync,Portfolio Parent Group Name (Sync),Synchronized name of the parent portfolio group.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.portfolio_parent_group_name_sync FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_revenue_type,revenue_type,Revenue Type,"The type of revenue (e.g., DIGITAL, PRINT).",ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.revenue_type FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
dim_publishing_division_group,publishing_division_group,Publishing Division Group,The group associated with the publishing division.,ncau-data-newsquery-prd,asl_finance_derived,revenue_movement,SELECT t0.publishing_division_group FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0,dimension,False,low,36,a1b901e6-c4fb-44bc-955a-3a7070c15829
total_budget_amount_fy2025_news_media_pub_wk4_rev_exp,total_budget_amount,"Total Budget Amount for FY2025 News Media Publishing (Week 4, Revenue/Expenses)","Aggregated budget amount for fiscal year 2025, specifically for 'News Media Publishing' within 'Total Revenue' or 'Total Expenses' categories, for fiscal week 4.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t0.Budget_Amount) AS total_budget_amount
FROM
  (
    WITH
      OSandFACT AS (
        SELECT
          os.Budget_Amount,
          calendar.fy_week_of_year,
          calendar.fy_year,
          pub.is_print_digital_flag,
          pub.l03_publication_code,
          pub.l12_publication_code,
          os.os_level_4,
          os.os_level_5,
          os.os_level_6,
          os.publication_name
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
          LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
          LEFT JOIN (
            SELECT DISTINCT
              CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
              CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
              CAST(c.fy_first_day_of_week AS date) AS fy_first_day_of_week,
              CAST(c.fy_last_day_of_week AS date) AS fy_last_day_of_week,
              CAST(c.fy_month_of_year AS int) AS fy_month_of_year,
              CAST(c.fy_year_month_number AS int) AS fy_year_month_number,
              CAST(c.relative_fisc_year_number AS int) AS relative_fisc_year_number,
              CAST(c.relative_fisc_week_number AS int) AS relative_fisc_week_number,
              c.fy_month_of_year_short_name,
              CASE
                WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y'
                ELSE 'N'
              END AS month_end_flag,
              CAST(c.fy_quarter_of_year AS int) AS fy_quarter_of_year,
              CAST(c.fy_year AS int) AS fy_year,
              `current_timestamp`() AS extract_time
            FROM
              `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
              JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
            WHERE
              1 = 1
          ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
          LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
      )
    SELECT
      OSandFACT.Budget_Amount,
      OSandFACT.fy_week_of_year,
      OSandFACT.fy_year AS gl_hierarchy_code_alias,
      OSandFACT.is_print_digital_flag,
      OSandFACT.l03_publication_code,
      OSandFACT.l12_publication_code,
      OSandFACT.os_level_4,
      OSandFACT.os_level_5,
      OSandFACT.os_level_6,
      OSandFACT.publication_name
    FROM
      OSandFACT
  ) AS t0
WHERE
  SAFE_CAST(t0.gl_hierarchy_code_alias AS STRING) = 'FY2025'
  AND SAFE_CAST(t0.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(t0.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(t0.fy_week_of_year AS INT64) IN (4)
LIMIT 1",measure,True,high,37,b1c5901f-a535-42eb-870d-05cc025f7c27
total_actual_amount_fy2025_rev_exp_wk40,total_actual_amount,"Total Actual Amount for FY2025 (Week 40, Revenue/Expenses)","Aggregated actual amount for fiscal year 2025, specifically for 'Total Revenue' or 'Total Expenses' categories, for fiscal week 40.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(t0.Actual_Amount) AS total_actual_amount
FROM
  (
    WITH
      OSandFACT AS (
        SELECT
          os.Actual_Amount,
          calendar.fy_week_of_year,
          calendar.fy_year,
          pub.is_print_digital_flag,
          pub.l12_publication_code,
          os.os_level_4,
          os.os_level_5,
          os.os_level_9,
          os.publication_name
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
          LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
          LEFT JOIN (
            SELECT DISTINCT
              CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
              CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
              CAST(c.fy_first_day_of_week AS date) AS fy_first_day_of_week,
              CAST(c.fy_last_day_of_week AS date) AS fy_last_day_of_week,
              CAST(c.fy_month_of_year AS int) AS fy_month_of_year,
              CAST(c.fy_year_month_number AS int) AS fy_year_month_number,
              CAST(c.relative_fisc_year_number AS int) AS relative_fisc_year_number,
              CAST(c.relative_fisc_week_number AS int) AS relative_fisc_week_number,
              c.fy_month_of_year_short_name,
              CASE
                WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y'
                ELSE 'N'
              END AS month_end_flag,
              CAST(c.fy_quarter_of_year AS int) AS fy_quarter_of_year,
              CAST(c.fy_year AS int) AS fy_year,
              `current_timestamp`() AS extract_time
            FROM
              `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
              JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
            WHERE
              1 = 1
          ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
          LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep ON os.os_level_12 = dep.department_code
      )
    SELECT
      OSandFACT.Actual_Amount,
      OSandFACT.fy_week_of_year,
      OSandFACT.fy_year AS gl_hierarchy_code_alias,
      OSandFACT.is_print_digital_flag,
      OSandFACT.l12_publication_code,
      OSandFACT.os_level_4,
      OSandFACT.os_level_5,
      OSandFACT.os_level_9,
      OSandFACT.publication_name
    FROM
      OSandFACT
  ) AS t0
WHERE
  SAFE_CAST(t0.gl_hierarchy_code_alias AS STRING) = 'FY2025'
  AND SAFE_CAST(t0.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(t0.fy_week_of_year AS INT64) IN (40)
LIMIT 1",measure,True,high,37,b1c5901f-a535-42eb-870d-05cc025f7c27
fiscal_year_filtered_by_week_40,fiscal_year,Fiscal Year (filtered by week 40),The fiscal year associated with fiscal week 40. Used as a dimension or filter control.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SAFE_CAST(t0.fy_year AS STRING) AS fiscal_year
FROM
  (
    WITH
      OSandFACT AS (
        SELECT
          calendar.fy_week_of_year,
          calendar.fy_year
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
          LEFT JOIN (
            SELECT DISTINCT
              CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
              CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
              CAST(c.fy_first_day_of_week AS date) AS fy_first_day_of_week,
              CAST(c.fy_last_day_of_week AS date) AS fy_last_day_of_week,
              CAST(c.fy_month_of_year AS int) AS fy_month_of_year,
              CAST(c.fy_year_month_number AS int) AS fy_year_month_number,
              CAST(c.relative_fisc_year_number AS int) AS relative_fisc_year_number,
              CAST(c.relative_fisc_week_number AS int) AS relative_fisc_week_number,
              c.fy_month_of_year_short_name,
              CASE
                WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y'
                ELSE 'N'
              END AS month_end_flag,
              CAST(c.fy_quarter_of_year AS int) AS fy_quarter_of_year,
              CAST(c.fy_year AS int) AS fy_year,
              `current_timestamp`() AS extract_time
            FROM
              `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
              JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
            WHERE
              1 = 1
          ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      )
    SELECT
      OSandFACT.fy_week_of_year,
      OSandFACT.fy_year
    FROM
      OSandFACT
  ) AS t0
WHERE
  SAFE_CAST(t0.fy_week_of_year AS INT64) IN (40)
GROUP BY
  fiscal_year
ORDER BY
  fiscal_year DESC
LIMIT 12",dimension,False,low,37,b1c5901f-a535-42eb-870d-05cc025f7c27
total_expense_margin_1_or_2_actuals_2025_by_category,total_expense_margin_level_filtered,Total Expense (Margin Level 1 or 2) for Actuals 2025 by Category,"The sum of 'Expense' for records where 'Margin_Level' is '1' or '2', filtered for 'Actuals' source and Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, SUM(CASE WHEN (SAFE_CAST(t0.Margin_Level AS STRING) = '1' OR SAFE_CAST(t0.Margin_Level AS STRING) = '2') THEN t0.Expense ELSE 0 END) AS total_expense FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,true,high,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
product_revenue_actuals_2025_by_category,product_revenue,Product Revenue for Actuals 2025 by Category,"The sum of 'Product_Revenue' filtered for 'Actuals' source and Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, SUM(t0.Product_Revenue) AS product_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,true,high,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_1_actuals_2025_by_category,running_expense_level_1,"Running Expense Level 1 (Actuals, 2025) by Category","The maximum 'Running Expense' for level 1, derived from either 'CONSUMER' or 'ADVERTISING' actuals, filtered for Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, MAX(CASE WHEN SAFE_CAST(t0.Category AS STRING) = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_1_Actuals WHEN SAFE_CAST(t0.Category AS STRING) = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_1_Actuals ELSE 0 END) AS running_expense_1 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,false,medium,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_2_actuals_2025_by_category,running_expense_level_2,"Running Expense Level 2 (Actuals, 2025) by Category","The maximum 'Running Expense' for level 2, derived from either 'CONSUMER' or 'ADVERTISING' actuals, filtered for Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, MAX(CASE WHEN SAFE_CAST(t0.Category AS STRING) = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_2_Actuals WHEN SAFE_CAST(t0.Category AS STRING) = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_2_Actuals ELSE 0 END) AS running_expense_2 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,false,medium,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_3_actuals_2025_by_category,running_expense_level_3,"Running Expense Level 3 (Actuals, 2025) by Category","The maximum 'Running Expense' for level 3, derived from either 'CONSUMER' or 'ADVERTISING' actuals, filtered for Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, MAX(CASE WHEN SAFE_CAST(t0.Category AS STRING) = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_3_Actuals WHEN SAFE_CAST(t0.Category AS STRING) = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_3_Actuals ELSE 0 END) AS running_expense_3 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,false,medium,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_4_actuals_2025_by_category,running_expense_level_4,"Running Expense Level 4 (Actuals, 2025) by Category","The maximum 'Running Expense' for level 4, derived from either 'CONSUMER' or 'ADVERTISING' actuals, filtered for Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, MAX(CASE WHEN SAFE_CAST(t0.Category AS STRING) = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_4_Actuals WHEN SAFE_CAST(t0.Category AS STRING) = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_4_Actuals ELSE 0 END) AS running_expense_4 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,false,medium,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_5_actuals_2025_by_category,running_expense_level_5,"Running Expense Level 5 (Actuals, 2025) by Category","The maximum 'Running Expense' for level 5, derived from either 'CONSUMER' or 'ADVERTISING' actuals, filtered for Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, MAX(CASE WHEN SAFE_CAST(t0.Category AS STRING) = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_5_Actuals WHEN SAFE_CAST(t0.Category AS STRING) = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_5_Actuals ELSE 0 END) AS running_expense_5 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,false,medium,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
running_expense_6_actuals_2025_by_category,running_expense_level_6,"Running Expense Level 6 (Actuals, 2025) by Category","The maximum 'Running Expense' for level 6, derived from either 'CONSUMER' or 'ADVERTISING' actuals, filtered for Fiscal Year 2025, grouped by 'Category'.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Category AS STRING) AS Category, MAX(CASE WHEN SAFE_CAST(t0.Category AS STRING) = 'CONSUMER' THEN t0.Running_Expense_CONSUMER_6_Actuals WHEN SAFE_CAST(t0.Category AS STRING) = 'ADVERTISING' THEN t0.Running_Expense_ADVERTISING_6_Actuals ELSE 0 END) AS running_expense_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 AND SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Category",measure,false,medium,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
record_count_by_source_2025,record_count_by_source,Record Count by Source for Fiscal Year 2025,"The total number of records, grouped by 'Source', filtered for Fiscal Year 2025.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Source AS STRING) AS Source, COUNT(1) AS record_count FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = 2025 GROUP BY Source",aggregation,false,low,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
product_revenue_by_fiscal_year_actuals,product_revenue,Product Revenue by Fiscal Year for Actuals,"The sum of 'Product_Revenue', grouped by 'Fiscal_Year', filtered for 'Actuals' source.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_pacman_running_expense,"SELECT SAFE_CAST(t0.Fiscal_Year AS INT64) AS Fiscal_Year, SUM(t0.Product_Revenue) AS product_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 WHERE SAFE_CAST(t0.Source AS STRING) = 'Actuals' GROUP BY Fiscal_Year",measure,true,high,39,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
total_records_fy_week_quartile_2025_digital_excl_deep_niche,total_records,"Total Records by FY Week Quartile (2025, Digital Subscriptions, Excl. Deep Niche)","Count of records grouped by fiscal year week quartile for digital subscriptions in FY 2025, excluding deep niche publications.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    (CASE WHEN t0.fy_week_of_year <= 13 THEN 1 WHEN t0.fy_week_of_year <= 26 THEN 2 WHEN t0.fy_week_of_year <= 39 THEN 3 ELSE 4 END) AS fy_week_quartile,
    COUNT(1) AS total_records
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.table_nm IN ('mov', 'agg')
    AND t0.classification_level_1 IN ('Standard Paid', 'Other Paid')
    AND t0.classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) != 'Exclude'
    AND (CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END) IN ('Digital Subscriptions')
    AND t0.fy_year IN (2025)
    AND ((CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) NOT IN ('Deep Niche Publications') OR (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) IS NULL)
GROUP BY 1
ORDER BY total_records DESC
LIMIT 100;",measure,False,low,40,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_acquisitions_fy_year_digital_specific_mastheads,total_acquisitions,"Total Acquisitions by FY Year (Digital Subscriptions, The Australian, Metro, Regionals, Other Publications)",Sum of acquisition counts grouped by fiscal year for digital subscriptions across specific masthead groups.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    t0.fy_year,
    SUM(t0.acquisition_count) AS total_acquisitions
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.table_nm IN ('mov', 'agg')
    AND t0.classification_level_1 IN ('Standard Paid', 'Other Paid')
    AND t0.classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) != 'Exclude'
    AND (CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END) IN ('Digital Subscriptions')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) IN ('The Australian', 'Metro', 'Regionals', 'Other Publications')
GROUP BY 1
ORDER BY total_acquisitions DESC
LIMIT 100;",measure,True,high,40,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_records_cleaned_delivery_medium_type_digital_specific_mastheads,total_records,"Total Records by Cleaned Delivery Medium Type (Digital Subscriptions, The Australian, Metro, Regionals, Other Publications)",Count of records grouped by a cleaned version of delivery medium type for digital subscriptions across specific masthead groups.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    (CASE WHEN t0.delivery_medium_type = 'Not Available' THEN 'Digital' ELSE t0.delivery_medium_type END) AS cleaned_delivery_medium_type,
    COUNT(1) AS total_records
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.table_nm IN ('mov', 'agg')
    AND t0.classification_level_1 IN ('Standard Paid', 'Other Paid')
    AND t0.classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) != 'Exclude'
    AND (CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END) IN ('Digital Subscriptions')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) IN ('The Australian', 'Regionals', 'Other Publications', 'Metro')
GROUP BY 1
ORDER BY 1 DESC
LIMIT 100;",measure,False,low,40,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_records_frontbook_backbook_2025_q3_digital,total_records,"Total Records by Frontbook/Backbook Group (FY 2025, Q3, Digital Subscriptions)","Count of records grouped by frontbook/backbook group name for digital subscriptions in FY 2025, fiscal week quartile 3.",ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    t0.frontbook_backbook_group_name,
    COUNT(1) AS total_records
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.table_nm IN ('mov', 'agg')
    AND t0.classification_level_1 IN ('Standard Paid', 'Other Paid')
    AND t0.classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) != 'Exclude'
    AND (CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END) IN ('Digital Subscriptions')
    AND t0.fy_year IN (2025)
    AND (CASE WHEN t0.fy_week_of_year <= 13 THEN 1 WHEN t0.fy_week_of_year <= 26 THEN 2 WHEN t0.fy_week_of_year <= 39 THEN 3 ELSE 4 END) IN (3)
GROUP BY 1
ORDER BY 1 DESC
LIMIT 100;",measure,False,low,40,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_records_cleaned_delivery_medium_type_2026_digital,total_records,"Total Records by Cleaned Delivery Medium Type (FY 2026, Digital Subscriptions)",Count of records grouped by a cleaned version of delivery medium type for digital subscriptions in FY 2026.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    (CASE WHEN t0.delivery_medium_type = 'Not Available' THEN 'Digital' ELSE t0.delivery_medium_type END) AS cleaned_delivery_medium_type,
    COUNT(1) AS total_records
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.table_nm IN ('mov', 'agg')
    AND t0.classification_level_1 IN ('Standard Paid', 'Other Paid')
    AND t0.classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) != 'Exclude'
    AND (CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END) IN ('Digital Subscriptions')
    AND t0.fy_year IN (2026)
GROUP BY 1
ORDER BY 1 DESC
LIMIT 100;",measure,False,low,40,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_records_fy_week_of_year_digital_specific_mastheads,total_records,"Total Records by FY Week of Year (Digital Subscriptions, The Australian, Metro, Regionals, Other Publications)",Count of records grouped by fiscal week of year for digital subscriptions across specific masthead groups.,ncau-data-newsquery-prd,asl_finance_derived,acquisitions_cancellations_movements,"SELECT
    t0.fy_week_of_year,
    COUNT(1) AS total_records
FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.table_nm IN ('mov', 'agg')
    AND t0.classification_level_1 IN ('Standard Paid', 'Other Paid')
    AND t0.classification_level_2 IN ('DPE only', 'Digital', 'Essentials', 'Bundles', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) != 'Exclude'
    AND (CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END) IN ('Digital Subscriptions')
    AND (CASE WHEN t0.masthead = 'TA' THEN 'The Australian' WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals' WHEN t0.masthead = 'WT' THEN 'Other Publications' WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications' WHEN t0.masthead IS NULL THEN 'check' ELSE 'Exclude' END) IN ('The Australian', 'Regionals', 'Other Publications', 'Metro')
GROUP BY 1
ORDER BY total_records DESC
LIMIT 100;",measure,False,low,40,1e9c7a29-2613-47b8-85d1-127e5b8c66ac
total_records_digital_subscriptions,total_records,Total Records in Digital Subscriptions,"The total number of records available in the digital subscriptions dataset, representing the overall volume of data.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT COUNT(1) AS total_records FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`,aggregation,false,low,41,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
records_by_scenario_digital_subscriptions,records_by_dimension,Digital Subscriptions Records by Scenario,"The count of digital subscription records, broken down by the 'scenario' dimension. This metric helps understand the distribution of records across different scenarios.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SAFE_CAST(t0.scenario AS STRING) AS scenario, COUNT(1) AS records_count FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY scenario",aggregation,false,medium,41,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
distinct_scenario_values,distinct_dimension_values,Distinct Scenario Values,"A list of all unique 'scenario' values present in the digital subscriptions dataset. This is typically used to populate filters or dropdowns in the dashboard, allowing users to select specific scenarios.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT SAFE_CAST(t0.scenario AS STRING) AS scenario FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY scenario,dimension,false,low,41,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
closing_base_current_fy_current_week,closing_base,"Closing Base (Current FY, Current Week)","The closing base amount for the current fiscal year (2025) and current fiscal week (43), specifically for records from 'bmasnap_close', 'SC - CODE Manual APLS', or 'SC Manual APLS' sources. This metric is filtered for 'Digital Recognition' and excludes 'Discontinued' and 'Deep Niche Publications' publication groups.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,"SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 43 AND t0.table_union_source IN ('bmasnap_close', 'SC - CODE Manual APLS', 'SC Manual APLS')) THEN t0.ClosingBase ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END != 'Discontinued' AND CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END = 'Digital Recognition' AND (CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END NOT IN ('Deep Niche Publications') OR CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END IS NULL)",measure,true,high,43,37641205-ec3e-4184-a5dd-f5ca79248335
opening_base_current_fy_current_week,opening_base,"Opening Base (Current FY, Current Week)","The opening base amount for the current fiscal year (2025) and current fiscal week (43), specifically for records from the 'bmasnap_open' source. This metric is filtered for 'Digital Recognition' and excludes 'Discontinued' and 'Deep Niche Publications' publication groups.",ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 43 AND t0.table_union_source = 'bmasnap_open') THEN t0.OpeningBase ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END != 'Discontinued' AND CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END = 'Digital Recognition' AND (CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.gl_publication_code = 'Taste Online') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END NOT IN ('Deep Niche Publications') OR CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END IS NULL),measure,true,high,43,37641205-ec3e-4184-a5dd-f5ca79248335
conditional_earned_amount_current_fy_current_week,conditional_earned_amount,"Conditional Earned Amount (Current FY, Current Week)",The earned amount (either NFEarnedAmount or EarnedAmount based on year and source) for the current fiscal year (2025) and current fiscal week (43). This metric is filtered for 'Digital Recognition' and excludes 'Discontinued' and 'Deep Niche Publications' publication groups.,ncau-data-newsquery-prd,asl_finance_derived,digital_subscriptions,SELECT SUM(CASE WHEN (t0.fy_year = 2025 AND t0.fy_week_of_year = 43) THEN (CASE WHEN (t0.fy_year <= 2024 AND t0.table_union_source = 'nfmanualhist') THEN t0.NFEarnedAmount WHEN (t0.fy_year > 2024 AND t0.table_union_source = 'subsnapfact') THEN t0.EarnedAmount ELSE NULL END) ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 WHERE (CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END != 'Discontinued' AND CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END = 'Digital Recognition' AND (CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END NOT IN ('Deep Niche Publications') OR CASE WHEN (t0.gl_publication_code = '100' OR t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian' WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '402' OR t0.masthead_code = 'CM') THEN 'Courier Mail' WHEN (t0.gl_publication_code = '110' OR t0.gl_publication_code = '111' OR t0.gl_publication_code = '116' OR t0.masthead_code = 'DT') THEN 'Daily Telegraph' WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303' OR t0.masthead_code = 'HS') THEN 'Herald Sun' WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560' OR t0.masthead_code = 'AA') THEN 'The Advertiser' WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460' OR t0.masthead_code = 'CP') THEN 'Cairns Post' WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351' OR t0.masthead_code = 'GA') THEN 'Geelong' WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685' OR t0.masthead_code = 'GC') THEN 'Gold Coast' WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963' OR t0.masthead_code = 'NT') THEN 'NT News' WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852' OR t0.masthead_code = 'TM') THEN 'The Mercury' WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253' OR t0.masthead_code = 'TC') THEN 'Toowoomba' WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490' OR t0.masthead_code = 'TB') THEN 'Townsville' WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.masthead_code = 'WT') THEN 'Weekly Times' WHEN (t0.gl_publication_code = '9001' OR t0.masthead_code = 'CS') THEN 'Code' WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = 'Punters.com.au' OR t0.masthead_code = 'PU') THEN 'Punters' WHEN (t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet' WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus' WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online' WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X' WHEN (t0.gl_publication_code = '103' OR t0.masthead_code = 'The Oz') THEN 'The Oz' WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au' WHEN (t0.gl_publication_code = '121') THEN 'Others' WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games' WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others' WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly' WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate' WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital' ELSE 'Discontinued' END IS NULL),measure,true,high,43,37641205-ec3e-4184-a5dd-f5ca79248335
total_finance_tables_monitored,finance_table_count,Total Finance Tables Monitored,The total number of finance-related tables whose update status is being monitored by the dashboard.,your-gcp-project-id,bdm_finance,__TABLES__,"SELECT
  COUNT(t0.table_id) AS total_finance_tables_monitored
FROM
  (
    WITH
      table_list AS (
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'external_sundry_expenses_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_budget_forecast_fct' AS tableid UNION ALL
        SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_balance_fct' AS tableid UNION ALL
        SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_transaction_fct' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_account_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_business_unit_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_company_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_department_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_ledger_type_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_party_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_publication_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_responsibility_unit_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_type_dim' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_snapshot_fct' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_snapshot_fct' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'offplatform_subscription_revenue_fct' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_snapshot_fct' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'content_licensing_snapshot_fct' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'expense_depreciation_snapshot_fct' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'finance_gaap_adjustment' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'sundry_revenue_snapshot_fct' AS tableid
      ),
      table_update_list AS (
        SELECT
          dataset_id,
          table_id,
          datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
          row_count,
          size_bytes / power(2, 30) AS size_gb,
          table_list.update_frequency
        FROM
          `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
          JOIN
          table_list
          ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
      ),
      load_stats AS (
        SELECT
          * EXCEPT (last_update_time),
          CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
          `current_datetime`(""Australia/Sydney"") AS time_now,
          datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
          `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency, 'Y', 'N') AS delayed
        FROM
          table_update_list
      ),
      alert_sts AS (
        SELECT
          *,
          CASE
            WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) > update_frequency THEN -2
            WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND (updated_minutes_ago - update_frequency) > 30 THEN -2
            WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND (updated_minutes_ago - update_frequency) > 1440 THEN -2
            WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <= update_frequency THEN -1
            WHEN row_count = 0 THEN -3
            ELSE 0
          END AS alert_status
        FROM
          load_stats
      )
    SELECT
      table_id,
      CASE
        WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"", ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
        ELSE alert_status
      END AS alert_status_final
    FROM
      alert_sts
  ) AS t0",measure,False,medium,44,f9b52275-5924-4afb-8222-2c55854183ba
finance_tables_ok_or_ignored,finance_table_count,Finance Tables OK or Ignored,"The number of finance-related tables that are either up-to-date (alert_status_final = 0) or are intentionally ignored for update frequency checks (alert_status_final = -1, typically budget forecast tables).",your-gcp-project-id,bdm_finance,__TABLES__,"SELECT
  COUNT(CASE WHEN t0.alert_status_final IN (0, -1) THEN t0.table_id ELSE NULL END) AS finance_tables_ok_or_ignored
FROM
  (
    WITH
      table_list AS (
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'external_sundry_expenses_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_budget_forecast_fct' AS tableid UNION ALL
        SELECT 0 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_budget_forecast_fct' AS tableid UNION ALL
        SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_balance_fct' AS tableid UNION ALL
        SELECT 60 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_transaction_fct' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_account_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_business_unit_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_company_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_department_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_ledger_type_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_party_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_publication_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_responsibility_unit_profisee_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_dim' AS tableid UNION ALL
        SELECT 1440 AS update_frequency, 'bdm_finance' AS datasetid, 'gl_sub_ledger_type_dim' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'advertising_snapshot_fct' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'circulation_snapshot_fct' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'offplatform_subscription_revenue_fct' AS tableid UNION ALL
        SELECT 10080 AS update_frequency, 'bdm_finance' AS datasetid, 'subscription_snapshot_fct' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'content_licensing_snapshot_fct' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'expense_depreciation_snapshot_fct' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'finance_gaap_adjustment' AS tableid UNION ALL
        SELECT 44640 AS update_frequency, 'bdm_finance' AS datasetid, 'sundry_revenue_snapshot_fct' AS tableid
      ),
      table_update_list AS (
        SELECT
          dataset_id,
          table_id,
          datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time,
          row_count,
          size_bytes / power(2, 30) AS size_gb,
          table_list.update_frequency
        FROM
          `your-gcp-project-id.bdm_finance.__TABLES__` AS meta
          JOIN
          table_list
          ON (meta.table_id = table_list.tableid AND table_list.datasetid = 'bdm_finance')
      ),
      load_stats AS (
        SELECT
          * EXCEPT (last_update_time),
          CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time,
          `current_datetime`(""Australia/Sydney"") AS time_now,
          datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) AS updated_minutes_ago,
          `if`(datetime_diff(`current_datetime`(""Australia/Sydney""), last_update_time, MINUTE) > update_frequency, 'Y', 'N') AS delayed
        FROM
          table_update_list
      ),
      alert_sts AS (
        SELECT
          *,
          CASE
            WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) > update_frequency THEN -2
            WHEN updated_minutes_ago > update_frequency AND update_frequency > 60 AND update_frequency <= 1440 AND (updated_minutes_ago - update_frequency) > 30 THEN -2
            WHEN updated_minutes_ago > update_frequency AND update_frequency > 1440 AND update_frequency <= 44640 AND (updated_minutes_ago - update_frequency) > 1440 THEN -2
            WHEN updated_minutes_ago > update_frequency AND update_frequency <= 60 AND (updated_minutes_ago - update_frequency) <= update_frequency THEN -1
            WHEN row_count = 0 THEN -3
            ELSE 0
          END AS alert_status
        FROM
          load_stats
      )
    SELECT
      table_id,
      CASE
        WHEN table_id IN (""advertising_budget_forecast_fct"", ""circulation_budget_forecast_fct"", ""external_sundry_expenses_budget_forecast_fct"", ""gl_budget_forecast_fct"", ""subscription_budget_forecast_fct"") THEN -1
        ELSE alert_status
      END AS alert_status_final
    FROM
      alert_sts
  ) AS t0",measure,True,high,44,f9b52275-5924-4afb-8222-2c55854183ba
total_circulation_records_by_vendor_date,circulation_record_count,Total Circulation Records by Vendor and Date,"The sum of record counts for circulation volume and revenue data, broken down by vendor and draw date, for specific vendors and a recent date range.",your-gcp-project-id,bdm_circulation,rcti_circulation_volume_revenue_fct,"SELECT
  SUM(t0.data_total) AS total_circulation_records_by_vendor_date,
  t0.draw_date,
  t0.vendor
FROM
  (
    SELECT DISTINCT
      UPPER(vendor_name) AS vendor,
      draw_date,
      Count(*) AS data_total
    FROM
      `your-gcp-project-id.bdm_circulation.rcti_circulation_volume_revenue_fct`
    WHERE
      dw_tgt_partition_date >= `CURRENT_DATE`('Australia/Sydney') - 1
      AND draw_date BETWEEN DATE_SUB(DATE_TRUNC(`CURRENT_DATE`('Australia/Sydney'), ISOWEEK), INTERVAL 4 WEEK) AND DATE_SUB(DATE_TRUNC(`CURRENT_DATE`('Australia/Sydney'), WEEK(MONDAY)), INTERVAL 1 DAY)
    GROUP BY 1, 2
  ) AS t0
WHERE
  (t0.draw_date IN (DATE '2025-05-12', DATE '2025-05-13', DATE '2025-05-14', DATE '2025-05-15', DATE '2025-05-16', DATE '2025-05-17', DATE '2025-05-18', DATE '2025-05-19', DATE '2025-05-20', DATE '2025-05-21', DATE '2025-05-22', DATE '2025-05-23', DATE '2025-05-24', DATE '2025-05-25', DATE '2025-05-26', DATE '2025-05-27', DATE '2025-05-28', DATE '2025-05-29', DATE '2025-05-30', DATE '2025-05-31', DATE '2025-06-01', DATE '2025-06-02', DATE '2025-06-03', DATE '2025-06-04', DATE '2025-06-05', DATE '2025-06-06', DATE '2025-06-07', DATE '2025-06-08')
  AND t0.vendor IN ('WOOLWORTH', 'EG', 'COLES', 'AMPOL', '7ELEVEN'))
GROUP BY
  t0.draw_date, t0.vendor",measure,True,high,44,f9b52275-5924-4afb-8222-2c55854183ba
actual_amount_total,actual_amount,Total Actual Amount,The total actual financial amount recorded across all dimensions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(SAFE_CAST(Actual_Amount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1,measure,True,high,45,cbab66df-64cb-4ec6-a112-088557684b7e
actual_amount_fy25_revenue_expenses_newsmedia_week40,actual_amount,"Actual Amount (FY2025, Revenue/Expenses, News Media, Week 40)","Actual financial amount for Fiscal Year 2025, specifically for 'Total Revenue' or 'Total Expenses' within 'News Media Publishing' for fiscal week 40.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(SAFE_CAST(os.Actual_Amount AS BIGNUMERIC))
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
    ON os.gl_publication_code = pub.publication_code
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
    ON os.fiscal_week_id = calendar.fy_year_week_number
WHERE
  SAFE_CAST(calendar.fy_year AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) IN (40)
LIMIT 1",measure,True,high,45,cbab66df-64cb-4ec6-a112-088557684b7e
last_year_actual_amount_total,last_year_actual_amount,Total Last Year Actual Amount,The total actual financial amount recorded for the previous fiscal year across all dimensions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(SAFE_CAST(Last_Year_Actual_Amount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1,measure,True,high,45,cbab66df-64cb-4ec6-a112-088557684b7e
last_year_actual_amount_fy25_revenue_expenses_newsmedia,last_year_actual_amount,"Last Year Actual Amount (FY2025, Revenue/Expenses, News Media)","Last year's actual financial amount for Fiscal Year 2025, specifically for 'Total Revenue' or 'Total Expenses' within 'News Media Publishing'.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,"SELECT
  SUM(SAFE_CAST(os.Last_Year_Actual_Amount AS BIGNUMERIC))
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
    ON os.gl_publication_code = pub.publication_code
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
    ON os.fiscal_week_id = calendar.fy_year_week_number
WHERE
  SAFE_CAST(calendar.fy_year AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
LIMIT 1",measure,True,high,45,cbab66df-64cb-4ec6-a112-088557684b7e
budget_amount_total,budget_amount,Total Budget Amount,The total budgeted financial amount across all dimensions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(SAFE_CAST(Budget_Amount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1,measure,True,high,45,cbab66df-64cb-4ec6-a112-088557684b7e
forecast_amount_total,forecast_amount,Total Forecast Amount,The total forecasted financial amount across all dimensions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(SAFE_CAST(Forecast_Amount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1,measure,True,high,45,cbab66df-64cb-4ec6-a112-088557684b7e
volume_total,volume,Total Volume,The total volume associated with financial transactions across all dimensions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(SAFE_CAST(volume AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1,measure,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
last_year_volume_total,last_year_volume,Total Last Year Volume,The total volume associated with financial transactions for the previous fiscal year across all dimensions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT SUM(SAFE_CAST(Last_Year_volume AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1,measure,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
fiscal_year_dimension,fiscal_year,Fiscal Year,The fiscal year associated with the financial data.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_calendar,SELECT DISTINCT SAFE_CAST(fy_year AS INT) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` ORDER BY fy_year DESC LIMIT 10,dimension,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
fiscal_week_of_year_dimension,fiscal_week_of_year,Fiscal Week of Year,The week number within the fiscal year.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_calendar,SELECT DISTINCT SAFE_CAST(fy_week_of_year AS INT) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` ORDER BY fy_week_of_year ASC LIMIT 10,dimension,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
os_level_5_dimension,os_level_5,OS Level 5,A specific organizational structure level 5 for financial categorization.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(os_level_5 AS STRING) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE os_level_5 IS NOT NULL LIMIT 10,dimension,False,low,45,cbab66df-64cb-4ec6-a112-088557684b7e
os_level_4_dimension,os_level_4,OS Level 4,"A specific organizational structure level 4 for financial categorization, often used for high-level categories like Revenue or Expenses.",ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(os_level_4 AS STRING) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE os_level_4 IS NOT NULL LIMIT 10,dimension,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
gl_publication_code_dimension,publication_code,GL Publication Code,The General Ledger publication code for financial transactions.,ncau-data-newsquery-prd,asl_finance,v_asl_FCT_finance_os_aggregated,SELECT DISTINCT SAFE_CAST(gl_publication_code AS STRING) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE gl_publication_code IS NOT NULL LIMIT 10,dimension,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
l03_publication_code_dimension,publication_code_l03,L03 Publication Code,"A specific level 3 publication code from the hierarchy, often used for broad categories like 'News Media Publishing'.",ncau-data-newsquery-prd,asl_finance,v_asl_DIM_os_publication_hierachy,SELECT DISTINCT SAFE_CAST(l03_publication_code AS STRING) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` WHERE l03_publication_code IS NOT NULL LIMIT 10,dimension,False,medium,45,cbab66df-64cb-4ec6-a112-088557684b7e
is_print_digital_flag_dimension,print_digital_flag,Is Print Digital Flag,Flag indicating if the publication is categorized as print or digital.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_os_publication_hierachy,SELECT DISTINCT SAFE_CAST(is_print_digital_flag AS STRING) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` WHERE is_print_digital_flag IS NOT NULL LIMIT 10,dimension,False,low,45,cbab66df-64cb-4ec6-a112-088557684b7e
publication_name_dimension,publication_name,Publication Name,The human-readable name of the publication.,ncau-data-newsquery-prd,asl_finance,v_asl_DIM_os_publication_hierachy,SELECT DISTINCT SAFE_CAST(publication_name AS STRING) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` WHERE publication_name IS NOT NULL LIMIT 10,dimension,False,low,45,cbab66df-64cb-4ec6-a112-088557684b7e
month_end_flag_dimension,month_end_flag,Month End Flag,"A flag indicating whether the last day of the fiscal week is also the last day of the fiscal month ('Y' for yes, 'N' for no).",ncau-data-newsquery-prd,asl_finance,v_asl_DIM_calendar,SELECT DISTINCT CASE WHEN SAFE_CAST(c.fy_last_day_of_week AS DATE) = SAFE_CAST(c.fy_last_day_of_month AS DATE) THEN 'Y' ELSE 'N' END AS month_end_flag FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c WHERE c.fy_last_day_of_week IS NOT NULL AND c.fy_last_day_of_month IS NOT NULL LIMIT 2,dimension,False,low,45,cbab66df-64cb-4ec6-a112-088557684b7e
total_cost_aud_overall,total_cost_aud,Total Cost (AUD),"The total cost incurred in Australian Dollars for all GCP services, excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice')",measure,True,high,46,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_cost_component,total_cost_aud,Total Cost by Cost Component (AUD),"The total cost incurred in Australian Dollars, broken down by specific GCP cost components (SKUs), excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT SAFE_CAST(sku.description AS STRING) AS cost_component, SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice') GROUP BY SAFE_CAST(sku.description AS STRING)",aggregation,False,medium,46,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_service,total_cost_aud,Total Cost by Service (AUD),"The total cost incurred in Australian Dollars, broken down by GCP service, excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT SAFE_CAST(service.description AS STRING) AS service, SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice') GROUP BY SAFE_CAST(service.description AS STRING)",aggregation,False,medium,46,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_project,total_cost_aud,Total Cost by Project (AUD),"The total cost incurred in Australian Dollars, broken down by GCP project (with 'ncau-data-newsquery-' prefix removed), excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT SAFE_CAST(REPLACE(project.name, 'ncau-data-newsquery-', '') AS STRING) AS project, SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice') GROUP BY SAFE_CAST(REPLACE(project.name, 'ncau-data-newsquery-', '') AS STRING)",aggregation,False,medium,46,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_service_month,total_cost_aud,Total Cost by Service Month (AUD),"The total cost incurred in Australian Dollars, aggregated by the month of service usage, excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT DATE_TRUNC(DATE(DATETIME(usage_end_time, ""Australia/Sydney"")), MONTH) AS service_month, SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice') GROUP BY DATE_TRUNC(DATE(DATETIME(usage_end_time, ""Australia/Sydney"")), MONTH)",aggregation,False,medium,46,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_service_day_filtered,total_cost_aud,Total Cost by Service and Day (AUD) for Key Services,"The total cost incurred in Australian Dollars, broken down by GCP service and service day, specifically for a predefined list of key services (e.g., BigQuery, Cloud Storage), excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT SAFE_CAST(service.description AS STRING) AS service, DATE(DATETIME(usage_end_time, ""Australia/Sydney"")) AS service_day, SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice') AND SAFE_CAST(service.description AS STRING) IN ('BigQuery Reservation API', 'BigQuery', 'Cloud Storage', 'Support', 'Cloud Dataflow', 'Cloud Composer', 'Cloud Run Functions', 'Compute Engine', 'Vertex AI', 'Cloud SQL') GROUP BY SAFE_CAST(service.description AS STRING), DATE(DATETIME(usage_end_time, ""Australia/Sydney""))",aggregation,False,medium,46,fbf4d483-b17a-4040-b18c-091481d62200
total_cost_by_component_project_service,total_cost_aud,"Total Cost by Cost Component, Project, and Service (AUD)","The total cost incurred in Australian Dollars, broken down by GCP cost component, project (with 'ncau-data-newsquery-' prefix removed), and service, excluding invoices, within the selected date range.",ncau-tech-mgmt,billing_export,gcp_billing_export_v1_0129CD_D10B4E_0A39B2,"SELECT SAFE_CAST(sku.description AS STRING) AS cost_component, SAFE_CAST(REPLACE(project.name, 'ncau-data-newsquery-', '') AS STRING) AS project, SAFE_CAST(service.description AS STRING) AS service, SUM(cost) AS total_cost_aud FROM `ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2` WHERE date(_PARTITIONTIME) BETWEEN PARSE_DATE(""%Y%m%d"", @DS_START_DATE) AND PARSE_DATE(""%Y%m%d"", @DS_END_DATE) AND service.description NOT IN ('Invoice') GROUP BY SAFE_CAST(sku.description AS STRING), SAFE_CAST(REPLACE(project.name, 'ncau-data-newsquery-', '') AS STRING), SAFE_CAST(service.description AS STRING)",aggregation,False,low,46,fbf4d483-b17a-4040-b18c-091481d62200
tm1_amount_jul_2026_numeric_pub,tm1_amount,"TM1 Amount (Jul 2026, Numeric Pub Code)","The sum of amounts recorded in the TM1 financial system for July 2026, specifically filtered for publication codes that are purely numeric.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT SUM(t0.TM1_Amount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE t0.fiscal_year = 2026 AND t0.month_short_name = 'Jul' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')",measure,False,high,47,f353b933-30eb-4853-9976-0d35371db7d7
tableau_actual_amount_jul_2026_numeric_pub,tableau_actual_amount,"Tableau Actual Amount (Jul 2026, Numeric Pub Code)","The sum of actual amounts reported in Tableau for July 2026, specifically filtered for publication codes that are purely numeric.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT SUM(t0.Tableau_Actual_Amount) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE t0.fiscal_year = 2026 AND t0.month_short_name = 'Jul' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')",measure,False,high,47,f353b933-30eb-4853-9976-0d35371db7d7
reconciliation_variance_jul_2026_numeric_pub,reconciliation_variance,"Reconciliation Variance (Jul 2026, Numeric Pub Code)","The absolute sum of the difference between Tableau Actual Amount and TM1 Amount for July 2026, specifically for publication codes that are purely numeric. This metric highlights discrepancies between the two financial systems.",ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT SUM(ABS(t0.Tableau_Actual_Amount - t0.TM1_Amount)) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE t0.fiscal_year = 2026 AND t0.month_short_name = 'Jul' AND SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')",measure,True,high,47,f353b933-30eb-4853-9976-0d35371db7d7
os_level_6_dimension_feb_2025,os_level_6,OS Level 6 (Feb 2025 Filter),A distinct list of 'OS Level 6' values available for February 2025. This dimension is typically used for filtering or grouping data within the dashboard.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,SELECT DISTINCT t0.os_level_6 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 WHERE t0.fiscal_year = 2025 AND t0.month_short_name = 'Feb',dimension,False,medium,47,f353b933-30eb-4853-9976-0d35371db7d7
publication_code_numeric_flag,publication_code_numeric_flag,Publication Code Numeric Flag,A boolean flag indicating whether a 'publication_code' consists solely of digits. This is a derived field used to apply a specific business rule filter.,ncau-data-newsquery-prd,sbx_fda_corefin,dv_tableau_vs_tm1_monthly_expenses,"SELECT CASE WHEN (SAFE.REGEXP_CONTAINS(t0.publication_code, '^(^[0-9]+$)$')) THEN true ELSE false END FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses` AS t0 LIMIT 1",calculated_field,False,low,47,f353b933-30eb-4853-9976-0d35371db7d7
total_actual_revenue,actual_revenue,Total Actual Revenue,"The sum of actual revenue across all available data, typically used for overall performance.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,SELECT SUM(SAFE_CAST(actual AS BIGNUMERIC)) AS total_actual_revenue FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`,measure,True,high,48,415199ee-c67c-4b55-85f1-38b4aa291931
ytd_actual_revenue_latest_year,actual_revenue,YTD Actual Revenue (Latest Year),"The year-to-date sum of actual revenue for the most recent fiscal year with available data, excluding future weeks.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed,
        EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) AS max_year
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
),
main_flags AS (
    SELECT
      fiscal_week_end_date,
      actual,
      CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = (SELECT max_year FROM max_date_info) THEN 1 ELSE 0 END AS latest_year_flag,
      CASE WHEN fiscal_week_end_date > (SELECT max_fwed FROM max_date_info) THEN 1 ELSE 0 END AS future_week_flag
    FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
)
SELECT SUM(CASE WHEN SAFE_CAST(future_week_flag AS INT64) = 1 THEN NULL WHEN SAFE_CAST(latest_year_flag AS INT64) = 1 THEN SAFE_CAST(actual AS BIGNUMERIC) ELSE 0 END) AS ytd_actual_revenue_latest_year
FROM main_flags",measure,True,high,48,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_actual_revenue,actual_revenue,Latest Week Actual Revenue,The sum of actual revenue for the most recently completed fiscal week.,ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
),
main_flags AS (
    SELECT
      actual,
      CASE WHEN fiscal_week_end_date = (SELECT max_fwed FROM max_date_info) THEN 1 ELSE 0 END AS latest_week_flag
    FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
)
SELECT SUM(SAFE_CAST(actual AS BIGNUMERIC)) AS latest_week_actual_revenue
FROM main_flags
WHERE latest_week_flag = 1",measure,True,high,48,415199ee-c67c-4b55-85f1-38b4aa291931
total_actual_volume,actual_volume,Total Actual Volume,"The sum of actual volume across all available data, typically used for overall performance.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,SELECT SUM(SAFE_CAST(actual_volume AS BIGNUMERIC)) AS total_actual_volume FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`,measure,False,medium,48,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_actual_volume,actual_volume,Latest Week Actual Volume,The sum of actual volume for the most recently completed fiscal week.,ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
),
main_flags AS (
    SELECT
      actual_volume,
      CASE WHEN fiscal_week_end_date = (SELECT max_fwed FROM max_date_info) THEN 1 ELSE 0 END AS latest_week_flag
    FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
)
SELECT SUM(SAFE_CAST(actual_volume AS BIGNUMERIC)) AS latest_week_actual_volume
FROM main_flags
WHERE latest_week_flag = 1",measure,False,medium,48,415199ee-c67c-4b55-85f1-38b4aa291931
ytd_revenue_variance_actual_vs_forecast,revenue_variance,YTD Revenue Variance (Actual vs Forecast),"The year-to-date difference between actual revenue and forecast revenue for the latest fiscal year, excluding future weeks.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed,
        EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) AS max_year
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
),
main_flags AS (
    SELECT
      fiscal_week_end_date,
      actual,
      forecast,
      CASE WHEN EXTRACT(YEAR FROM fiscal_week_end_date) + 0 = (SELECT max_year FROM max_date_info) THEN 1 ELSE 0 END AS latest_year_flag,
      CASE WHEN fiscal_week_end_date > (SELECT max_fwed FROM max_date_info) THEN 1 ELSE 0 END AS future_week_flag
    FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
)
SELECT SUM(
  (CASE WHEN SAFE_CAST(future_week_flag AS INT64) = 1 THEN NULL WHEN SAFE_CAST(latest_year_flag AS INT64) = 1 THEN SAFE_CAST(actual AS BIGNUMERIC) ELSE 0 END) -
  (CASE WHEN SAFE_CAST(future_week_flag AS INT64) = 1 THEN 0 WHEN SAFE_CAST(latest_year_flag AS INT64) = 1 THEN SAFE_CAST(forecast AS BIGNUMERIC) ELSE 0 END)
) AS ytd_revenue_variance_actual_vs_forecast
FROM main_flags",calculated_field,True,high,48,415199ee-c67c-4b55-85f1-38b4aa291931
revised_forecast_revenue_ytd,revised_forecast_revenue,Revised Forecast Revenue (YTD),"A dynamically calculated forecast revenue for the latest year, combining actuals, standard forecasts, and ML forecasts based on specific date thresholds.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH
  tab_num AS (
    SELECT
      fiscal_week_end_date,
      COUNT(*) AS num
    FROM
      `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
      os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE',
        'THE WEEKLY TIMES')
    GROUP BY 1
  ),
  model_rev AS (
    SELECT
      CAST(forecast_timestamp AS date) AS fiscal_week_end_date,
      forecast_value AS ml_forecast_rev
    FROM
      ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level))
  ),
  max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed,
        EXTRACT(YEAR FROM MAX(fiscal_week_end_date)) AS max_year
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
  ),
  combined_data AS (
    SELECT
      t.fiscal_week_end_date,
      t.actual,
      t.forecast,
      CASE WHEN EXTRACT(YEAR FROM t.fiscal_week_end_date) + 0 = (SELECT max_year FROM max_date_info) THEN 1 ELSE 0 END AS latest_year_flag,
      COALESCE(aml.ml_forecast_rev_agg, 0) AS ml_forecast_rev_final
    FROM
      `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` AS t
      LEFT JOIN
      (
        SELECT
          mr.fiscal_week_end_date,
          sum(ml_forecast_rev) / tn.num AS ml_forecast_rev_agg
        FROM
          model_rev AS mr
          LEFT JOIN
          tab_num AS tn
          ON mr.fiscal_week_end_date = tn.fiscal_week_end_date
        GROUP BY 1, tn.num
      ) AS aml
      ON t.fiscal_week_end_date = aml.fiscal_week_end_date
    WHERE
      t.month_end_flag = false AND t.os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
  )
SELECT
  SUM(CASE
    WHEN SAFE_CAST(fiscal_week_end_date AS DATE) <= SAFE_CAST('2023-09-24' AS DATE) THEN SAFE_CAST(forecast AS BIGNUMERIC)
    WHEN SAFE_CAST(fiscal_week_end_date AS DATE) <= SAFE_CAST('2023-11-12' AS DATE) THEN SAFE_CAST(actual AS BIGNUMERIC) * 0.98
    WHEN SAFE_CAST(fiscal_week_end_date AS DATE) < SAFE_CAST('2024-06-01' AS DATE) THEN SAFE_CAST(ml_forecast_rev_final AS BIGNUMERIC) * 0.96
    ELSE 0
  END) AS revised_forecast_revenue_ytd
FROM combined_data
WHERE latest_year_flag = 1",calculated_field,True,high,48,415199ee-c67c-4b55-85f1-38b4aa291931
revised_forecast_revenue_latest_week,revised_forecast_revenue,Revised Forecast Revenue (Latest Week),"A dynamically calculated forecast revenue for the most recent fiscal week, combining actuals, standard forecasts, and ML forecasts based on specific date thresholds.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH
  tab_num AS (
    SELECT
      fiscal_week_end_date,
      COUNT(*) AS num
    FROM
      `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
      os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE',
        'THE WEEKLY TIMES')
    GROUP BY 1
  ),
  model_rev AS (
    SELECT
      CAST(forecast_timestamp AS date) AS fiscal_week_end_date,
      forecast_value AS ml_forecast_rev
    FROM
      ML.FORECAST(MODEL `ncau-data-newsquery-dev.arima_dataset.model_rev`, STRUCT(20 AS horizon, 0.9 AS confidence_level))
  ),
  max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
  ),
  combined_data AS (
    SELECT
      t.fiscal_week_end_date,
      t.actual,
      t.forecast,
      CASE WHEN t.fiscal_week_end_date = (SELECT max_fwed FROM max_date_info) THEN 1 ELSE 0 END AS latest_week_flag,
      COALESCE(aml.ml_forecast_rev_agg, 0) AS ml_forecast_rev_final
    FROM
      `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query` AS t
      LEFT JOIN
      (
        SELECT
          mr.fiscal_week_end_date,
          sum(ml_forecast_rev) / tn.num AS ml_forecast_rev_agg
        FROM
          model_rev AS mr
          LEFT JOIN
          tab_num AS tn
          ON mr.fiscal_week_end_date = tn.fiscal_week_end_date
        GROUP BY 1, tn.num
      ) AS aml
      ON t.fiscal_week_end_date = aml.fiscal_week_end_date
    WHERE
      t.month_end_flag = false AND t.os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
  )
SELECT
  SUM(CASE
    WHEN SAFE_CAST(fiscal_week_end_date AS DATE) <= SAFE_CAST('2023-09-24' AS DATE) THEN SAFE_CAST(forecast AS BIGNUMERIC)
    WHEN SAFE_CAST(fiscal_week_end_date AS DATE) <= SAFE_CAST('2023-11-12' AS DATE) THEN SAFE_CAST(actual AS BIGNUMERIC) * 0.98
    WHEN SAFE_CAST(fiscal_week_end_date AS DATE) < SAFE_CAST('2024-06-01' AS DATE) THEN SAFE_CAST(ml_forecast_rev_final AS BIGNUMERIC) * 0.96
    ELSE 0
  END) AS revised_forecast_revenue_latest_week
FROM combined_data
WHERE latest_week_flag = 1",calculated_field,True,high,48,415199ee-c67c-4b55-85f1-38b4aa291931
latest_week_adjusted_volume,adjusted_volume,Latest Week Adjusted Volume,"The actual volume for the most recent fiscal week, adjusted by a factor of 1.2. This might represent a target or a scaled volume.",ncau-data-newsquery-prd,newsquery_data_backup,tableau_operating_statement_query,"WITH max_date_info AS (
    SELECT
        MAX(fiscal_week_end_date) AS max_fwed
    FROM
        `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE
        actual > 0 AND actual_volume > 0
),
main_flags AS (
    SELECT
      actual_volume,
      CASE WHEN fiscal_week_end_date = (SELECT max_fwed FROM max_date_info) THEN 1 ELSE 0 END AS latest_week_flag
    FROM `ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query`
    WHERE month_end_flag = false AND os_l7 IN ('NSW', 'REGIONAL', 'NIS', 'VIC', 'DIGITAL OTHER', 'QLD', 'REGIONALS', 'SA WA', 'PRESTIGE', 'THE WEEKLY TIMES')
)
SELECT SUM(SAFE_CAST(actual_volume AS BIGNUMERIC) * 1.2) AS latest_week_adjusted_volume
FROM main_flags
WHERE latest_week_flag = 1",calculated_field,False,medium,48,415199ee-c67c-4b55-85f1-38b4aa291931
draw_volume_total,circulation_volume,Total Draw Volume,"The total volume of publications initially drawn for circulation, representing the quantity distributed.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT SUM(CASE WHEN ci.charge_type = 'DRAW' THEN ci.route_volume ELSE 0 END) AS total_draw_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci,measure,True,high,49,c441950c-1e3f-432c-9838-847d1d315b9e
returns_volume_total,circulation_volume,Total Returns Volume,"The total volume of publications returned from circulation, indicating unsold or excess copies.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT SUM(CASE WHEN ci.charge_type = 'RETURNS' THEN ci.route_volume ELSE 0 END) AS total_returns_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci,measure,True,high,49,c441950c-1e3f-432c-9838-847d1d315b9e
adjustment_volume_total,circulation_volume,Total Adjustment Volume,"The total volume of publications adjusted in circulation, accounting for corrections or special cases.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT SUM(CASE WHEN ci.charge_type = 'ADJUSTMENT' THEN ci.route_volume ELSE 0 END) AS total_adjustment_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci,measure,False,medium,49,c441950c-1e3f-432c-9838-847d1d315b9e
total_circulation_volume,circulation_volume,Total Circulation Volume (Draws + Returns + Adjustments),"The sum of all circulation volumes including draws, returns, and adjustments, representing the overall movement of publications.",ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT SUM(CASE WHEN ci.charge_type = 'DRAW' THEN ci.route_volume ELSE 0 END + CASE WHEN ci.charge_type = 'ADJUSTMENT' THEN ci.route_volume ELSE 0 END + CASE WHEN ci.charge_type = 'RETURNS' THEN ci.route_volume ELSE 0 END) AS total_circulation_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci,calculated_field,True,high,49,c441950c-1e3f-432c-9838-847d1d315b9e
total_charge_amount,charge_amount,Total Charge Amount,The total monetary value charged for circulation activities.,ncau-data-newsquery-prd,asl_finance,v_asl_circualtion_insights,SELECT SUM(ci.charge_amount) AS total_charge_amount FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci,measure,True,high,49,c441950c-1e3f-432c-9838-847d1d315b9e
