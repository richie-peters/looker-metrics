dashboard_id,dashboard_name,primary_data_sources,business_domain,complexity_score,consolidation_score,score_reasoning,total_metrics_identified,date_grain,response_id
5491badf-5ec0-4b4f-a427-b12a3a3395dd,Programmatic / Tubi Performance FY25,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,finance,9,9,"High complexity due to deeply nested subqueries (up to 7 levels), extensive use of `CASE` statements for dynamic categorization and filtering, and multiple layers of aliasing. High consolidation potential as all identified metrics are variations of a single base revenue amount, differentiated only by specific `CASE` conditions and `WHERE` clauses related to revenue type, fiscal year, and historical data.",12,monthly,0
fbf4d483-b17a-4040-b18c-091481d62200,NewsQuery - Cost Tracking,ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2,finance,5,9,"The dashboard uses a single core metric (`sum(cost)`) derived from a consistent base subquery. All variations are simply different aggregations or filters on this core metric and its associated dimensions. This indicates high potential for consolidation into a single, well-defined metric with flexible dimensional breakdowns. The SQL itself is moderately complex due to nested subqueries and date/string manipulations, but follows a clear, repeatable pattern.",6,daily,1
1e9c7a29-2613-47b8-85d1-127e5b8c66ac,Cancellations Extract,ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements,finance,7,9,"The dashboard queries exhibit moderate to high complexity due to deeply nested subqueries and extensive use of CASE statements for categorization (e.g., masthead grouping, subscription type). The high consolidation score is driven by the repetitive nature of the core metrics (COUNT(1) and SUM(acquisition_count)) and the same complex CASE logic being re-applied across multiple queries, with only the grouping dimensions and specific filters changing. This suggests significant opportunity for creating reusable views or a more unified data model.",6,mixed,2
38809f41-7138-4b94-94d1-ae919b2d9517,Adpoint Line Items for Financial Accounting V2,ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client,finance,7,8,"The dashboard queries involve nested subqueries, multiple layers of filtering, and various aggregations. There's a high degree of similarity across queries, primarily differing in the specific dimensions selected for grouping or the exact date/year filters applied, indicating strong potential for consolidation into a more unified data model or parameterized queries.",12,mixed,3
37641205-ec3e-4184-a5dd-f5ca79248335,Digital Subscriptions Report,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,finance,8,9,"The dashboard queries exhibit high complexity due to deeply nested subqueries and extensive use of CASE statements for creating custom dimensions (e.g., masthead groupings, recognition types) and filtering. The same complex logic for dimension creation is repeated across multiple queries, indicating significant opportunities for consolidation through pre-calculated dimensions or views. The generic column naming (clmnX_) further adds to the complexity and reduces readability.",3,weekly,4
6de90f2a-b3f3-46fe-a4fe-13474b2d6618,PACMAN AND EXCLUDE LOD,ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense,finance,8,9,"High complexity due to deeply nested subqueries and intricate CASE statements used to conditionally select and aggregate Running_Expense values based on Category, Source, and Margin_Level. High consolidation potential exists for the numerous Running_Expense metrics, which are essentially different views of the same underlying data, currently presented as separate calculated fields.",10,yearly,5
4114bd43-f752-4628-9b6c-1941b3c0d962,FY26 Campaigns Report (Sandbox),ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,finance,7,8,"The dashboard queries involve nested subqueries, extensive and repeated `NOT IN` clauses for filtering dimensions, and aggregation of key financial metrics. This indicates moderate complexity. The high consolidation score is due to the frequent reuse of the same base table and similar filtering logic across multiple queries, particularly for 'gross_revenue_amount' and various dimensions, suggesting opportunities for shared data models or views.",7,mixed,6
c441950c-1e3f-432c-9838-847d1d315b9e,Circulation Insights for Analysis,ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights;ncau-data-newsquery-prd.prstn_finance.v_calendar_dim,finance,7,8,"Queries use nested subqueries and complex CASE statements to derive multiple related metrics (e.g., different types of route volumes) and dimensions (e.g., publication names) from a single base table. This structure, while functional, leads to repeated logic and offers significant opportunities for consolidation into more streamlined views or CTEs for improved readability and maintainability.",6,weekly,7
28082293-c836-46f0-83f8-b5ce909cd051,SANDBOX VERSION - Commercial Finance Scorecards,ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard;ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast;ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast;ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct;ncau-data-newsquery-prd.prstn_finance.calendar_dim,"finance, consumer",9,9,"The SQL queries exhibit extreme nesting (up to 7 levels), extensive use of complex CASE statements to derive new dimensions and metrics based on various conditions (scenario, masthead, channel, package type), and intricate date calculations. This makes them highly complex. The repetition of similar metric calculations with slight variations (e.g., '_B' for Budget, '_F' for Forecast, different channel/category groupings) across multiple queries points to a very high consolidation opportunity. Many metrics are variations of a core concept, indicating a need for standardized definitions.",15,weekly,8
c67409c3-3e67-4d5a-8472-34a3aa704cf6,NewsGPT Analytics,ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2;ncau-tech-mgmt.ncau_gcp_metaadata.ncau-gcp-projects-metadata,finance,8,9,"The SQL queries exhibit high complexity due to multiple layers of nested subqueries, a full join, a CASE statement for environment classification, and the use of UNNEST for credits. Dynamic date filtering and varying project ID lists further add to the complexity. There is significant consolidation potential as all queries calculate variations of 'real_cost' with different date ranges and project filters, suggesting a common underlying metric with configurable parameters.",6,monthly,9
d7412673-0af1-4efe-8374-ca475b001fb6,Finance OS datasource template report,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department,finance,7,9,"High complexity due to deeply nested CTEs and multiple joins for every query. High consolidation potential as all queries share an identical, large base CTE (`OSandFACT`), differing only in their final aggregation and grouping, indicating redundant data processing.",3,weekly,10
a1b901e6-c4fb-44bc-955a-3a7070c15829,Revenue Movement,ncau-data-newsquery-prd.asl_finance_derived.revenue_movement,finance,8,9,"The dashboard uses deeply nested subqueries and complex CASE statements to derive multiple variations of revenue metrics and dimensions. Column aliasing is inconsistent across queries, making consolidation challenging but highly beneficial for maintainability and performance. The core metrics are repeated with varying filters and derived dimensions.",3,daily,11
61f1feb4-fc3e-4bee-b987-84c86cfe6425,Digital - Publications and Products Monthly ,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,advertising,7,8,"The dashboard uses a single primary data source but generates numerous queries with varying filters and complex, repeated CASE statements for derived dimensions. This indicates a high potential for consolidating the underlying data logic into a more efficient and more maintainable structure (e.g., a single view with all derived dimensions). The SQL itself involves nested subqueries and complex logic, contributing to its technical complexity.",6,mixed,12
dd0544cd-634f-43bd-a385-158c78dace66,Product Revenue Tracking Report,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,advertising,5,8,"The dashboard queries exhibit medium complexity due to nested subqueries and a lengthy, repetitive CASE statement used to derive a 'Publication Group'. The high consolidation score is primarily due to the exact repetition of this complex CASE statement across multiple queries, indicating a strong opportunity to consolidate this logic into a single calculated field or view.",6,mixed,14
b3eace25-3ec3-427a-839f-0639faf377ea,Regression Source Data Analysis,ncau-data-newsquery-prd.sbx_fda_noncorefin.dt_regression_data,sales,3,8,"The dashboard queries primarily involve simple SUM aggregations on a single table, indicating low technical complexity. However, there's significant overlap in the core 'Sales_volume' metric, with variations only in grouping dimensions and filters, suggesting high potential for metric consolidation. The presence of unusual metrics like 'SUM(Year)' and 'SUM(Week)' also points to potential misconfigurations that could be consolidated or removed.",6,mixed,15
23c8b213-a9f0-4158-b8fa-bff14425abb5,TM1 NewsQuery Tables,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions;ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim,finance,3,2,"Queries are straightforward SELECTs from single tables, often wrapped in a subquery. No complex joins, window functions, or intricate business logic observed. The identical duplicate queries in the input suggest Looker Studio's internal query generation for different components, not diverse metric definitions, thus limiting consolidation opportunities within the provided samples.",21,weekly,16
5e3be025-a96e-4f5d-8172-dfef07e60f6d,Commercial Finance Scorecards (Forecast Version),ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,8,9,"The SQL queries exhibit deep nesting and extensive use of CASE statements to implement dynamic filtering and conditional aggregation based on dashboard controls (e.g., 'Weekly' vs 'Date Range' selection, specific masthead vs 'All Mastheads', and current vs. previous fiscal year). This complexity makes the queries hard to read and maintain. The high number of SUM(clmnX_) where clmnX_ is a conditionally filtered version of a base column points to a strong need for metric consolidation.",32,weekly,17
0aff66b8-3b9d-4830-96ec-abef5f7eb7ef,Publisher and Product Performance Dashboard - FY25,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,finance,7,8,"The queries utilize deeply nested subqueries and complex `CASE` statements to derive various time-based and conditional metrics (current year, last year, STLY, current/future months). This indicates a high level of complexity in metric definition. The repetition of similar logic for different time periods (current, last, next year) and the use of `SAFE_DIVIDE` for 'K' (thousands) versions suggests significant consolidation opportunities by parameterizing the time offsets and scaling factors.",11,mixed,18
507bd07a-24bc-4402-ba8b-fcfbfac83996,Client Growth Dashboard FY25,ncau-data-newsquery-prd.asl_finance_derived.client_growth,finance,8,8,"The dashboard queries exhibit high complexity due to deeply nested subqueries and extensive use of dynamically generated 'clmnX_' aliases, which are inconsistent across queries for the same underlying data. This makes direct interpretation and consolidation challenging. However, the core metrics (gross revenue, digital revenue, print revenue) are consistently applied, but with varying combinations of complex derived filters. This strong pattern of reusable base metrics with different filter sets indicates a high potential for consolidation through well-defined CTEs or views.",6,daily,19
e0746d13-dad7-4ba1-aabc-d3b8e83cef54,FY25 Copy of AdSales Data for Pacing Report ,ncau-data-newsquery-prd.asl_finance_derived_archive.adsales_performance_archive_FY25,finance,4,7,"The queries primarily focus on selecting and filtering dimensions like financial year, month, revenue type, and revenue group subtype. There are no complex aggregations or joins present in the provided samples. Consolidation potential is high as similar dimensions are queried with minor variations in WHERE clauses, suggesting a common underlying data model for dashboard filters.",6,monthly,20
f9b52275-5924-4afb-8222-2c55854183ba,Finance Health - Check,your-gcp-project-id.bdm_finance.__TABLES__;your-gcp-project-id.bdm_circulation.rcti_circulation_volume_revenue_fct,finance,7,3,"The dashboard uses complex SQL with nested subqueries, CTEs, and intricate CASE statements for data health monitoring and specific date/vendor filtering for circulation data. The queries are already consolidated within their respective data domains (finance data health and circulation volume), limiting further cross-domain consolidation opportunities. The use of BigQuery's `__TABLES__` metadata table adds to the complexity.",3,mixed,21
a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d,PACMAN Dashboard - FY25,ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4,finance,7,8,"The SQL uses nested subqueries and extensive `CASE` statements to define multiple variations of 'Expense' metrics based on `Margin_Level` and a dynamic 'Category' dimension. This complexity, combined with the clear pattern of similar metrics, indicates a high potential for consolidation by treating 'Margin_Level' as a dimension for 'Expense'.",7,none,22
da5dcd47-2e80-45e8-94b8-5b71d81182f5,Failed Payment Dashboard - Prod v1.0,ncau-data-newsquery-sit.qvr_consumer.fp_all_trans,finance,7,8,"The dashboard uses complex SQL with CTEs, subqueries, and joins to derive metrics. All identified metrics are variations of a single base metric (distinct subscriber count) with different filtering and grouping, indicating high consolidation potential.",2,daily,23
1dff8d78-5d94-49fa-a2a5-086e3aaccd35,FY25 Copy of - Adsales Details Report,ncau-data-newsquery-prd.asl_finance_derived_archive.details_dashboard_archive_FY25_T,finance,6,7,"SQL uses nested subqueries and `CASE` statements for dynamic field selection (though conditions are static in samples). Multiple queries retrieve distinct values of similar dimensions with varying filters, indicating opportunities for consolidation into parameterized queries or a single data source with robust filtering capabilities. The `SAFE_CAST` operations add a layer of complexity.",8,mixed,24
6a26c78f-0070-4fb3-88b8-691ee4a4485a,Circ Budget Revenue Weekly Report,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,finance,8,9,"The dashboard uses deeply nested subqueries and complex CASE statements to derive both dimensions (e.g., publication groups, sales channels) and metrics (e.g., YTD, prior period, daily averages). Metric selection appears to be controlled by hardcoded values in CASE statements (e.g., '1' = '1'), indicating a lack of explicit parameterization in the SQL, which increases complexity and reduces reusability. There is high potential for consolidation by defining core 'Amount' and 'Volume' metrics and applying filters/parameters at a higher level.",9,weekly,25
3b23bf1a-c212-49a1-afa1-558ec7ed6b19,Print Subscription Summary,ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements;ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg_snap,finance,8,9,"High complexity due to nested subqueries, complex CASE logic for custom dimensions and metric definitions, and the use of window functions for Week-over-Week (WoW) and Year-over-Year (YoY) comparisons. High consolidation potential exists because the underlying data sources, filtering criteria, and custom dimension logic are almost identical across different query types, indicating a well-defined business domain that could benefit from a unified data model or metric layer.",6,weekly,26
fed70b12-c274-4cde-9920-592ca4c4dab0,Independent Agency Report,ncau-data-newsquery-prd.sbx_dcp.ia;ncau-data-newsquery-prd.asl_finance_derived.revenue_movement,finance,8,9,"The SQL queries exhibit high complexity due to deep nesting of subqueries (up to 6 levels), extensive use of CASE statements for conditional logic and aliasing, and complex date manipulations. The dashboard shows significant consolidation potential as multiple queries define identical metrics using different aliases, and a fixed parameter ('FY' = 'FY') is consistently evaluated, suggesting a hardcoded value that could be simplified or parameterized.",4,mixed,27
b1c5901f-a535-42eb-870d-05cc025f7c27,OS extract for month end rec,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,finance,7,8,"The SQL queries utilize multiple CTEs and joins across several dimension tables to enrich a central fact table, indicating a moderately complex data model. The high consolidation score is due to the significant repetition across queries, where the primary differences are the aggregated measure (Budget vs. Actual) and specific filter values (e.g., fiscal week, publication code). This suggests a strong opportunity for consolidation using parameterized queries or a more flexible data source definition.",3,weekly,28
c44e51ad-f0c4-4a5e-bb7c-e0044deaa278,Cost to Serve Dashboard,ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model;ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_bu_cost;ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_product,finance,7,8,"Queries involve multiple nested subqueries, complex date comparisons (`fiscal_month_id < current_fiscal_month_id`), and extensive filtering on dimensions like `service_model` and `fiscal_month_id`. There's significant overlap in metrics and filters across queries from the `cost_to_serve_service_model` table, indicating strong consolidation opportunities.",9,monthly,30
e380f99e-2ef3-40ec-a3ec-bc35491cc0bb,GL and SubSnapFact Revenue Extract,ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct,finance,8,8,"The SQL queries exhibit high complexity due to deeply nested subqueries and intricate CASE statements used for filtering classification descriptions. The primary revenue metric is calculated multiple times with variations in fiscal periods and scenario types, indicating significant potential for consolidation by parameterizing these filters. Several queries are also used to populate filter dropdowns, which could be consolidated into a single data source for filter values.",6,weekly,31
9c992f02-f13b-4c32-a400-90135fdff180,Verity 2.0 - TAUS Wealth Last Week,ncau-data-newsquery-prd.prstn_verity.t_registration_details_snapshot_summary;ncau-data-newsquery-prd.cdm_reference_data.subscription_targets,other,6,7,"The dashboard uses two distinct data sources. Queries against `t_registration_details_snapshot_summary` involve complex `WHERE` clauses with multiple `REGEXP_CONTAINS` and `OR` conditions. Queries against `subscription_targets` are nearly identical, differing only by date ranges, indicating high potential for consolidation using date parameters. Nested subqueries are prevalent, contributing to moderate complexity.",4,weekly,32
cbab66df-64cb-4ec6-a112-088557684b7e,FY25 OS extract for month end rec,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department,finance,7,8,"High complexity due to nested queries, multiple joins, and custom fiscal calendar logic. High consolidation potential as the core data extraction logic (OSandFACT CTE) is duplicated across all queries, with only the final SELECT, WHERE, and GROUP BY clauses changing. This suggests a need for a more unified data model or parameterized queries.",2,weekly,33
70ed3b92-987b-479b-9ed7-d2903bd2787e,Monthly Invoicing Breakdown,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,finance,3,7,"The dashboard's SQL queries are relatively simple, primarily involving direct column selections, basic filtering, and one straightforward CASE statement. There are no complex joins, aggregations beyond simple counts, or window functions, leading to a low complexity score. However, many queries retrieve single dimensions or the same calculated field with different filters, indicating a high potential for consolidation. A more efficient dashboard could likely fetch multiple related dimensions and metrics in fewer, broader queries.",5,none,34
aca2f032-b796-49a2-89fe-781ca947aa33,Circulation Performance Dashboard,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,finance,8,9,"The SQL queries are highly complex due to deep nesting and extensive use of aliased columns (clmnX_) generated by Looker Studio. Date filtering logic is convoluted, and multiple metrics are derived from the same base columns (Actual_Amount, Volume, Last_Year_Actual_Amount) with slightly different date or dimension filters. The presence of redundant calculations (e.g., clmn56_ and clmn57_ in query 3 resolving to the same underlying metric due to outer WHERE clauses) indicates significant opportunities for consolidation and simplification into fewer, more flexible queries. The dashboard focuses on a specific fiscal year (FY2025).",4,weekly,35
2dfb1b58-42eb-44cb-b550-66469ae7df3c,Data Load Checks,ncau-data-newsquery-prd.finance_monthend_checks.v_os_data_load_check;ncau-data-newsquery-prd.finance_monthend_checks.v_jde_data_load_check,finance,6,4,"The dashboard queries involve nested subqueries, date/time manipulation (`DATETIME_TRUNC`, `PARSE_DATE`, `DATETIME_ADD`), and `SAFE_CAST` for type handling, indicating moderate technical complexity. Consolidation opportunities are limited as the queries target distinct metrics from two different underlying tables (`v_os_data_load_check` and `v_jde_data_load_check`), even though they both relate to 'data load checks'. The repeated identical queries suggest Looker Studio re-executes the same query for different dashboard components or user interactions, rather than indicating a need for metric consolidation.",3,daily,36
2104a3f5-9424-4087-a928-e67fecae789a,Circulation Performance Dashboard,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department,finance,8,9,"The SQL queries are deeply nested with many aliased columns (`clmnX_`) making them very hard to read and debug. Complex `CASE` statements are used for date calculations (current week, YTD) and channel categorization, leading to repeated logic. Multiple metrics are derived from the same base values (Actual, Budget, Volume) with slight variations in filtering (e.g., by day of week, sales channel, or period type), suggesting that a more consolidated data model or a set of well-defined base metrics could simplify the dashboard significantly.",18,weekly,37
57d87efe-c112-4d42-be1b-045f0c8ca73e,Commercial Finance Scorecards,ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,8,8,"High complexity due to deeply nested subqueries, dynamic date calculations based on fixed reference dates, and multiple CASE statements for derived dimensions/filters. High consolidation potential due to identical metrics appearing with and without a `_V` suffix, suggesting a need for a unified metric definition layer. The repeated complex date logic also points to consolidation opportunities.",29,weekly,38
be4575e4-3850-46e2-9ba9-73a4393c5d2a,Finance - unearned revenue (dev),ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25;ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring;ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25;ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base;ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement;ncau-data-newsquery-sit.qvr_consumer.fp_all_trans,finance,7,8,"The dashboard uses complex SQL with nested CTEs, subqueries, and intricate date calculations (prorata allocation). It pulls data from multiple tables across different environments (sit/prd). There's significant repetition in the core revenue allocation logic across several queries, indicating a high potential for consolidation into a shared view or calculated field.",3,mixed,39
f502f44a-e283-405f-ab8f-6a641edb4194,FY25 Campaigns Report,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard;ncau-data-newsquery-prd.asl_finance_derived_archive.details_dashboard_archive_FY25_T,finance,4,8,"SQL queries are generally simple aggregations and dimension selections with various WHERE clauses. The high consolidation score is due to the repeated use of the same base metrics (e.g., `gross_revenue_amount`) and dimensions (e.g., `unified_publication_name`, `data_load_datetime`) with only changes in filtering conditions, suggesting that these could be consolidated into fewer, more flexible metrics.",14,mixed,40
f353b933-30eb-4853-9976-0d35371db7d7,Month End Reporting Reconcilation,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses,finance,6,8,"Queries are consistent in structure, primarily differing by date filters and the specific aggregation (TM1 amount, Tableau amount, or their absolute difference). This indicates a strong opportunity for consolidating underlying data models and potentially using parameters for date selection.",4,monthly,41
61cc5171-703d-44b5-acd7-e9db7cf81778,Commercial Finance Scorecards,ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,8,6,"High complexity due to deeply nested subqueries and obfuscated column names. Extensive use of `CASE WHEN` for conditional logic and complex date calculations. The financial metrics query already consolidates many measures into a single query. The calendar query is complex but serves a specific purpose of generating date-related flags, which is a form of consolidating date logic. Further consolidation would involve simplifying the SQL structure and aliasing for better readability and maintainability.",37,weekly,42
7ada02b8-e93e-41d8-9a7e-05013ff81247,Unmapped Revenue NPV,ncau-data-newsquery-prd.asl_finance_derived.adsales_npv,finance,6,8,"The dashboard primarily queries a single table with a consistent, moderately complex structure involving nested subqueries and conditional logic for dimension handling. The high consolidation score is due to the near-identical nature of the main data retrieval queries, indicating significant potential for consolidating logic into a single view or pre-aggregated table.",2,monthly,43
906ca8a7-1733-4a1a-b2f5-2660551f3d3a,Month End Reporting Reconcilation - ME team copy,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals;ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses;ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue;ncau-data-newsquery-prd.sbx_fda_corefin.dv_asl_FCT_finance_os_agg_with_hierarchy,finance,7,8,"The dashboard uses multiple financial tables with varying levels of organizational hierarchy. SQL queries involve nested subqueries, `CASE` statements with `REGEXP_CONTAINS`, and `SAFE_CAST` for data manipulation, indicating moderate to high complexity. There's significant opportunity for consolidation as many queries select similar organizational dimensions (`os_level_3`, `os_level_4`, `os_level_6`) from different tables, and core financial metrics (revenue, actuals, variance) are calculated across different sources, suggesting a need for a more unified data model or pre-aggregated views.",13,mixed,44
712ca6fe-b491-4a01-af6e-1495fb3c7d12,Finance Data Checks,ncau-data-newsquery-prd.finance_monthend_checks.v_rcti_files_check;ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check;ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check,finance,2,3,"The SQL queries are very simple, primarily selecting or summing single columns from different tables. This indicates low technical complexity. Consolidation opportunities are limited as each query targets a distinct table for a specific 'check' (e.g., vendor list, total revenue, fiscal month IDs), rather than variations of the same core metric.",3,mixed,45
d4d68a71-2b12-4caf-bc6b-96fc2d18a025,Adsales Details Dashboard,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,sales,3,2,"The SQL queries are primarily for selecting distinct dimension values, likely for dashboard filters or dropdowns, rather than calculating complex aggregate metrics. They use nested subqueries and CASE statements for dynamic dimension selection (e.g., financial vs. calendar year, current vs. sync portfolio names), which is a common Looker Studio pattern for consolidating similar dimensions. The complexity is low due to the lack of complex joins or aggregations. Consolidation is already partially achieved through the CASE statements.",2,mixed,47
a1c16d3b-d19a-4abd-b96c-7a87580815db,Verity data for finance scorecard - DRAFT,ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,1,1,"The SQL queries are very simple, primarily selecting and transforming date dimensions from a single calendar table. There are no complex joins, aggregations, or business logic, leading to low complexity. The queries are already highly similar, indicating minimal consolidation benefit.",4,weekly,48
c32d96e5-38f4-48a8-9b70-3d89a83f03aa,Circulation Insights,ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check,finance,6,8,"All queries derive a sum of 'amount' from the same base table, differing only by filters on `revenue_type` and `fy_year_week_number`, and grouping dimensions. This indicates significant consolidation potential around a core 'total amount' metric, as the underlying metric logic is identical across all samples.",1,weekly,49
bb49fa78-5abe-4e68-a9c1-8172a832e724,optimization,ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions,finance,8,8,"The SQL queries exhibit high complexity due to deeply nested subqueries and extensive use of CASE statements for derived columns and date logic. Hardcoded dates within the queries suggest a lack of dynamic date parameterization at the SQL level, which could lead to multiple similar queries for different time periods. Many metrics are variations of core financial figures (e.g., Budget Earned Amount, Closing Base, Opening Base, Earned Amount) filtered by different fiscal periods (FY, WTD, MTD), indicating significant consolidation opportunities. The dimension/filter queries are also highly repetitive, often returning a single distinct value due to the `(1=1)` pattern.",12,mixed,51
52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,Consumer Finance Landing Page,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,finance,2,5,"The dashboard's SQL queries are very simple, primarily involving basic counts and distinct selections from a single table. There are no complex joins, subqueries, or intricate business logic (e.g., extensive CASE statements). This leads to a low complexity score. The consolidation score is medium because while the queries are simple, they are fragmented (e.g., separate queries for total count and count by dimension) and could be combined into fewer, more comprehensive queries for efficiency.",3,none,52
