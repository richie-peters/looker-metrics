dashboard_id,dashboard_name,primary_data_sources,business_domain,complexity_score,consolidation_score,score_reasoning,total_metrics_identified,date_grain,response_id
be4575e4-3850-46e2-9ba9-73a4393c5d2a,Finance - unearned revenue (dev),ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_mar25;ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_recurring;ncau-data-newsquery-sit.qvr_consumer.fin_unearned_revenue_Jun25;ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base;ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement;ncau-data-newsquery-sit.qvr_consumer.fp_all_trans,finance,8,9,"The dashboard queries exhibit high complexity due to nested CTEs, complex date calculations (prorata allocation), and conditional logic. There's significant repetition in the 'core' and 'core_2' CTEs across multiple queries, indicating a strong opportunity for consolidation into a shared view or pre-calculated table. Query 6 introduces additional complexity with multiple joins and unioned CTEs for subscription status, which is distinct from the unearned revenue calculation but part of the same dashboard.",6,weekly,0
c32d96e5-38f4-48a8-9b70-3d89a83f03aa,Circulation Insights,ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check,finance,6,8,"Queries use nested subqueries, `CASE` statements for metric selection, and various string/numeric functions for dimension derivation. High consolidation potential as all queries derive from the same base table and metric logic, differing primarily in filters and grouping dimensions, suggesting a single flexible data source could serve multiple dashboard components.",1,weekly,1
28082293-c836-46f0-83f8-b5ce909cd051,SANDBOX VERSION - Commercial Finance Scorecards,ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard;ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_acquisition_budget_forecast;ncau-data-newsquery-prd.prstn_consumer_views.v_consumer_churn_budget_forecast;ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,8,9,"The dashboard's SQL queries exhibit high complexity due to deeply nested subqueries, extensive use of Common Table Expressions (CTEs), multiple joins across different data sources, and intricate CASE statements for deriving metrics based on scenarios (Budget, Forecast, YOY) and channels. This complexity indicates a sophisticated data model and transformation logic. The high consolidation score is driven by the numerous variations of core metrics (e.g., Gross Adds, Revenue, Cancels) that are differentiated by scenario (Budget/Forecast) or specific channels/categories. This suggests a strong opportunity to define base metrics and then apply scenario/channel dimensions for more streamlined reporting.",34,weekly,2
b9dfd2f4-92fa-4f81-a5b1-17de880470f9,Contra Report,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard;ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily;ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data,finance,8,9,"The dashboard's SQL queries exhibit high complexity due to multiple levels of nested subqueries, extensive use of `CASE` statements for deriving new dimensions and measures (e.g., revenue by fiscal year offset, digital/print revenue), and complex filtering logic involving subqueries and string manipulations. The consolidation score is high because many distinct metrics are variations of a core 'gross_revenue_amount' metric, differentiated only by `CASE` statements or filters on fiscal year offset and revenue type. Grouping of account/advertiser names also presents consolidation opportunities.",14,daily,3
c44e51ad-f0c4-4a5e-bb7c-e0044deaa278,Cost to Serve Dashboard,ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_service_model;ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_bu_cost;ncau-data-newsquery-prd.sbx_fda_noncorefin.cost_to_serve_product,finance,7,8,"The dashboard queries involve multiple nested subqueries, complex WHERE clauses with SAFE_CAST and CONCAT functions, and utilize three different tables. This indicates a moderately high technical complexity. The high consolidation score is due to the frequent repetition of similar filtering logic (e.g., `fiscal_month_id < current_fiscal_month_id` and `service_model != 'V1. Hybrid'`) across multiple queries and metrics derived from the same base columns, suggesting opportunities for a more consolidated data model or views.",11,monthly,4
e380f99e-2ef3-40ec-a3ec-bc35491cc0bb,GL and SubSnapFact Revenue Extract,ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct,finance,8,7,"The dashboard queries involve complex nested subqueries and intricate CASE statements for filtering, particularly for the core 'earned amount' metric, indicating high technical complexity. The presence of multiple queries fetching variations of the same base metric (earned amount) with different date ranges and 'scenario' filters, along with several queries for distinct dimension values, suggests a good opportunity for consolidation into more flexible, parameterized metrics.",7,weekly,5
7ada02b8-e93e-41d8-9a7e-05013ff81247,Unmapped Revenue NPV,ncau-data-newsquery-prd.asl_finance_derived.adsales_npv,finance,7,8,"The SQL queries involve nested subqueries, conditional logic (CASE statements) for dimension selection, and specific filtering on financial flags (`NPV`) and offsets. This indicates a moderately complex data model and metric definition. The high consolidation score is due to the fact that almost all provided SQL samples are identical, suggesting a single core query drives much of the dashboard's functionality, making it highly consolidatable.",2,monthly,6
4114bd43-f752-4628-9b6c-1941b3c0d962,FY26 Campaigns Report (Sandbox),ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,finance,7,6,"Complexity is high due to nested subqueries, extensive and repeated `NOT IN` clauses for filtering, and `SAFE_CAST` usage. Consolidation potential exists as several queries are identical or nearly identical (e.g., job_DVjMH3px-UtVRGKFLk-rzMVKleAo and job_SsRUIJWLm0GO0Mdcq0j_gxnvrU6x; job_DhrhewcLom4IwA1hY5W6b4zPQ9tc and job_vdf-2X0_hGgS93uICcsd8d9s01V0). The long, repeated exclusion lists for publication names and ad types could be managed more efficiently, possibly via a lookup table or a more centralized filter definition.",4,mixed,7
5e3be025-a96e-4f5d-8172-dfef07e60f6d,Commercial Finance Scorecards (Forecast Version),ncau-data-newsquery-prd.sbx_fda_noncorefin.masthead_scorecard_forecast_version;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,9,9,"The SQL queries are highly nested and use complex CASE statements to handle dashboard parameters (like date ranges and masthead selections). This leads to a large number of derived columns and makes the queries hard to read and maintain. The presence of '_B' (Budget/Benchmark) and non-'_B' (Actual/Forecast) versions of almost every metric indicates a strong candidate for consolidation, potentially via a parameter or a more unified data model.",11,weekly,8
dd0544cd-634f-43bd-a385-158c78dace66,Product Revenue Tracking Report,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,advertising,4,7,"The SQL queries involve nested subqueries, CASE statements for categorization, and SAFE_CAST, indicating moderate complexity. The repeated use of the same CASE statement logic across multiple queries for different dimensions highlights a strong opportunity for consolidation into a single calculated field or view, improving maintainability and potentially performance.",6,mixed,9
0e05b4ce-cb33-488a-8537-b9e68a844e2e,Acquisitions - Extracts,ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements,finance,8,9,"The dashboard queries feature deeply nested subqueries and extensive, repetitive CASE statements to derive common business dimensions (e.g., customer type, masthead groups, product categories). This indicates a lack of a pre-modeled semantic layer, leading to high query complexity and significant redundancy across different dashboard components. Consolidating these derived dimensions into a single, well-defined view or table would drastically simplify queries, improve performance, and reduce maintenance overhead.",9,weekly,10
da5dcd47-2e80-45e8-94b8-5b71d81182f5,Failed Payment Dashboard - Prod v1.0,ncau-data-newsquery-sit.qvr_consumer.fp_all_trans,finance,7,9,"The dashboard's queries utilize complex subqueries and CTEs to identify the latest transaction for each subscriber and subscription within a 60-day window. All identified metrics are variations of counting distinct subscribers based on this core logic, differing only by grouping dimensions or specific filtering conditions. This high degree of shared logic indicates significant potential for consolidation.",2,daily,11
449b9707-f939-42e1-b6f5-11998369f473,Digital Subscription Report,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,finance,9,9,"The dashboard queries exhibit extremely high complexity due to deeply nested subqueries, extensive use of aliased columns (clmnXXX), and complex, multi-layered CASE statements for deriving dimensions and selecting measures. The metrics are variations of 'earned amount' for different fiscal periods (current vs. previous year, specific week) and types (actual, forecast, NF), suggesting strong potential for consolidation into parameterized metrics. The hardcoded fiscal year (2025/2024) and week (42) in the metric definitions further indicate a need for dynamic parameterization.",3,mixed,12
61cc5171-703d-44b5-acd7-e9db7cf81778,Commercial Finance Scorecards,ncau-data-newsquery-prd.asl_finance_derived.consumer_deepniche_scorecard;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,8,7,"High complexity due to extensive use of nested subqueries and complex CASE statements for deriving new columns and applying filters. The calendar queries are particularly opaque, indicating intricate date logic. High consolidation potential exists due to repetitive metric patterns (e.g., _3rd_Party, _APLS, _GPLA variations) and nearly identical calendar queries that differ only by a date literal, suggesting opportunities for parameterization or a unified calendar table.",36,weekly,13
bb49fa78-5abe-4e68-a9c1-8172a832e724,optimization,ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions,finance,8,7,"The SQL queries exhibit high complexity due to deep nesting of subqueries (up to 10 levels) and intricate CASE statements used for conditional logic and aliasing. Date calculations are also present, albeit on fixed dates. The consolidation score is high because multiple queries calculate very similar financial metrics (EarnedAmount, ClosingBase, OpeningBase) for different fixed weeks/years using almost identical underlying logic. These could be consolidated into more flexible, parameterized queries. The 'control field' queries (for dropdowns/parameters) are inherently consolidated in their purpose but highlight a pattern of generating separate queries for each dashboard control.",12,mixed,14
a1c16d3b-d19a-4abd-b96c-7a87580815db,Verity data for finance scorecard - DRAFT,ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,2,8,"SQL queries are very simple, primarily selecting and truncating date dimensions from a single calendar table. All queries are variations of selecting calendar attributes, indicating high consolidation potential into a single calendar dimension view or table.",4,weekly,15
0aff66b8-3b9d-4830-96ec-abef5f7eb7ef,Publisher and Product Performance Dashboard - FY25,ncau-data-newsquery-prd.asl_finance_derived.adsales_performance,advertising,8,9,"The dashboard queries exhibit high complexity due to deeply nested subqueries and extensive use of `CASE` statements to derive multiple variations of core financial metrics (gross revenue, pub LGB) based on relative time offsets and flags. The same underlying data transformations are repeated across different queries, varying only by the final `WHERE` clause filters, indicating significant opportunities for metric consolidation and reuse.",19,mixed,16
2dfb1b58-42eb-44cb-b550-66469ae7df3c,Data Load Checks,ncau-data-newsquery-prd.finance_monthend_checks.v_os_data_load_check;ncau-data-newsquery-prd.finance_monthend_checks.v_jde_data_load_check,finance,5,6,"The queries involve nested subqueries, date parsing/truncation, and multiple filtering conditions, indicating moderate complexity. Consolidation opportunities exist for metrics derived from the same base table, especially `v_os_data_load_check`, where `SUM(records_count)` and `COUNT(DISTINCT scenario)` are both calculated, albeit with different grouping and filtering. The dashboard likely serves to monitor data loading across different financial systems.",3,daily,17
8f848270-688f-4455-82a6-3bc9a7d39cce,Newsquery Health App,your-gcp-project-id.bdm_finance.__TABLES__,finance,7,3,"The SQL queries are identical and involve multiple CTEs and complex CASE statements to determine table alert statuses, indicating moderate technical complexity. The dashboard appears to be a health monitoring tool for finance data tables. The two identified metrics are direct counts derived from this complex, but already consolidated, logic. There is limited opportunity for further consolidation of these specific metrics without changing the dashboard's core purpose.",2,none,18
5515c1c6-18fe-449d-b621-d47631023320,Adpoint Line Items for Financial Accounting,asl_advertising.v_adsales_revenue_client,finance,7,8,"The dashboard consistently uses a single primary data source and applies a common set of filters across most queries, indicating a focused purpose. However, there are multiple distinct queries primarily used for filter dropdowns, which could be consolidated into fewer, more dynamic queries. The main metric query is well-defined but could be parameterized for different aggregations or timeframes, offering further consolidation opportunities.",13,mixed,19
5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26,Optimizing Digital Subscriptions Report,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions;ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions,finance,9,8,"High complexity due to deeply nested subqueries, extensive use of CASE statements for dynamic categorization (e.g., masthead groups, recognition types), and conditional metric selection based on hardcoded date parameters and week calculations. The dashboard queries often involve complex transformations to derive dimensions and filter criteria. High consolidation potential exists by abstracting common categorization logic and parameter-driven metric selection into reusable components or views, reducing redundant logic.",15,mixed,20
57d87efe-c112-4d42-be1b-045f0c8ca73e,Commercial Finance Scorecards,ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard;ncau-data-newsquery-prd.prstn_finance.calendar_dim,finance,8,7,"The SQL queries exhibit high complexity due to multiple layers of nested subqueries (up to 7 levels), intricate CASE statements for date calculations and categorical groupings, and extensive use of aliasing (`clmnX_`). This makes the queries difficult to read and maintain. The dashboard uses two primary tables, but the financial metrics are predominantly derived from the same `consumer_masthead_scorecard` table, with slight variations in column names (`_V` suffix vs. no suffix) and selected metrics across different queries. This redundancy suggests a high potential for consolidation into a more streamlined data model or set of views, reducing query duplication and improving performance and maintainability.",54,weekly,21
f502f44a-e283-405f-ab8f-6a641edb4194,FY25 Campaigns Report,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard;ncau-data-newsquery-prd.asl_finance_derived_archive.details_dashboard_archive_FY25_T,finance,7,8,"The dashboard uses multiple subqueries and complex WHERE clauses with extensive NOT IN lists for filtering dimensions. Gross revenue is calculated under various specific conditions, indicating a high potential for metric consolidation through parameterized queries or a more flexible data model. The use of two different tables, one being an archive, adds a layer of complexity.",3,yearly,22
712ca6fe-b491-4a01-af6e-1495fb3c7d12,Finance Data Checks,ncau-data-newsquery-prd.finance_monthend_checks.v_subs_rateplangroup_check;ncau-data-newsquery-prd.finance_monthend_checks.v_persisted_os_nulls_Check;ncau-data-newsquery-prd.finance_monthend_checks.v_missing_Bus_check,finance,2,3,"The SQL queries are very simple, primarily involving basic aggregations (COUNT, SUM) and selections from single tables. There are no complex joins, window functions, or intricate CASE statements. The dashboard appears to be a collection of distinct data quality checks, each targeting a different view/table, which inherently limits consolidation opportunities between the identified metrics.",3,mixed,23
d7412673-0af1-4efe-8374-ca475b001fb6,Finance OS datasource template report,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,finance,7,8,"High complexity due to deeply nested CTEs and multiple joins, especially the large `OSandFACT` CTE which is duplicated across all queries. High consolidation potential as the core data preparation logic is identical, suggesting a need for a common, pre-joined view or a more efficient data model to reduce redundant processing and improve query performance.",4,weekly,24
6a26c78f-0070-4fb3-88b8-691ee4a4485a,Circ Budget Revenue Weekly Report,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,finance,8,8,"The SQL queries are highly nested with multiple subqueries and complex CASE statements used for both dimension standardization and metric calculation. Many metrics are variations of core financial figures (Actual, Budget, Forecast) filtered by time periods (e.g., 'past weeks', 'fiscal week 40 onwards') or specific business dimensions (publication, sales channel). This indicates a high potential for metric consolidation and simplification by abstracting common logic into reusable components. The hardcoded fiscal year 'FY2025' and date '2025-04-15' suggest a need for parameterization.",15,weekly,25
906ca8a7-1733-4a1a-b2f5-2660551f3d3a,Month End Reporting Reconcilation - ME team copy,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_externals;ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses;ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_revenue;ncau-data-newsquery-prd.sbx_fda_corefin.dv_asl_FCT_finance_os_agg_with_hierarchy,finance,7,6,"The dashboard uses multiple distinct financial data sources (`MER_externals`, `monthly_expenses`, `monthly_revenue`, `finance_os_agg`) but consistently applies `fiscal_year`, `month_short_name`, and `os_level_X` dimensions. This indicates a structured financial reporting environment. The SQL queries involve nested subqueries, `SAFE_CAST`, `REGEXP_CONTAINS`, and various aggregations, contributing to a moderate-to-high complexity. While the underlying data is segmented by financial category (revenue, expenses, external), the common dimensions and the dashboard's reconciliation purpose suggest that a consolidated view of these financial figures, perhaps through a unified data model or consistent metric definitions, would be beneficial for comprehensive month-end reporting.",9,mixed,26
23c8b213-a9f0-4158-b8fa-bff14425abb5,TM1 NewsQuery Tables,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions;ncau-data-newsquery-prd.dap_tm1.gl_business_unit_dim,finance,3,2,"SQL queries are straightforward SELECTs from single tables with basic WHERE and GROUP BY clauses. The dashboard reuses identical queries across multiple job IDs, indicating good internal consolidation of query logic. Metrics are distinct across the two primary data sources.",21,weekly,27
a2edd9c0-9f0c-45f4-b481-6ed9e4a3f11d,PACMAN Dashboard - FY25,ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4,finance,8,9,The dashboard's SQL uses complex nested CASE statements to define multiple variations of the 'Expense' metric based on 'Margin_Level' categories. A dynamic dimension selection (though hardcoded to 'Category' in this specific query) adds to the complexity. There is high consolidation potential as many identified metrics are derived from a single base 'Expense' column with different filtering conditions.,7,none,28
2104a3f5-9424-4087-a928-e67fecae789a,Circulation Performance Dashboard,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department,finance,8,9,"High complexity due to deeply nested subqueries and intricate CASE statements for deriving metrics and dimensions (e.g., clmn68_, clmn71_, clmn86_ etc.). The use of fixed dates for 'current' period calculations adds to the obfuscation. High consolidation potential as many metrics are simply filtered or scaled versions of a few core financial figures (Actual, Budget, Volume) by day of week or sales channel. The presence of two distinct sets of WHERE clauses for different dashboard components also indicates room for consolidation.",17,weekly,29
9c8f39dc-bf5f-4292-bfe3-c6e1ec71c588,Streaming Performance FY26,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard;ncau-data-newsquery-prd.sbx_dcp.Progo_Streaming_Tgt;ncau-data-newsquery-prd.sbx_dcp.progo_target_streaming,finance,7,8,"The dashboard queries exhibit moderate complexity due to nested subqueries, `WITH` clauses, and `UNION ALL` operations to combine actuals and targets. Multiple `CASE` statements are used to derive dimensions (e.g., `Rev_Type`, `Target_team_flag`) and specific metric variations (e.g., current vs. previous FY revenue). There's high consolidation potential as the base data preparation logic (CTEs, UNION ALL, initial joins) is heavily duplicated across queries, and several metrics are variations of a core revenue concept.",8,mixed,30
fed70b12-c274-4cde-9920-592ca4c4dab0,Independent Agency Report,ncau-data-newsquery-prd.sbx_dcp.ia;ncau-data-newsquery-prd.asl_finance_derived.revenue_movement,finance,8,8,"High complexity due to deeply nested subqueries and intricate CASE statements for date and fiscal/calendar year logic. The dashboard uses hardcoded dates for 'current date' calculations, which would typically be dynamic in a live environment. High consolidation potential as multiple queries compute the same core revenue metrics (Current Year, Previous Year, and a complex 'Prior Year Adjusted') using different internal aliases, suggesting a lack of a unified metric definition layer. The date calculations are also very complex and could benefit from standardization.",4,mixed,31
d828e66e-2476-4e31-91af-3a202a45f99d,Historic Closing Base and Revenue,ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_base_movement_agg;ncau-data-newsquery-prd.prstn_finance.v_subscription_snapshot_fct;ncau-data-newsquery-prd.prstn_finance.v_subscription_budget_forecast_fct;ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,consumer,8,9,"High complexity due to deeply nested subqueries, extensive CASE statements for dimension derivation, and UNION ALL across multiple fact tables. High consolidation potential as similar derived dimensions (Product, Masthead Grouping) and base metrics (Closing Base, Acquisition Count) are calculated with slight variations or repeated logic across different queries. The date filtering logic is also duplicated.",10,mixed,32
70ed3b92-987b-479b-9ed7-d2903bd2787e,Monthly Invoicing Breakdown,ncau-data-newsquery-prd.asl_finance_derived.details_dashboard,finance,2,8,"Queries are simple selections of single dimensions or hardcoded values from a single table. High consolidation potential as many queries retrieve the same or similar dimensions, likely for filter controls, which could be optimized.",6,none,33
38809f41-7138-4b94-94d1-ae919b2d9517,Adpoint Line Items for Financial Accounting V2,ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client,finance,7,8,"Queries utilize nested selects, DATETIME_TRUNC, SAFE_CAST, and complex WHERE clauses with multiple AND/IN conditions. There is significant repetition of WHERE clauses across different queries, indicating a strong potential for consolidation by defining common base filters and then applying specific dimension/measure selections on top.",17,mixed,34
aca2f032-b796-49a2-89fe-781ca947aa33,Circulation Performance Dashboard,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department,finance,8,8,"The SQL queries exhibit high complexity due to deeply nested subqueries (up to 9 levels), extensive use of `CASE` statements for both metric definition and dimension creation, and intricate date calculations involving fixed dates. There's significant redundancy in metric definitions (e.g., `SUM(clmn0_)` and `SUM(clmn51_)` are identical, and `SUM(clmn56_)` and `SUM(clmn57_)` are identical under the dashboard's outer filters), and the blended amount logic (`clmn54_`) is overly convoluted, suggesting opportunities for simplification and consolidation of metric definitions.",5,weekly,35
a1b901e6-c4fb-44bc-955a-3a7070c15829,Revenue Movement,ncau-data-newsquery-prd.asl_finance_derived.revenue_movement,finance,8,9,"The dashboard queries feature deeply nested subqueries and complex, repeated CASE statements to derive dimensions and conditional measures. This indicates high technical complexity and significant opportunities for consolidation through shared CTEs or views to simplify logic and improve maintainability. Duplicate WHERE clauses further highlight potential for optimization.",14,daily,36
b1c5901f-a535-42eb-870d-05cc025f7c27,OS extract for month end rec,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly,finance,8,9,"High complexity due to deeply nested subqueries, multiple joins, and extensive casting. High consolidation potential as queries are nearly identical, varying only in the specific financial metric (Budget vs. Actual) and filter values (e.g., fiscal week, publication type). A single parameterized query could likely serve multiple dashboard components.",3,weekly,37
6de90f2a-b3f3-46fe-a4fe-13474b2d6618,PACMAN AND EXCLUDE LOD,ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense,finance,8,9,"The SQL queries involve deeply nested subqueries and intricate CASE statements to derive multiple 'Running Expense' metrics based on Category, Source, and Margin_Level. This complexity, combined with the highly repetitive nature of the 'Running_Expense' fields (1-6 for both Actuals/Budget and Consumer/Advertising), indicates significant potential for consolidation and simplification of the underlying data model or metric definitions.",10,yearly,39
1e9c7a29-2613-47b8-85d1-127e5b8c66ac,Cancellations Extract,ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements,finance,7,8,"The dashboard queries consistently use a single complex base table with multiple layers of nested subqueries and extensive CASE statements to derive dimensions. While the core measures (record count, acquisition sum) are simple, the varied filtering and grouping across queries indicate high potential for consolidation into a more unified data model or set of views.",6,weekly,40
52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,Consumer Finance Landing Page,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,finance,1,2,"The dashboard's queries are very basic, primarily fetching total counts and counts by a single dimension ('scenario') from a single table. There are no joins, complex functions, or conditional logic (CASE statements) observed, leading to low complexity. Consolidation opportunities are minimal as the queries are already quite atomic for Looker Studio's typical chart generation.",3,none,41
37641205-ec3e-4184-a5dd-f5ca79248335,Digital Subscriptions Report,ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions,finance,8,9,"The dashboard queries exhibit high complexity due to deeply nested subqueries, extensive use of CASE statements for categorization (e.g., publication groups, recognition types), and intricate date calculations to determine fiscal week/year. The repetition of these complex CASE statements and date logic across multiple queries indicates significant opportunities for consolidation into views or UDFs to improve readability, maintainability, and potentially performance.",3,weekly,43
f9b52275-5924-4afb-8222-2c55854183ba,Finance Health - Check  ,your-gcp-project-id.bdm_finance.__TABLES__;your-gcp-project-id.bdm_circulation.rcti_circulation_volume_revenue_fct,finance,7,3,"The dashboard uses two distinct data sources and serves two different purposes (finance table health monitoring and circulation data analysis), limiting consolidation opportunities. The SQL for finance health involves multiple CTEs and complex CASE logic for alert statuses, contributing to moderate complexity. The circulation data SQL also uses subqueries and complex date calculations.",3,mixed,44
cbab66df-64cb-4ec6-a112-088557684b7e,FY25 OS extract for month end rec,ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_rel_timeperiod_weekly;ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control,finance,8,7,"The dashboard queries utilize complex nested CTEs and multiple joins across several dimension tables to a central financial fact table. The queries are highly repetitive, differing primarily in the specific dimensions selected for grouping and the values used in WHERE clauses (e.g., fiscal year, week, OS levels, publication codes). This indicates a well-defined underlying data model but also significant opportunities for consolidating similar metric calculations into fewer, more flexible components or parameterized queries to reduce redundancy.",17,weekly,45
fbf4d483-b17a-4040-b18c-091481d62200,NewsQuery - Cost Tracking,ncau-tech-mgmt.billing_export.gcp_billing_export_v1_0129CD_D10B4E_0A39B2,finance,4,8,"All queries derive from a single base table and calculate variations of total cost, differing only in grouping dimensions and minor filtering. This indicates high consolidation potential. The SQL itself is not overly complex, mainly standard aggregations and date functions.",7,mixed,46
f353b933-30eb-4853-9976-0d35371db7d7,Month End Reporting Reconcilation,ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_vs_tm1_monthly_expenses,finance,6,8,"The dashboard uses nested subqueries and a complex REGEXP_CONTAINS function for data filtering, contributing to moderate complexity. There is high potential for consolidation as the same core financial metrics (TM1 Amount, Tableau Actual Amount, and their absolute difference) are repeatedly calculated, with variations primarily driven by date filters and a specific business rule on publication codes.",5,monthly,47
415199ee-c67c-4b55-85f1-38b4aa291931,Finance | Business Performance Summary,ncau-data-newsquery-prd.newsquery_data_backup.tableau_operating_statement_query;ncau-data-newsquery-dev.arima_dataset.model_rev;ncau-data-newsquery-dev.arima_dataset.model_vol,finance,9,9,"The SQL queries exhibit high complexity due to deep nesting, extensive use of conditional logic via CASE statements, and the integration of ML.FORECAST models. The same complex CTEs and subqueries are repeated across multiple dashboard queries, indicating significant opportunities for consolidation into a single, optimized view or pre-aggregated tables to improve performance and maintainability.",6,weekly,48
c441950c-1e3f-432c-9838-847d1d315b9e,Circulation Insights for Analysis,ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights;ncau-data-newsquery-prd.prstn_finance.v_calendar_dim,finance,7,8,"The dashboard's SQL queries exhibit deep nesting and repetitive `CASE` statements for deriving metrics and dimensions from a single primary table. This pattern suggests that a more consolidated data model (e.g., a pre-calculated view or a more sophisticated Looker Studio data source setup with calculated fields) could significantly simplify the queries, improve performance, and reduce maintenance. The queries also show specific filtering by year, fiscal week, day of week, sales channel, and publication type, indicating a need for flexible filtering.",5,weekly,49
