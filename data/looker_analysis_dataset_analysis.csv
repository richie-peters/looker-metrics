primary_analysis_sql,structure_sql,validation_sql,business_rules_sql,response_id,dashboard_id
"SELECT
    t0.fy_year,
    t0.fy_week_of_year,
    CASE
        WHEN (t0.masthead_group = 'The Australian') THEN '01.The Australian'
        WHEN (t0.masthead_group = 'Metros') THEN '02.Metros'
        WHEN (t0.masthead_group = 'Regionals') THEN '03.Regionals'
        WHEN (t0.masthead_group = 'Others') THEN '04.Others'
        WHEN (t0.masthead_group = 'Deep Niche Publications') THEN '05.Deep Niche Publications'
        ELSE 'Discontinued'
    END AS masthead_group_ordered,
    CASE WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition' WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition' ELSE 'Digital Recognition' END AS recognition_type,
    SUM(t0.ClosingBase) AS total_closing_base,
    SUM(t0.OpeningBase) AS total_opening_base,
    SUM(t0.EarnedAmount) AS total_earned_amount
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.fy_year = 2025
GROUP BY
    1, 2, 3, 4
ORDER BY
    t0.fy_year, t0.fy_week_of_year, masthead_group_ordered
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.gl_publication_code AS STRING)) AS unique_publication_codes,
    COUNT(DISTINCT SAFE_CAST(t0.masthead_code AS STRING)) AS unique_masthead_codes,
    MIN(SAFE_CAST(t0.date_column AS DATE)) AS min_date, -- Assuming a 'date_column' exists for actual date, otherwise use a derived date
    MAX(SAFE_CAST(t0.date_column AS DATE)) AS max_date, -- Assuming a 'date_column' exists for actual date
    MIN(SAFE_CAST(t0.fy_year AS INT64)) AS min_fy_year,
    MAX(SAFE_CAST(t0.fy_year AS INT64)) AS max_fy_year
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
LIMIT 1;","SELECT
    CASE WHEN COUNT(*) > 0 THEN 'PASS' ELSE 'FAIL' END AS record_count_check,
    CASE WHEN MAX(t0.fy_year) >= EXTRACT(YEAR FROM CURRENT_DATE()) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check,
    CASE WHEN SUM(t0.ClosingBase) > 0 THEN 'PASS' ELSE 'FAIL' END AS closing_base_positive_check
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
    t0.fy_year = EXTRACT(YEAR FROM CURRENT_DATE())
LIMIT 1;","SELECT
    CASE
        WHEN (masthead_name_derived = 'The Australian') THEN 'The Australian'
        WHEN (t0.masthead_code = 'CM' OR t0.classification_level_2_description = 'Daily Telegraph' OR t0.classification_level_2_description = 'Herald Sun' OR t0.classification_level_2_description = 'The Advertiser') THEN 'Metros'
        WHEN (t0.classification_level_2_description = 'Cairns Post' OR t0.classification_level_2_description = 'Geelong' OR t0.classification_level_2_description = 'Gold Coast' OR t0.classification_level_2_description = 'NT News' OR t0.classification_level_2_description = 'The Mercury' OR t0.classification_level_2_description = 'Toowoomba' OR t0.classification_level_2_description = 'Townsville') THEN 'Regionals'
        WHEN (masthead_name_derived = 'Weekly Times') THEN 'Others'
        WHEN (t0.classification_level_2_description = 'Supercoach Plus' OR t0.classification_level_2_description = 'Code' OR t0.classification_level_2_description = 'Taste Online' OR t0.classification_level_2_description = 'Apple Podcast: Crime X' OR t0.classification_level_2_description = 'Racenet' OR t0.classification_level_2_description = 'Punters' OR t0.classification_level_2_description = 'Others') THEN 'Deep Niche Publications'
        ELSE 'Discontinued'
    END AS masthead_group,
    COUNT(*) AS count_of_subscriptions
FROM
    (
        SELECT
            t0.classification_level_1_description,
            t0.classification_level_2_description,
            t0.delivery_medium_type,
            t0.gl_publication_code,
            t0.masthead_code,
            t0.subscriber_has_email_flag,
            CASE
                WHEN (t0.gl_publication_code = '101' OR t0.gl_publication_code = '100' OR t0.gl_publication_code = '402') THEN 'The Australian'
                WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '401' OR t0.gl_publication_code = '110' OR t0.gl_publication_code = '111') THEN 'Daily Telegraph'
                WHEN (t0.gl_publication_code = '301' OR t0.gl_publication_code = '302' OR t0.gl_publication_code = '303') THEN 'Herald Sun'
                WHEN (t0.gl_publication_code = '500' OR t0.gl_publication_code = '501' OR t0.gl_publication_code = '560') THEN 'The Advertiser'
                WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '460') THEN 'Cairns Post'
                WHEN (t0.gl_publication_code = '350' OR t0.gl_publication_code = '351') THEN 'Geelong'
                WHEN (t0.gl_publication_code = '670' OR t0.gl_publication_code = '685') THEN 'Gold Coast'
                WHEN (t0.gl_publication_code = '961' OR t0.gl_publication_code = '962' OR t0.gl_publication_code = '963') THEN 'NT News'
                WHEN (t0.gl_publication_code = '850' OR t0.gl_publication_code = '851' OR t0.gl_publication_code = '852') THEN 'The Mercury'
                WHEN (t0.gl_publication_code = '5053' OR t0.gl_publication_code = '5253') THEN 'Toowoomba'
                WHEN (t0.gl_publication_code = '475' OR t0.gl_publication_code = '490') THEN 'Townsville'
                WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307') THEN 'Weekly Times'
                WHEN (t0.gl_publication_code = '9001' OR t0.gl_publication_code = '9002') THEN 'Code'
                WHEN (t0.gl_publication_code = '8821' OR t0.gl_publication_code = '8822' OR t0.gl_publication_code = 'Punters.com.au') THEN 'Punters'
                WHEN (t0.gl_publication_code = 'Racenet' OR t0.masthead_code = 'RN') THEN 'Racenet'
                WHEN (t0.gl_publication_code = '9653' OR t0.masthead_code = 'SC') THEN 'Supercoach Plus'
                WHEN (t0.gl_publication_code = '9600' OR t0.masthead_code = 'TS') THEN 'Taste Online'
                WHEN (t0.gl_publication_code = '9003' OR t0.masthead_code = 'AP') THEN 'Apple Podcast: Crime X'
                WHEN (t0.gl_publication_code = '103' OR t0.classification_level_2_description = 'The Oz') THEN 'The Oz'
                WHEN (t0.gl_publication_code = '9000' OR t0.masthead_code = 'NW') THEN 'news.com.au'
                WHEN (t0.gl_publication_code = '121') THEN 'Others'
                WHEN (t0.gl_publication_code = '9002' OR t0.masthead_code = 'BG') THEN 'Brain Games'
                WHEN (t0.gl_publication_code = '9504' OR t0.gl_publication_code = '9514' OR t0.gl_publication_code = '9556' OR t0.gl_publication_code = '9558' OR t0.gl_publication_code = '9560' OR t0.gl_publication_code = '9603' OR t0.gl_publication_code = '9623') THEN 'Others'
                WHEN (t0.gl_publication_code = '9644') THEN 'Suddenly'
                WHEN (t0.gl_publication_code = '9903') THEN 'News Corporate'
                WHEN (t0.gl_publication_code = 'Group Newspaper Management - Digital') THEN 'Group Newspaper Management - Digital'
                ELSE NULL
            END AS masthead_name_derived
        FROM
            `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
    ) AS subquery_t0
GROUP BY
    masthead_group
ORDER BY
    masthead_group
LIMIT 10;",0,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
"SELECT
    SAFE_CAST(t0.fiscal_year AS BIGNUMERIC) AS fiscal_year,
    SAFE_CAST(t0.month_short_name AS STRING) AS month_short_name,
    SAFE_CAST(t0.scenario AS STRING) AS scenario,
    SUM(t0.Actual_Amount) AS total_actual_amount
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
GROUP BY
    1, 2, 3
ORDER BY
    1 DESC, 2 DESC
LIMIT 12;","SELECT
    COUNT(1) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.fiscal_year AS BIGNUMERIC)) AS unique_fiscal_years,
    COUNT(DISTINCT SAFE_CAST(t0.month_short_name AS STRING)) AS unique_months,
    COUNT(DISTINCT SAFE_CAST(t0.scenario AS STRING)) AS unique_scenarios,
    MIN(SAFE_CAST(t0.fiscal_year AS BIGNUMERIC)) AS min_fiscal_year,
    MAX(SAFE_CAST(t0.fiscal_year AS BIGNUMERIC)) AS max_fiscal_year
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
LIMIT 12;","SELECT
    CASE WHEN SUM(t0.Actual_Amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_positive_check,
    CASE WHEN MAX(SAFE_CAST(t0.fiscal_year AS BIGNUMERIC)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS recent_data_check
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
LIMIT 1;","SELECT
    SAFE_CAST(t0.scenario AS STRING) AS scenario,
    COUNT(1) AS record_count
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
GROUP BY
    1
ORDER BY
    2 DESC
LIMIT 12;",1,f353b933-30eb-4853-9976-0d35371db7d7
"SELECT
  SAFE_CAST(financial_year AS INT64) AS financial_year,
  SAFE_CAST(advertiser_name AS STRING) AS advertiser_name,
  IFNULL(SAFE_CAST(current_portfolio_conformed_owner_full_name_current AS STRING), 'VACANT') AS current_owner,
  SUM(gross_revenue_amount) AS total_gross_contra_revenue,
  SUM(CASE WHEN SAFE_CAST(relative_fy_year_offset AS INT64) = 0 THEN gross_revenue_amount ELSE 0 END) AS gross_contra_revenue_current_fy,
  SUM(CASE WHEN SAFE_CAST(revenue_type AS STRING) = 'Digital' THEN gross_revenue_amount ELSE 0 END) AS gross_contra_revenue_digital
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
WHERE
  lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr'
  AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange')
  AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%'
       OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%'
           AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-')))
GROUP BY
  1, 2, 3
ORDER BY
  financial_year DESC, total_gross_contra_revenue DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(adpoint_account_number AS STRING)) AS unique_adpoint_accounts,
  COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertisers,
  MIN(SAFE_CAST(financial_year AS INT64)) AS min_financial_year,
  MAX(SAFE_CAST(financial_year AS INT64)) AS max_financial_year,
  MIN(SAFE_CAST(calendar_year_month AS STRING)) AS min_calendar_year_month,
  MAX(SAFE_CAST(calendar_year_month AS STRING)) AS max_calendar_year_month
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
LIMIT 1;","SELECT
  CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(SAFE_CAST(calendar_year_month AS STRING)) >= FORMAT_DATE('%Y-%m', DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH)) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
WHERE
  lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr'
  AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange')
  AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%'
       OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%'
           AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-')))
LIMIT 1;","SELECT
  sheet_account_flag,
  status_asl,
  COUNT(*) AS record_count
FROM (
  SELECT
    CASE
      WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (
        SELECT DISTINCT SAFE_CAST(NMBS_T_Number AS STRING)
        FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      ) THEN 'Y'
      ELSE 'N'
    END AS sheet_account_flag,
    CASE
      WHEN SAFE_CAST(adpoint_account_number AS STRING) IN (
        SELECT DISTINCT SAFE_CAST(NMBS_T_Number AS STRING)
        FROM `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
        WHERE SAFE_CAST(Status AS STRING) = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr'
    AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange')
    AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED')
    AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE'
    AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
    AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%'
         OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%'
             AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-')))
)
GROUP BY
  sheet_account_flag,
  status_asl
LIMIT 10;",2,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
"SELECT
  t0.Sales_Group,
  t0.financial_year,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_year_gross_revenue,
  SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS last_year_gross_revenue
FROM
  (
    WITH
      SFCE_USER AS (
        SELECT
          TEMP1.network_user_name AS login_name,
          TEMP1.user_name AS full_name
        FROM
          (
            SELECT
              UPPER(network_user_name) AS network_user_name,
              UPPER(user_name) AS user_name,
              ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
            FROM
              `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
            WHERE
              dw_source_system_code = 'SFCE'
          ) AS TEMP1
        WHERE
          TEMP1.RN = 1
      ),
      CTE2 AS (
        SELECT
          financial_year,
          relative_fy_year_offset,
          gross_revenue_amount,
          CASE WHEN sales_segment_l_2_name_sync = 'MRCA' THEN 'MRCA' ELSE 'Client' END AS Sales_Group,
          UPPER(revenue_type) AS revenue_type,
          UPPER(revenue_group_subtype) AS revenue_group_subtype,
          sales_segment_l_2_name_sync,
          advertiser_parent,
          CASE WHEN source_system_code = 'PLUTO' THEN NULL ELSE booking_line_created_date END AS booking_line_created_date
        FROM
          `ncau-data-newsquery-prd`.asl_advertising.v_adsales_revenue_client_weekly
          LEFT JOIN
          SFCE_USER AS GSD_JOIN
          ON UPPER(current_portfolio_group_owner_sync) = GSD_JOIN.login_name
        WHERE
          relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND account_number IN ('17114', '29172', '52809')))
        GROUP BY ALL
      )
    SELECT
      *,
      MIN(CASE WHEN advertiser_parent = ""DOUBLECLICK"" THEN CAST(booking_line_created_date AS DATE) END) OVER (PARTITION BY financial_year) AS fix_date_lod
    FROM
      CTE2
  ) AS t0
WHERE
  t0.Sales_Group = 'Client'
GROUP BY
  t0.Sales_Group,
  t0.financial_year
ORDER BY
  t0.financial_year DESC
LIMIT 5;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(advertiser_group AS STRING)) AS unique_advertiser_groups,
  COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertiser_names,
  MIN(SAFE_CAST(booking_line_created_date AS DATE)) AS min_booking_date,
  MAX(SAFE_CAST(booking_line_created_date AS DATE)) AS max_booking_date
FROM
  `ncau-data-newsquery-prd`.asl_advertising.v_adsales_revenue_client_weekly
LIMIT 1;","SELECT
  CASE
    WHEN SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS current_year_revenue_check,
  CASE
    WHEN MAX(SAFE_CAST(booking_line_created_date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd`.asl_advertising.v_adsales_revenue_client_weekly
WHERE
  UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
LIMIT 1;","SELECT
  CASE WHEN sales_segment_l_2_name_sync = 'MRCA' THEN 'MRCA' ELSE 'Client' END AS Sales_Group,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd`.asl_advertising.v_adsales_revenue_client_weekly
WHERE
  relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
GROUP BY
  Sales_Group
ORDER BY
  record_count DESC
LIMIT 5;",4,1a5f7b4e-ea3a-46e4-8b77-b428f4178510
"SELECT
  t0.portfolio_conformed_name_current,
  t0.sales_segment_l_2_name,
  t0.revenue_group_subtype,
  SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
  SUM(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END) AS future_fy_gross_revenue,
  SUM(
    CASE
      WHEN (t0.relative_fy_year_offset = 0 AND UPPER(SAFE_CAST(t0.unified_publication_name AS STRING)) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE')) THEN t0.gross_revenue_amount
      WHEN (t0.relative_fy_year_offset = 0 AND
            (CASE
              WHEN (t0.revenue_type = 'DIGITAL' AND t0.revenue_group_subtype = 'DIGITAL' AND t0.sales_segment_l_2_name_sync = 'Digital Other' AND t0.advertiser_parent != 'DOUBLECLICK') THEN t0.fix_date_lod
              ELSE PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)
            END) <= DATETIME_ADD(SAFE_CAST(CURRENT_DATE() AS DATETIME), INTERVAL -365 DAY)
           ) THEN t0.gross_revenue_amount
      ELSE 0
    END
  ) AS digital_other_revenue_current_fy
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  t0.portfolio_conformed_name_current,
  t0.sales_segment_l_2_name,
  t0.revenue_group_subtype
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.advertiser_parent AS STRING)) AS unique_advertiser_parents,
  COUNT(DISTINCT SAFE_CAST(t0.portfolio_conformed_name_current AS STRING)) AS unique_portfolios,
  MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
  MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  SAFE_CAST(t0.relative_fy_year_offset AS STRING) AS relative_fy_offset,
  COUNT(*) AS record_count,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  relative_fy_offset
ORDER BY
  relative_fy_offset
LIMIT 12;",5,9269e9c6-1ad0-4415-96c3-aca8a710ba01
"SELECT
  t0.masthead_group,
  t0.fy_year,
  SUM(CASE WHEN ((t0.fy_week_of_year = 37) AND (t0.fy_year = 2025)) THEN t0.BudgetEarnedAmount ELSE 0 END) AS current_week_budget_earned_amount,
  SUM(CASE WHEN ((t0.fy_year = 2025) AND (t0.fy_week_of_year = 37)) THEN t0.ClosingBase ELSE 0 END) AS current_week_closing_base,
  SUM(CASE WHEN ((t0.fy_year = 2025) AND (t0.fy_week_of_year = 37)) THEN t0.OpeningBase ELSE 0 END) AS current_week_opening_base,
  SUM(CASE WHEN ((t0.fy_year = 2025) AND (t0.fy_week_of_year = 37)) THEN t0.EarnedAmount ELSE 0 END) AS current_week_earned_amount
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
  t0.masthead_group != 'Discontinued'
  AND t0.finance_recognition = 'Digital Recognition'
GROUP BY
  1, 2
ORDER BY
  1, 2 DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.masthead_group AS STRING)) AS unique_masthead_groups,
  MIN(SAFE_CAST(t0.fy_year AS INT64)) AS min_fy_year,
  MAX(SAFE_CAST(t0.fy_year AS INT64)) AS max_fy_year,
  MIN(SAFE_CAST(t0.fy_week_of_year AS INT64)) AS min_fy_week_of_year,
  MAX(SAFE_CAST(t0.fy_week_of_year AS INT64)) AS max_fy_week_of_year
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(CASE WHEN ((t0.fy_year = 2025) AND (t0.fy_week_of_year = 37)) THEN t0.EarnedAmount ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS earned_amount_positive_check,
  CASE WHEN MAX(SAFE_CAST(t0.fy_year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS recent_year_check
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
  t0.masthead_group != 'Discontinued'
  AND t0.finance_recognition = 'Digital Recognition'
LIMIT 1;","SELECT
  SAFE_CAST(t0.finance_recognition AS STRING) AS finance_recognition_type,
  COUNT(1) AS record_count
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
GROUP BY
  1
ORDER BY
  2 DESC
LIMIT 5;",6,bb49fa78-5abe-4e68-a9c1-8172a832e724
"SELECT
  SAFE_CAST(t0.Fiscal_Year AS INT64) AS Fiscal_Year,
  t0.Category AS Category,
  t0.Margin_Level AS Margin_Level,
  SUM(t0.Product_Revenue) AS Total_Product_Revenue,
  SUM(t0.Running_Expense_ADVERTISING_1) AS Total_Advertising_Expense_Level_1
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0
GROUP BY 1, 2, 3
ORDER BY 1 DESC, 2, 3
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.Fiscal_Year AS INT64)) AS unique_fiscal_years,
  MIN(SAFE_CAST(t0.Fiscal_Year AS INT64)) AS min_fiscal_year,
  MAX(SAFE_CAST(t0.Fiscal_Year AS INT64)) AS max_fiscal_year,
  COUNT(DISTINCT t0.Category) AS unique_categories,
  COUNT(DISTINCT t0.Margin_Level) AS unique_margin_levels
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0
LIMIT 1;","SELECT
  CASE
    WHEN SUM(t0.Product_Revenue) > 0 AND MAX(SAFE_CAST(t0.Fiscal_Year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS'
    ELSE 'FAIL'
  END AS data_validation_status
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0
WHERE SAFE_CAST(t0.Fiscal_Year AS INT64) = EXTRACT(YEAR FROM CURRENT_DATE()) OR SAFE_CAST(t0.Fiscal_Year AS INT64) = EXTRACT(YEAR FROM CURRENT_DATE()) - 1
LIMIT 1;","SELECT
  t0.Category,
  SAFE_CAST(t0.Margin_Level AS STRING) AS Margin_Level,
  COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0
WHERE t0.Category IN ('CONSUMER', 'ADVERTISING') AND SAFE_CAST(t0.Margin_Level AS STRING) IN ('1', '2', '3', '4', '5', '6')
GROUP BY 1, 2
ORDER BY 1, 2
LIMIT 12;",7,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
"SELECT t0.Advertiser, SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) AS month_start_date, SUM(t0.RevenueGross) AS total_gross_revenue, SUM(t0.RevenueNet) AS total_net_revenue, SUM(t0.PaidImpressions) AS total_paid_impressions FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 GROUP BY t0.Advertiser, month_start_date ORDER BY month_start_date DESC, t0.Advertiser LIMIT 10","SELECT COUNT(*) AS total_records, COUNT(DISTINCT t0.Advertiser) AS unique_advertisers, COUNT(DISTINCT t0.DSP) AS unique_dsps, COUNT(DISTINCT t0.Source) AS unique_sources, COUNT(DISTINCT t0.Buyer) AS unique_buyers, MIN(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE)) AS min_month_date, MAX(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE)) AS max_month_date FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 LIMIT 1","SELECT CASE WHEN SUM(t0.RevenueGross) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check, CASE WHEN MAX(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.CalendarYear, t0.CalendarMonth, 1) AS DATETIME), MONTH) AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH) THEN 'PASS' ELSE 'FAIL' END AS freshness_check FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 LIMIT 1","SELECT t0.TransactionType, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0 WHERE t0.TransactionType IN ('Deal', 'Direct', 'Guaranteed', 'Open Auction') GROUP BY t0.TransactionType ORDER BY record_count DESC LIMIT 5",8,87651b69-c43e-471f-9c4b-98df1208a844
"SELECT financial_year, SAFE_CAST(financial_month AS FLOAT64) AS financial_month, SUM(gross_revenue_amount) AS total_gross_revenue, SUM(rebate_3_amount) AS total_rebate_3, SUM(adjustment_amount) AS total_adjustment FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') GROUP BY financial_year, financial_month ORDER BY financial_year DESC, financial_month DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT account_number) AS unique_accounts, COUNT(DISTINCT advertiser_name) AS unique_advertisers, MIN(SAFE_CAST(financial_year AS STRING)) AS min_financial_year, MAX(SAFE_CAST(financial_year AS STRING)) AS max_financial_year, MIN(SAFE_CAST(financial_month AS FLOAT64)) AS min_financial_month, MAX(SAFE_CAST(financial_month AS FLOAT64)) AS max_financial_month FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` LIMIT 1;","SELECT CASE WHEN MAX(SAFE_CAST(financial_year AS STRING)) = '2025' THEN 'PASS' ELSE 'FAIL' END AS latest_year_check, CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS positive_revenue_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE SAFE_CAST(financial_year AS STRING) = '2025' LIMIT 1;","SELECT revenue_transaction_status, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` GROUP BY revenue_transaction_status ORDER BY record_count DESC LIMIT 5;",9,a17622e2-ad43-49cc-b3c5-19c95036fd14
"SELECT
    t0.product_group,
    t0.advertiser_group,
    SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS current_fy_gross_revenue_k_aud,
    SUM(SAFE_DIVIDE(CASE WHEN (t0.relative_fy_year_offset = -1 AND t0.stly_flag = 'Y') THEN t0.gross_revenue_amount ELSE 0 END, 1000)) AS stly_gross_revenue_k_aud
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
WHERE
    t0.relative_fy_year_offset IN (0, -1)
GROUP BY
    t0.product_group,
    t0.advertiser_group
ORDER BY
    current_fy_gross_revenue_k_aud DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.advertiser_group) AS unique_advertiser_groups,
    COUNT(DISTINCT t0.product_group) AS unique_product_groups,
    MIN(t0.financial_week) AS min_financial_week,
    MAX(t0.financial_week) AS max_financial_week,
    MIN(t0.relative_fy_year_offset) AS min_fy_offset,
    MAX(t0.relative_fy_year_offset) AS max_fy_offset
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS'
        ELSE 'FAIL'
    END AS gross_revenue_check,
    CASE
        WHEN MAX(t0.relative_fy_year_offset) = 0 THEN 'PASS'
        ELSE 'FAIL'
    END AS current_fy_data_check,
    CASE
        WHEN MAX(SAFE_CAST(t0.financial_week AS INT64)) >= (EXTRACT(WEEK FROM CURRENT_DATE()) - 4) THEN 'PASS'
        ELSE 'FAIL'
    END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    t0.relative_fy_year_offset,
    t0.is_future_period_flag,
    t0.stly_flag,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    t0.relative_fy_year_offset,
    t0.is_future_period_flag,
    t0.stly_flag
ORDER BY
    t0.relative_fy_year_offset, t0.is_future_period_flag, t0.stly_flag
LIMIT 12;",11,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
"SELECT
    t0.fy_year,
    t0.fy_week_of_year,
    t0.masthead,
    SUM(t0.Total_Revenue) AS total_revenue,
    SUM(t0.Total_Weekly_Sales) AS total_weekly_sales,
    SUM(t0.Total_Closing_Base) AS total_closing_base,
    SUM(t0.Net_Growth_Consumer) AS net_growth_consumer
FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0
GROUP BY 1, 2, 3
ORDER BY 1 DESC, 2 DESC, 3
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.fy_year AS STRING) || '-' || SAFE_CAST(t0.fy_week_of_year AS STRING)) AS unique_fiscal_weeks,
    COUNT(DISTINCT t0.masthead) AS unique_mastheads,
    MIN(t0.fy_year) AS min_fy_year,
    MAX(t0.fy_year) AS max_fy_year,
    MIN(t0.fy_week_of_year) AS min_fy_week_of_year,
    MAX(t0.fy_week_of_year) AS max_fy_week_of_year
FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(t0.Total_Revenue) > 0 THEN 'PASS' ELSE 'FAIL' END AS total_revenue_check,
    CASE WHEN MAX(t0.fy_year) = 2025 THEN 'PASS' ELSE 'FAIL' END AS data_fy_year_check
FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN t0.masthead = 'TA' THEN 'The Australian'
        WHEN t0.masthead = 'DT' THEN 'Daily Telegraph'
        WHEN t0.masthead = 'HS' THEN 'Herald Sun'
        WHEN t0.masthead = 'WT' THEN 'Weekly Times'
        WHEN t0.masthead = 'GA' THEN 'Geelong Advertiser'
        WHEN t0.masthead = 'CM' THEN 'Courier Mail'
        WHEN t0.masthead = 'CP' THEN 'Cairns Post'
        WHEN t0.masthead = 'TB' THEN 'Townsville Bulletin'
        WHEN t0.masthead = 'TC' THEN 'Toowoomba Chronicles'
        WHEN t0.masthead = 'GC' THEN 'Gold Coast'
        WHEN t0.masthead = 'TM' THEN 'The Mercury'
        WHEN t0.masthead = 'NT' THEN 'NT News'
        WHEN t0.masthead = 'AA' THEN 'The Advertiser'
        ELSE 'Unknown'
    END AS masthead_full_name,
    CASE
        WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT') THEN 'States and Community'
        WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
        ELSE 'Unknown'
    END AS masthead_group_1,
    CASE
        WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
        WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT') THEN 'Regionals'
        ELSE 'Unknown'
    END AS masthead_group_2,
    COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0
GROUP BY 1, 2, 3
ORDER BY 4 DESC
LIMIT 10;",12,57d87efe-c112-4d42-be1b-045f0c8ca73e
"SELECT financial_year, financial_month, sales_segment_l_2_name_sync, SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) AS gross_revenue_current_fy, SUM(CASE WHEN relative_fy_year_offset = 0 THEN pipeline ELSE 0 END) AS pipeline_current_fy, SUM(pipeline) AS total_pipeline, MAX(sales_segment_l_2_name_sync = 'Digital Other') AS is_digital_other_segment_present FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` WHERE relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND account_number IN ('17114', '29172', '52809'))) GROUP BY financial_year, financial_month, sales_segment_l_2_name_sync ORDER BY financial_year DESC, financial_month DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertisers, COUNT(DISTINCT SAFE_CAST(sales_segment_l_2_name_sync AS STRING)) AS unique_sales_segments, MIN(SAFE_CAST(financial_year AS INT64)) AS min_financial_year, MAX(SAFE_CAST(financial_year AS INT64)) AS max_financial_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` LIMIT 1;","SELECT CASE WHEN SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS current_fy_revenue_check, CASE WHEN MAX(SAFE_CAST(financial_year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` WHERE UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') LIMIT 1;","SELECT CASE WHEN sales_segment_l_2_name_sync = 'MRCA' THEN 'MRCA' ELSE 'Client' END AS Sales_Group_Derived, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` WHERE relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED') GROUP BY Sales_Group_Derived LIMIT 2;",13,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
"SELECT
  t0.fiscal_week_id,
  t0.sales_channel_l4,
  t0.day_of_week,
  SUM(CASE WHEN SAFE_CAST(t0.charge_type AS STRING) = 'DRAW' THEN SAFE_CAST(t0.route_volume AS BIGNUMERIC) ELSE 0 END) AS total_draw_volume,
  SUM(CASE WHEN SAFE_CAST(t0.charge_type AS STRING) = 'RETURNS' THEN SAFE_CAST(t0.route_volume AS BIGNUMERIC) ELSE 0 END) AS total_returns_volume,
  SUM(SAFE_CAST(t0.charge_amount AS BIGNUMERIC)) AS total_charge_amount
FROM
  (
    SELECT
      ci.fiscal_week_id,
      ci.sales_channel_l4,
      ci.charge_type,
      ci.route_volume,
      ci.charge_amount,
      cal.day_short_name AS day_of_week
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
      LEFT JOIN
      `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
      ON ci.charge_date = cal.calendar_date
    WHERE
      SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025
  ) AS t0
GROUP BY
  t0.fiscal_week_id,
  t0.sales_channel_l4,
  t0.day_of_week
ORDER BY
  t0.fiscal_week_id DESC, total_draw_volume DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(ci.fiscal_week_id AS STRING)) AS unique_fiscal_weeks,
  COUNT(DISTINCT SAFE_CAST(ci.charge_date AS DATE)) AS unique_charge_dates,
  COUNT(DISTINCT SAFE_CAST(ci.sales_channel_l4 AS STRING)) AS unique_sales_channels_l4,
  COUNT(DISTINCT SAFE_CAST(ci.gl_publication_code AS STRING)) AS unique_publication_codes,
  MIN(SAFE_CAST(ci.charge_date AS DATE)) AS min_charge_date,
  MAX(SAFE_CAST(ci.charge_date AS DATE)) AS max_charge_date,
  MIN(SAFE_CAST(ci.fiscal_week_id AS INT64)) AS min_fiscal_week_id,
  MAX(SAFE_CAST(ci.fiscal_week_id AS INT64)) AS max_fiscal_week_id
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
WHERE
  SAFE_CAST(LEFT(SAFE_CAST(fiscal_week_id AS STRING), 4) AS INT64) = 2025
LIMIT 1;","SELECT
  CASE
    WHEN SUM(CASE WHEN SAFE_CAST(charge_type AS STRING) = 'DRAW' THEN SAFE_CAST(route_volume AS BIGNUMERIC) ELSE 0 END) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS total_draw_volume_check,
  CASE
    WHEN MAX(SAFE_CAST(charge_date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`
WHERE
  SAFE_CAST(LEFT(SAFE_CAST(fiscal_week_id AS STRING), 4) AS INT64) = 2025
LIMIT 1;","SELECT
  CASE
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('500', '560') THEN 'ADV'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '100' THEN 'AUS'
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('400', '402') THEN 'CM'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '9504' THEN 'Delicious'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '9505' THEN 'Delicious Specials'
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('110', '116') THEN 'DT'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '350' THEN 'GAD'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '670' THEN 'GCB'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '180' THEN 'Group Shared Services'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '156' THEN 'Hobart Print Services'
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('301', '303') THEN 'HS'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '5003' THEN 'MDM'
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('850', '852') THEN 'MERCURY'
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('961', '963') THEN 'NTN'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '158' THEN 'Perth Print Services'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = 'Post Courier' THEN 'Post Courier'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '5024' THEN 'SC'
    WHEN SAFE_CAST(gl_publication_code AS STRING) IN ('9514', '9515') THEN 'Taste'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '5053' THEN 'TCHRN'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '450' THEN 'TCP'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '475' THEN 'TVB'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '9560' THEN 'Vogue'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '9556' THEN 'Vogue Living'
    WHEN SAFE_CAST(gl_publication_code AS STRING) = '305' THEN 'WT'
    ELSE 'Other'
  END AS mapped_publication_name,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`
WHERE
  SAFE_CAST(LEFT(SAFE_CAST(fiscal_week_id AS STRING), 4) AS INT64) = 2025
GROUP BY
  mapped_publication_name
ORDER BY
  record_count DESC
LIMIT 10;",14,c441950c-1e3f-432c-9838-847d1d315b9e
"SELECT
    t0.financial_year,
    SAFE_CAST(t0.financial_quarter AS INT64) AS financial_quarter,
    t0.sales_segment_l_2_name,
    SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
    SUM(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END) AS prior_fy_gross_revenue,
    SUM(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.pipeline ELSE 0 END) AS prior_fy_pipeline
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    t0.financial_year,
    financial_quarter,
    t0.sales_segment_l_2_name
ORDER BY
    t0.financial_year DESC, financial_quarter DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.financial_year AS STRING)) AS unique_financial_years,
    COUNT(DISTINCT t0.product_group) AS unique_product_groups,
    COUNT(DISTINCT t0.sales_segment_l_2_name) AS unique_sales_segments,
    MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
    MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date,
    MIN(t0.dw_asl_load_timestamp) AS min_load_timestamp,
    MAX(t0.dw_asl_load_timestamp) AS max_load_timestamp
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) > 0 THEN 'PASS'
        ELSE 'FAIL'
    END AS current_fy_revenue_check,
    CASE
        WHEN MAX(t0.dw_asl_load_timestamp) >= DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 7 DAY) THEN 'PASS'
        ELSE 'FAIL'
    END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE WHEN t0.unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin', 'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News', 'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin', 'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs' ELSE 'Non Sundry Pubs' END AS publication_group,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    publication_group
LIMIT 10;",15,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
"SELECT
  t0.publication_name,
  t0.os_level_7,
  t0.fy_year_week_number,
  SUM(t0.Actual_Amount) AS total_actual_amount,
  SUM(t0.volume) AS total_volume,
  SUM(t0.Budget_Amount) AS total_budget_amount,
  SUM(t0.Forecast_Amount) AS total_forecast_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
GROUP BY
  t0.publication_name,
  t0.os_level_7,
  t0.fy_year_week_number
ORDER BY
  t0.fy_year_week_number DESC, total_actual_amount DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.publication_name AS STRING)) AS unique_publication_names,
  COUNT(DISTINCT SAFE_CAST(t0.os_level_7 AS STRING)) AS unique_os_level_7,
  COUNT(DISTINCT SAFE_CAST(t0.fiscal_week_id AS STRING)) AS unique_fiscal_week_ids,
  MIN(SAFE_CAST(calendar.fy_first_day_of_week AS DATE)) AS min_date,
  MAX(SAFE_CAST(calendar.fy_first_day_of_week AS DATE)) AS max_date
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
LIMIT 1;","SELECT
  CASE WHEN SUM(CASE WHEN t0.Actual_Amount > 0 THEN 1 ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_positive_check,
  CASE WHEN MAX(SAFE_CAST(calendar.fy_first_day_of_week AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check,
  CASE WHEN COUNT(1) > 0 THEN 'PASS' ELSE 'FAIL' END AS record_count_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
LIMIT 1;","SELECT
  CASE
    WHEN t0.publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN 'Regionals'
    WHEN t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
    WHEN t0.publication_name IN ('The Australian') THEN 'The Australian'
    WHEN t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
    WHEN t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE 'Other'
  END AS publication_group,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
GROUP BY
  publication_group
ORDER BY
  record_count DESC
LIMIT 10;",16,2104a3f5-9424-4087-a928-e67fecae789a
"SELECT t0.fin_adtype_name, t0.financial_year, SUM(t0.gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.revenue_transaction_status IN ('Booked', 'Billed') AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL) GROUP BY 1, 2 ORDER BY 1, 2 DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT t0.booking_number) AS unique_bookings, COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers, MIN(t0.financial_year) AS min_financial_year, MAX(t0.financial_year) AS max_financial_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 LIMIT 1;","SELECT CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_positive_check, CASE WHEN MAX(t0.financial_year) = '2025' THEN 'PASS' ELSE 'FAIL' END AS latest_year_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year = '2025' LIMIT 1;","SELECT t0.revenue_transaction_status, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 GROUP BY 1 ORDER BY 2 DESC LIMIT 5;",17,f65a9149-93b4-4aa9-aef6-d12002853222
"SELECT
    t0.agency_parent,
    t0.relative_fy_year_offset,
    t0.relative_cal_year_offset,
    SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
    SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue,
    SUM(CASE WHEN t0.relative_cal_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_cal_gross_revenue
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
WHERE
    (t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL)
GROUP BY
    t0.agency_parent,
    t0.relative_fy_year_offset,
    t0.relative_cal_year_offset
ORDER BY
    t0.agency_parent, t0.relative_fy_year_offset DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.agency_parent) AS unique_agency_parents,
    COUNT(DISTINCT t0.IA_MAPPING) AS unique_ia_mappings,
    MIN(t0.booking_line_created_date) AS min_booking_date,
    MAX(t0.booking_line_created_date) AS max_booking_date
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS current_fy_revenue_check,
    CASE WHEN MAX(t0.booking_line_created_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('ATOMIC', 'ATOMIC212') THEN 'Atomic'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('HOWASTON', 'HOWATSON + CO', 'HOWATSON+CO', 'HOWATSON') THEN 'Howatson'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('HAVAS', 'FRONTIER') THEN 'Havas/Frontier'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('THUMP', 'THUMP TRAVEL') THEN 'Thump Media'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('TTB', 'TODAY THE BRAVE') THEN 'Today The Brave'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('NUNN', 'NUNN MEDIA') THEN 'Nunn'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'NUNN VIC' THEN 'Nunn Melbourne'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'RYVALMEDIA' THEN 'Ryval'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'HALF DOME' THEN 'Half Dome'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'M2 MARKETING' THEN 'PMA'
        ELSE UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING))
    END AS mapped_agency_name,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
GROUP BY
    mapped_agency_name
ORDER BY
    record_count DESC
LIMIT 10;",18,fed70b12-c274-4cde-9920-592ca4c4dab0
"SELECT t0.financial_year, t0.revenue_group_subtype, t0.source_publishing_division, SUM(t0.gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') AND t0.revenue_group_subtype IN ('Digital', 'Print') GROUP BY t0.financial_year, t0.revenue_group_subtype, t0.source_publishing_division ORDER BY t0.financial_year DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers, COUNT(DISTINCT t0.booking_number) AS unique_bookings, MIN(SAFE_CAST(t0.calendar_year AS STRING) || '-' || LPAD(SAFE_CAST(t0.calendar_month AS STRING), 2, '0') || '-01') AS min_calendar_date, MAX(SAFE_CAST(t0.calendar_year AS STRING) || '-' || LPAD(SAFE_CAST(t0.calendar_month AS STRING), 2, '0') || '-01') AS max_calendar_date, MIN(t0.financial_year) AS min_financial_year, MAX(t0.financial_year) AS max_financial_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 LIMIT 1;","SELECT CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check, CASE WHEN MAX(SAFE_CAST(t0.calendar_year AS STRING) || '-' || LPAD(SAFE_CAST(t0.calendar_month AS STRING), 2, '0') || '-01') >= FORMAT_DATE('%Y-%m-%d', DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY)) THEN 'PASS' ELSE 'FAIL' END AS freshness_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.revenue_transaction_status IN ('Billed', 'Booked') LIMIT 1;","SELECT t0.revenue_transaction_status, t0.revenue_group_subtype, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 GROUP BY t0.revenue_transaction_status, t0.revenue_group_subtype ORDER BY record_count DESC LIMIT 10;",19,c560ed20-040d-4c6a-9c3f-ec8bce27d132
"SELECT
    t0.Source,
    t0.FinancialYear,
    t0.FinancialMonthNumber,
    SUM(t0.RevenueNet) AS total_revenue_net,
    SUM(SAFE_DIVIDE(t0.RevenueNet, t0.NumDays) * t0.StaticDays) AS total_adjusted_revenue
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
GROUP BY
    1, 2, 3
ORDER BY
    t0.FinancialYear DESC, t0.FinancialMonthNumber DESC
LIMIT 10;","SELECT
    COUNT(1) AS total_records,
    COUNT(DISTINCT t0.Source) AS unique_sources,
    MIN(SAFE_CAST(CONCAT(SAFE_CAST(t0.FinancialYear AS STRING), '-', LPAD(SAFE_CAST(t0.FinancialMonthNumber AS STRING), 2, '0'), '-01') AS DATE)) AS min_financial_date,
    MAX(SAFE_CAST(CONCAT(SAFE_CAST(t0.FinancialYear AS STRING), '-', LPAD(SAFE_CAST(t0.FinancialMonthNumber AS STRING), 2, '0'), '-01') AS DATE)) AS max_financial_date
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(t0.RevenueNet) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_positive_check,
    CASE WHEN MAX(SAFE_CAST(CONCAT(SAFE_CAST(t0.FinancialYear AS STRING), '-', LPAD(SAFE_CAST(t0.FinancialMonthNumber AS STRING), 2, '0'), '-01') AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
LIMIT 1;","SELECT
    t0.TransactionType,
    COUNT(1) AS count_transactions
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` AS t0
GROUP BY
    t0.TransactionType
ORDER BY
    count_transactions DESC
LIMIT 5;",20,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
"SELECT
  SAFE_CAST(financial_year AS STRING) AS financial_year,
  SAFE_CAST(fy_year_month_number AS INT64) AS fy_year_month_number,
  SAFE_CAST(source_unified_publication_name AS STRING) AS source_unified_publication_name,
  CASE
    WHEN SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$') THEN 'Sponsorship'
    WHEN SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$') THEN 'Production'
    ELSE 'Media'
  END AS ad_type,
  SUM(gross_revenue_amount) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
GROUP BY
  1, 2, 3, 4
ORDER BY
  financial_year DESC, fy_year_month_number DESC
LIMIT 10","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertisers,
  COUNT(DISTINCT SAFE_CAST(booking_number AS STRING)) AS unique_bookings,
  MIN(SAFE_CAST(financial_year AS STRING)) AS min_financial_year,
  MAX(SAFE_CAST(financial_year AS STRING)) AS max_financial_year,
  MIN(SAFE_CAST(fy_year_month_number AS INT64)) AS min_fy_year_month_number,
  MAX(SAFE_CAST(fy_year_month_number AS INT64)) AS max_fy_year_month_number
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
LIMIT 1","SELECT
  CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(SAFE_CAST(financial_year AS STRING)) >= '2024' THEN 'PASS' ELSE 'FAIL' END AS recent_data_check
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (0)
LIMIT 1","SELECT
  CASE
    WHEN SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$') THEN 'Sponsorship'
    WHEN SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$') THEN 'Production'
    ELSE 'Media'
  END AS ad_type,
  COUNT(*) AS record_count,
  SUM(gross_revenue_amount) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
GROUP BY
  ad_type
ORDER BY
  record_count DESC
LIMIT 12",21,e83da1de-4227-43e6-bcc6-73051c66914b
"SELECT t0.FinancialYear, t0.FinancialQuarter, t0.Advertiser, t0.State, SUM(t0.RevenueGross) AS total_gross_revenue, COUNT(DISTINCT t0.DSP) AS unique_dsps FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 GROUP BY t0.FinancialYear, t0.FinancialQuarter, t0.Advertiser, t0.State ORDER BY t0.FinancialYear DESC, t0.FinancialQuarter DESC LIMIT 10","SELECT COUNT(*) AS total_records, COUNT(DISTINCT t0.Advertiser) AS unique_advertisers, COUNT(DISTINCT t0.DSP) AS unique_dsps, COUNT(DISTINCT t0.PortfolioParentGroup) AS unique_parent_groups, COUNT(DISTINCT t0.PortfolioChildGroup) AS unique_child_groups, MIN(t0.FinancialYear) AS min_financial_year, MAX(t0.FinancialYear) AS max_financial_year, MIN(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATETIME), MONTH) AS DATE)) AS min_financial_month_date, MAX(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATETIME), MONTH) AS DATE)) AS max_financial_month_date FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 LIMIT 1","SELECT CASE WHEN (SUM(t0.RevenueGross) > 0) THEN 'PASS' ELSE 'FAIL' END AS revenue_check, CASE WHEN (MAX(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATETIME), MONTH) AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH)) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 LIMIT 1","SELECT SAFE_CAST(t0.TransactionType AS STRING) AS transaction_type, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 GROUP BY SAFE_CAST(t0.TransactionType AS STRING) ORDER BY record_count DESC LIMIT 10",22,6f1c8731-02da-464f-b146-bf2947860735
"WITH
  adex_data AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
    WHERE
      source = 'Adex'
  ),
  union_table AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
  ),
  TEMP1 AS (
    SELECT
      *,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year
    FROM
      union_table
      CROSS JOIN
      (
        SELECT
          MAX(date) AS latest_date
        FROM
          adex_data
      )
      CROSS JOIN
      (
        SELECT
          MAX(financial_year) AS max_fin_year
        FROM
          adex_data
      )
  ),
  TEMP2 AS (
    SELECT
      *,
      CASE 'Rolling 12 months' -- Assuming 'Rolling 12 months' for @time_period
        WHEN 'Rolling 12 months' THEN
        CASE
          WHEN DATE_DIFF(latest_date, date, MONTH) <= 11 THEN 'ty'
          WHEN DATE_DIFF(latest_date, date, MONTH) BETWEEN 12 AND 23 THEN 'ly'
          ELSE NULL
        END
        WHEN 'Calendar Year' THEN
        CASE
          WHEN date <= latest_date AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(EXTRACT(YEAR FROM latest_date) AS STRING),'-1-1')) THEN 'ty'
          WHEN date <= DATETIME_ADD(latest_date, INTERVAL -1 YEAR) AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(EXTRACT(YEAR FROM latest_date) - 1 AS STRING), '-1-1')) THEN 'ly'
          ELSE NULL
        END
        WHEN 'Financial Year' THEN
        CASE
          WHEN date <= latest_date AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(max_fin_year - 1 AS STRING),'-7-1')) THEN 'ty'
          WHEN date <= DATETIME_ADD(latest_date, INTERVAL -1 YEAR) AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(max_fin_year - 2 AS STRING), '-7-1')) THEN 'ly'
          ELSE NULL
        END
        ELSE NULL
      END AS ty_ly_embed
    FROM
      TEMP1
  )
SELECT
  t0.Major_Category,
  t0.Media_Network,
  t0.calendar_year,
  SUM(CASE WHEN t0.ty_ly_embed = 'ty' THEN SAFE_DIVIDE(t0.Spend, 1000) ELSE 0 END) AS total_spend_k_ty,
  SUM(CASE WHEN t0.ty_ly_embed = 'ly' THEN SAFE_DIVIDE(t0.Spend, 1000) ELSE 0 END) AS total_spend_k_ly,
  SUM(CASE WHEN t0.ty_ly_embed = 'ty' AND t0.Media_Network = 'NEWS CORP' THEN SAFE_DIVIDE(t0.Spend, 1000) ELSE 0 END) AS news_corp_spend_k_ty
FROM
  TEMP2 AS t0
GROUP BY
  t0.Major_Category,
  t0.Media_Network,
  t0.calendar_year
ORDER BY
  t0.calendar_year DESC, total_spend_k_ty DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(Advertiser AS STRING)) AS unique_advertisers,
  COUNT(DISTINCT SAFE_CAST(Media_Network AS STRING)) AS unique_media_networks,
  COUNT(DISTINCT SAFE_CAST(Major_Category AS STRING)) AS unique_major_categories,
  MIN(SAFE_CAST(date AS DATE)) AS min_date,
  MAX(SAFE_CAST(date AS DATE)) AS max_date
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
LIMIT 1;","WITH
  adex_data AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
    WHERE
      source = 'Adex'
  ),
  union_table AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
  ),
  TEMP1 AS (
    SELECT
      *,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year
    FROM
      union_table
      CROSS JOIN
      (
        SELECT
          MAX(date) AS latest_date
        FROM
          adex_data
      )
      CROSS JOIN
      (
        SELECT
          MAX(financial_year) AS max_fin_year
        FROM
          adex_data
      )
  ),
  TEMP2 AS (
    SELECT
      *,
      CASE 'Rolling 12 months' -- Assuming 'Rolling 12 months' for @time_period
        WHEN 'Rolling 12 months' THEN
        CASE
          WHEN DATE_DIFF(latest_date, date, MONTH) <= 11 THEN 'ty'
          WHEN DATE_DIFF(latest_date, date, MONTH) BETWEEN 12 AND 23 THEN 'ly'
          ELSE NULL
        END
        WHEN 'Calendar Year' THEN
        CASE
          WHEN date <= latest_date AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(EXTRACT(YEAR FROM latest_date) AS STRING),'-1-1')) THEN 'ty'
          WHEN date <= DATETIME_ADD(latest_date, INTERVAL -1 YEAR) AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(EXTRACT(YEAR FROM latest_date) - 1 AS STRING), '-1-1')) THEN 'ly'
          ELSE NULL
        END
        WHEN 'Financial Year' THEN
        CASE
          WHEN date <= latest_date AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(max_fin_year - 1 AS STRING),'-7-1')) THEN 'ty'
          WHEN date <= DATETIME_ADD(latest_date, INTERVAL -1 YEAR) AND date >= PARSE_DATE('%Y-%m-%d', CONCAT(CAST(max_fin_year - 2 AS STRING), '-7-1')) THEN 'ly'
          ELSE NULL
        END
        ELSE NULL
      END AS ty_ly_embed
    FROM
      TEMP1
  )
SELECT
  CASE WHEN SUM(CASE WHEN t0.ty_ly_embed = 'ty' THEN SAFE_DIVIDE(t0.Spend, 1000) ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS spend_ty_check,
  CASE WHEN MAX(SAFE_CAST(t0.date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  TEMP2 AS t0
LIMIT 1;","SELECT
  CASE
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Print' THEN 'Print'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Digital' AND SAFE_CAST(Ad_Type AS STRING) = 'Display' THEN 'Digital Display'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Digital' AND SAFE_CAST(Ad_Type AS STRING) = 'Video' THEN 'Digital Video'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Social' AND SAFE_CAST(Ad_Type AS STRING) = 'Display' THEN 'Digital Social Display'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Social' AND SAFE_CAST(Ad_Type AS STRING) = 'Video' THEN 'Digital Social Video'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Cinema' THEN 'Cinema'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Out of Home' THEN 'Out of Home'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Radio' THEN 'Radio'
    WHEN SAFE_CAST(Media_Group AS STRING) = 'Television' THEN 'Television'
    ELSE 'Other/Unknown'
  END AS derived_media_group,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
GROUP BY
  derived_media_group
ORDER BY
  record_count DESC
LIMIT 10;",23,601ed0d2-e944-4189-8170-d593c8e72026
"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fy_week_of_year,
  pub.is_print_digital_flag,
  pub.l12_publication_code,
  os.os_level_6,
  os.os_level_9,
  pub.publication_name,
  SUM(os.Actual_Amount) AS total_actual_amount,
  SUM(os.Budget_Amount) AS total_budget_amount,
  SUM(os.Forecast_Amount) AS total_forecast_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
WHERE
  SAFE_CAST(calendar.fy_year AS STRING) = 'FY2025'
  AND os.os_level_4 IN ('Total Revenue', 'Total Expenses')
  AND pub.l03_publication_code = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) IN (40)
GROUP BY
  1, 2, 3, 4, 5, 6
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT os.gl_publication_code) AS unique_publications,
  COUNT(DISTINCT os.fiscal_week_id) AS unique_fiscal_weeks,
  MIN(SAFE_CAST(calendar.fy_first_day_of_week AS DATE)) AS min_date,
  MAX(SAFE_CAST(calendar.fy_last_day_of_week AS DATE)) AS max_date
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.Actual_Amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_check,
  CASE WHEN MAX(SAFE_CAST(calendar.fy_last_day_of_week AS DATE)) >= CURRENT_DATE() - INTERVAL 7 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE SAFE_CAST(calendar.fy_year AS STRING) = 'FY2025'
LIMIT 1;","SELECT
  calendar.month_end_flag,
  COUNT(DISTINCT calendar.fy_year_week_number) AS distinct_weeks_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
WHERE
  SAFE_CAST(calendar.fy_year AS INT) = 2024
GROUP BY
  calendar.month_end_flag
LIMIT 2;",24,b1c5901f-a535-42eb-870d-05cc025f7c27
"SELECT
  t0.portfolio_conformed_name_sync,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_year_gross_revenue,
  SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS last_year_gross_revenue,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.target ELSE 0 END) AS current_year_target
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  t0.portfolio_conformed_name_sync
ORDER BY
  current_year_gross_revenue DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.portfolio_conformed_name_sync) AS unique_portfolios,
  COUNT(DISTINCT t0.advertiser_group) AS unique_advertiser_groups,
  MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
  MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date,
  MIN(SAFE_CAST(t0.fix_date_lod AS DATE)) AS min_fix_date_lod,
  MAX(SAFE_CAST(t0.fix_date_lod AS DATE)) AS max_fix_date_lod
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE
    WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS: Gross Revenue is positive'
    ELSE 'FAIL: Gross Revenue is not positive'
  END AS revenue_check,
  CASE
    WHEN MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) >= DATE_SUB(CURRENT_DATE('Australia/Sydney'), INTERVAL 7 DAY) THEN 'PASS: Data is recent (within 7 days)'
    ELSE 'FAIL: Data is not recent (older than 7 days)'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","WITH
  CTE AS (
    SELECT
      *,
      SUM(CASE WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount ELSE 0 END) OVER (PARTITION BY advertiser_group) AS fix_ly_lgr,
      SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) OVER (PARTITION BY advertiser_group) AS fix_ty_lgr
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance
  )
SELECT
  CASE
    WHEN fix_ly_lgr <= 1 AND fix_ty_lgr > 1 THEN 'NEW BUSINESS'
    WHEN fix_ly_lgr > 1 AND fix_ty_lgr > 1 THEN 'RETAINED'
    WHEN fix_ly_lgr > 1 AND fix_ty_lgr <= 1 THEN 'INACTIVE'
    WHEN fix_ly_lgr <= 1 AND fix_ty_lgr <= 1 THEN 'LAPSED'
    ELSE 'Other'
  END AS customer_status,
  COUNT(*) AS count_of_records
FROM
  CTE
GROUP BY
  customer_status
ORDER BY
  count_of_records DESC
LIMIT 5;",25,155c4518-72bf-4309-a0e9-240dd564f421
"SELECT
    t0.source,
    UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) AS transaction_type,
    SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) AS financial_month_date,
    SUM(t0.revenuenet) AS total_revenue
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
    t0.source IN ('AdX', 'AppNexus', 'DFP', 'Index Exchange', 'InSkin', 'Kargo', 'Playground XYZ', 'PubMatic', 'Rubicon', 'Tremor')
    AND UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
GROUP BY
    1, 2, 3
ORDER BY
    financial_month_date DESC, total_revenue DESC
LIMIT 10;","SELECT
    COUNT(1) AS total_records,
    APPROX_COUNT_DISTINCT(t0.advertiser) AS unique_advertisers,
    APPROX_COUNT_DISTINCT(t0.buyer) AS unique_buyers,
    APPROX_COUNT_DISTINCT(t0.source) AS unique_sources,
    MIN(SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE)) AS min_financial_month_date,
    MAX(SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE)) AS max_financial_month_date
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(t0.revenuenet) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check,
    CASE WHEN MAX(SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
LIMIT 1;","SELECT
    UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) AS transaction_type,
    COUNT(1) AS count_of_records
FROM
    `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
    t0.source IN ('AdX', 'AppNexus', 'DFP', 'Index Exchange', 'InSkin', 'Kargo', 'Playground XYZ', 'PubMatic', 'Rubicon', 'Tremor')
GROUP BY
    1
ORDER BY
    count_of_records DESC
LIMIT 10;",26,783f341c-8660-4e90-bab8-9bc860119cf5
"SELECT
    t0.masthead,
    t0.subscription_movement_count_type,
    SAFE_CAST(DATETIME_TRUNC(t0.movement_datetime, DAY) AS DATE) AS movement_date,
    COUNT(DISTINCT t0.subscription_id_src) AS distinct_subscriptions,
    COUNT(DISTINCT t0.subscriber_id_src) AS distinct_subscribers
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` AS t0
WHERE
    t0.movement_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
GROUP BY
    1, 2, 3
ORDER BY
    movement_date DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.subscription_id_src) AS unique_subscriptions,
    COUNT(DISTINCT t0.subscriber_id_src) AS unique_subscribers,
    MIN(t0.movement_datetime) AS min_movement_datetime,
    MAX(t0.movement_datetime) AS max_movement_datetime
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` AS t0
LIMIT 1;","SELECT
    CASE WHEN COUNT(DISTINCT t0.subscription_id_src) > 0 THEN 'PASS' ELSE 'FAIL' END AS acquisition_count_check,
    CASE WHEN MAX(t0.movement_datetime) >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` AS t0
WHERE
    t0.masthead = 'SC'
    AND t0.subscription_movement_count_type = 'acquisition'
    AND t0.movement_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
LIMIT 1;","SELECT
    t0.subscription_movement_count_type,
    COUNT(DISTINCT t0.subscription_id_src) AS distinct_subscriptions,
    COUNT(DISTINCT t0.subscriber_id_src) AS distinct_subscribers
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` AS t0
WHERE
    t0.masthead = 'SC'
    AND t0.movement_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY)
GROUP BY
    t0.subscription_movement_count_type
ORDER BY
    distinct_subscriptions DESC
LIMIT 5;",27,6e8b534b-485a-48dd-842d-13dc6bebb01a
"SELECT
  SAFE_CAST(t0.financial_year AS STRING) AS financial_year,
  SAFE_CAST(t0.portfolio_group_name_current AS STRING) AS portfolio_group_name_current,
  SAFE_CAST(t0.unified_publication_name AS STRING) AS unified_publication_name,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
GROUP BY
  financial_year,
  portfolio_group_name_current,
  unified_publication_name
ORDER BY
  record_count DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.account_number AS STRING)) AS unique_account_numbers,
  MIN(SAFE_CAST(t0.publication_date AS DATE)) AS min_publication_date,
  MAX(SAFE_CAST(t0.publication_date AS DATE)) AS max_publication_date
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
  CASE WHEN COUNT(*) > 0 THEN 'PASS' ELSE 'FAIL' END AS record_count_check,
  CASE WHEN MAX(SAFE_CAST(t0.publication_date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
  CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END AS derived_revenue_type,
  COUNT(*) AS count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
GROUP BY
  derived_revenue_type
ORDER BY
  count DESC
LIMIT 10;",28,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
"SELECT
  t0.Sales_Group,
  t0.publishing_division_group,
  CONCAT(SAFE_CAST(t0.financial_short_month AS STRING),' ',CONCAT('Q',SAFE_CAST(SAFE_CAST(t0.financial_quarter AS INT64) AS STRING)),' ',CASE WHEN ((SAFE_CAST(t0.financial_quarter AS INT64) >= 1) AND (SAFE_CAST(t0.financial_quarter AS INT64) <= 2)) THEN 'H1' WHEN ((SAFE_CAST(t0.financial_quarter AS INT64) >= 3) AND (SAFE_CAST(t0.financial_quarter AS INT64) <= 4)) THEN 'H2' ELSE SAFE_CAST(SAFE_CAST(t0.financial_quarter AS INT64) AS STRING) END) AS financial_period_month_quarter_half,
  SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_year_gross_revenue,
  SUM(CASE WHEN (t0.relative_fy_year_offset = -1) THEN t0.gross_revenue_amount ELSE 0 END) AS prior_year_gross_revenue
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY 1, 2, 3
ORDER BY 1, 2, 3 DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers,
  COUNT(DISTINCT t0.Sales_Group) AS unique_sales_groups,
  MIN(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)) AS min_booking_date,
  MAX(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)) AS max_booking_date
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS total_revenue_check,
  CASE WHEN MAX(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)) >= CURRENT_DATE('Australia/Sydney') - INTERVAL 7 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN (t0.fin_adtype_name = 'XTEND') THEN 'XTEND' WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC - DIGITAL OTHER' WHEN (t0.revenue_group_subtype = 'PROGRAMMATIC EXCHANGE') THEN 'PROGRAMMATIC - DIGITAL OTHER OFFSET' WHEN (SAFE.LEFT(t0.cost_model_type, 3) = 'GUA') THEN 'PROGRAMMATIC - GUARANTEED' WHEN (SAFE.LEFT(t0.cost_model_type, 3) = 'NON') THEN 'PROGRAMMATIC - OPEN EXCHANGE' WHEN (SAFE.LEFT(t0.cost_model_type, 3) = 'PMP') THEN 'PROGRAMMATIC - PMP' WHEN (t0.revenue_group_subtype = 'DIGITAL') THEN 'ADPT DIGITAL' WHEN (SAFE.LEFT(t0.revenue_group_subtype, 6) = 'SUNDRY') THEN 'SUNDRY' ELSE t0.revenue_group_subtype END AS revenue_type_grouping,
  COUNT(1) AS record_count,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;",29,80ca81f3-0671-40ef-a0a9-825a1580ca1b
"SELECT
  t0.financial_short_month,
  t0.financial_quarter,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue,
  SUM(CASE WHEN t0.unified_publication_name = 'TUBI' THEN t0.gross_revenue_amount ELSE NULL END) AS tubi_revenue,
  SUM(CASE WHEN UPPER(t0.cost_model_type) = 'PMP' THEN t0.gross_revenue_amount ELSE NULL END) AS pmp_revenue,
  SUM(CASE WHEN t0.unified_publication_name = 'Run of Audience Extension' THEN t0.gross_revenue_amount ELSE NULL END) AS performance_revenue
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE t0.relative_fy_year_offset = 0
GROUP BY 1, 2
ORDER BY 2, 1
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.financial_month) AS unique_financial_months,
  COUNT(DISTINCT t0.financial_quarter) AS unique_financial_quarters,
  MIN(t0.reporting_date) AS min_reporting_date,
  MAX(t0.reporting_date) AS max_reporting_date,
  COUNT(DISTINCT t0.cost_model_type) AS unique_cost_model_types,
  COUNT(DISTINCT t0.unified_publication_name) AS unique_publication_names
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(t0.reporting_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE t0.relative_fy_year_offset = 0
LIMIT 1;","SELECT
  CASE
    WHEN t0.unified_publication_name = 'TUBI' THEN 'TUBI'
    WHEN UPPER(t0.cost_model_type) = 'GUARANTEED' THEN 'PG'
    WHEN UPPER(t0.cost_model_type) = 'NON-GUARANTEED' THEN 'OMP'
    WHEN UPPER(t0.cost_model_type) = 'PMP' THEN 'PMP'
    WHEN t0.unified_publication_name = 'Run of Audience Extension' THEN 'PERFORMANCE'
    ELSE 'OTHER'
  END AS revenue_type_classification,
  COUNT(*) AS record_count,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;",30,5491badf-5ec0-4b4f-a427-b12a3a3395dd
"SELECT SAFE_CAST(t0.scenario AS STRING) AS scenario, COUNT(1) AS record_count FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY scenario ORDER BY record_count DESC LIMIT 10;","SELECT COUNT(1) AS total_records, COUNT(DISTINCT SAFE_CAST(t0.scenario AS STRING)) AS unique_scenarios FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1;",SELECT CASE WHEN COUNT(1) > 0 THEN 'PASS' ELSE 'FAIL' END AS data_exists_check FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1;,"SELECT SAFE_CAST(t0.scenario AS STRING) AS scenario_value, COUNT(1) AS count_of_records FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY scenario_value ORDER BY count_of_records DESC LIMIT 5;",31,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
"WITH
  adex_data AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
  ),
  adex_date_fact AS (
    SELECT
      Media_Type,
      portfolio_parent_group_name,
      date,
      DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
      DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
    FROM
      (
        SELECT DISTINCT
          Media_Type,
          portfolio_parent_group_name
        FROM
          adex_data
      )
      CROSS JOIN
      UNNEST(GENERATE_DATE_ARRAY((
          SELECT
            MIN(date)
          FROM
            adex_data
        ), (
          SELECT
            MAX(date)
          FROM
            adex_data
        ), INTERVAL 1 MONTH)) AS date
  ),
  adex_full_date AS (
    SELECT
      adf.*,
      financial_year,
      Major_Category,
      Advertiser_Group___Advertiser,
      Advertiser,
      Media_Network,
      Media_Group,
      Ad_Type,
      Brand,
      Product,
      Category,
      Sub_Category,
      account_number,
      portfolio_group_name,
      portfolio_conformed_name,
      Spend,
      sales_segment_gm_name
    FROM
      adex_date_fact AS adf
      LEFT JOIN
      adex_data
      ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
        adex_data.portfolio_parent_group_name
  ),
  base_data AS (
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  )
SELECT
  SAFE_CAST(date AS DATE) AS report_date,
  Media_Group,
  Major_Category,
  Media_Network,
  SUM(Spend) AS total_spend,
  SUM(CASE WHEN SAFE_CAST(date AS DATETIME) BETWEEN PARSE_DATETIME('%Y-%m-%d', '2023-08-01') AND PARSE_DATETIME('%Y-%m-%d', '2024-06-01') THEN Spend ELSE 0 END) AS current_period_spend,
  SUM(CASE WHEN SAFE_CAST(date AS DATETIME) BETWEEN PARSE_DATETIME('%Y-%m-%d', '2022-08-01') AND PARSE_DATETIME('%Y-%m-%d', '2023-06-01') THEN Spend ELSE 0 END) AS previous_period_spend,
  SUM(CASE WHEN Media_Network = 'NEWS CORP' AND SAFE_CAST(date AS DATETIME) BETWEEN PARSE_DATETIME('%Y-%m-%d', '2023-08-01') AND PARSE_DATETIME('%Y-%m-%d', '2024-06-01') THEN Spend ELSE 0 END) AS current_period_newscorp_spend
FROM
  base_data
GROUP BY
  1, 2, 3, 4
ORDER BY
  report_date DESC
LIMIT 12;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(Advertiser AS STRING)) AS unique_advertisers,
  COUNT(DISTINCT SAFE_CAST(Media_Group AS STRING)) AS unique_media_groups,
  COUNT(DISTINCT SAFE_CAST(Major_Category AS STRING)) AS unique_major_categories,
  MIN(SAFE_CAST(date AS DATE)) AS min_date,
  MAX(SAFE_CAST(date AS DATE)) AS max_date
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
LIMIT 1;","WITH
  adex_data AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
  ),
  adex_date_fact AS (
    SELECT
      Media_Type,
      portfolio_parent_group_name,
      date,
      DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
      DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
    FROM
      (
        SELECT DISTINCT
          Media_Type,
          portfolio_parent_group_name
        FROM
          adex_data
      )
      CROSS JOIN
      UNNEST(GENERATE_DATE_ARRAY((
          SELECT
            MIN(date)
          FROM
            adex_data
        ), (
          SELECT
            MAX(date)
          FROM
            adex_data
        ), INTERVAL 1 MONTH)) AS date
  ),
  adex_full_date AS (
    SELECT
      adf.*,
      financial_year,
      Major_Category,
      Advertiser_Group___Advertiser,
      Advertiser,
      Media_Network,
      Media_Group,
      Ad_Type,
      Brand,
      Product,
      Category,
      Sub_Category,
      account_number,
      portfolio_group_name,
      portfolio_conformed_name,
      Spend,
      sales_segment_gm_name
    FROM
      adex_date_fact AS adf
      LEFT JOIN
      adex_data
      ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
        adex_data.portfolio_parent_group_name
  ),
  latest_date_cte AS (
    SELECT
      MAX(SAFE_CAST(date AS DATE)) AS max_date
    FROM
      adex_full_date
  )
SELECT
  CASE WHEN SUM(t1.Spend) > 0 THEN 'PASS' ELSE 'FAIL' END AS spend_check,
  CASE WHEN MAX(t1.date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS freshness_check
FROM
  adex_full_date AS t1
JOIN
  latest_date_cte AS t2
ON
  SAFE_CAST(t1.date AS DATE) = t2.max_date
LIMIT 1;","WITH
  adex_data AS (
    SELECT
      *
    FROM
      `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
  ),
  adex_date_fact AS (
    SELECT
      Media_Type,
      portfolio_parent_group_name,
      date,
      DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
      DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
    FROM
      (
        SELECT DISTINCT
          Media_Type,
          portfolio_parent_group_name
        FROM
          adex_data
      )
      CROSS JOIN
      UNNEST(GENERATE_DATE_ARRAY((
          SELECT
            MIN(date)
          FROM
            adex_data
        ), (
          SELECT
            MAX(date)
          FROM
            adex_data
        ), INTERVAL 1 MONTH)) AS date
  ),
  adex_full_date AS (
    SELECT
      adf.*,
      financial_year,
      Major_Category,
      Advertiser_Group___Advertiser,
      Advertiser,
      Media_Network,
      Media_Group,
      Ad_Type,
      Brand,
      Product,
      Category,
      Sub_Category,
      account_number,
      portfolio_group_name,
      portfolio_conformed_name,
      Spend,
      sales_segment_gm_name
    FROM
      adex_date_fact AS adf
      LEFT JOIN
      adex_data
      ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
        adex_data.portfolio_parent_group_name
  )
SELECT
  Major_Category,
  SUM(Spend) AS total_spend,
  SUM(CASE WHEN Major_Category = 'Retail' THEN Spend ELSE 0 END) AS retail_spend,
  SUM(CASE WHEN Media_Network = 'NEWS CORP' THEN Spend ELSE 0 END) AS newscorp_spend
FROM
  adex_full_date
GROUP BY
  Major_Category
ORDER BY
  total_spend DESC
LIMIT 12;",32,e9d8a216-4950-4d30-b344-5011776edbdf
"SELECT t0.Adpoint_Account, t0.Genera_Booking_Account, t0.Medium_Rare_Debtor_Account, t0.National_Debtor_Account FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 GROUP BY t0.Adpoint_Account, t0.Genera_Booking_Account, t0.Medium_Rare_Debtor_Account, t0.National_Debtor_Account LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT SAFE_CAST(t0.Adpoint_Account AS STRING)) AS unique_adpoint_accounts, COUNT(DISTINCT SAFE_CAST(t0.Genera_Booking_Account AS STRING)) AS unique_genera_booking_accounts, COUNT(DISTINCT SAFE_CAST(t0.Medium_Rare_Debtor_Account AS STRING)) AS unique_medium_rare_debtor_accounts, COUNT(DISTINCT SAFE_CAST(t0.National_Debtor_Account AS STRING)) AS unique_national_debtor_accounts FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1;","SELECT CASE WHEN (SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` LIMIT 1) > 0 THEN 'PASS' ELSE 'FAIL' END AS data_exists_check, CASE WHEN ( SELECT DATETIME_DIFF(CURRENT_DATETIME(""Australia/Sydney""), DATETIME(timestamp_millis(last_modified_time), ""Australia/Sydney""), HOUR) < 24 FROM `sdm_advertisingexternals.__TABLES__` WHERE table_id = ""gbaba_act_xref"" LIMIT 1 ) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check LIMIT 1;","SELECT COUNTIF(t0.Adpoint_Account IS NULL) AS null_adpoint_accounts, COUNTIF(t0.Genera_Booking_Account IS NULL) AS null_genera_booking_accounts, COUNTIF(t0.Medium_Rare_Debtor_Account IS NULL) AS null_medium_rare_debtor_accounts, COUNTIF(t0.National_Debtor_Account IS NULL) AS null_national_debtor_accounts FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1;",33,258a722d-9b6e-45df-ba00-1b9954ec36b2
"SELECT
  SAFE_CAST(t0.SSPDate AS DATE) AS ssp_date,
  SAFE_CAST(FORMAT_DATETIME('%m%d', SAFE_CAST(t0.SSPDate AS DATETIME)) AS INT64) AS ssp_date_mmdd,
  SAFE_CAST(t0.TransactionType AS STRING) AS transaction_type,
  CASE
    WHEN (t0.TransactionType = 'AG' OR t0.TransactionType = 'PG - CPM' OR t0.TransactionType = 'PG - CPD') THEN 'Guaranteed'
    WHEN (t0.TransactionType = 'Deal' OR t0.TransactionType = 'pmp' OR t0.TransactionType = 'PMP_DEAL' OR t0.TransactionType = 'UFR') THEN 'Deal'
    WHEN (t0.TransactionType = 'Open Auction' OR t0.TransactionType = 'RTB' OR t0.TransactionType = 'Unknown') THEN 'Open Auction'
    ELSE SAFE_CAST(t0.TransactionType AS STRING)
  END AS transaction_type_category,
  SAFE_CAST(t0.ProductType AS STRING) AS product_type,
  SUM(t0.RevenueNet) AS total_revenue_net
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
GROUP BY 1, 2, 3, 4, 5
ORDER BY ssp_date DESC, total_revenue_net DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.TransactionType AS STRING)) AS unique_transaction_types,
  COUNT(DISTINCT SAFE_CAST(t0.ProductType AS STRING)) AS unique_product_types,
  MIN(SAFE_CAST(t0.SSPDate AS DATE)) AS min_ssp_date,
  MAX(SAFE_CAST(t0.SSPDate AS DATE)) AS max_ssp_date
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
LIMIT 1;","SELECT
  CASE WHEN MAX(SAFE_CAST(t0.SSPDate AS DATE)) >= CURRENT_DATE() - INTERVAL 2 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check,
  CASE WHEN SUM(t0.RevenueNet) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_positive_check
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
LIMIT 1;","SELECT
  CASE
    WHEN (clmn6_ OR clmn5_ OR clmn9_) THEN 'Guaranteed'
    WHEN (clmn3_ OR clmn4_ OR clmn7_ OR clmn12_) THEN 'Deal'
    WHEN (clmn10_ OR clmn8_ OR clmn11_) THEN 'Open Auction'
    ELSE clmn2_
  END AS transaction_type_category,
  COUNT(*) AS record_count,
  SUM(clmn0_) AS total_revenue_net
FROM (
  SELECT
    SAFE_CAST(clmn1_ AS STRING) AS clmn2_,
    (clmn1_ = 'Deal') AS clmn3_,
    (clmn1_ = 'pmp') AS clmn4_,
    (clmn1_ = 'PG - CPM') AS clmn5_,
    (clmn1_ = 'AG') AS clmn6_,
    (clmn1_ = 'PMP_DEAL') AS clmn7_,
    (clmn1_ = 'RTB') AS clmn8_,
    (clmn1_ = 'PG - CPD') AS clmn9_,
    (clmn1_ = 'Open Auction') AS clmn10_,
    (clmn1_ = 'Unknown') AS clmn11_,
    (clmn1_ = 'UFR') AS clmn12_,
    clmn0_,
    clmn1_
  FROM (
    SELECT
      t0.RevenueNet AS clmn0_,
      t0.TransactionType AS clmn1_
    FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
  )
)
GROUP BY transaction_type_category
ORDER BY total_revenue_net DESC
LIMIT 5;",34,b15d856f-e3ce-4991-bf2a-92395390524f
"SELECT
  t0.publication_name,
  t0.os_level_8 AS sales_channel,
  t0.fy_quarter_of_year AS fiscal_quarter,
  SUM(t0.Actual_Amount) AS total_actual_amount,
  SUM(t0.Budget_Volume) AS total_budget_volume,
  SUM(t0.Forecast_Volume) AS total_forecast_volume
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON t0.gl_publication_code = pub.publication_code
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
GROUP BY
  1, 2, 3
ORDER BY
  1, 2, 3
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT t0.publication_name) AS unique_publications,
  COUNT(DISTINCT t0.os_level_8) AS unique_sales_channels,
  COUNT(DISTINCT t0.fiscal_week_id) AS unique_fiscal_weeks,
  MIN(calendar.fy_first_day_of_week) AS min_date,
  MAX(calendar.fy_first_day_of_week) AS max_date
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON t0.gl_publication_code = pub.publication_code
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
LIMIT 1;","SELECT
  CASE
    WHEN SUM(t0.Actual_Amount) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS actual_amount_check,
  CASE
    WHEN MAX(calendar.fy_first_day_of_week) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.gl_hierarchy_code = 'FY2025'
LIMIT 1;","SELECT
  CASE
      WHEN (t0.publication_name IN ('Advertiser', 'Sunday Mail (SA)')) THEN 'The Advertiser'
      WHEN (t0.publication_name IN ('Weekly Times')) THEN 'Weekly Times'
      WHEN (t0.publication_name IN ('Herald Sun', 'Sunday Herald Sun')) THEN 'The Herald Sun'
      WHEN (t0.publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph'
      WHEN (t0.publication_name = 'Toowoomba') THEN 'The Chronicle'
      WHEN (t0.publication_name = 'Townsville Bulletin') THEN 'Townsville Bulletin'
      WHEN (t0.publication_name = 'Gold Coast Bulletin') THEN 'GCB'
      WHEN (t0.publication_name = 'Geelong Advertiser') THEN 'Geelong Advertiser'
      WHEN (t0.publication_name = 'Cairns Post') THEN 'Cairns Post'
      WHEN (t0.publication_name = 'Sunshine Coast') THEN 'Sunshine Coast'
      WHEN (t0.publication_name IN ('Courier Mail', 'Sunday Mail (QLD)')) THEN 'Courier Mail'
      WHEN (t0.publication_name IN ('Mercury', 'Sunday Tasmanian')) THEN 'Mercury'
      WHEN (t0.publication_name IN ('Sunday Territorian', 'NT News')) THEN 'Northern Territory News'
      WHEN (t0.publication_name = 'Mackay') THEN 'Daily Mercury'
      ELSE 'Other'
  END AS publication_group,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON t0.gl_publication_code = pub.publication_code
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON t0.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
GROUP BY
  1
ORDER BY
  record_count DESC
LIMIT 5;",35,6a26c78f-0070-4fb3-88b8-691ee4a4485a
"SELECT
  financial_year,
  UPPER(ASL.revenue_group_sub_type_code) AS revenue_group_subtype,
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN IFNULL(gross_revenue_amount, 0) ELSE 0 END) AS gross_revenue_current_fy,
  SUM(CASE WHEN relative_fy_year_offset = -1 THEN IFNULL(gross_revenue_amount, 0) ELSE 0 END) AS gross_revenue_previous_fy,
  SUM(IFNULL(target_amount, 0)) AS total_target_amount
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
WHERE
  (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0))
  AND UPPER(IFNULL(revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(source_publishing_division_name, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
  (UPPER(publication_name) LIKE 'SUDDENLY%' AND (SAFE_CAST(advertiser_id_src AS STRING) IN ('17114', '29172', '52809') OR ad_type_name = '-')))
GROUP BY
  financial_year,
  revenue_group_subtype
ORDER BY
  financial_year DESC, revenue_group_subtype
LIMIT 5;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(advertiser_id_src AS STRING)) AS unique_advertisers,
  MIN(SAFE_CAST(client_reporting_date AS DATE)) AS min_client_reporting_date,
  MAX(SAFE_CAST(client_reporting_date AS DATE)) AS max_client_reporting_date,
  MIN(SAFE_CAST(booking_line_created_date AS DATE)) AS min_booking_line_created_date,
  MAX(SAFE_CAST(booking_line_created_date AS DATE)) AS max_booking_line_created_date
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily`
LIMIT 1;","SELECT
  CASE
    WHEN (SELECT SUM(IFNULL(gross_revenue_amount, 0)) FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` WHERE relative_fy_year_offset = 0) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS current_fy_revenue_check,
  CASE
    WHEN (SELECT MAX(SAFE_CAST(client_reporting_date AS DATE)) FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily`) >= DATE_SUB(CURRENT_DATE('Australia/Sydney'), INTERVAL 7 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
LIMIT 1;","SELECT
  CASE
    WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
      'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
      'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
      'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
      'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
      'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
    ELSE 'Non Sundry Pubs'
  END AS Sundry_Pubs_Flag,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
WHERE
  (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0))
  AND UPPER(IFNULL(revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(source_publishing_division_name, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
  (UPPER(publication_name) LIKE 'SUDDENLY%' AND (SAFE_CAST(advertiser_id_src AS STRING) IN ('17114', '29172', '52809') OR ad_type_name = '-')))
GROUP BY
  Sundry_Pubs_Flag
LIMIT 2;",36,52c11c9c-052a-4e45-9cda-8fecd87d7964
"SELECT
  SAFE_CAST(t0.financial_year AS STRING) AS financial_year,
  SAFE_CAST(t0.revenue_group_subtype AS STRING) AS revenue_group_subtype,
  (CASE
    WHEN (CASE WHEN (SAFE_CAST(t0.xtend_flag AS STRING) = 'Y') THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'DIGITAL') THEN 'DIGITAL (excl.XTEND)'
    WHEN (CASE WHEN (SAFE_CAST(t0.xtend_flag AS STRING) = 'Y') THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'PRINT') THEN 'PRINT'
    WHEN (CASE WHEN (SAFE_CAST(t0.xtend_flag AS STRING) = 'Y') THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'XTEND') THEN 'XTEND ONLY'
    ELSE NULL
  END) AS derived_revenue_category,
  COUNT(DISTINCT SAFE_CAST(t0.unified_publication_name AS STRING)) AS distinct_publications_count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
WHERE
  SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025')
GROUP BY
  1, 2, 3
ORDER BY
  1, 2, 3
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.financial_year AS STRING)) AS unique_financial_years,
  COUNT(DISTINCT SAFE_CAST(t0.unified_publication_name AS STRING)) AS unique_publication_names,
  MIN(t0.dw_asl_load_timestamp) AS min_load_timestamp,
  MAX(t0.dw_asl_load_timestamp) AS max_load_timestamp
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN COUNT(1) > 0 THEN 'PASS' ELSE 'FAIL' END AS record_count_check,
  CASE WHEN MAX(t0.dw_asl_load_timestamp) > DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  (CASE WHEN (SAFE_CAST(t0.xtend_flag AS STRING) = 'Y') THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END) AS base_derived_revenue_type,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  1
ORDER BY
  record_count DESC
LIMIT 5;",37,61f1feb4-fc3e-4bee-b987-84c86cfe6425
"SELECT
  SAFE_CAST(t0.fy_year_week_number AS STRING) AS fy_year_week_number,
  SAFE_CAST(SAFE.LEFT(t0.revenue_type, 2) AS STRING) AS revenue_type_prefix,
  SUM(SAFE_CAST(t0.amount AS BIGNUMERIC)) AS total_amount,
  SUM(SAFE_CAST(t0.volume AS BIGNUMERIC)) AS total_volume,
  SUM(CASE WHEN SAFE_CAST(SAFE.LEFT(t0.revenue_type, 2) AS STRING) = '03' THEN SAFE_CAST(t0.amount AS BIGNUMERIC) ELSE 0 END) AS amount_revenue_type_03,
  SUM(CASE WHEN SAFE_CAST(SAFE.LEFT(t0.revenue_type, 2) AS STRING) = '03' THEN SAFE_CAST(t0.volume AS BIGNUMERIC) ELSE 0 END) AS volume_revenue_type_03
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
GROUP BY
  fy_year_week_number,
  revenue_type_prefix
ORDER BY
  fy_year_week_number DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_rows,
  COUNT(DISTINCT SAFE_CAST(fy_year_week_number AS STRING)) AS unique_fy_week_numbers,
  MIN(SAFE_CAST(fy_year_week_number AS STRING)) AS min_fy_week_number,
  MAX(SAFE_CAST(fy_year_week_number AS STRING)) AS max_fy_week_number,
  COUNT(DISTINCT SAFE_CAST(revenue_type AS STRING)) AS unique_revenue_types
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check`
LIMIT 1;","SELECT
  CASE WHEN (SELECT SUM(SAFE_CAST(amount AS BIGNUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` LIMIT 1) > 0 THEN 'PASS' ELSE 'FAIL' END AS amount_check,
  CASE WHEN (SELECT MIN(DATETIME_TRUNC(snap_load_time, SECOND)) FROM (
    SELECT MAX(snap_load_time) AS snap_load_time FROM (
      SELECT datetime(max(dw_prstn_load_timestamp), 'Australia/Sydney') AS snap_load_time FROM `ncau-data-newsquery-prd.prstn_finance_persisted.finance_operating_statement` WHERE source_system_name = 'Circulation' AND scenario = 'Estimate' AND sub_source_system_name IN ('RCTI', 'THINK', 'DTI')
      UNION ALL
      SELECT datetime(max(dw_bdm_load_timestamp), 'Australia/Sydney') AS snap_load_time FROM `ncau-data-newsquery-prd.prstn_finance.v_circulation_snapshot_fct`
    ) AS load_time
  ) WHERE snap_load_time >= DATETIME_SUB(CURRENT_DATETIME('Australia/Sydney'), INTERVAL 24 HOUR) LIMIT 1) IS NOT NULL THEN 'PASS' ELSE 'FAIL' END AS freshness_check
LIMIT 1;","SELECT
  SAFE_CAST(SAFE.LEFT(revenue_type, 2) AS STRING) AS revenue_type_prefix,
  COUNT(*) AS record_count,
  SUM(SAFE_CAST(amount AS BIGNUMERIC)) AS total_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check`
GROUP BY
  revenue_type_prefix
ORDER BY
  total_amount DESC
LIMIT 5;",38,f7a9efeb-df3c-45c9-899d-0bcada701572
"WITH
  OSandFACT AS (
    SELECT
      os.source_system_name,
      os.sub_source_system_name,
      CAST(os.fiscal_week_id AS int) AS fiscal_week_id,
      os.gl_publication_code,
      os.day_of_week,
      os.state,
      os.os_level_1,
      os.os_level_2,
      os.os_level_3,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      os.os_level_7,
      os.os_level_8,
      os.os_level_9,
      os.os_level_10,
      os.os_level_11,
      os.os_level_12,
      os.Estimate,
      os.True_Up_Adjustment,
      os.Actual_Amount,
      os.volume,
      os.Last_Year_Actual_Amount,
      os.Last_Year_volume,
      os.Budget_Draft_Amount,
      os.Budget_Draft_Volume,
      os.Budget_Amount,
      os.Budget_Volume,
      os.Forecast_Amount,
      os.Forecast_Volume,
      os.Budget_Jan_Amount,
      os.Budget_Jan_Volume,
      os.Budget_Feb_Amount,
      os.Budget_Feb_Volume,
      os.Budget_Mar_Amount,
      os.Budget_Mar_Volume,
      os.Budget_Apr_Amount,
      os.Budget_Apr_Volume,
      os.Budget_May_Amount,
      os.Budget_May_Volume,
      os.Budget_Jun_Amount,
      os.Budget_Jun_Volume,
      os.Budget_Jul_Amount,
      os.Budget_Jul_Volume,
      os.Budget_Aug_Amount,
      os.Budget_Aug_Volume,
      os.Budget_Sep_Amount,
      os.Budget_Sep_Volume,
      os.Budget_Oct_Amount,
      os.Budget_Oct_Volume,
      os.Budget_Nov_Amount,
      os.Budget_Nov_Volume,
      os.Budget_Dec_Amount,
      os.Budget_Dec_Volume,
      os.Forecast_Q1F_Amount,
      os.Forecast_Q1F_Volume,
      os.Forecast_Q2F_Amount,
      os.Forecast_Q2F_Volume,
      os.Forecast_Q3F_Amount,
      os.Forecast_Q3F_Volume,
      os.Forecast_Q4F_Amount,
      os.Forecast_Q4F_Volume,
      os.Forecast_Q5F_Amount,
      os.Forecast_Q5F_Volume,
      calendar.fy_year,
      calendar.fy_quarter_of_year,
      calendar.fy_month_of_year,
      calendar.fy_week_of_year,
      calendar.fy_first_day_of_week,
      calendar.fy_last_day_of_week,
      calendar.month_end_flag
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_first_day_of_week AS date) AS fy_first_day_of_week,
          CAST(c.fy_last_day_of_week AS date) AS fy_last_day_of_week,
          CAST(c.fy_month_of_year AS int) AS fy_month_of_year,
          CAST(c.fy_year_month_number AS int) AS fy_year_month_number,
          CAST(c.relative_fisc_year_number AS int) AS relative_fisc_year_number,
          CAST(c.relative_fisc_week_number AS int) AS relative_fisc_week_number,
          c.fy_month_of_year_short_name,
          CASE
            WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y'
            ELSE 'N'
          END AS month_end_flag,
          CAST(c.fy_quarter_of_year AS int) AS fy_quarter_of_year,
          CAST(c.fy_year AS int) AS fy_year,
          `current_timestamp`() AS extract_time
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
        WHERE
          1 = 1
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SAFE_CAST(fy_year AS STRING) AS fiscal_year,
  source_system_name,
  SUM(Actual_Amount) AS total_actual_amount,
  SUM(Budget_Amount) AS total_budget_amount,
  SUM(Forecast_Amount) AS total_forecast_amount,
  COUNT(1) AS record_count
FROM
  OSandFACT
GROUP BY
  fiscal_year,
  source_system_name
ORDER BY
  fiscal_year DESC, source_system_name
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(fiscal_week_id AS STRING)) AS unique_fiscal_weeks,
  MIN(SAFE_CAST(fiscal_week_id AS INT)) AS min_fiscal_week_id,
  MAX(SAFE_CAST(fiscal_week_id AS INT)) AS max_fiscal_week_id,
  COUNT(DISTINCT source_system_name) AS unique_source_systems,
  COUNT(DISTINCT gl_publication_code) AS unique_publications
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`
LIMIT 1;","SELECT
  CASE WHEN SUM(SAFE_CAST(Actual_Amount AS BIGNUMERIC)) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_positive_check,
  CASE WHEN MAX(SAFE_CAST(fiscal_week_id AS INT)) >= SAFE_CAST(FORMAT_DATE('%Y%W', CURRENT_DATE()) AS INT) - 4 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`
LIMIT 1;","WITH
  OSandFACT AS (
    SELECT
      os.source_system_name,
      os.sub_source_system_name,
      CAST(os.fiscal_week_id AS int) AS fiscal_week_id,
      os.gl_publication_code,
      os.day_of_week,
      os.state,
      os.os_level_1,
      os.os_level_2,
      os.os_level_3,
      os.os_level_4,
      os.os_level_5,
      os.os_level_6,
      os.os_level_7,
      os.os_level_8,
      os.os_level_9,
      os.os_level_10,
      os.os_level_11,
      os.os_level_12,
      os.Estimate,
      os.True_Up_Adjustment,
      os.Actual_Amount,
      os.volume,
      os.Last_Year_Actual_Amount,
      os.Last_Year_volume,
      os.Budget_Draft_Amount,
      os.Budget_Draft_Volume,
      os.Budget_Amount,
      os.Budget_Volume,
      os.Forecast_Amount,
      os.Forecast_Volume,
      os.Budget_Jan_Amount,
      os.Budget_Jan_Volume,
      os.Budget_Feb_Amount,
      os.Budget_Feb_Volume,
      os.Budget_Mar_Amount,
      os.Budget_Mar_Volume,
      os.Budget_Apr_Amount,
      os.Budget_Apr_Volume,
      os.Budget_May_Amount,
      os.Budget_May_Volume,
      os.Budget_Jun_Amount,
      os.Budget_Jun_Volume,
      os.Budget_Jul_Amount,
      os.Budget_Jul_Volume,
      os.Budget_Aug_Amount,
      os.Budget_Aug_Volume,
      os.Budget_Sep_Amount,
      os.Budget_Sep_Volume,
      os.Budget_Oct_Amount,
      os.Budget_Oct_Volume,
      os.Budget_Nov_Amount,
      os.Budget_Nov_Volume,
      os.Budget_Dec_Amount,
      os.Budget_Dec_Volume,
      os.Forecast_Q1F_Amount,
      os.Forecast_Q1F_Volume,
      os.Forecast_Q2F_Amount,
      os.Forecast_Q2F_Volume,
      os.Forecast_Q3F_Amount,
      os.Forecast_Q3F_Volume,
      os.Forecast_Q4F_Amount,
      os.Forecast_Q4F_Volume,
      os.Forecast_Q5F_Amount,
      os.Forecast_Q5F_Volume,
      calendar.fy_year,
      calendar.fy_quarter_of_year,
      calendar.fy_month_of_year,
      calendar.fy_week_of_year,
      calendar.fy_first_day_of_week,
      calendar.fy_last_day_of_week,
      calendar.month_end_flag
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN
      `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
      ON os.gl_publication_code = pub.publication_code
      LEFT JOIN
      (
        SELECT DISTINCT
          CAST(c.fy_week_of_year AS int) AS fy_week_of_year,
          CAST(c.fy_year_week_number AS int) AS fy_year_week_number,
          CAST(c.fy_first_day_of_week AS date) AS fy_first_day_of_week,
          CAST(c.fy_last_day_of_week AS date) AS fy_last_day_of_week,
          CAST(c.fy_month_of_year AS int) AS fy_month_of_year,
          CAST(c.fy_year_month_number AS int) AS fy_year_month_number,
          CAST(c.relative_fisc_year_number AS int) AS relative_fisc_year_number,
          CAST(c.relative_fisc_week_number AS int) AS relative_fisc_week_number,
          c.fy_month_of_year_short_name,
          CASE
            WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y'
            ELSE 'N'
          END AS month_end_flag,
          CAST(c.fy_quarter_of_year AS int) AS fy_quarter_of_year,
          CAST(c.fy_year AS int) AS fy_year,
          `current_timestamp`() AS extract_time
        FROM
          `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
          JOIN
          `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control
          ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
        WHERE
          1 = 1
      ) AS calendar
      ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN
      `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep
      ON os.os_level_12 = dep.department_code
  )
SELECT
  SAFE_CAST(month_end_flag AS STRING) AS month_end_flag_status,
  COUNT(1) AS record_count
FROM
  OSandFACT
GROUP BY
  month_end_flag_status
LIMIT 2;",39,d7412673-0af1-4efe-8374-ca475b001fb6
"SELECT t0.financial_year, t0.source_publishing_division, t0.revenue_type_level2, SUM(t0.gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') GROUP BY t0.financial_year, t0.source_publishing_division, t0.revenue_type_level2 ORDER BY t0.financial_year DESC, total_gross_revenue DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers, COUNT(DISTINCT t0.financial_year) AS unique_financial_years, MIN(t0.data_load_datetime) AS min_data_load_datetime, MAX(t0.data_load_datetime) AS max_data_load_datetime FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 LIMIT 1;","SELECT CASE WHEN SUM(CASE WHEN t0.gross_revenue_amount > 0 THEN 1 ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS has_positive_revenue, CASE WHEN MAX(t0.data_load_datetime) >= DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' AND t0.revenue_transaction_status IN ('Billed', 'Booked') LIMIT 1;","SELECT t0.revenue_transaction_status, COUNT(*) AS status_count, SUM(t0.gross_revenue_amount) AS total_revenue_by_status FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year IS NOT NULL AND t0.source_publishing_division != 'Medium Rare Content Agency' GROUP BY t0.revenue_transaction_status ORDER BY status_count DESC LIMIT 5;",40,705edcb5-737a-4600-b1a7-11870177f97a
"SELECT financial_year, revenue_group_subtype, fin_adtype_name, SUM(gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` GROUP BY financial_year, revenue_group_subtype, fin_adtype_name ORDER BY financial_year DESC, total_gross_revenue DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT financial_year) AS unique_financial_years, COUNT(DISTINCT revenue_group_subtype) AS unique_revenue_groups, COUNT(DISTINCT advertiser_name) AS unique_advertisers, COUNT(DISTINCT unified_publication_name) AS unique_publications, MIN(financial_year) AS min_financial_year, MAX(financial_year) AS max_financial_year, MIN(SAFE_CAST(financial_week AS INT64)) AS min_financial_week, MAX(SAFE_CAST(financial_week AS INT64)) AS max_financial_week FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 1;","SELECT CASE WHEN (SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE financial_year = (SELECT MAX(financial_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`)) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check, CASE WHEN (SELECT MAX(SAFE_CAST(financial_year AS INT64)) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check LIMIT 1;","SELECT financial_short_month, CASE WHEN (financial_short_month = 'Jul') THEN 1 WHEN (financial_short_month = 'Aug') THEN 2 WHEN (financial_short_month = 'Sep') THEN 3 WHEN (financial_short_month = 'Oct') THEN 4 WHEN (financial_short_month = 'Nov') THEN 5 WHEN (financial_short_month = 'Dec') THEN 6 WHEN (financial_short_month = 'Jan') THEN 7 WHEN (financial_short_month = 'Feb') THEN 8 WHEN (financial_short_month = 'Mar') THEN 9 WHEN (financial_short_month = 'Apr') THEN 10 WHEN (financial_short_month = 'May') THEN 11 WHEN (financial_short_month = 'Jun') THEN 12 ELSE NULL END AS month_order, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` GROUP BY financial_short_month, month_order ORDER BY month_order LIMIT 10;",41,3ee20092-1897-49b7-8bcd-4157d5f816eb
"SELECT financial_year, source_system_code, revenue_transaction_status, SUM(gross_revenue_amount) AS total_gross_revenue, COUNT(DISTINCT invoice_number) AS unique_invoices, COUNT(DISTINCT advertiser_name) AS unique_advertisers FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` GROUP BY financial_year, source_system_code, revenue_transaction_status ORDER BY financial_year DESC, total_gross_revenue DESC LIMIT 10;","SELECT COUNT(1) AS total_records, COUNT(DISTINCT invoice_number) AS unique_invoice_numbers, COUNT(DISTINCT advertiser_name) AS unique_advertiser_names, MIN(data_load_datetime) AS min_data_load_datetime, MAX(data_load_datetime) AS max_data_load_datetime, MIN(financial_year) AS min_financial_year, MAX(financial_year) AS max_financial_year FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` LIMIT 1;","SELECT CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check, CASE WHEN MAX(data_load_datetime) > DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` LIMIT 1;","SELECT revenue_transaction_status, COUNT(1) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` GROUP BY revenue_transaction_status ORDER BY record_count DESC LIMIT 5;",42,77c68c35-20ce-477a-b216-0c781d43a8ca
"SELECT
    SAFE_CAST(t0.fiscal_week_id AS STRING) AS fiscal_week,
    t0.category_name,
    t0.gl_publication_code,
    SUM(SAFE_CAST(t0.add_volume AS BIGNUMERIC)) AS total_add_volume,
    SUM(SAFE_CAST(t0.closing_base AS BIGNUMERIC)) AS total_closing_base,
    SUM(SAFE_CAST(t0.earned_amount AS BIGNUMERIC)) AS total_earned_amount
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0
GROUP BY
    1, 2, 3
ORDER BY
    fiscal_week DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(fiscal_week_id AS STRING)) AS unique_fiscal_weeks,
    MIN(SAFE_CAST(fiscal_week_id AS STRING)) AS min_fiscal_week_id,
    MAX(SAFE_CAST(fiscal_week_id AS STRING)) AS max_fiscal_week_id
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`
LIMIT 1;","SELECT
    CASE WHEN SUM(SAFE_CAST(earned_amount AS BIGNUMERIC)) > 0 THEN 'PASS' ELSE 'FAIL' END AS earned_amount_positive_check,
    CASE WHEN MAX(SAFE_CAST(fiscal_week_id AS INT64)) >= (CAST(FORMAT_DATE('%Y%W', CURRENT_DATE()) AS INT64) - 4) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`
LIMIT 1;","SELECT
    t0.category_name,
    t0.gl_publication_code,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` AS t0
GROUP BY
    t0.category_name,
    t0.gl_publication_code
ORDER BY
    record_count DESC
LIMIT 10;",43,23c8b213-a9f0-4158-b8fa-bff14425abb5
"SELECT
  t0.movement_date,
  t0.financial_year,
  t0.portfolio_parent_group_name_sync,
  t0.revenue_type,
  CASE
    WHEN (t0.xtend_flag = 'Y') THEN 'XTEND'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 3) = 'PRO' OR (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_sub_type = 'DIGITAL')) THEN 'PROGRAMMATIC'
    WHEN (t0.revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY'
    ELSE t0.revenue_sub_type
  END AS revenue_category,
  CASE WHEN t0.advertiser_group IS NULL THEN 'Nah' ELSE t0.advertiser_group END AS advertiser_group_handled,
  SUM(t0.GROSS_AMOUNT_DIFF) AS total_gross_amount_diff,
  SUM(CASE WHEN t0.revenue_type = 'DIGITAL' THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS digital_gross_amount_diff,
  SUM(CASE WHEN t0.revenue_type = 'PRINT' THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS print_gross_amount_diff
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0
WHERE
  t0.movement_date BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) AND CURRENT_DATE()
GROUP BY
  1, 2, 3, 4, 5, 6
ORDER BY
  t0.movement_date DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.booking_line_id AS STRING)) AS unique_booking_lines,
  COUNT(DISTINCT t0.advertiser_parent) AS unique_advertiser_parents,
  MIN(t0.movement_date) AS min_movement_date,
  MAX(t0.movement_date) AS max_movement_date
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0
LIMIT 1;","SELECT
  CASE
    WHEN SUM(t0.GROSS_AMOUNT_DIFF) > 0 AND MAX(t0.movement_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS status,
  SUM(t0.GROSS_AMOUNT_DIFF) AS recent_gross_amount_diff,
  MAX(t0.movement_date) AS latest_movement_date
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0
WHERE
  t0.movement_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
LIMIT 1;","SELECT
  CASE
    WHEN (t0.xtend_flag = 'Y') THEN 'XTEND'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 3) = 'PRO' OR (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_sub_type = 'DIGITAL')) THEN 'PROGRAMMATIC'
    WHEN (t0.revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY'
    ELSE t0.revenue_sub_type
  END AS revenue_category,
  COUNT(*) AS record_count,
  SUM(t0.GROSS_AMOUNT_DIFF) AS total_gross_amount_diff
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0
WHERE
  t0.movement_date BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) AND CURRENT_DATE()
GROUP BY
  revenue_category
ORDER BY
  total_gross_amount_diff DESC
LIMIT 12;",44,a1b901e6-c4fb-44bc-955a-3a7070c15829
"SELECT
  t0.financial_year,
  t0.financial_short_month,
  t0.revenue_type,
  t0.sales_segment_l_2_name_sync,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
  SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue,
  SUM(t0.ss_lgb) AS total_ss_lgb
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  t0.financial_year,
  t0.financial_short_month,
  t0.revenue_type,
  t0.sales_segment_l_2_name_sync
ORDER BY
  t0.financial_year DESC, t0.financial_short_month DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.financial_year) AS unique_financial_years,
  COUNT(DISTINCT t0.financial_short_month) AS unique_financial_months,
  COUNT(DISTINCT t0.product_group) AS unique_product_groups,
  MIN(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)) AS min_booking_date,
  MAX(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)) AS max_booking_date
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(PARSE_DATE('%Y-%m-%d', t0.booking_line_created_date)) >= CURRENT_DATE() - INTERVAL 30 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN t0.xtend_flag = 'Y' THEN 'XTEND' ELSE t0.revenue_type END AS revenue_type_category,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  1
ORDER BY
  record_count DESC
LIMIT 5;",45,4d8074b2-17a8-48ba-babe-c536359b1f64
