primary_analysis_sql,structure_sql,validation_sql,business_rules_sql,response_id,dashboard_id
"SELECT
  financial_year,
  UPPER(revenue_group_subtype) AS revenue_group_subtype,
  SUM(IFNULL(gross_revenue_amount, 0)) AS total_gross_revenue,
  SUM(IFNULL(target_amount, 0)) AS total_target_amount
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL
WHERE
  (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0))
  AND UPPER(IFNULL(revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(source_publishing_division_name, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND (advertiser_id_src IN ('17114', '29172', '52809') OR ad_type_name = '-')))
GROUP BY
  financial_year,
  revenue_group_subtype
ORDER BY
  financial_year DESC, total_gross_revenue DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertisers,
  COUNT(DISTINCT SAFE_CAST(unified_publication_name AS STRING)) AS unique_publications,
  MIN(SAFE_CAST(client_reporting_date AS DATE)) AS min_client_reporting_date,
  MAX(SAFE_CAST(client_reporting_date AS DATE)) AS max_client_reporting_date,
  MIN(SAFE_CAST(booking_line_created_date AS DATE)) AS min_booking_created_date,
  MAX(SAFE_CAST(booking_line_created_date AS DATE)) AS max_booking_created_date
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily`
LIMIT 1;","SELECT
  CASE WHEN SUM(IFNULL(gross_revenue_amount, 0)) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(SAFE_CAST(client_reporting_date AS DATE)) >= DATE_SUB(CURRENT_DATE('Australia/Sydney'), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily`
WHERE
  UPPER(IFNULL(revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED')
LIMIT 1;","SELECT
  CASE
    WHEN unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales',
      'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin',
      'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin',
      'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News',
      'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin',
      'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
    ELSE 'Non Sundry Pubs'
  END AS Sundry_Pubs_Flag,
  COUNT(DISTINCT unified_publication_name) AS publication_count,
  SUM(IFNULL(gross_revenue_amount, 0)) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily`
WHERE
  UPPER(IFNULL(revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED')
GROUP BY
  Sundry_Pubs_Flag
LIMIT 2;",0,52c11c9c-052a-4e45-9cda-8fecd87d7964
"SELECT product_group, advertiser_group, SAFE_CAST(financial_week AS STRING) AS financial_week_str, SUM(CASE WHEN (is_future_period_flag = 'N' AND relative_fy_year_offset = 0) THEN gross_revenue_amount ELSE 0 END) AS current_fy_actual_gross_revenue, SUM(CASE WHEN (relative_fy_year_offset = -1 AND stly_flag = 'Y') THEN gross_revenue_amount ELSE 0 END) AS stly_gross_revenue, SUM(CASE WHEN (relative_fy_year_offset = 0 AND relative_fy_week_offset < 0) THEN pub_lgb ELSE 0 END) AS current_fy_past_weeks_pub_lgb FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` GROUP BY product_group, advertiser_group, financial_week_str ORDER BY product_group, advertiser_group, financial_week_str DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT advertiser_group) AS unique_advertiser_groups, COUNT(DISTINCT product_group) AS unique_product_groups, COUNT(DISTINCT unified_publication_name) AS unique_publications, MIN(SAFE_CAST(financial_week AS STRING)) AS min_financial_week, MAX(SAFE_CAST(financial_week AS STRING)) AS max_financial_week FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 1;","SELECT CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check, CASE WHEN MAX(relative_fy_year_offset) = 0 THEN 'PASS' ELSE 'FAIL' END AS current_fy_data_check FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 1;","SELECT product_group, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` GROUP BY product_group ORDER BY record_count DESC LIMIT 5;",1,d3bcf796-2396-4a6f-b0a3-da0b7f299a58
"SELECT
  SAFE_CAST(t0.masthead_group AS STRING) AS masthead_group,
  SAFE_CAST(t0.finance_recognition AS STRING) AS finance_recognition,
  SAFE_CAST(t0.fy_year AS INT64) AS fiscal_year,
  SAFE_CAST(t0.fy_week_of_year AS INT64) AS fiscal_week_of_year,
  SUM(SAFE_CAST(t0.BudgetEarnedAmount AS BIGNUMERIC)) AS total_budget_earned_amount,
  SUM(SAFE_CAST(t0.ClosingBase AS BIGNUMERIC)) AS total_closing_base,
  SUM(SAFE_CAST(t0.OpeningBase AS BIGNUMERIC)) AS total_opening_base,
  SUM(SAFE_CAST(t0.EarnedAmount AS BIGNUMERIC)) AS total_earned_amount,
  SUM(SAFE_CAST(t0.ClosingBase AS BIGNUMERIC) - SAFE_CAST(t0.OpeningBase AS BIGNUMERIC)) AS total_net_change
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
  SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued'
  AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'
GROUP BY
  1, 2, 3, 4
ORDER BY
  fiscal_year DESC, fiscal_week_of_year DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(masthead_group AS STRING)) AS unique_masthead_groups,
  COUNT(DISTINCT SAFE_CAST(finance_recognition AS STRING)) AS unique_finance_recognitions,
  MIN(SAFE_CAST(fy_year AS INT64)) AS min_fy_year,
  MAX(SAFE_CAST(fy_year AS INT64)) AS max_fy_year,
  MIN(SAFE_CAST(fy_week_of_year AS INT64)) AS min_fy_week_of_year,
  MAX(SAFE_CAST(fy_week_of_year AS INT64)) AS max_fy_week_of_year,
  MIN(SAFE_CAST(fy_month_of_year AS INT64)) AS min_fy_month_of_year,
  MAX(SAFE_CAST(fy_month_of_year AS INT64)) AS max_fy_month_of_year,
  MIN(SAFE_CAST(fy_quarter_of_year AS INT64)) AS min_fy_quarter_of_year,
  MAX(SAFE_CAST(fy_quarter_of_year AS INT64)) AS max_fy_quarter_of_year
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions`
LIMIT 1;","SELECT
  CASE WHEN SUM(SAFE_CAST(t0.EarnedAmount AS BIGNUMERIC)) > 0 THEN 'PASS' ELSE 'FAIL' END AS earned_amount_positive_check,
  CASE WHEN MAX(SAFE_CAST(t0.fy_year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS recent_data_year_check,
  CASE WHEN COUNT(*) > 1000 THEN 'PASS' ELSE 'FAIL' END AS sufficient_record_count_check
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
  SAFE_CAST(t0.masthead_group AS STRING) != 'Discontinued'
  AND SAFE_CAST(t0.finance_recognition AS STRING) = 'Digital Recognition'
LIMIT 1;","SELECT
  SAFE_CAST(t0.finance_recognition AS STRING) AS finance_recognition_type,
  COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
GROUP BY
  1
ORDER BY
  record_count DESC
LIMIT 5;",2,bb49fa78-5abe-4e68-a9c1-8172a832e724
"SELECT t0.Fiscal_Year, t0.Category, SUM(t0.Product_Revenue) AS total_product_revenue, MAX(t0.Running_Expense_ADVERTISING_1) AS max_adv_expense_ml1 FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 GROUP BY t0.Fiscal_Year, t0.Category ORDER BY t0.Fiscal_Year DESC, t0.Category LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT t0.Fiscal_Year) AS unique_fiscal_years, MIN(t0.Fiscal_Year) AS min_fiscal_year, MAX(t0.Fiscal_Year) AS max_fiscal_year, COUNT(DISTINCT t0.Category) AS unique_categories FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 LIMIT 1;","SELECT CASE WHEN SUM(t0.Product_Revenue) > 0 THEN 'PASS' ELSE 'FAIL' END AS product_revenue_check, CASE WHEN MAX(t0.Fiscal_Year) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 LIMIT 1;","SELECT t0.Category, COUNT(*) AS category_count FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` AS t0 GROUP BY t0.Category ORDER BY category_count DESC LIMIT 5;",3,6de90f2a-b3f3-46fe-a4fe-13474b2d6618
"SELECT
  SAFE_CAST(t0.fy_year AS INT) AS fy_year,
  t0.source_system_name,
  SUM(t0.Actual_Amount) AS total_actual_amount,
  COUNT(1) AS record_count
FROM (
  WITH OSandFACT AS (
    SELECT
      os.source_system_name,
      os.Actual_Amount,
      CAST(os.fiscal_week_id AS INT) AS fiscal_week_id,
      os.gl_publication_code,
      os.os_level_12,
      calendar.fy_year
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number,
          CAST(c.fy_year AS INT) AS fy_year
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
GROUP BY
  SAFE_CAST(t0.fy_year AS INT),
  t0.source_system_name
ORDER BY
  SAFE_CAST(t0.fy_year AS INT) DESC,
  total_actual_amount DESC
LIMIT 12","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.source_system_name AS STRING)) AS unique_source_systems,
  COUNT(DISTINCT SAFE_CAST(t0.gl_publication_code AS STRING)) AS unique_publications,
  MIN(SAFE_CAST(t0.fiscal_week_id AS INT)) AS min_fiscal_week_id,
  MAX(SAFE_CAST(t0.fiscal_week_id AS INT)) AS max_fiscal_week_id,
  MIN(SAFE_CAST(t0.fy_first_day_of_week AS DATE)) AS min_date,
  MAX(SAFE_CAST(t0.fy_first_day_of_week AS DATE)) AS max_date
FROM (
  WITH OSandFACT AS (
    SELECT
      os.source_system_name,
      os.gl_publication_code,
      CAST(os.fiscal_week_id AS INT) AS fiscal_week_id,
      calendar.fy_first_day_of_week
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number,
          CAST(c.fy_first_day_of_week AS DATE) AS fy_first_day_of_week
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
LIMIT 1","SELECT
  CASE WHEN SUM(SAFE_CAST(t0.Actual_Amount AS BIGNUMERIC)) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_check,
  CASE WHEN MAX(SAFE_CAST(t0.fy_first_day_of_week AS DATE)) > DATE_SUB(CURRENT_DATE(), INTERVAL 365 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM (
  WITH OSandFACT AS (
    SELECT
      os.Actual_Amount,
      CAST(os.fiscal_week_id AS INT) AS fiscal_week_id,
      calendar.fy_first_day_of_week
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number,
          CAST(c.fy_first_day_of_week AS DATE) AS fy_first_day_of_week
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
LIMIT 1","SELECT
  t0.month_end_flag,
  COUNT(1) AS count_of_records
FROM (
  WITH OSandFACT AS (
    SELECT
      os.fiscal_week_id,
      calendar.month_end_flag
    FROM
      `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
      LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
      LEFT JOIN (
        SELECT DISTINCT
          CAST(c.fy_year_week_number AS INT) AS fy_year_week_number,
          CASE WHEN c.fy_last_day_of_week = c.fy_last_day_of_month THEN 'Y' ELSE 'N' END AS month_end_flag
        FROM `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS c
        JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_period_control AS control ON control.source_week_number = c.fy_year_week_number AND control.period_name IN ('CP', 'PY')
      ) AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
      LEFT JOIN `ncau-data-newsquery-prd`.asl_finance.v_asl_DIM_gl_department AS dep ON os.os_level_12 = dep.department_code
  )
  SELECT * FROM OSandFACT
) AS t0
WHERE t0.month_end_flag IS NOT NULL
GROUP BY
  t0.month_end_flag
LIMIT 12",4,d7412673-0af1-4efe-8374-ca475b001fb6
"SELECT
  t0.movement_date,
  t0.financial_year,
  CASE
    WHEN (t0.xtend_flag = 'Y') THEN 'XTEND'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 3) = 'PRO' OR (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_sub_type = 'DIGITAL')) THEN 'PROGRAMMATIC'
    WHEN (t0.revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY'
    ELSE t0.revenue_sub_type
  END AS revenue_channel_type,
  CASE
    WHEN (t0.advertiser_group IS NULL) THEN 'Nah'
    ELSE t0.advertiser_group
  END AS advertiser_group_display,
  SUM(t0.GROSS_AMOUNT_DIFF) AS total_gross_amount_diff,
  SUM(CASE WHEN (t0.revenue_type = 'DIGITAL') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS digital_gross_amount_diff,
  SUM(CASE WHEN (t0.revenue_type = 'PRINT') THEN t0.GROSS_AMOUNT_DIFF ELSE 0 END) AS print_gross_amount_diff
FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0
WHERE t0.financial_year = '2025'
GROUP BY 1, 2, 3, 4
ORDER BY t0.movement_date DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT booking_line_id) AS unique_booking_lines,
  COUNT(DISTINCT advertiser_parent) AS unique_advertiser_parents,
  MIN(movement_date) AS min_movement_date,
  MAX(movement_date) AS max_movement_date
FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement`
LIMIT 1;","SELECT
  CASE
    WHEN MAX(movement_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check,
  CASE
    WHEN SUM(GROSS_AMOUNT_DIFF) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS gross_amount_diff_positive_check
FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement`
LIMIT 1;","SELECT
  CASE
    WHEN (t0.xtend_flag = 'Y') THEN 'XTEND'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 3) = 'PRO' OR (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_sub_type = 'DIGITAL')) THEN 'PROGRAMMATIC'
    WHEN (t0.revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL'
    WHEN (SAFE.LEFT(t0.revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY'
    ELSE t0.revenue_sub_type
  END AS revenue_channel_type,
  COUNT(t0.GROSS_AMOUNT_DIFF) AS record_count,
  SUM(t0.GROSS_AMOUNT_DIFF) AS total_gross_amount_diff
FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement` AS t0
GROUP BY 1
ORDER BY record_count DESC
LIMIT 5;",5,a1b901e6-c4fb-44bc-955a-3a7070c15829
"SELECT SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) AS month_start, Advertiser, SUM(RevenueGross) AS total_gross_revenue, SUM(RevenueNet) AS total_net_revenue, SUM(PaidImpressions) AS total_paid_impressions FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` GROUP BY 1, 2 ORDER BY 1 DESC, 3 DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT Advertiser) AS unique_advertisers, COUNT(DISTINCT DSP) AS unique_dsps, COUNT(DISTINCT Buyer) AS unique_buyers, MIN(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE)) AS min_date, MAX(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE)) AS max_date FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` LIMIT 1;","SELECT CASE WHEN SUM(RevenueGross) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check, CASE WHEN MAX(SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` LIMIT 1;","SELECT TransactionType, COUNT(*) AS record_count, SUM(RevenueGross) AS total_gross_revenue FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` GROUP BY TransactionType ORDER BY record_count DESC LIMIT 5;",6,87651b69-c43e-471f-9c4b-98df1208a844
"SELECT
  t0.financial_year,
  t0.financial_month,
  t0.sales_segment_l_2_name_sync,
  UPPER(t0.revenue_type) AS revenue_type,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
  SUM(IFNULL(t0.pipeline, 0)) AS total_pipeline
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly` AS t0
  LEFT JOIN (
    SELECT
      TEMP1.network_user_name AS login_name,
      TEMP1.user_name AS full_name
    FROM
      (
        SELECT
          UPPER(network_user_name) AS network_user_name,
          UPPER(user_name) AS user_name,
          ROW_NUMBER() OVER (PARTITION BY UPPER(network_user_name)) AS RN
        FROM
          `ncau-data-newsquery-prd`.prstn_advertising_views.v_user_dim
        WHERE
          dw_source_system_code = 'SFCE'
      ) AS TEMP1
    WHERE
      TEMP1.RN = 1
  ) AS SFCE_USER_GSD
  ON UPPER(t0.current_portfolio_group_owner_sync) = SFCE_USER_GSD.login_name
WHERE
  t0.relative_fy_year_offset IN (-1, 0, 1)
  AND UPPER(IFNULL(t0.revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(t0.style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(t0.source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(t0.publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(t0.publication_name) LIKE 'SUDDENLY%' AND t0.account_number IN ('17114', '29172', '52809')))
GROUP BY
  t0.financial_year,
  t0.financial_month,
  t0.sales_segment_l_2_name_sync,
  revenue_type
ORDER BY
  t0.financial_year DESC, t0.financial_month DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(financial_year AS STRING)) AS unique_financial_years,
  COUNT(DISTINCT SAFE_CAST(financial_month AS STRING)) AS unique_financial_months,
  COUNT(DISTINCT sales_segment_l_2_name_sync) AS unique_sales_segments,
  COUNT(DISTINCT UPPER(revenue_type)) AS unique_revenue_types,
  MIN(SAFE_CAST(financial_year AS STRING)) AS min_financial_year,
  MAX(SAFE_CAST(financial_year AS STRING)) AS max_financial_year,
  MIN(SAFE_CAST(financial_month AS STRING)) AS min_financial_month,
  MAX(SAFE_CAST(financial_month AS STRING)) AS max_financial_month
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
  AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND account_number IN ('17114', '29172', '52809')))
LIMIT 1;","SELECT
  CASE WHEN SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS current_fy_gross_revenue_check,
  CASE WHEN MAX(SAFE_CAST(financial_year AS STRING)) = FORMAT_DATE('%Y', CURRENT_DATE()) OR MAX(SAFE_CAST(financial_year AS STRING)) = FORMAT_DATE('%Y', DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR)) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
  AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND account_number IN ('17114', '29172', '52809')))
LIMIT 1;","SELECT
  CASE WHEN sales_segment_l_2_name_sync = 'MRCA' THEN 'MRCA' ELSE 'Client' END AS Sales_Group,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
  AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
  AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE'
  AND UPPER(IFNULL(source_publishing_division, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
  AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(publication_name) LIKE 'SUDDENLY%' AND account_number IN ('17114', '29172', '52809')))
GROUP BY
  Sales_Group
LIMIT 10;",7,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5
"WITH base_data AS (
    SELECT
        t0.financial_short_month,
        t0.financial_quarter,
        t0.financial_month,
        t0.gross_revenue_amount,
        t0.relative_fy_year_offset,
        SAFE_CAST(t0.reporting_date AS DATE) AS reporting_date,
        t0.revenue_group_subtype,
        t0.unified_publication_name,
        CASE
            WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
            WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
            WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
            ELSE NULL
        END AS revenue_category
    FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
)
SELECT
    financial_short_month,
    financial_quarter,
    financial_month,
    revenue_category,
    SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE NULL END) AS current_fy_gross_revenue,
    SUM(CASE WHEN relative_fy_year_offset = 0 AND reporting_date < CURRENT_DATE() THEN gross_revenue_amount ELSE NULL END) AS current_fy_ytd_gross_revenue,
    SUM(CASE WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount ELSE NULL END) AS previous_fy_gross_revenue
FROM base_data
GROUP BY
    financial_short_month,
    financial_quarter,
    financial_month,
    revenue_category
ORDER BY
    financial_quarter, financial_month, financial_short_month, revenue_category
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.financial_month AS STRING)) AS unique_financial_months,
    COUNT(DISTINCT SAFE_CAST(t0.financial_quarter AS STRING)) AS unique_financial_quarters,
    MIN(SAFE_CAST(t0.reporting_date AS DATE)) AS min_reporting_date,
    MAX(SAFE_CAST(t0.reporting_date AS DATE)) AS max_reporting_date
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_positive_check,
    CASE WHEN MAX(SAFE_CAST(t0.reporting_date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN (t0.unified_publication_name = 'TUBI') THEN 'TUBI'
        WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'GUARANTEED') THEN 'PG'
        WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'NON-GUARANTEED') THEN 'OMP'
        WHEN (UPPER(SAFE_CAST(t0.cost_model_type AS STRING)) = 'PMP') THEN 'PMP'
        WHEN (t0.unified_publication_name = 'Run of Audience Extension') THEN 'PERFORMANCE'
        ELSE 'Other'
    END AS revenue_category,
    COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
GROUP BY
    revenue_category
ORDER BY
    record_count DESC
LIMIT 10;",8,5491badf-5ec0-4b4f-a427-b12a3a3395dd
"SELECT t0.Source, t0.FinancialYear, t0.FinancialMonthNumber, SUM(t0.RevenueNet) AS total_revenue_net, SUM(SAFE_DIVIDE(t0.RevenueNet, t0.NumDays)*t0.StaticDays) AS total_prorated_revenue FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 GROUP BY 1, 2, 3 ORDER BY t0.FinancialYear DESC, t0.FinancialMonthNumber DESC LIMIT 10;","SELECT COUNT(*) AS total_records, MIN(SAFE_CAST(t0.FinancialYear AS STRING) || '-' || SAFE_CAST(t0.FinancialMonthNumber AS STRING)) AS min_financial_period, MAX(SAFE_CAST(t0.FinancialYear AS STRING) || '-' || SAFE_CAST(t0.FinancialMonthNumber AS STRING)) AS max_financial_period, COUNT(DISTINCT t0.Source) AS distinct_sources, COUNT(DISTINCT t0.FinancialYear) AS distinct_financial_years FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 LIMIT 1;","SELECT CASE WHEN SUM(CASE WHEN t0.CurrentMonthFlag = 1 THEN t0.RevenueNet ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS current_month_revenue_check, CASE WHEN MAX(SAFE_CAST(t0.FinancialYear AS STRING) || '-' || SAFE_CAST(t0.FinancialMonthNumber AS STRING)) >= FORMAT_DATE('%Y-%m', CURRENT_DATE()) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 LIMIT 1;","SELECT t0.CurrentMonthFlag, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0 GROUP BY t0.CurrentMonthFlag LIMIT 10;",9,a8fe6bb0-3cbf-4d6e-8838-fa6e6dce447f
"WITH pre_calculated_dims AS (
    SELECT
        t0.fy_year,
        t0.fy_week_of_year,
        t0.offer_category_name,
        t0.offer_category_group_name,
        t0.acquisition_count,
        t0.free_to_paid_conversion_count,
        t0.reactivation_30day_acquisition_count,
        t0.switch_acquisition_count,
        t0.table_nm,
        -- Subscription Type Category
        CASE WHEN (CONCAT(SAFE_CAST(t0.delivery_medium_type AS STRING),' ',SAFE_CAST(t0.subscriber_has_email_flag AS STRING)) IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions' ELSE 'Print Subscriptions' END AS subscription_type_category,
        -- Masthead Category Level 1
        CASE
            WHEN t0.masthead = 'TA' THEN 'The Australian'
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro'
            WHEN t0.masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC') THEN 'Regionals'
            WHEN t0.masthead = 'WT' THEN 'Other Publications'
            WHEN t0.masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU') THEN 'Deep Niche Publications'
            WHEN t0.masthead IS NULL THEN 'check'
            ELSE 'Exclude'
        END AS masthead_category_level1,
        -- Masthead Category Level 2
        CASE
            WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
            WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
            WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
            WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
            ELSE 'Exclude'
        END AS masthead_category_level2,
        -- Acquisition Source Category
        CASE
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_AB') > 0) THEN 'Above the Fold'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_BB') > 0) THEN 'Blackbook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CF') > 0) THEN 'Community Form'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_CS') > 0) THEN 'Closing Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FA') > 0) THEN 'Free Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_FF') > 0) THEN 'Form Finder'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_NA') > 0) THEN 'News Articles'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PC') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_PE') > 0) THEN 'Punters Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SL') > 0) THEN 'Shortlist'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_SS') > 0) THEN 'Setting Speed'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TE') > 0) THEN 'Tippers Edge'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TH') > 0) THEN 'Todays Headlines'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_TO') > 0) THEN 'The Oz'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), '_WS') > 0) THEN 'Why Subscribe'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 4), 'PRED') > 0) THEN 'Predictor'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'AMP') > 0) THEN 'Google AMP'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'FMB') > 0) THEN 'Facebook Messenger Bot'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGL') > 0) THEN 'Google'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'GGN') > 0) THEN 'Google News'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'INS') > 0) THEN 'Instagram'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NEW') > 0) THEN 'news.com.au'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'NWL') > 0) THEN 'Newsletter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POD') > 0) THEN 'Podcasts'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'POR') > 0) THEN 'Newsletter Sports'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SCP') > 0) THEN 'Supercoach Plus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'SEC') > 0) THEN 'Sectionals'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TCA') > 0) THEN 'True Crime Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TMP') > 0) THEN 'Tips Mrket Place'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWA') > 0) THEN 'The Weekend Aus'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'TWT') > 0) THEN 'Twitter'
            WHEN (STRPOS(SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), 3), 'WID') > 0) THEN 'Widget'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_FBK') > 0) THEN 'Facebook'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_GGL') > 0) THEN 'Google'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_LIN') > 0) THEN 'Linked In'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_RED') > 0) THEN 'Reddit'
            WHEN (STRPOS(LTRIM(RTRIM(SAFE_CAST(t0.sold_in_source_code AS STRING))), '_TWT') > 0) THEN 'Twitter'
            ELSE NULL
        END AS acquisition_source_category,
        -- Business Segment Category
        CASE
            WHEN t0.classification_level_2 IN ('Consumer', 'Gift Receiver') THEN 'B2C'
            WHEN t0.classification_level_2 IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB') THEN 'B2B'
            ELSE 'Others'
        END AS business_segment_category
    FROM
        `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
)
SELECT
    pre_calculated_dims.fy_year,
    pre_calculated_dims.fy_week_of_year,
    pre_calculated_dims.masthead_category_level2 AS masthead_group,
    pre_calculated_dims.subscription_type_category AS subscription_type,
    pre_calculated_dims.acquisition_source_category AS source_category,
    pre_calculated_dims.business_segment_category AS business_segment,
    COUNT(1) AS total_records,
    SUM(pre_calculated_dims.acquisition_count) AS total_acquisition_count,
    SUM(pre_calculated_dims.free_to_paid_conversion_count) AS total_free_to_paid_conversions,
    SUM(pre_calculated_dims.reactivation_30day_acquisition_count) AS total_30day_reactivations,
    SUM(pre_calculated_dims.switch_acquisition_count) AS total_switch_acquisitions
FROM
    pre_calculated_dims
WHERE
    pre_calculated_dims.masthead_category_level1 != 'Exclude'
    AND pre_calculated_dims.subscription_type_category = 'Digital Subscriptions'
    AND pre_calculated_dims.table_nm != 'op'
    AND pre_calculated_dims.acquisition_source_category IS NOT NULL
    AND pre_calculated_dims.masthead_category_level2 = 'The Australian and Prestige'
    AND pre_calculated_dims.fy_year = 2025
    AND pre_calculated_dims.business_segment_category IN ('B2C')
GROUP BY
    1, 2, 3, 4, 5, 6
ORDER BY
    pre_calculated_dims.fy_year DESC, pre_calculated_dims.fy_week_of_year DESC
LIMIT 10;","SELECT
    COUNT(1) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.fy_year AS STRING)) AS unique_fiscal_years,
    MIN(SAFE_CAST(t0.fy_year AS STRING)) AS min_fiscal_year,
    MAX(SAFE_CAST(t0.fy_year AS STRING)) AS max_fiscal_year,
    COUNT(DISTINCT t0.masthead) AS unique_mastheads,
    COUNT(DISTINCT t0.sold_in_source_code) AS unique_source_codes,
    COUNT(DISTINCT t0.delivery_medium_type) AS unique_delivery_medium_types,
    COUNT(DISTINCT t0.classification_level_2) AS unique_classification_level_2s
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
LIMIT 1;","SELECT
    CASE WHEN COUNT(1) > 0 THEN 'PASS' ELSE 'FAIL' END AS data_exists_check,
    CASE WHEN MAX(t0.fy_year) >= 2024 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check_fy_year,
    CASE WHEN SUM(t0.acquisition_count) > 0 THEN 'PASS' ELSE 'FAIL' END AS acquisition_count_positive_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
WHERE
    t0.fy_year = 2025
LIMIT 1;","SELECT
    CASE
        WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC') THEN 'States and Community'
        WHEN t0.masthead = 'TA' THEN 'The Australian and Prestige'
        WHEN t0.masthead IN ('PU', 'RN') THEN 'Commercial Content'
        WHEN t0.masthead IN ('TS') THEN 'Free & Lifestyle'
        ELSE 'Exclude'
    END AS masthead_group_level2,
    COUNT(1) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
GROUP BY
    masthead_group_level2
ORDER BY
    record_count DESC
LIMIT 5;",10,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101
"SELECT
  t0.portfolio_conformed_name_sync,
  t0.financial_quarter,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_cy,
  SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS gross_revenue_ly,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.target ELSE 0 END) AS target_cy
FROM
  `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0
GROUP BY
  t0.portfolio_conformed_name_sync,
  t0.financial_quarter
ORDER BY
  t0.portfolio_conformed_name_sync,
  t0.financial_quarter
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.portfolio_conformed_name_sync) AS unique_portfolios,
  COUNT(DISTINCT t0.GSD) AS unique_gsds,
  MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
  MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date
FROM
  `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0
LIMIT 1;","SELECT
  CASE
    WHEN SUM(CASE WHEN t0.gross_revenue_amount < 0 THEN 1 ELSE 0 END) = 0 THEN 'PASS: All gross revenue amounts are non-negative.'
    ELSE 'FAIL: Some gross revenue amounts are negative.'
  END AS revenue_check,
  CASE
    WHEN MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) >= CURRENT_DATE() - INTERVAL 90 DAY THEN 'PASS: Data is recent (within last 90 days).'
    ELSE 'FAIL: Data is not recent (older than 90 days).'
  END AS freshness_check
FROM
  `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance AS t0
LIMIT 1;","WITH
  CTE AS (
    SELECT
      *,
      CASE
        WHEN @reporting_mth = 0 THEN
        CASE
          WHEN relative_fy_month_offset = 0 OR relative_fy_month_offset = -12 THEN CAST(financial_month AS INT)
        END
        ELSE @reporting_mth
      END AS filter_reporting_month,
      SUM(
        CASE
          WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount
          ELSE 0
        END) OVER (PARTITION BY advertiser_group) AS fix_ly_lgr,
      SUM(
        CASE
          WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount
          ELSE 0
        END) OVER (PARTITION BY advertiser_group) AS fix_ty_lgr
    FROM
      `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance
  )
SELECT
  CASE
    WHEN fix_ly_lgr <= 1 AND fix_ty_lgr > 1 THEN 'NEW BUSINESS'
    WHEN fix_ly_lgr > 1 AND fix_ty_lgr > 1 THEN 'RETAINED'
    WHEN fix_ly_lgr > 1 AND fix_ty_lgr <= 1 THEN 'INACTIVE'
    WHEN fix_ly_lgr <= 1 AND fix_ty_lgr <= 1 THEN 'LAPSED'
    ELSE 'Other'
  END AS customer_status_full,
  COUNT(*) AS record_count
FROM
  CTE
GROUP BY
  customer_status_full
LIMIT 12;",11,155c4518-72bf-4309-a0e9-240dd564f421
"SELECT
  ci.fiscal_week_id,
  ci.sales_channel_l4,
  CASE
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('500', '560') THEN 'ADV'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '100' THEN 'AUS'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('400', '402') THEN 'CM'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9504' THEN 'Delicious'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9505' THEN 'Delicious Specials'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('110', '116') THEN 'DT'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '350' THEN 'GAD'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '670' THEN 'GCB'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '180' THEN 'Group Shared Services'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '156' THEN 'Hobart Print Services'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('301', '303') THEN 'HS'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5003' THEN 'MDM'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('850', '852') THEN 'MERCURY'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('961', '963') THEN 'NTN'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '158' THEN 'Perth Print Services'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = 'Post Courier' THEN 'Post Courier'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5024' THEN 'SC'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('9514', '9515') THEN 'Taste'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5053' THEN 'TCHRN'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '450' THEN 'TCP'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '475' THEN 'TVB'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9560' THEN 'Vogue'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9556' THEN 'Vogue Living'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '305' THEN 'WT'
    ELSE 'Other'
  END AS publication_name,
  SUM(CASE WHEN ci.charge_type = 'DRAW' THEN ci.route_volume ELSE 0 END) AS draw_route_volume,
  SUM(CASE WHEN ci.charge_type = 'RETURNS' THEN ci.route_volume ELSE 0 END) AS returns_route_volume,
  SUM(ci.charge_amount) AS total_charge_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
  LEFT JOIN
  `ncau-data-newsquery-prd.prstn_finance.v_calendar_dim` AS cal
  ON ci.charge_date = cal.calendar_date
WHERE
  SAFE_CAST(LEFT(SAFE_CAST(ci.fiscal_week_id AS STRING), 4) AS INT64) = 2025
GROUP BY
  1, 2, 3
ORDER BY
  ci.fiscal_week_id DESC
LIMIT 10","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT ci.fiscal_week_id) AS unique_fiscal_weeks,
  COUNT(DISTINCT ci.sales_channel_l4) AS unique_sales_channels_l4,
  MIN(ci.charge_date) AS min_charge_date,
  MAX(ci.charge_date) AS max_charge_date
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
LIMIT 1","SELECT
  CASE WHEN (SELECT SUM(ci.charge_amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci WHERE ci.fiscal_week_id = (SELECT MAX(fiscal_week_id) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights`)) > 0 THEN 'PASS' ELSE 'FAIL' END AS charge_amount_check,
  CASE WHEN (SELECT MAX(ci.charge_date) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci) >= CURRENT_DATE() - INTERVAL 30 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
LIMIT 1","SELECT
  CASE
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('500', '560') THEN 'ADV'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '100' THEN 'AUS'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('400', '402') THEN 'CM'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9504' THEN 'Delicious'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9505' THEN 'Delicious Specials'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('110', '116') THEN 'DT'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '350' THEN 'GAD'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '670' THEN 'GCB'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '180' THEN 'Group Shared Services'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '156' THEN 'Hobart Print Services'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('301', '303') THEN 'HS'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5003' THEN 'MDM'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('850', '852') THEN 'MERCURY'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('961', '963') THEN 'NTN'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '158' THEN 'Perth Print Services'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = 'Post Courier' THEN 'Post Courier'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5024' THEN 'SC'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) IN ('9514', '9515') THEN 'Taste'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '5053' THEN 'TCHRN'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '450' THEN 'TCP'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '475' THEN 'TVB'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9560' THEN 'Vogue'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '9556' THEN 'Vogue Living'
    WHEN SAFE_CAST(ci.gl_publication_code AS STRING) = '305' THEN 'WT'
    ELSE 'Other'
  END AS publication_name,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` AS ci
GROUP BY
  publication_name
ORDER BY
  record_count DESC
LIMIT 10",12,c441950c-1e3f-432c-9838-847d1d315b9e
"SELECT
  t0.Sales_Group,
  t0.financial_quarter,
  SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
  SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  1, 2
ORDER BY
  1, 2
LIMIT 10","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers,
  COUNT(DISTINCT t0.Sales_Group) AS unique_sales_groups,
  MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
  MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS total_revenue_check,
  CASE WHEN MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) >= CURRENT_DATE('Australia/Sydney') - INTERVAL 7 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1","SELECT
  CASE
    WHEN t0.fin_adtype_name = 'XTEND' THEN 'XTEND'
    WHEN (t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER' AND t0.revenue_group_subtype = 'DIGITAL') THEN 'PROGRAMMATIC - DIGITAL OTHER'
    WHEN t0.revenue_group_subtype = 'PROGRAMMATIC EXCHANGE' THEN 'PROGRAMMATIC - DIGITAL OTHER OFFSET'
    WHEN SAFE.LEFT(t0.cost_model_type, 3) = 'GUA' THEN 'PROGRAMMATIC - GUARANTEED'
    WHEN SAFE.LEFT(t0.cost_model_type, 3) = 'NON' THEN 'PROGRAMMATIC - OPEN EXCHANGE'
    WHEN SAFE.LEFT(t0.cost_model_type, 3) = 'PMP' THEN 'PROGRAMMATIC - PMP'
    WHEN t0.revenue_group_subtype = 'DIGITAL' THEN 'ADPT DIGITAL'
    WHEN SAFE.LEFT(t0.revenue_group_subtype, 6) = 'SUNDRY' THEN 'SUNDRY'
    ELSE t0.revenue_group_subtype
  END AS revenue_classification,
  COUNT(*) AS count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
  1
ORDER BY
  count DESC
LIMIT 10",13,80ca81f3-0671-40ef-a0a9-825a1580ca1b
"SELECT
    t0.financial_year,
    CASE
        WHEN t0.financial_short_month = 'Jul' THEN '1.Jul'
        WHEN t0.financial_short_month = 'Aug' THEN '2.Aug'
        WHEN t0.financial_short_month = 'Sep' THEN '3.Sep'
        WHEN t0.financial_short_month = 'Oct' THEN '4.Oct'
        WHEN t0.financial_short_month = 'Nov' THEN '5.Nov'
        WHEN t0.financial_short_month = 'Dec' THEN '6.Dec'
        WHEN t0.financial_short_month = 'Jan' THEN '7.Jan'
        WHEN t0.financial_short_month = 'Feb' THEN '8.Feb'
        WHEN t0.financial_short_month = 'Mar' THEN '9.Mar'
        WHEN t0.financial_short_month = 'Apr' THEN '10.Apr'
        WHEN t0.financial_short_month = 'May' THEN '11.May'
        WHEN t0.financial_short_month = 'Jun' THEN '12.Jun'
        ELSE NULL
    END AS financial_short_month_mapped,
    t0.sales_segment_l_2_name_sync,
    SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) AS gross_revenue_amount_current_fy_k,
    SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN SAFE_DIVIDE(t0.gross_revenue_amount, 1000) ELSE 0 END) AS gross_revenue_amount_previous_fy_k,
    SUM(t0.pipeline) AS pipeline_total
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    t0.financial_year,
    financial_short_month_mapped,
    t0.sales_segment_l_2_name_sync
ORDER BY
    t0.financial_year DESC, financial_short_month_mapped ASC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.product_group) AS unique_product_groups,
    COUNT(DISTINCT t0.unified_publication_name) AS unique_publications,
    MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
    MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN COUNTIF(t0.gross_revenue_amount <= 0) = 0 THEN 'PASS'
        ELSE 'FAIL'
    END AS gross_revenue_positive_check,
    CASE
        WHEN MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) >= CURRENT_DATE() - INTERVAL 30 DAY THEN 'PASS'
        ELSE 'FAIL'
    END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    t0.relative_fy_year_offset,
    COUNT(*) AS record_count,
    SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_revenue,
    SUM(CASE WHEN t0.relative_fy_year_offset = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_revenue,
    SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.gross_revenue_amount ELSE 0 END) AS next_fy_revenue
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    t0.relative_fy_year_offset
ORDER BY
    t0.relative_fy_year_offset
LIMIT 12;",14,4d8074b2-17a8-48ba-babe-c536359b1f64
"SELECT financial_year, SAFE_CAST(financial_month AS INT64) AS financial_month, revenue_type, source_publishing_division, SUM(gross_revenue_amount) AS total_gross_revenue, SUM(gross_revenue_ex_adj_amount) AS total_gross_revenue_ex_adj, SUM(adjustment_amount) AS total_adjustment_amount, SUM(rebate_3_amount) AS total_rebate_3_amount, SUM(rebate_2_amount) AS total_rebate_2_amount FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE (revenue_transaction_status IN ('Booked', 'Billed') AND financial_year IS NOT NULL AND (source_publishing_division != 'Medium Rare Content Agency' OR source_publishing_division IS NULL) AND revenue_type IN ('Print', 'Digital') AND revenue_group_subtype IN ('Programmatic Source', 'Print', 'Digital') AND financial_year IN ('2025')) GROUP BY financial_year, financial_month, revenue_type, source_publishing_division ORDER BY financial_year DESC, financial_month DESC LIMIT 10;","SELECT COUNT(1) AS total_records, COUNT(DISTINCT account_number) AS unique_accounts, COUNT(DISTINCT invoice_number) AS unique_invoices, MIN(financial_year) AS min_financial_year, MAX(financial_year) AS max_financial_year, MIN(SAFE_CAST(financial_month AS INT64)) AS min_financial_month, MAX(SAFE_CAST(financial_month AS INT64)) AS max_financial_month FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` LIMIT 1;","SELECT CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_positive_check, CASE WHEN MAX(financial_year) = '2025' THEN 'PASS' ELSE 'FAIL' END AS latest_year_check, CASE WHEN COUNT(DISTINCT revenue_transaction_status) > 0 THEN 'PASS' ELSE 'FAIL' END AS transaction_status_exists_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` WHERE revenue_transaction_status IN ('Booked', 'Billed') LIMIT 1;","SELECT revenue_transaction_status, COUNT(1) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` GROUP BY revenue_transaction_status ORDER BY record_count DESC LIMIT 5;",15,a17622e2-ad43-49cc-b3c5-19c95036fd14
"SELECT
  SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) AS financial_month_adjusted,
  t0.source,
  UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) AS source_transaction_type_upper,
  t0.advertiser,
  SUM(t0.revenuenet) AS total_revenue_net
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE
  t0.source IN ('AdX', 'AppNexus', 'DFP', 'Index Exchange', 'InSkin', 'Kargo', 'Playground XYZ', 'PubMatic', 'Rubicon', 'Tremor')
  AND UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) IN ('DEAL', 'UFR', 'PG - CPD', 'PG - CPM', 'DIRECT')
GROUP BY
  financial_month_adjusted,
  t0.source,
  source_transaction_type_upper,
  t0.advertiser
ORDER BY
  financial_month_adjusted DESC, total_revenue_net DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.advertiser AS STRING)) AS unique_advertisers,
  COUNT(DISTINCT SAFE_CAST(t0.buyer AS STRING)) AS unique_buyers,
  COUNT(DISTINCT SAFE_CAST(t0.source AS STRING)) AS unique_sources,
  COUNT(DISTINCT UPPER(SAFE_CAST(t0.source_transactiontype AS STRING))) AS unique_transaction_types,
  MIN(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATE)) AS min_financial_date,
  MAX(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATE)) AS max_financial_date
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.revenuenet) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check,
  CASE WHEN MAX(SAFE_CAST(DATE(t0.financialyear, t0.financialmonthnumber, 1) AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
LIMIT 1;","SELECT
  UPPER(SAFE_CAST(t0.source_transactiontype AS STRING)) AS source_transaction_type,
  COUNT(*) AS record_count,
  SUM(t0.revenuenet) AS total_revenue_net
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
GROUP BY
  source_transaction_type
ORDER BY
  record_count DESC
LIMIT 5;",16,783f341c-8660-4e90-bab8-9bc860119cf5
"SELECT
  t0.financial_year AS financial_year,
  t0.fin_adtype_name AS fin_adtype_name,
  t0.revenue_transaction_status AS revenue_transaction_status,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE t0.revenue_transaction_status IN ('Booked', 'Billed')
  AND (t0.source_publishing_division != 'Medium Rare Content Agency' OR t0.source_publishing_division IS NULL)
  AND t0.financial_year IN ('2025', '2024')
GROUP BY 1, 2, 3
ORDER BY 1 DESC, 2 ASC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.booking_number) AS unique_booking_numbers,
  COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers,
  MIN(t0.financial_year) AS min_financial_year,
  MAX(t0.financial_year) AS max_financial_year
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check,
  CASE WHEN MAX(t0.financial_year) >= CAST(EXTRACT(YEAR FROM CURRENT_DATE()) AS STRING) THEN 'PASS' ELSE 'FAIL' END AS freshness_check
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE t0.financial_year = CAST(EXTRACT(YEAR FROM CURRENT_DATE()) AS STRING)
LIMIT 1;","SELECT
  t0.revenue_transaction_status AS transaction_status,
  COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5;",17,f65a9149-93b4-4aa9-aef6-d12002853222
"SELECT financial_year, revenue_transaction_status, source_system_code, SUM(gross_revenue_amount) AS total_gross_revenue, SUM(ss_lgb) AS total_ss_lgb FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` GROUP BY financial_year, revenue_transaction_status, source_system_code ORDER BY financial_year DESC LIMIT 10;","SELECT COUNT(1) AS total_records, COUNT(DISTINCT invoice_number) AS unique_invoices, COUNT(DISTINCT advertiser_name) AS unique_advertisers, MIN(financial_year) AS min_financial_year, MAX(financial_year) AS max_financial_year, MIN(data_load_datetime) AS min_data_load_datetime, MAX(data_load_datetime) AS max_data_load_datetime FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` LIMIT 1;","SELECT CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check, CASE WHEN MAX(t0.data_load_datetime) > DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS freshness_check FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0 WHERE t0.financial_year = '2025' LIMIT 1;","SELECT revenue_transaction_status, COUNT(1) AS record_count FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` GROUP BY revenue_transaction_status LIMIT 5;",18,77c68c35-20ce-477a-b216-0c781d43a8ca
"SELECT
    t0.fiscal_year,
    t0.month_short_name,
    t0.scenario,
    t0.os_level_4,
    SUM(t0.Actual_Amount) AS total_actual_amount
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
GROUP BY
    t0.fiscal_year,
    t0.month_short_name,
    t0.scenario,
    t0.os_level_4
ORDER BY t0.fiscal_year DESC, t0.month_short_name DESC
LIMIT 10;","SELECT
    COUNT(1) AS total_records,
    COUNT(DISTINCT t0.fiscal_year) AS unique_fiscal_years,
    COUNT(DISTINCT t0.month_short_name) AS unique_months,
    MIN(SAFE_CAST(t0.fiscal_year AS INT64)) AS min_fiscal_year,
    MAX(SAFE_CAST(t0.fiscal_year AS INT64)) AS max_fiscal_year
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(t0.Actual_Amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_positive_check,
    CASE WHEN COUNT(DISTINCT SAFE_CAST(t0.fiscal_year AS INT64)) > 0 THEN 'PASS' ELSE 'FAIL' END AS fiscal_year_data_check
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
WHERE SAFE_CAST(t0.fiscal_year AS INT64) = 2025
LIMIT 1;","SELECT
    t0.scenario,
    COUNT(1) AS record_count,
    SUM(t0.Actual_Amount) AS total_amount
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tableau_MER_budgets_forecasts` AS t0
GROUP BY t0.scenario
ORDER BY record_count DESC
LIMIT 12;",19,f353b933-30eb-4853-9976-0d35371db7d7
"SELECT
    t0.FinancialYear,
    t0.FinancialQuarter,
    t0.PortfolioParentGroup,
    SUM(t0.RevenueGross) AS total_revenue_gross,
    COUNT(DISTINCT t0.DSP) AS unique_dsps
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
GROUP BY
    t0.FinancialYear,
    t0.FinancialQuarter,
    t0.PortfolioParentGroup
ORDER BY
    t0.FinancialYear DESC,
    t0.FinancialQuarter DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    APPROX_COUNT_DISTINCT(t0.Advertiser) AS unique_advertisers,
    APPROX_COUNT_DISTINCT(t0.DSP) AS unique_dsps,
    APPROX_COUNT_DISTINCT(t0.PortfolioChildGroup) AS unique_portfolio_child_groups,
    MIN(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATE)) AS min_calendar_date,
    MAX(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATE)) AS max_calendar_date
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(t0.RevenueGross) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_positive_check,
    CASE WHEN MAX(SAFE_CAST(DATE(t0.FinancialYear, (CASE WHEN (t0.FinancialMonthNumber = 1) THEN 7 WHEN (t0.FinancialMonthNumber = 2) THEN 8 WHEN (t0.FinancialMonthNumber = 3) THEN 9 WHEN (t0.FinancialMonthNumber = 4) THEN 10 WHEN (t0.FinancialMonthNumber = 5) THEN 11 WHEN (t0.FinancialMonthNumber = 6) THEN 12 WHEN (t0.FinancialMonthNumber = 7) THEN 1 WHEN (t0.FinancialMonthNumber = 8) THEN 2 WHEN (t0.FinancialMonthNumber = 9) THEN 3 WHEN (t0.FinancialMonthNumber = 10) THEN 4 WHEN (t0.FinancialMonthNumber = 11) THEN 5 WHEN (t0.FinancialMonthNumber = 12) THEN 6 ELSE NULL END), 1) AS DATE)) IS NOT NULL THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
LIMIT 1;","SELECT
    t0.TransactionType,
    COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` AS t0
GROUP BY
    t0.TransactionType
ORDER BY
    record_count DESC
LIMIT 5;",20,6f1c8731-02da-464f-b146-bf2947860735
"SELECT
  t0.Major_Category,
  t0.Media_Network,
  DATETIME_TRUNC(SAFE_CAST(t0.date AS DATETIME), MONTH) AS month_start_date,
  SUM(CASE WHEN SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2022-08-01') AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2023-06-01') THEN t0.Spend ELSE 0 END) AS spend_current_period,
  SUM(CASE WHEN SAFE_CAST(t0.date AS DATETIME) >= PARSE_DATETIME('%Y-%m-%d', '2023-08-01') AND SAFE_CAST(t0.date AS DATETIME) <= PARSE_DATETIME('%Y-%m-%d', '2024-06-01') THEN t0.Spend ELSE 0 END) AS spend_comparison_period
FROM
  (
    WITH
      adex_data AS (
        SELECT
          *
        FROM
          `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
      ),
      adex_date_fact AS (
        SELECT
          Media_Type,
          portfolio_parent_group_name,
          date,
          DATE_ADD(date, INTERVAL 1 MONTH) AS next_mth,
          DATE_ADD(date, INTERVAL 12 MONTH) AS next_yr
        FROM
          (
            SELECT DISTINCT
              Media_Type,
              portfolio_parent_group_name
            FROM
              adex_data
          )
          CROSS JOIN
          UNNEST(GENERATE_DATE_ARRAY((
              SELECT
                MIN(date)
              FROM
                adex_data
            ), (
              SELECT
                MAX(date)
              FROM
                adex_data
            ), INTERVAL 1 MONTH)) AS date
      ),
      adex_full_date AS (
        SELECT
          adf.*,
          financial_year,
          Major_Category,
          Advertiser_Group___Advertiser,
          Advertiser,
          Media_Network,
          Media_Group,
          Ad_Type,
          Brand,
          Product,
          Category,
          Sub_Category,
          account_number,
          portfolio_group_name,
          portfolio_conformed_name,
          Spend,
          sales_segment_gm_name
        FROM
          adex_date_fact AS adf
          LEFT JOIN
          adex_data
          ON adf.date = adex_data.date AND adf.Media_Type = adex_data.Media_Type AND adf.portfolio_parent_group_name =
            adex_data.portfolio_parent_group_name
      )
    SELECT
      afd.*,
      FORMAT_DATETIME('%b', DATETIME(date)) AS calendar_month_short_name,
      CAST(FORMAT_DATETIME('%Y', DATETIME(date)) AS INT) AS calendar_year,
      SUM(Spend) OVER (PARTITION BY date) AS spend_monthly_agg,
      latest_date
    FROM
      adex_full_date AS afd
      CROSS JOIN
      (
        SELECT
          MAX(adf.date) AS latest_date
        FROM
          adex_full_date AS adf
      )
  ) AS t0
GROUP BY
  1, 2, 3
ORDER BY
  month_start_date DESC
LIMIT 10","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT Media_Type) AS unique_media_types,
  COUNT(DISTINCT Major_Category) AS unique_major_categories,
  COUNT(DISTINCT Media_Network) AS unique_media_networks,
  MIN(date) AS min_date,
  MAX(date) AS max_date
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
LIMIT 1","SELECT
  CASE WHEN SUM(SAFE_CAST(Spend AS BIGNUMERIC)) > 0 THEN 'PASS' ELSE 'FAIL' END AS spend_positive_check,
  CASE WHEN MAX(SAFE_CAST(date AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
LIMIT 1","SELECT
  'Media_Group' AS dimension_name,
  Media_Group AS dimension_value,
  COUNT(*) AS record_count,
  SUM(SAFE_CAST(Spend AS BIGNUMERIC)) AS total_spend
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
GROUP BY
  1, 2
UNION ALL
SELECT
  'Major_Category' AS dimension_name,
  Major_Category AS dimension_value,
  COUNT(*) AS record_count,
  SUM(SAFE_CAST(Spend AS BIGNUMERIC)) AS total_spend
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
GROUP BY
  1, 2
UNION ALL
SELECT
  'Media_Network' AS dimension_name,
  Media_Network AS dimension_value,
  COUNT(*) AS record_count,
  SUM(SAFE_CAST(Spend AS BIGNUMERIC)) AS total_spend
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource
GROUP BY
  1, 2
ORDER BY
  dimension_name, total_spend DESC
LIMIT 10",21,e9d8a216-4950-4d30-b344-5011776edbdf
"SELECT SUM(t0.Total_Revenue) AS total_revenue, SUM(t0.Net_Growth_Consumer) AS net_growth_consumer, SUM(t0.Total_Weekly_Sales) AS total_weekly_sales, SAFE_CAST(t0.fy_year AS INT64) AS fiscal_year, SAFE_CAST(t0.fy_week_of_year AS INT64) AS fiscal_week_of_year, SAFE_CAST(t0.masthead AS STRING) AS masthead FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY fiscal_year, fiscal_week_of_year, masthead ORDER BY fiscal_year DESC, fiscal_week_of_year DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT SAFE_CAST(t0.masthead AS STRING)) AS unique_mastheads, MIN(SAFE_CAST(t0.fy_year AS INT64)) AS min_fy_year, MAX(SAFE_CAST(t0.fy_year AS INT64)) AS max_fy_year, MIN(SAFE_CAST(t0.fy_week_of_year AS INT64)) AS min_fy_week, MAX(SAFE_CAST(t0.fy_week_of_year AS INT64)) AS max_fy_week FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 LIMIT 1;","SELECT CASE WHEN SUM(t0.Total_Revenue) > 0 THEN 'PASS' ELSE 'FAIL' END AS total_revenue_check, CASE WHEN MAX(SAFE_CAST(t0.fy_year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE()) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 WHERE SAFE_CAST(t0.fy_year AS INT64) = (SELECT SAFE_CAST(MAX(fy_year) AS INT64) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` LIMIT 1) AND SAFE_CAST(t0.fy_week_of_year AS INT64) = (SELECT SAFE_CAST(MAX(fy_week_of_year) AS INT64) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE SAFE_CAST(fy_year AS INT64) = (SELECT SAFE_CAST(MAX(fy_year) AS INT64) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` LIMIT 1) LIMIT 1) LIMIT 1;","SELECT SAFE_CAST(t0.masthead AS STRING) AS original_masthead, CASE WHEN (SAFE_CAST(t0.masthead AS STRING) = 'TA') THEN 'The Australian' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'DT') THEN 'Daily Telegraph' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'HS') THEN 'Herald Sun' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'WT') THEN 'Weekly Times' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'GA') THEN 'Geelong Advertiser' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'CM') THEN 'Courier Mail' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'CP') THEN 'Cairns Post' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'TB') THEN 'Townsville Bulletin' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'TC') THEN 'Toowoomba Chronicles' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'GC') THEN 'Gold Coast' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'TM') THEN 'The Mercury' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'NT') THEN 'NT News' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'AA') THEN 'The Advertiser' ELSE 'Other' END AS masthead_full_name, CASE WHEN (SAFE_CAST(t0.masthead AS STRING) IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'States and Community' WHEN (SAFE_CAST(t0.masthead AS STRING) = 'TA') THEN 'The Australian and Prestige' ELSE 'Other' END AS masthead_group_1, CASE WHEN (SAFE_CAST(t0.masthead AS STRING) IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro' WHEN (SAFE_CAST(t0.masthead AS STRING) IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT')) THEN 'Regionals' ELSE 'Other' END AS masthead_group_2, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0 GROUP BY 1, 2, 3, 4 ORDER BY record_count DESC LIMIT 10;",22,57d87efe-c112-4d42-be1b-045f0c8ca73e
"SELECT
  t0.fy_year_week_number,
  t0.revenue_type,
  SUM(t0.amount) AS total_amount,
  SUM(t0.volume) AS total_volume,
  SUM(CASE WHEN SAFE.LEFT(t0.revenue_type, 2) = '03' THEN t0.amount ELSE 0 END) AS amount_revenue_type_03,
  SUM(CASE WHEN SAFE.LEFT(t0.revenue_type, 2) = '03' THEN t0.volume ELSE 0 END) AS volume_revenue_type_03
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
GROUP BY
  t0.fy_year_week_number,
  t0.revenue_type
ORDER BY
  t0.fy_year_week_number DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_rows,
  COUNT(DISTINCT SAFE_CAST(t0.fy_year_week_number AS STRING)) AS unique_fy_week_numbers,
  MIN(t0.fy_year_week_number) AS min_fy_week_number,
  MAX(t0.fy_year_week_number) AS max_fy_week_number,
  COUNT(DISTINCT t0.revenue_type) AS unique_revenue_types
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
LIMIT 1;","SELECT
  CASE WHEN (SELECT MAX(snap_load_time) FROM (
    SELECT datetime(max(dw_prstn_load_timestamp), 'Australia/Sydney') AS snap_load_time FROM `ncau-data-newsquery-prd.prstn_finance_persisted.finance_operating_statement` WHERE source_system_name = 'Circulation' AND scenario = 'Estimate' AND sub_source_system_name IN ('RCTI', 'THINK', 'DTI')
    UNION ALL
    SELECT datetime(max(dw_bdm_load_timestamp), 'Australia/Sydney') AS snap_load_time FROM `ncau-data-newsquery-prd.prstn_finance.v_circulation_snapshot_fct`
  ) AS load_time) IS NOT NULL THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check,
  CASE WHEN (SELECT SUM(amount) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check`) > 0 THEN 'PASS' ELSE 'FAIL' END AS amount_positive_check
LIMIT 1;","SELECT
  SAFE.LEFT(t0.revenue_type, 2) AS revenue_type_prefix,
  COUNT(1) AS record_count,
  SUM(t0.amount) AS total_amount_for_prefix
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` AS t0
GROUP BY
  revenue_type_prefix
ORDER BY
  record_count DESC
LIMIT 5;",23,f7a9efeb-df3c-45c9-899d-0bcada701572
"SELECT
  t.Major_Category,
  t.Media_Network,
  SUM(CASE WHEN DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) <= 11 THEN SAFE_DIVIDE(t.Spend, 1000) ELSE 0 END) AS spend_ty_rolling12m,
  SUM(CASE WHEN DATE_DIFF(max_date_cte.latest_date, t.date, MONTH) BETWEEN 12 AND 23 THEN SAFE_DIVIDE(t.Spend, 1000) ELSE 0 END) AS spend_ly_rolling12m
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
CROSS JOIN
  (SELECT MAX(date) AS latest_date FROM `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource WHERE source = 'Adex') AS max_date_cte
GROUP BY
  t.Major_Category,
  t.Media_Network
ORDER BY
  spend_ty_rolling12m DESC
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t.Advertiser) AS unique_advertisers,
  COUNT(DISTINCT t.Major_Category) AS unique_major_categories,
  COUNT(DISTINCT t.Media_Network) AS unique_media_networks,
  MIN(t.date) AS min_date,
  MAX(t.date) AS max_date
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
WHERE
  t.source = 'Adex'
LIMIT 1;","SELECT
  CASE WHEN MAX(t.date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check,
  CASE WHEN SUM(t.Spend) > 0 THEN 'PASS' ELSE 'FAIL' END AS spend_positive_check
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
WHERE
  t.source = 'Adex'
LIMIT 1;","SELECT
  CASE
    WHEN t.Media_Group = 'Print' THEN 'Print'
    WHEN t.Media_Group = 'Digital' AND t.Ad_Type = 'Display' THEN 'Digital Display'
    WHEN t.Media_Group = 'Digital' AND t.Ad_Type = 'Video' THEN 'Digital Video'
    WHEN t.Media_Group = 'Social' AND t.Ad_Type = 'Display' THEN 'Digital Social Display'
    WHEN t.Media_Group = 'Social' AND t.Ad_Type = 'Video' THEN 'Digital Social Video'
    WHEN t.Media_Group = 'Cinema' THEN 'Cinema'
    WHEN t.Media_Group = 'Out of Home' THEN 'Out of Home'
    WHEN t.Media_Group = 'Radio' THEN 'Radio'
    WHEN t.Media_Group = 'Television' THEN 'Television'
    ELSE 'Other'
  END AS media_group_classification,
  COUNT(*) AS record_count,
  SUM(SAFE_DIVIDE(t.Spend, 1000)) AS total_spend_000s
FROM
  `ncau-data-newsquery-prd`.sbx_dcp.adex_datasource AS t
WHERE
  t.source = 'Adex'
GROUP BY
  media_group_classification
ORDER BY
  total_spend_000s DESC
LIMIT 10;",24,601ed0d2-e944-4189-8170-d593c8e72026
"SELECT
    SAFE_CAST(t0.financial_year AS STRING) AS financial_year,
    SAFE_CAST(t0.revenue_group_subtype AS STRING) AS revenue_group_subtype,
    CASE
        WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'DIGITAL') THEN 'DIGITAL (excl.XTEND)'
        WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'PRINT') THEN 'PRINT'
        WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'XTEND') THEN 'XTEND ONLY'
        ELSE NULL
    END AS Revenue_Category,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
WHERE
    SAFE_CAST(t0.financial_year AS STRING) IN ('2024', '2025')
GROUP BY
    financial_year,
    revenue_group_subtype,
    Revenue_Category
ORDER BY
    financial_year DESC, record_count DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.unified_publication_name AS STRING)) AS unique_publications,
    COUNT(DISTINCT SAFE_CAST(t0.fin_adtype_name AS STRING)) AS unique_ad_types,
    MIN(SAFE_CAST(t0.dw_asl_load_timestamp AS TIMESTAMP)) AS min_load_timestamp,
    MAX(SAFE_CAST(t0.dw_asl_load_timestamp AS TIMESTAMP)) AS max_load_timestamp,
    MIN(SAFE_CAST(t0.financial_year AS STRING)) AS min_financial_year,
    MAX(SAFE_CAST(t0.financial_year AS STRING)) AS max_financial_year
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE WHEN COUNT(*) > 0 THEN 'PASS' ELSE 'FAIL' END AS record_count_check,
    CASE WHEN MAX(SAFE_CAST(t0.dw_asl_load_timestamp AS TIMESTAMP)) >= DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'DIGITAL') THEN 'DIGITAL (excl.XTEND)'
        WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'PRINT') THEN 'PRINT'
        WHEN (CASE WHEN SAFE_CAST(t0.xtend_flag AS STRING) = 'Y' THEN 'XTEND' ELSE SAFE_CAST(t0.revenue_type AS STRING) END = 'XTEND') THEN 'XTEND ONLY'
        ELSE 'Other/Null'
    END AS Derived_Revenue_Category,
    COUNT(*) AS count_of_records
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    Derived_Revenue_Category
ORDER BY
    count_of_records DESC
LIMIT 5;",25,61f1feb4-fc3e-4bee-b987-84c86cfe6425
"SELECT
    t0.financial_year,
    t0.financial_short_month,
    t0.sales_segment_l_2_name,
    SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
    SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue,
    SUM(CASE WHEN t0.relative_fy_year_offset = 1 THEN t0.pipeline ELSE 0 END) AS previous_fy_pipeline
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    t0.financial_year,
    t0.financial_short_month,
    t0.sales_segment_l_2_name
ORDER BY
    t0.financial_year DESC, t0.financial_short_month DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.financial_year) AS unique_financial_years,
    COUNT(DISTINCT t0.financial_quarter) AS unique_financial_quarters,
    COUNT(DISTINCT t0.financial_short_month) AS unique_financial_months,
    MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
    MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date,
    MIN(SAFE_CAST(t0.dw_asl_load_timestamp AS DATETIME)) AS min_load_timestamp,
    MAX(SAFE_CAST(t0.dw_asl_load_timestamp AS DATETIME)) AS max_load_timestamp
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE WHEN MAX(SAFE_CAST(t0.dw_asl_load_timestamp AS DATETIME)) > DATETIME_SUB(CURRENT_DATETIME('Australia/Sydney'), INTERVAL 24 HOUR) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check,
    CASE WHEN SUM(CASE WHEN t0.relative_fy_year_offset = 0 THEN t0.gross_revenue_amount ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS current_fy_revenue_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN t0.unified_publication_name IN ('Admin.ADV', 'Admin.DTM', 'Admin.HWT', 'Admin.International', 'Admin.Sales', 'Admin.Sport', 'Admin.TCM', 'Bestrecipes.Admin', 'Bodyandsoul.Admin', 'CODE', 'CodeBet', 'Delicious.admin', 'Escape.Admin', 'GQ.Admin', 'Kidspot.Admin', 'National Sundry', 'National Tabloid PrePrint', 'News.Admin', 'odds.com.au', 'Punters.com.au', 'Qantas Travel Insider', 'RACENET', 'Shortlyster Managed Service', 'Sky News', 'SKYNEWS.ADMIN', 'Stellar.Admin', 'Stockhead', 'SUDDENLY.CW', 'SUDDENLY.NORTH', 'SUDDENLY.TGG', 'Taste.Admin', 'TAUS.ADMIN', 'The Sunday Times', 'TOOWOOMBACUSTOM', 'Vogue.Admin', 'Vogueliving.Admin') THEN 'Sundry Pubs'
        ELSE 'Non Sundry Pubs'
    END AS publication_type_grouping,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY
    publication_type_grouping
LIMIT 10;",26,4bd7954c-5a94-4fb6-92e1-ed152b1cf7b3
"SELECT
  t0.fy_quarter_of_year,
  t0.publication_name,
  t0.os_level_8,
  SUM(t0.Actual_Amount) AS total_actual_amount,
  SUM(t0.Budget_Amount) AS total_budget_amount,
  SUM(t0.volume) AS total_volume,
  SUM(t0.Forecast_Volume) AS total_forecast_volume
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.l04_publication_code <> 'Free News & Lifestyle'
  AND t0.l06_publication_code NOT IN ('Food', 'Prestige')
  AND t0.gl_hierarchy_code = 'FY2025'
GROUP BY
  t0.fy_quarter_of_year,
  t0.publication_name,
  t0.os_level_8
LIMIT 12;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT fiscal_week_id) AS unique_fiscal_weeks,
  COUNT(DISTINCT gl_publication_code) AS unique_publication_codes,
  COUNT(DISTINCT os_level_8) AS unique_os_level_8_values,
  MIN(fy_first_day_of_week) AS min_date,
  MAX(fy_last_day_of_week) AS max_date
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND l04_publication_code <> 'Free News & Lifestyle'
  AND l06_publication_code NOT IN ('Food', 'Prestige')
  AND gl_hierarchy_code = 'FY2025'
LIMIT 1;","SELECT
  CASE
    WHEN SUM(t0.Actual_Amount) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS actual_amount_check,
  CASE
    WHEN MAX(t0.fy_last_day_of_week) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t0
WHERE
  upper(t0.os_level_6) = 'CIRCULATION'
  AND t0.gl_hierarchy_code = 'FY2025'
LIMIT 1;","SELECT
  CASE
    WHEN (publication_name = 'The Daily Telegraph') THEN ' NSW'
    WHEN (publication_name IN ('The Herald Sun', 'Geelong Advertiser', 'Weekly Times')) THEN '  VIC'
    WHEN (publication_name = 'The Advertiser') THEN '   SA'
    WHEN (publication_name IN ('Courier Mail', 'Cairns Post', 'GCB', 'Townsville Bulletin', 'The Chronicle', 'Daily Mercury', 'Sunshine Coast')) THEN '     QLD'
    WHEN (publication_name = 'Northern Territory News') THEN '      NT'
    WHEN (publication_name = 'Mercury') THEN '    TAS'
    ELSE 'Other/Unknown'
  END AS publication_state_region,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`
WHERE
  upper(os_level_6) = 'CIRCULATION'
  AND gl_hierarchy_code = 'FY2025'
GROUP BY
  publication_state_region
ORDER BY
  record_count DESC
LIMIT 12;",27,6a26c78f-0070-4fb3-88b8-691ee4a4485a
"SELECT financial_year, revenue_group_subtype, SUM(gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE style_name != 'PRODUCTION' GROUP BY financial_year, revenue_group_subtype ORDER BY financial_year DESC, revenue_group_subtype ASC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT financial_year) AS unique_financial_years, COUNT(DISTINCT revenue_group_subtype) AS unique_revenue_groups, COUNT(DISTINCT advertiser_name) AS unique_advertisers, MIN(SAFE_CAST(financial_year AS INT64)) AS min_financial_year, MAX(SAFE_CAST(financial_year AS INT64)) AS max_financial_year, MIN(SAFE_CAST(financial_week AS INT64)) AS min_financial_week, MAX(SAFE_CAST(financial_week AS INT64)) AS max_financial_week FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 1;","SELECT CASE WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check, CASE WHEN MAX(SAFE_CAST(financial_year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` LIMIT 1;","SELECT revenue_group_subtype, COUNT(*) AS record_count, SUM(gross_revenue_amount) AS total_gross_revenue FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE financial_year IN ('2025', '2024') GROUP BY revenue_group_subtype ORDER BY record_count DESC LIMIT 5;",28,3ee20092-1897-49b7-8bcd-4157d5f816eb
"SELECT
  t0.financial_year,
  t0.sales_segment_gm_name,
  t0.status_asl,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue,
  COUNT(DISTINCT SAFE_CAST(t0.adpoint_account_number AS STRING)) AS distinct_contra_accounts
FROM (
  SELECT
    financial_year,
    sales_segment_gm_name,
    adpoint_account_number,
    gross_revenue_amount,
    CASE
      WHEN adpoint_account_number IN (
        SELECT DISTINCT
          NMBS_T_Number
        FROM
          `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
        WHERE
          SAFE_CAST(Status AS STRING) = 'Closed'
      ) THEN 'Closed'
      ELSE 'Open'
    END AS status_asl
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr'
    AND SAFE_CAST(adpoint_account_number AS STRING) != '20696'
    AND NOT(SAFE_CAST(cost_model_type AS STRING) = 'Guaranteed' AND SAFE_CAST(revenue_group_name AS STRING) = 'Exchange')
    AND UPPER(IFNULL(SAFE_CAST(revenue_transaction_status AS STRING), 'XXX')) IN ('BILLED', 'BOOKED')
    AND UPPER(IFNULL(SAFE_CAST(style_name AS STRING), 'XXX')) <> 'ROP COMPOSITE'
    AND UPPER(IFNULL(SAFE_CAST(source_publishing_division AS STRING), 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'
    AND (UPPER(IFNULL(SAFE_CAST(publication_name AS STRING), 'XXX')) NOT LIKE 'SUDDENLY%' OR (UPPER(SAFE_CAST(publication_name AS STRING)) LIKE 'SUDDENLY%' AND (SAFE_CAST(account_number AS STRING) IN ('17114', '29172', '52809') OR SAFE_CAST(adtype_name AS STRING) = '-')))
) AS t0
GROUP BY
  t0.financial_year,
  t0.sales_segment_gm_name,
  t0.status_asl
ORDER BY
  t0.financial_year DESC, total_gross_revenue DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(adpoint_account_number AS STRING)) AS unique_adpoint_accounts,
  COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertisers,
  MIN(SAFE_CAST(financial_year AS STRING)) AS min_financial_year,
  MAX(SAFE_CAST(financial_year AS STRING)) AS max_financial_year,
  MIN(SAFE_CAST(calendar_year_month AS STRING)) AS min_calendar_year_month,
  MAX(SAFE_CAST(calendar_year_month AS STRING)) AS max_calendar_year_month
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
LIMIT 1;","SELECT
  CASE WHEN (SELECT SUM(gross_revenue_amount) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` WHERE SAFE_CAST(financial_year AS STRING) = SAFE_CAST(EXTRACT(YEAR FROM CURRENT_DATE()) AS STRING) OR SAFE_CAST(financial_year AS STRING) = SAFE_CAST(EXTRACT(YEAR FROM CURRENT_DATE()) - 1 AS STRING) LIMIT 1) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN (SELECT MAX(SAFE_CAST(financial_year AS STRING)) FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily` LIMIT 1) >= SAFE_CAST(EXTRACT(YEAR FROM CURRENT_DATE()) - 1 AS STRING) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
LIMIT 1;","SELECT
  CASE
    WHEN adpoint_account_number IN (
      SELECT DISTINCT
        NMBS_T_Number
      FROM
        `ncau-data-newsquery-prd.sbx_dcp.contra_sheet_data`
      WHERE
        SAFE_CAST(Status AS STRING) = 'Closed'
    ) THEN 'Closed'
    ELSE 'Open'
  END AS status_asl,
  COUNT(DISTINCT SAFE_CAST(adpoint_account_number AS STRING)) AS distinct_accounts_count
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
WHERE
  lower(SAFE_CAST(LEFT(advertiser_name, 3) AS STRING)) = 'ctr'
GROUP BY
  status_asl
LIMIT 10;",29,b9dfd2f4-92fa-4f81-a5b1-17de880470f9
"SELECT SAFE_CAST(t0.scenario AS STRING) AS scenario, COUNT(1) AS total_records_for_scenario FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY scenario ORDER BY total_records_for_scenario DESC LIMIT 5;","SELECT COUNT(1) AS total_rows, COUNT(DISTINCT SAFE_CAST(t0.scenario AS STRING)) AS unique_scenarios, MIN(NULL) AS min_date_column, MAX(NULL) AS max_date_column FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1;",SELECT CASE WHEN COUNT(1) > 0 THEN 'PASS' ELSE 'FAIL' END AS data_exists_check FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 LIMIT 1;,"SELECT SAFE_CAST(t0.scenario AS STRING) AS scenario_type, COUNT(1) AS count_of_type FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0 GROUP BY scenario_type ORDER BY count_of_type DESC LIMIT 5;",30,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3
"SELECT fiscal_week_id, gl_publication_code, category_name, SUM(add_volume) AS total_add_volume, SUM(red_volume) AS total_red_volume, SUM(earned_amount) AS total_earned_amount FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` GROUP BY fiscal_week_id, gl_publication_code, category_name ORDER BY fiscal_week_id DESC LIMIT 10;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT SAFE_CAST(fiscal_week_id AS STRING)) AS unique_fiscal_weeks, COUNT(DISTINCT category_name) AS unique_categories, MIN(SAFE_CAST(fiscal_week_id AS STRING)) AS min_fiscal_week_id, MAX(SAFE_CAST(fiscal_week_id AS STRING)) AS max_fiscal_week_id FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` LIMIT 1;","SELECT CASE WHEN SUM(earned_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS earned_amount_check, CASE WHEN MAX(fiscal_week_id) >= SAFE_CAST(FORMAT_DATE('%Y%W', CURRENT_DATE()) AS INT64) - 2 THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` LIMIT 1;","SELECT category_name, COUNT(*) AS record_count FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions` GROUP BY category_name ORDER BY record_count DESC LIMIT 5;",31,23c8b213-a9f0-4158-b8fa-bff14425abb5
"SELECT
    t0.fy_year,
    t0.fy_week_of_year,
    CASE
        WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian'
        WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros'
        WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals'
        WHEN (t0.gl_publication_code = '121') THEN 'Others'
        WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications'
        ELSE 'Discontinued'
    END AS masthead_group,
    CASE
        WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition'
        WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition'
        ELSE 'Digital Recognition'
    END AS recognition_type,
    SUM(SAFE_CAST(t0.ClosingBase AS BIGNUMERIC)) AS total_closing_base,
    SUM(SAFE_CAST(t0.EarnedAmount AS BIGNUMERIC)) AS total_earned_amount,
    SUM(SAFE_CAST(t0.TotalAcquisition AS BIGNUMERIC)) AS total_acquisition,
    SUM(SAFE_CAST(t0.TotalCancellation AS BIGNUMERIC)) AS total_cancellation
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
WHERE
    (CASE
        WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian'
        WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros'
        WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals'
        WHEN (t0.gl_publication_code = '121') THEN 'Others'
        WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications'
        ELSE 'Discontinued'
    END) != 'Discontinued'
    AND (CASE
        WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition'
        WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition'
        ELSE 'Digital Recognition'
    END) = 'Digital Recognition'
GROUP BY
    1, 2, 3, 4
ORDER BY
    t0.fy_year DESC, t0.fy_week_of_year DESC
LIMIT 10","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.gl_publication_code AS STRING)) AS unique_publication_codes,
    COUNT(DISTINCT SAFE_CAST(t0.masthead_code AS STRING)) AS unique_masthead_codes,
    MIN(SAFE_CAST(t0.fy_year AS INT64)) AS min_fiscal_year,
    MAX(SAFE_CAST(t0.fy_year AS INT64)) AS max_fiscal_year,
    MIN(SAFE_CAST(t0.fy_week_of_year AS INT64)) AS min_fiscal_week_of_year,
    MAX(SAFE_CAST(t0.fy_week_of_year AS INT64)) AS max_fiscal_week_of_year
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
LIMIT 1","SELECT
    CASE WHEN SUM(SAFE_CAST(t0.ClosingBase AS BIGNUMERIC)) > 0 THEN 'PASS' ELSE 'FAIL' END AS closing_base_check,
    CASE WHEN MAX(SAFE_CAST(t0.fy_year AS INT64)) >= EXTRACT(YEAR FROM CURRENT_DATE('Australia/Sydney')) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
WHERE
    t0.fy_year = (SELECT MAX(fy_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`)
LIMIT 1","SELECT
    CASE
        WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA') THEN 'The Australian'
        WHEN (t0.gl_publication_code IN ('400', '402', '100', '111') OR t0.masthead_code IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metros'
        WHEN (t0.gl_publication_code IN ('450', '350', '670', '961', '850', '5053', '475', '305', '963', '851', '5253', '490', '351', '560') OR t0.masthead_code IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TC', 'TB', 'WT')) THEN 'Regionals'
        WHEN (t0.gl_publication_code = '121') THEN 'Others'
        WHEN (t0.gl_publication_code IN ('8822', '9001', '9653', '9003', '9600', '9002', '9603', '9558', '9556', '9623', '9514', '9504', '8821', '962') OR t0.masthead_code IN ('RN', 'CS', 'SC', 'AP', 'TS', 'BG', 'PU')) THEN 'Deep Niche Publications'
        ELSE 'Discontinued'
    END AS masthead_group,
    CASE
        WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition'
        WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition'
        ELSE 'Digital Recognition'
    END AS recognition_type,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
GROUP BY
    1, 2
ORDER BY
    record_count DESC
LIMIT 10",32,d05b3d29-4437-4ee5-987a-e0109eb9590e
"SELECT
  SAFE_CAST(t0.SSPDate AS DATE) AS SSP_Date,
  CASE
    WHEN (t0.TransactionType = 'AG' OR t0.TransactionType = 'PG - CPM' OR t0.TransactionType = 'PG - CPD') THEN 'Guaranteed'
    WHEN (t0.TransactionType = 'Deal' OR t0.TransactionType = 'pmp' OR t0.TransactionType = 'PMP_DEAL' OR t0.TransactionType = 'UFR') THEN 'Deal'
    WHEN (t0.TransactionType = 'Open Auction' OR t0.TransactionType = 'RTB' OR t0.TransactionType = 'Unknown') THEN 'Open Auction'
    ELSE SAFE_CAST(t0.TransactionType AS STRING)
  END AS TransactionType_Grouped,
  t0.ProductType,
  SUM(t0.RevenueNet) AS Total_Revenue_Net
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
GROUP BY 1, 2, 3
ORDER BY 1 DESC, 4 DESC
LIMIT 10","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.TransactionType) AS unique_transaction_types,
  COUNT(DISTINCT t0.ProductType) AS unique_product_types,
  MIN(SAFE_CAST(t0.SSPDate AS DATE)) AS min_ssp_date,
  MAX(SAFE_CAST(t0.SSPDate AS DATE)) AS max_ssp_date
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
LIMIT 1","SELECT
  CASE WHEN SUM(t0.RevenueNet) > 0 THEN 'PASS' ELSE 'FAIL' END AS revenue_check,
  CASE WHEN MAX(SAFE_CAST(t0.SSPDate AS DATE)) >= CURRENT_DATE() - INTERVAL 7 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
LIMIT 1","SELECT
  CASE
    WHEN (t0.TransactionType = 'AG' OR t0.TransactionType = 'PG - CPM' OR t0.TransactionType = 'PG - CPD') THEN 'Guaranteed'
    WHEN (t0.TransactionType = 'Deal' OR t0.TransactionType = 'pmp' OR t0.TransactionType = 'PMP_DEAL' OR t0.TransactionType = 'UFR') THEN 'Deal'
    WHEN (t0.TransactionType = 'Open Auction' OR t0.TransactionType = 'RTB' OR t0.TransactionType = 'Unknown') THEN 'Open Auction'
    ELSE SAFE_CAST(t0.TransactionType AS STRING)
  END AS TransactionType_Grouped,
  COUNT(*) AS record_count
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` AS t0
GROUP BY TransactionType_Grouped
ORDER BY record_count DESC
LIMIT 5",33,b15d856f-e3ce-4991-bf2a-92395390524f
"SELECT
    t0.agency_parent,
    UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) AS ia_mapping_group,
    SAFE_CAST(t0.relative_fy_year_offset AS INT64) AS fy_year_offset,
    SUM(t0.gross_revenue_amount) AS total_gross_revenue,
    SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = 0 THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_revenue,
    SUM(CASE WHEN SAFE_CAST(t0.relative_fy_year_offset AS INT64) = -1 THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_revenue,
    SUM(CASE WHEN SAFE_CAST(t0.relative_cal_year_offset AS INT64) = 0 AND SAFE_CAST(t0.calendar_quarter AS INT64) = 4 AND t0.Managed_Service_Fl != 'Other' AND t0.xtend_flag = 'N' THEN t0.gross_revenue_amount ELSE 0 END) AS current_cal_q4_ms_not_other_xtend_n_revenue
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
WHERE
    t0.revenue_group_subtype != 'PROGRAMMATIC EXCHANGE' OR t0.revenue_group_subtype IS NULL
GROUP BY
    t0.agency_parent,
    ia_mapping_group,
    fy_year_offset
ORDER BY
    current_fy_revenue DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.agency_parent) AS unique_agency_parents,
    COUNT(DISTINCT t0.IA_MAPPING) AS unique_ia_mappings,
    MIN(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS min_booking_date,
    MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) AS max_booking_date
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
LIMIT 1;","SELECT
    CASE WHEN SUM(CASE WHEN t0.gross_revenue_amount > 0 THEN 1 ELSE 0 END) > 0 THEN 'PASS' ELSE 'FAIL' END AS positive_revenue_check,
    CASE WHEN MAX(SAFE_CAST(t0.booking_line_created_date AS DATE)) >= CURRENT_DATE() - INTERVAL 30 DAY THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
LIMIT 1;","SELECT
    t0.revenue_group_subtype,
    COUNT(*) AS record_count,
    SUM(t0.gross_revenue_amount) AS total_revenue,
    CASE
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('ATOMIC', 'ATOMIC212') THEN 'Atomic'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('HOWASTON', 'HOWATSON + CO', 'HOWATSON+CO', 'HOWATSON') THEN 'Howatson'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('HAVAS', 'FRONTIER') THEN 'Havas/Frontier'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('THUMP', 'THUMP TRAVEL') THEN 'Thump Media'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('TTB', 'TODAY THE BRAVE') THEN 'Today The Brave'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) IN ('NUNN', 'NUNN MEDIA') THEN 'Nunn'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'NUNN VIC' THEN 'Nunn Melbourne'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'RYVALMEDIA' THEN 'Ryval'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'HALF DOME' THEN 'Half Dome'
        WHEN UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING)) = 'M2 MARKETING' THEN 'PMA'
        ELSE UPPER(SAFE_CAST(t0.IA_MAPPING AS STRING))
    END AS remapped_ia_mapping
FROM
    `ncau-data-newsquery-prd.sbx_dcp.ia` AS t0
GROUP BY
    t0.revenue_group_subtype,
    remapped_ia_mapping
ORDER BY
    record_count DESC
LIMIT 10;",34,fed70b12-c274-4cde-9920-592ca4c4dab0
"SELECT
  SAFE_CAST(calendar.fy_week_of_year AS INT) AS fiscal_week,
  SAFE_CAST(pub.publication_name AS STRING) AS publication_name,
  SAFE_CAST(os.os_level_4 AS STRING) AS os_level_4,
  SUM(SAFE_CAST(os.Actual_Amount AS BIGNUMERIC)) AS total_actual_amount,
  SUM(SAFE_CAST(os.Budget_Amount AS BIGNUMERIC)) AS total_budget_amount,
  SUM(SAFE_CAST(os.Forecast_Amount AS BIGNUMERIC)) AS total_forecast_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub
  ON os.gl_publication_code = pub.publication_code
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar
  ON os.fiscal_week_id = calendar.fy_year_week_number
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_gl_department` AS dep
  ON os.os_level_12 = dep.department_code
WHERE
  SAFE_CAST(dep.gl_hierarchy_code AS STRING) = 'FY2025'
  AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses')
  AND SAFE_CAST(pub.l03_publication_code AS STRING) = 'News Media Publishing'
  AND SAFE_CAST(calendar.fy_week_of_year AS INT) IN (40, 41)
GROUP BY
  1, 2, 3
ORDER BY
  fiscal_week, publication_name, os_level_4
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(fiscal_week_id AS INT)) AS unique_fiscal_weeks,
  COUNT(DISTINCT SAFE_CAST(gl_publication_code AS STRING)) AS unique_publications,
  COUNT(DISTINCT SAFE_CAST(os_level_4 AS STRING)) AS unique_os_level_4s,
  MIN(SAFE_CAST(fiscal_week_id AS INT)) AS min_fiscal_week_id,
  MAX(SAFE_CAST(fiscal_week_id AS INT)) AS max_fiscal_week_id
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated`
LIMIT 1;","SELECT
  CASE
    WHEN SUM(SAFE_CAST(t2.Actual_Amount AS BIGNUMERIC)) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS actual_amount_positive_check,
  CASE
    WHEN MAX(SAFE_CAST(t1.fy_year AS INT)) >= EXTRACT(YEAR FROM CURRENT_DATE()) - 1 THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS t2
LEFT JOIN
  `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS t1
  ON t2.fiscal_week_id = t1.fy_year_week_number
LIMIT 1;","SELECT
  SAFE_CAST(os.os_level_4 AS STRING) AS os_level_4_category,
  COUNT(1) AS record_count,
  SUM(SAFE_CAST(os.Actual_Amount AS BIGNUMERIC)) AS total_actual_amount
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
WHERE
  SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses', 'Other')
GROUP BY
  1
ORDER BY
  record_count DESC
LIMIT 5;",35,b1c5901f-a535-42eb-870d-05cc025f7c27
"SELECT
  t0.financial_year,
  t0.calendar_year,
  t0.revenue_group_subtype,
  t0.source_publishing_division,
  SUM(t0.gross_revenue_amount) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
  t0.financial_year IS NOT NULL
  AND t0.source_publishing_division != 'Medium Rare Content Agency'
  AND t0.revenue_transaction_status IN ('Billed', 'Booked')
  AND t0.revenue_group_subtype IN ('Digital', 'Print')
GROUP BY
  t0.financial_year,
  t0.calendar_year,
  t0.revenue_group_subtype,
  t0.source_publishing_division
ORDER BY
  t0.financial_year DESC, t0.calendar_year DESC
LIMIT 12;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers,
  COUNT(DISTINCT t0.booking_number) AS unique_booking_numbers,
  MIN(SAFE_CAST(t0.calendar_year AS STRING)) AS min_calendar_year,
  MAX(SAFE_CAST(t0.calendar_year AS STRING)) AS max_calendar_year,
  MIN(SAFE_CAST(t0.financial_year AS STRING)) AS min_financial_year,
  MAX(SAFE_CAST(t0.financial_year AS STRING)) AS max_financial_year
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
LIMIT 12;","SELECT
  CASE
    WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS gross_revenue_check,
  CASE
    WHEN MAX(SAFE_CAST(t0.calendar_year AS INT64)) >= 2023 THEN 'PASS'
    ELSE 'FAIL'
  END AS recent_data_check
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
  t0.financial_year IS NOT NULL
  AND t0.source_publishing_division != 'Medium Rare Content Agency'
  AND t0.revenue_transaction_status IN ('Billed', 'Booked')
LIMIT 1;","SELECT
  t0.revenue_transaction_status,
  COUNT(*) AS status_count,
  SUM(CASE WHEN t0.revenue_group_subtype = 'Digital' THEN 1 ELSE 0 END) AS digital_count,
  SUM(CASE WHEN t0.revenue_group_subtype = 'Print' THEN 1 ELSE 0 END) AS print_count
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
  t0.financial_year IS NOT NULL
  AND t0.source_publishing_division != 'Medium Rare Content Agency'
GROUP BY
  t0.revenue_transaction_status
ORDER BY
  status_count DESC
LIMIT 12;",36,c560ed20-040d-4c6a-9c3f-ec8bce27d132
"SELECT
  CASE
    WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian'
    WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros'
    WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals'
    WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others'
    ELSE 'Discontinued'
  END AS masthead_group,
  CASE
    WHEN (t0.delivery_medium_type = 'Print') THEN 'Print Recognition'
    WHEN (t0.subscriber_has_email_flag = 'N') THEN 'Print Recognition'
    ELSE 'Digital Recognition'
  END AS recognition_type,
  SUM(t0.ClosingBase) AS total_closing_base,
  SUM(t0.EarnedAmount) AS total_earned_amount,
  SUM(t0.BudgetClosingBase) AS total_budget_closing_base
FROM
  `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
  t0.fy_year = 2025
GROUP BY
  1, 2
LIMIT 10;","SELECT
  COUNT(*) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.gl_publication_code AS STRING)) AS unique_publication_codes,
  COUNT(DISTINCT SAFE_CAST(t0.masthead_code AS STRING)) AS unique_masthead_codes,
  MIN(SAFE_CAST(t0.fy_year AS STRING) || '-' || LPAD(SAFE_CAST(t0.fy_month_of_year AS STRING), 2, '0') || '-' || LPAD(SAFE_CAST(t0.fy_week_of_year AS STRING), 2, '0')) AS min_fiscal_date,
  MAX(SAFE_CAST(t0.fy_year AS STRING) || '-' || LPAD(SAFE_CAST(t0.fy_month_of_year AS STRING), 2, '0') || '-' || LPAD(SAFE_CAST(t0.fy_week_of_year AS STRING), 2, '0')) AS max_fiscal_date
FROM
  `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
LIMIT 1;","SELECT
  CASE
    WHEN MAX(t0.fy_year) >= EXTRACT(YEAR FROM CURRENT_DATE()) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check,
  CASE
    WHEN SUM(t0.ClosingBase) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS closing_base_positive_check
FROM
  `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` AS t0
WHERE
  t0.fy_year = EXTRACT(YEAR FROM CURRENT_DATE())
LIMIT 1;","SELECT
  CASE
    WHEN (t0.gl_publication_code = '101' OR t0.masthead_code = 'TA' OR t0.gl_publication_code = '100') THEN 'The Australian'
    WHEN (t0.gl_publication_code = '400' OR t0.gl_publication_code = '402' OR t0.gl_publication_code = '111' OR t0.masthead_code = 'CM') THEN 'Metros'
    WHEN (t0.gl_publication_code = '450' OR t0.gl_publication_code = '351' OR t0.gl_publication_code = '670' OR t0.gl_publication_code = '961' OR t0.masthead_code = 'CP') THEN 'Regionals'
    WHEN (t0.gl_publication_code = '305' OR t0.gl_publication_code = '307' OR t0.gl_publication_code = '303' OR t0.gl_publication_code = '302' OR t0.masthead_code = 'WT') THEN 'Others'
    ELSE 'Discontinued'
  END AS masthead_group,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
GROUP BY
  1
ORDER BY
  record_count DESC
LIMIT 5;",37,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26
"SELECT
    SAFE_CAST(t0.financial_year AS STRING) AS financial_year,
    t0.unified_publication_name,
    t0.portfolio_group_name_current,
    COUNT(DISTINCT SAFE_CAST(t0.account_number AS STRING)) AS distinct_accounts
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
GROUP BY
    1, 2, 3
ORDER BY
    financial_year DESC, distinct_accounts DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT SAFE_CAST(t0.account_number AS STRING)) AS unique_account_numbers,
    COUNT(DISTINCT SAFE_CAST(t0.unified_publication_name AS STRING)) AS unique_publications,
    MIN(SAFE_CAST(t0.publication_date AS DATE)) AS min_publication_date,
    MAX(SAFE_CAST(t0.publication_date AS DATE)) AS max_publication_date
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN MAX(SAFE_CAST(t0.publication_date AS DATE)) IS NULL THEN 'FAIL: No publication_date found'
        WHEN MAX(SAFE_CAST(t0.publication_date AS DATE)) < CURRENT_DATE() - INTERVAL 7 DAY THEN 'FAIL: Data not recent (older than 7 days)'
        ELSE 'PASS: Data is recent'
    END AS data_freshness_check,
    CASE
        WHEN COUNT(*) = 0 THEN 'FAIL: Table is empty'
        ELSE 'PASS: Table has data'
    END AS record_count_check
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN SAFE_CAST(dow AS STRING) = 'Monday' THEN 'Monday'
        WHEN SAFE_CAST(dow AS STRING) = 'Tuesday' THEN ' Tuesday'
        WHEN SAFE_CAST(dow AS STRING) = 'Wednesday' THEN '  Wednesday'
        WHEN SAFE_CAST(dow AS STRING) = 'Thursday' THEN '   Thursday'
        WHEN SAFE_CAST(dow AS STRING) = 'Friday' THEN '    Friday'
        WHEN SAFE_CAST(dow AS STRING) = 'Saturday' THEN '     Saturday'
        WHEN SAFE_CAST(dow AS STRING) = 'Sunday' THEN '      Sunday'
        ELSE 'Unknown'
    END AS formatted_day_of_week,
    COUNT(*) AS record_count
FROM
    `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
GROUP BY
    formatted_day_of_week
ORDER BY
    formatted_day_of_week
LIMIT 7;",38,d4d68a71-2b12-4caf-bc6b-96fc2d18a025
"SELECT
  financial_year,
  fy_year_month_number,
  source_unified_publication_name,
  CASE
    WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$')) THEN 'Sponsorship'
    WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$')) THEN 'Production'
    ELSE 'Media'
  END AS ad_type_classification,
  SUM(gross_revenue_amount) AS total_gross_revenue
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
GROUP BY
  financial_year,
  fy_year_month_number,
  source_unified_publication_name,
  ad_type_classification
ORDER BY
  financial_year DESC, fy_year_month_number DESC
LIMIT 10","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(advertiser_name AS STRING)) AS unique_advertisers,
  COUNT(DISTINCT SAFE_CAST(booking_number AS STRING)) AS unique_bookings,
  MIN(SAFE_CAST(financial_year AS STRING)) AS min_financial_year,
  MAX(SAFE_CAST(financial_year AS STRING)) AS max_financial_year,
  MIN(SAFE_CAST(fy_year_month_number AS INT64)) AS min_fy_year_month_number,
  MAX(SAFE_CAST(fy_year_month_number AS INT64)) AS max_fy_year_month_number
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
LIMIT 1","SELECT
  CASE
    WHEN SUM(gross_revenue_amount) > 0 THEN 'PASS'
    ELSE 'FAIL'
  END AS gross_revenue_check,
  CASE
    WHEN MAX(SAFE_CAST(fy_year_month_number AS INT64)) >= CAST(FORMAT_DATE('%Y%m', DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH)) AS INT64) THEN 'PASS'
    ELSE 'FAIL'
  END AS data_freshness_check
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
LIMIT 1","SELECT
  CASE
    WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$')) THEN 'Sponsorship'
    WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$')) THEN 'Production'
    ELSE 'Media'
  END AS ad_type_classification,
  COUNT(1) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (-1, 0, 1)
GROUP BY
  ad_type_classification
ORDER BY
  record_count DESC
LIMIT 10",39,e83da1de-4227-43e6-bcc6-73051c66914b
"WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code,
    calendar.fy_year_week_number,
    calendar.fy_year,
    calendar.fy_month_of_year,
    calendar.fy_first_day_of_week,
    calendar.fy_last_day_of_week,
    os.os_level_7
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  publication_name,
  os_level_7 AS sales_channel,
  fy_year_week_number,
  SUM(Actual_Amount) AS total_actual_amount,
  SUM(volume) AS total_volume,
  SUM(Budget_Amount) AS total_budget_amount,
  SUM(Forecast_Amount) AS total_forecast_amount
FROM
  OSandFACT
GROUP BY
  publication_name,
  sales_channel,
  fy_year_week_number
ORDER BY
  fy_year_week_number DESC, publication_name, sales_channel
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(fiscal_week_id AS STRING)) AS unique_fiscal_weeks,
  COUNT(DISTINCT publication_name) AS unique_publications,
  COUNT(DISTINCT os_level_7) AS unique_sales_channels,
  MIN(SAFE_CAST(fiscal_week_id AS STRING)) AS min_fiscal_week_id,
  MAX(SAFE_CAST(fiscal_week_id AS STRING)) AS max_fiscal_week_id,
  MIN(SAFE_CAST(fy_first_day_of_week AS DATE)) AS min_date,
  MAX(SAFE_CAST(fy_last_day_of_week AS DATE)) AS max_date
FROM
  `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
  LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
WHERE
  upper(os.os_level_6) = 'CIRCULATION'
  AND os.l04_publication_code <> 'Free News & Lifestyle'
  AND os.l06_publication_code NOT IN ('Food', 'Prestige')
  AND os.gl_hierarchy_code = 'FY2025'
LIMIT 1;","WITH OSandFACT AS (
  SELECT
    os.*,
    calendar.fy_year_week_number,
    calendar.fy_last_day_of_week
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  CASE WHEN SUM(Actual_Amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS actual_amount_check,
  CASE WHEN MAX(fy_last_day_of_week) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM
  OSandFACT
LIMIT 1;","WITH OSandFACT AS (
  SELECT
    os.*,
    pub.publication_name,
    pub.publication_code
  FROM
    `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os
    LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code
  WHERE
    upper(os.os_level_6) = 'CIRCULATION'
    AND os.l04_publication_code <> 'Free News & Lifestyle'
    AND os.l06_publication_code NOT IN ('Food', 'Prestige')
    AND os.gl_hierarchy_code = 'FY2025'
)
SELECT
  CASE
    WHEN publication_name IN ('Cairns Post', 'Ed Media', 'Geelong Advertiser', 'Gold Coast Bulletin', 'Mackay', 'Mercury', 'NT News', 'Sunday Tasmanian', 'Sunday Territorian', 'Sunshine Coast', 'Toowoomba', 'Townsville Bulletin', 'PNG', 'Weekly Times') THEN 'Regionals'
    WHEN publication_name IN ('Advertiser', 'Sunday Mail (SA)') THEN 'The Advertiser'
    WHEN publication_name IN ('The Australian') THEN 'The Australian'
    WHEN publication_name IN ('Courier Mail', 'Sunday Mail (QLD)') THEN 'The Courier Mail'
    WHEN publication_name IN ('The Daily Telegraph', 'The Sunday Telegraph') THEN 'The Daily Telegraph'
    WHEN publication_name IN ('Herald Sun', 'Sunday Herald Sun') THEN 'The Herald Sun'
    ELSE 'Other'
  END AS publication_group,
  COUNT(1) AS record_count
FROM
  OSandFACT
GROUP BY
  publication_group
ORDER BY
  record_count DESC
LIMIT 5;",40,2104a3f5-9424-4087-a928-e67fecae789a
"SELECT t0.Adpoint_Account, t0.Genera_Booking_Account, t0.Medium_Rare_Debtor_Account, t0.National_Debtor_Account FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 WHERE t0.Adpoint_Account IS NOT NULL LIMIT 5;","SELECT COUNT(*) AS total_records, COUNT(DISTINCT SAFE_CAST(t0.Adpoint_Account AS STRING)) AS unique_adpoint_accounts, COUNT(DISTINCT SAFE_CAST(t0.Genera_Booking_Account AS STRING)) AS unique_genera_accounts, COUNT(DISTINCT SAFE_CAST(t0.Medium_Rare_Debtor_Account AS STRING)) AS unique_medium_rare_accounts, COUNT(DISTINCT SAFE_CAST(t0.National_Debtor_Account AS STRING)) AS unique_national_accounts FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1;","SELECT CASE WHEN COUNT(t0.Adpoint_Account) > 0 THEN 'PASS' ELSE 'FAIL' END AS adpoint_account_check, CASE WHEN MAX(SAFE_CAST(t1.last_update_time AS TIMESTAMP)) > TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 24 HOUR) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0, ( WITH abc AS ( SELECT datetime(timestamp_millis(last_modified_time), ""Australia/Sydney"") AS last_update_time FROM `sdm_advertisingexternals.__TABLES__` WHERE table_id = ""gbaba_act_xref"" ) SELECT CAST(FORMAT_DATETIME('%F %X', last_update_time) AS STRING) AS last_update_time FROM abc ) AS t1 LIMIT 1;","SELECT COUNT(DISTINCT SAFE_CAST(t0.Adpoint_Account AS STRING)) AS total_adpoint_accounts, COUNT(DISTINCT CASE WHEN SAFE_CAST(t0.National_Debtor_Account AS STRING) IS NOT NULL AND SAFE_CAST(t0.National_Debtor_Account AS STRING) != '' THEN SAFE_CAST(t0.Adpoint_Account AS STRING) ELSE NULL END) AS adpoint_accounts_with_national_debtor FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` AS t0 LIMIT 1;",41,258a722d-9b6e-45df-ba00-1b9954ec36b2
"SELECT
  t0.portfolio_conformed_name_current,
  t0.advertiser_group,
  SUM(CASE WHEN (t0.relative_fy_year_offset = 0) THEN t0.gross_revenue_amount ELSE 0 END) AS current_fy_gross_revenue,
  SUM(CASE WHEN (t0.relative_fy_year_offset = 1) THEN t0.gross_revenue_amount ELSE 0 END) AS previous_fy_gross_revenue
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY 1, 2
ORDER BY current_fy_gross_revenue DESC
LIMIT 10;","SELECT
  COUNT(1) AS total_records,
  COUNT(DISTINCT SAFE_CAST(t0.advertiser_parent AS STRING)) AS unique_advertiser_parents,
  COUNT(DISTINCT SAFE_CAST(t0.portfolio_conformed_name_current AS STRING)) AS unique_portfolios,
  MIN(SAFE_CAST(t0.fix_date_lod AS DATE)) AS min_fix_date_lod,
  MAX(SAFE_CAST(t0.fix_date_lod AS DATE)) AS max_fix_date_lod
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS' ELSE 'FAIL' END AS gross_revenue_check,
  CASE WHEN MAX(SAFE_CAST(t0.fix_date_lod AS DATE)) >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) THEN 'PASS' ELSE 'FAIL' END AS data_freshness_check
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
LIMIT 1;","SELECT
  CASE
    WHEN (t0.fin_adtype_name = 'XTEND') THEN 'XTEND'
    WHEN ((t0.portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (t0.revenue_group_subtype = 'DIGITAL')) THEN 'PROGRAMMATIC - DIGITAL OTHER'
    WHEN (((SAFE.LEFT(t0.cost_model_type, 3) = 'GUA')) AND (t0.revenue_group_subtype = 'PROGRAMMATIC SOURCE')) THEN 'PROGRAMMATIC - GUARANTEED'
    WHEN (((SAFE.LEFT(t0.cost_model_type, 3) = 'NON')) AND (t0.revenue_group_subtype = 'PROGRAMMATIC SOURCE')) THEN 'PROGRAMMATIC - OPEN EXCHANGE'
    WHEN (((SAFE.LEFT(t0.cost_model_type, 3) = 'PMP')) AND (t0.revenue_group_subtype = 'PROGRAMMATIC SOURCE')) THEN 'PROGRAMMATIC - PMP'
    WHEN (t0.revenue_group_subtype = 'DIGITAL') THEN 'ADPT DIGITAL'
    WHEN (SAFE.LEFT(t0.revenue_group_subtype, 6) = 'SUNDRY') THEN 'SUNDRY'
    ELSE t0.revenue_group_subtype
  END AS derived_ad_type,
  COUNT(1) AS record_count
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
GROUP BY 1
ORDER BY record_count DESC
LIMIT 5;",42,9269e9c6-1ad0-4415-96c3-aca8a710ba01
"SELECT
    SAFE_CAST(DATETIME_TRUNC(movement_datetime, MONTH) AS DATE) AS month_start,
    masthead,
    SUBSTR(sold_in_source_code, 1, 2) AS SourceMasthead,
    COUNT(DISTINCT subscription_id_src) AS distinct_acquisitions,
    COUNT(DISTINCT subscriber_id_src) AS distinct_subscribers
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    movement_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH)
    AND subscription_movement_count_type = 'acquisition'
    AND masthead = 'SC'
GROUP BY
    1, 2, 3
ORDER BY
    1 DESC, 2, 3
LIMIT 10;","SELECT
    COUNT(1) AS total_records,
    COUNT(DISTINCT subscription_id_src) AS unique_subscriptions,
    COUNT(DISTINCT subscriber_id_src) AS unique_subscribers,
    MIN(movement_datetime) AS min_movement_datetime,
    MAX(movement_datetime) AS max_movement_datetime
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
LIMIT 1;","SELECT
    CASE
        WHEN COUNT(DISTINCT subscription_id_src) > 0 THEN 'PASS'
        ELSE 'FAIL'
    END AS acquisitions_check,
    CASE
        WHEN MAX(movement_datetime) >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) THEN 'PASS'
        ELSE 'FAIL'
    END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
LIMIT 1;","SELECT
    SUBSTR(sold_in_source_code, 1, 2) AS SourceMasthead,
    COUNT(DISTINCT subscription_id_src) AS distinct_acquisitions_count
FROM
    `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement`
WHERE
    masthead = 'SC'
    AND subscription_movement_count_type = 'acquisition'
    AND movement_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
GROUP BY
    1
ORDER BY
    distinct_acquisitions_count DESC
LIMIT 5;",43,6e8b534b-485a-48dd-842d-13dc6bebb01a
"SELECT
    t0.financial_year,
    t0.revenue_type_level2,
    t0.cost_model_type,
    SUM(t0.gross_revenue_amount) AS total_gross_revenue_amount,
    COUNT(DISTINCT t0.advertiser_name) AS distinct_advertisers
FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
    t0.financial_year IS NOT NULL
    AND t0.source_publishing_division != 'Medium Rare Content Agency'
    AND t0.revenue_transaction_status IN ('Billed', 'Booked')
GROUP BY
    t0.financial_year,
    t0.revenue_type_level2,
    t0.cost_model_type
ORDER BY
    t0.financial_year DESC, total_gross_revenue_amount DESC
LIMIT 10;","SELECT
    COUNT(*) AS total_records,
    COUNT(DISTINCT t0.advertiser_name) AS unique_advertisers,
    COUNT(DISTINCT t0.financial_year) AS unique_financial_years,
    COUNT(DISTINCT t0.revenue_transaction_status) AS unique_transaction_statuses,
    MIN(t0.data_load_datetime) AS min_data_load_datetime,
    MAX(t0.data_load_datetime) AS max_data_load_datetime,
    MIN(SAFE_CAST(t0.financial_year AS STRING)) AS min_financial_year,
    MAX(SAFE_CAST(t0.financial_year AS STRING)) AS max_financial_year
FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
LIMIT 1;","SELECT
    CASE
        WHEN SUM(t0.gross_revenue_amount) > 0 THEN 'PASS'
        ELSE 'FAIL'
    END AS gross_revenue_check,
    CASE
        WHEN MAX(t0.data_load_datetime) >= DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 7 DAY) THEN 'PASS'
        ELSE 'FAIL'
    END AS data_freshness_check
FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
    t0.revenue_transaction_status IN ('Billed', 'Booked')
LIMIT 1;","SELECT
    t0.revenue_transaction_status,
    COUNT(*) AS status_count,
    SUM(t0.gross_revenue_amount) AS total_revenue_for_status
FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
    t0.revenue_transaction_status IN ('Billed', 'Booked', 'Cancelled', 'Pending', 'Draft')
GROUP BY
    t0.revenue_transaction_status
ORDER BY
    status_count DESC
LIMIT 10;",44,705edcb5-737a-4600-b1a7-11870177f97a
