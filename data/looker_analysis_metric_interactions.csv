interaction_type,primary_metric,related_metrics,relationship_description,mathematical_formula,business_validation,validation_sql,relationship_strength,business_impact,response_id,dashboard_id,related_metrics_count,related_metrics_text
mathematical_relationship,total_current_fy_gross_revenue_k,['total_current_fy_gross_revenue'],Total Current FY Gross Revenue (000s) is derived by dividing Total Current FY Gross Revenue by 1000.,total_current_fy_gross_revenue_k = total_current_fy_gross_revenue / 1000,Ensures revenue figures are presented in a consistent and easily digestible format (thousands).,SELECT SUM(total_current_fy_gross_revenue_k * 1000) = SUM(total_current_fy_gross_revenue) FROM FinalMetrics,strong,medium,0,9269e9c6-1ad0-4415-96c3-aca8a710ba01,1,total_current_fy_gross_revenue
mathematical_relationship,total_prior_fy_gross_revenue_k,['total_prior_fy_gross_revenue'],Total Prior FY Gross Revenue (000s) is derived by dividing Total Prior FY Gross Revenue by 1000.,total_prior_fy_gross_revenue_k = total_prior_fy_gross_revenue / 1000,Ensures prior year revenue figures are presented in a consistent and easily digestible format (thousands).,SELECT SUM(total_prior_fy_gross_revenue_k * 1000) = SUM(total_prior_fy_gross_revenue) FROM FinalMetrics,strong,medium,0,9269e9c6-1ad0-4415-96c3-aca8a710ba01,1,total_prior_fy_gross_revenue
mathematical_relationship,total_conditional_gross_revenue_k,['total_conditional_gross_revenue'],Total Conditional Gross Revenue (000s) is derived by dividing Total Conditional Gross Revenue by 1000.,total_conditional_gross_revenue_k = total_conditional_gross_revenue / 1000,Ensures conditional revenue figures are presented in a consistent and easily digestible format (thousands).,SELECT SUM(total_conditional_gross_revenue_k * 1000) = SUM(total_conditional_gross_revenue) FROM FinalMetrics,strong,medium,0,9269e9c6-1ad0-4415-96c3-aca8a710ba01,1,total_conditional_gross_revenue
filter_impact,total_current_fy_gross_revenue_k,"['financial_period_combined', 'sales_segment_l_2_name']",All aggregated revenue metrics are filtered by specific values of 'financial_period_combined' ('Jul Q1 H1') and 'sales_segment_l_2_name' ('Consortium QLD').,N/A,"These filters define the scope of the sales performance being analyzed, focusing on a specific period and sales team.",SELECT COUNT(*) FROM FinalMetrics WHERE financial_period_combined NOT IN ('Jul Q1 H1') OR sales_segment_l_2_name NOT IN ('Consortium QLD'),strong,high,0,9269e9c6-1ad0-4415-96c3-aca8a710ba01,2,"financial_period_combined, sales_segment_l_2_name"
dependency,total_conditional_gross_revenue,"['is_current_fy', 'is_unified_publication_ecommerce_outstream_etc', 'effective_date_for_revenue', 'prior_year_reference_date', 'gross_revenue_amount']","The 'Conditional Gross Revenue' metric has complex dependencies on multiple flags and date comparisons, indicating a specific business rule for this revenue type.",SUM(CASE WHEN (is_current_fy AND is_unified_publication_ecommerce_outstream_etc) THEN gross_revenue_amount WHEN (is_current_fy AND effective_date_for_revenue <= prior_year_reference_date) THEN gross_revenue_amount ELSE 0 END),"This metric likely represents a specific 'Digital YTD' or 'Product-Specific YTD' revenue, requiring careful validation of its underlying business logic and date alignment.",SELECT COUNT(*) FROM FinalMetrics WHERE conditional_gross_revenue_base > 0 AND NOT ((is_current_fy AND is_unified_publication_ecommerce_outstream_etc) OR (is_current_fy AND SAFE_CAST(effective_date_for_revenue AS DATETIME) <= prior_year_reference_date)),strong,high,0,9269e9c6-1ad0-4415-96c3-aca8a710ba01,5,"is_current_fy, is_unified_publication_ecommerce_outstream_etc, effective_date_for_revenue, prior_year_reference_date, gross_revenue_amount"
mathematical_relationship,current_fy_revenue_k_minus_lgb_k,"['current_fy_gross_revenue_k', 'current_fy_lgb_k']",This metric is a direct subtraction of 'Current FY LGB (Thousands)' from 'Current FY Gross Revenue (Thousands)'.,current_fy_revenue_k_minus_lgb_k = current_fy_gross_revenue_k - current_fy_lgb_k,Validates the net revenue or variance after accounting for 'Last Good Booking' within the current financial year.,"SELECT 
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN SAFE_DIVIDE(gross_revenue_amount, 1000) ELSE 0 END) - 
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN SAFE_DIVIDE(ss_lgb, 1000) ELSE 0 END) AS calculated_difference,
  SUM((CASE WHEN relative_fy_year_offset = 0 THEN SAFE_DIVIDE(gross_revenue_amount, 1000) ELSE 0 END) - (CASE WHEN relative_fy_year_offset = 0 THEN SAFE_DIVIDE(ss_lgb, 1000) ELSE 0 END)) AS direct_calculation
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`
WHERE SAFE_CAST(booking_line_created_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY);",strong,high,1,4d8074b2-17a8-48ba-babe-c536359b1f64,2,"current_fy_gross_revenue_k, current_fy_lgb_k"
hierarchical,total_gross_revenue_amount,"['current_fy_gross_revenue', 'previous_fy_gross_revenue', 'next_fy_revenue_k']","The total gross revenue is the sum of revenue across all financial years. The FY-specific metrics are subsets of this total, filtered by `relative_fy_year_offset`.",total_gross_revenue_amount = SUM(current_fy_gross_revenue) + SUM(previous_fy_gross_revenue) + SUM(next_fy_revenue_k * 1000) + other_years_revenue,"Ensures that the sum of segmented revenue aligns with the overall total revenue, providing a consistent view of financial performance across different time horizons.","SELECT 
  SUM(gross_revenue_amount) AS total_revenue,
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) AS current_fy_revenue,
  SUM(CASE WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount ELSE 0 END) AS previous_fy_revenue,
  SUM(CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END) AS next_fy_revenue,
  SUM(CASE WHEN relative_fy_year_offset NOT IN (0, -1, 1) THEN gross_revenue_amount ELSE 0 END) AS other_fy_revenue
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`
WHERE SAFE_CAST(booking_line_created_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY);",strong,high,1,4d8074b2-17a8-48ba-babe-c536359b1f64,3,"current_fy_gross_revenue, previous_fy_gross_revenue, next_fy_revenue_k"
dependency,previous_fy_gross_revenue_date_cond,['previous_fy_gross_revenue'],"This metric is a more specific version of 'Previous FY Gross Revenue', adding a complex date condition. It is a subset of the general previous FY revenue.",previous_fy_gross_revenue_date_cond <= previous_fy_gross_revenue,"Used to compare a specific historical period's performance against the broader previous financial year, often for targeted analysis or campaign effectiveness.","SELECT 
  SUM(CASE WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount ELSE 0 END) AS previous_fy_total,
  SUM(CASE WHEN (relative_fy_year_offset = -1 AND (SAFE_CAST(CASE WHEN (revenue_type = 'DIGITAL' AND revenue_group_subtype = 'DIGITAL' AND sales_segment_l_2_name_sync = 'Digital Other' AND advertiser_parent != 'DOUBLECLICK') THEN fix_date_lod ELSE PARSE_DATE('%Y-%m-%d', booking_line_created_date) END AS DATETIME) <= DATETIME_ADD(DATE(TIMESTAMP '2025-01-06 23:58:33.668651+00', 'Australia/Sydney'), INTERVAL -365 DAY))) THEN gross_revenue_amount ELSE 0 END) AS previous_fy_date_cond_total
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`
WHERE SAFE_CAST(booking_line_created_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY);",strong,medium,1,4d8074b2-17a8-48ba-babe-c536359b1f64,1,previous_fy_gross_revenue
mathematical_relationship,total_volume_draw_adj_returns,"['total_draw_volume', 'total_returns_volume']","Total Volume (Draw + Adjustment + Returns) is a direct sum of Draw Volume, Returns Volume, and Adjustment Volume. It represents the aggregate movement of units.",total_volume_draw_adj_returns = SUM(Draw Volume) + SUM(Adjustment Volume) + SUM(Returns Volume),"This relationship ensures that the overall volume metric accurately reflects the sum of its component parts, providing a comprehensive view of unit circulation.","SELECT SUM(total_volume_draw_adj_returns) AS total_combined_volume, SUM(total_draw_volume + total_returns_volume + (SELECT SUM(CASE WHEN charge_type = 'ADJUSTMENT' THEN route_volume ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circualtion_insights` WHERE SAFE_CAST(LEFT(SAFE_CAST(fiscal_week_id AS STRING), 4) AS INT64) = 2025)) AS sum_of_components FROM primary_analysis_sql_output_table WHERE fiscal_week_id IN (202541, 202542, 202543, 202544, 202545) AND day_of_week = 'Sun';",strong,high,2,c441950c-1e3f-432c-9838-847d1d315b9e,2,"total_draw_volume, total_returns_volume"
filter_impact,total_charge_amount,"['publication_group', 'sales_channel_l4']",The 'Total Charge Amount' metric is specifically filtered by 'sales_channel_l4' = 'Subscriptions' and 'publication_group' = 'DT'. This indicates a focused analysis on a particular segment of revenue.,,"This relationship highlights that the dashboard is interested in subscription revenue specifically for the 'DT' publication group, implying these are key segments for financial tracking.","SELECT SUM(total_charge_amount) FROM primary_analysis_sql_output_table WHERE sales_channel_l4 = 'Subscriptions' AND publication_group = 'DT' AND fiscal_week_id IN (202533, 202534, 202535, 202536, 202537, 202538, 202539, 202540);",strong,high,2,c441950c-1e3f-432c-9838-847d1d315b9e,2,"publication_group, sales_channel_l4"
filter_impact,budget_earned_amount_current_week,"['masthead_group', 'finance_recognition']",All financial metrics are filtered by 'masthead_group != 'Discontinued'' and 'finance_recognition = 'Digital Recognition''.,N/A,Ensures that financial metrics only include relevant digital subscription data and exclude discontinued mastheads.,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` WHERE masthead_group = 'Discontinued' OR finance_recognition != 'Digital Recognition';,strong,high,3,bb49fa78-5abe-4e68-a9c1-8172a832e724,2,"masthead_group, finance_recognition"
mathematical_relationship,net_base_change_previous_year_same_week,"['closing_base_previous_year_same_week', 'opening_base_previous_year_same_week']",Net Base Change is calculated as Closing Base minus Opening Base for the specified period.,Net Base Change = Closing Base - Opening Base,"This calculation provides insight into the net change in subscriber base over a period, crucial for growth analysis.","SELECT SUM(ClosingBase - OpeningBase) AS calculated_net_change, SUM(ClosingBase) - SUM(OpeningBase) AS sum_of_diff_net_change FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` WHERE fy_year = (EXTRACT(YEAR FROM CURRENT_DATE()) - 1) AND fy_week_of_year = DATETIME_DIFF(SAFE_CAST(CURRENT_DATE() AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) LIMIT 1;",strong,high,3,bb49fa78-5abe-4e68-a9c1-8172a832e724,2,"closing_base_previous_year_same_week, opening_base_previous_year_same_week"
dependency,budget_earned_amount_current_week,['earned_amount_current_week'],"Budget Earned Amount is a target metric, while Earned Amount is the actual performance. They are often compared.",N/A (comparison),Comparison of actual earned amount against budgeted amount for performance tracking.,"SELECT SUM(CASE WHEN fy_year = EXTRACT(YEAR FROM CURRENT_DATE()) AND fy_week_of_year = DATETIME_DIFF(SAFE_CAST(CURRENT_DATE() AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) THEN SAFE_CAST(BudgetEarnedAmount AS NUMERIC) ELSE 0 END) AS current_budget, SUM(CASE WHEN fy_year = EXTRACT(YEAR FROM CURRENT_DATE()) AND fy_week_of_year = DATETIME_DIFF(SAFE_CAST(CURRENT_DATE() AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) THEN SAFE_CAST(EarnedAmount AS NUMERIC) ELSE 0 END) AS current_earned FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dt_digital_subscriptions` WHERE masthead_group != 'Discontinued' AND finance_recognition = 'Digital Recognition' LIMIT 1;",medium,high,3,bb49fa78-5abe-4e68-a9c1-8172a832e724,1,earned_amount_current_week
inconsistency,closing_base_current_week,"['opening_base_current_week', 'earned_amount_current_week']","The 'current week' definition varies slightly between Query 1 (based on 2025-03-26) and Query 2 (based on 2025-03-25), leading to different week numbers (38 vs 37).",N/A,"This inconsistency can lead to different values for 'current week' metrics depending on which query is used, causing confusion and distrust in data.","SELECT DATETIME_DIFF(SAFE_CAST(DATETIME '2025-03-26T00:00:00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AS week_q1, DATETIME_DIFF(SAFE_CAST(DATETIME '2025-03-25T00:00:00' AS DATETIME), SAFE_CAST(DATETIME '2024-07-03T00:00:00' AS DATETIME), WEEK) AS week_q2;",strong,high,3,bb49fa78-5abe-4e68-a9c1-8172a832e724,2,"opening_base_current_week, earned_amount_current_week"
filter_impact,total_gross_revenue,"['financial_year', 'fy_year_month_number', 'booking_name', 'revenue_transaction_status', 'adsize_category']","The `total_gross_revenue` metric is consistently filtered and grouped by various dimensions across the dashboard queries. Filters on `financial_year`, `fy_year_month_number`, and `booking_name` directly restrict the data used for revenue calculation. Grouping by `adsize_category` and `revenue_transaction_status` breaks down the total revenue into meaningful segments.",SUM(gross_revenue_amount) WHERE [dimension_filters] GROUP BY [dimensions],"This relationship allows users to analyze revenue performance over specific periods, for particular campaigns, or by different ad product categories and transaction statuses, providing granular insights into ad sales performance.","-- SQL to validate filter impact on total_gross_revenue
SELECT
  SAFE_CAST(financial_year AS STRING) AS financial_year,
  SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) AS total_gross_revenue_filtered
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (0) -- Current FY
  AND SAFE_CAST(financial_year AS STRING) = '2025' -- Specific hardcoded filter from queries
GROUP BY
  financial_year
HAVING
  SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) IS NOT NULL
LIMIT 10;",strong,high,4,e83da1de-4227-43e6-bcc6-73051c66914b,5,"financial_year, fy_year_month_number, booking_name, revenue_transaction_status, adsize_category"
dependency,adsize_category,['adsize_name'],The `adsize_category` dimension is directly derived from the `adsize_name` field using a `CASE WHEN` statement with `REGEXP_CONTAINS` logic. This means any changes or inconsistencies in `adsize_name` will directly impact the categorization.,adsize_category = f(adsize_name),"This derivation is a key business rule for segmenting ad products. Its accuracy is vital for correct reporting of 'Sponsorship', 'Production', and 'Media' revenue. Any changes to product naming conventions or categorization rules require updating this logic.","-- SQL to validate adsize_category derivation
SELECT
  adsize_name,
  CASE
    WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*event sponsorship.*)$')) THEN 'Sponsorship'
    WHEN (SAFE.REGEXP_CONTAINS(LOWER(SAFE_CAST(adsize_name AS STRING)), '^(.*production.*)$')) THEN 'Production'
    ELSE 'Media'
  END AS derived_adsize_category,
  COUNT(*) AS record_count
FROM
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  relative_fy_year_offset IN (0) -- Current FY
GROUP BY
  adsize_name, derived_adsize_category
ORDER BY
  record_count DESC
LIMIT 100;",strong,high,4,e83da1de-4227-43e6-bcc6-73051c66914b,1,adsize_name
mathematical_relationship,calculated_daily_volume_type_1_q3,"['calculated_daily_volume_type_2_q3', 'total_volume_q1']","Both 'Total Calculated Daily Volume Type 1' and 'Type 2' are derived from base volume metrics (like `volume`, `Forecast_Volume`) by applying complex conditional logic, division by a hardcoded '48', and then further division by 6 or 7 based on publication type. They represent different ways of normalizing volume to a daily average. 'Total Volume (Q1 Filtered)' is a direct sum of raw volume for a specific period, serving as a foundational metric.","Calculated_Daily_Volume = (Base_Volume / 48) / (6 or 7 days, conditionally)","These metrics aim to provide comparable daily volume figures across different publications and reporting periods, accounting for variations in publication schedules (e.g., 6-day vs. 7-day publications). The relationship highlights the need for clear definitions of 'daily volume' in a business context.","SELECT
  SUM(CASE WHEN T2.fy_year = 2025 AND T2.fy_year_week_number <= 202548 AND T2.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND T2.os_level_7 = 'All Sales Channels' AND T2.publication_group_q3_type_3 IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times') THEN T2.q3_final_volume_type_1 ELSE 0 END) AS total_calculated_volume_type_1_q3,
  SUM(CASE WHEN T2.fy_year = 2025 AND T2.fy_year_week_number <= 202548 AND T2.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND T2.os_level_7 = 'All Sales Channels' AND T2.publication_group_q3_type_3 IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times') THEN T2.q3_final_volume_type_2 ELSE 0 END) AS total_calculated_volume_type_2_q3,
  SUM(CASE WHEN T2.q1_week_match_filter = TRUE AND T2.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND T2.os_level_7 = 'All Sales Channels' THEN T2.volume ELSE 0 END) AS total_volume_q1
FROM CalculatedMetrics AS T2
LIMIT 1;",strong,high,5,2104a3f5-9424-4087-a928-e67fecae789a,2,"calculated_daily_volume_type_2_q3, total_volume_q1"
filter_impact,total_actual_amount_q1,"['total_volume_q1', 'publication_count_advertiser_q2', 'calculated_daily_volume_type_1_q3', 'calculated_daily_volume_type_2_q3']","All metrics share common base filters from the `OSandFACT` CTE (e.g., `os_level_6 = 'CIRCULATION'`, `gl_hierarchy_code = 'FY2025'`). However, each metric then applies additional, distinct filters (e.g., specific fiscal week, publication exclusions, sales channel, publication groups). This means that while they draw from the same underlying data, their final aggregated values are not directly comparable without understanding their specific filter contexts.",N/A,Understanding the specific filters applied to each metric is crucial for accurate interpretation and comparison. Misinterpreting the scope of each metric could lead to incorrect business decisions.,"SELECT
  'Filter Overlap Analysis' as analysis_type,
  SUM(CASE WHEN T2.q1_week_match_filter = TRUE AND T2.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND T2.os_level_7 = 'All Sales Channels' THEN 1 ELSE 0 END) AS q1_filtered_records,
  SUM(CASE WHEN T2.publication_group_q2 = 'Advertiser' THEN 1 ELSE 0 END) AS q2_filtered_records,
  SUM(CASE WHEN T2.fy_year = 2025 AND T2.fy_year_week_number <= 202548 AND T2.publication_name NOT IN ('Weekly Times', 'Sunshine Coast', 'Mackay') AND T2.os_level_7 = 'All Sales Channels' AND T2.publication_group_q3_type_3 IN ('Geelong Advertiser', 'Mercury', 'Sunday Tasmanian', 'Sunshine Coast', 'Sydney Suburbans', 'The Australian', 'The Daily Telegraph', 'The Herald Sun', 'Toowoomba', 'Townsville Bulletin', 'Weekly Times') THEN 1 ELSE 0 END) AS q3_filtered_records
FROM CalculatedMetrics AS T2
LIMIT 1;",strong,high,5,2104a3f5-9424-4087-a928-e67fecae789a,4,"total_volume_q1, publication_count_advertiser_q2, calculated_daily_volume_type_1_q3, calculated_daily_volume_type_2_q3"
filter_impact,sales_segment_l2_name_sync,"['revenue_transaction_status', 'source_publishing_division', 'fin_adtype_name']","The values and counts of 'Sales Segment Level 2 Name Sync' are directly filtered by specific 'Revenue Transaction Status', exclusion of 'Medium Rare Content Agency' from 'Source Publishing Division', and a predefined list of 'Financial Ad Type Names'.",,"Ensures that sales segment analysis focuses only on booked/billed revenue, excludes specific content agencies, and targets relevant ad types.",See business_rules_sql for filter coverage validation.,strong,high,6,f65a9149-93b4-4aa9-aef6-d12002853222,3,"revenue_transaction_status, source_publishing_division, fin_adtype_name"
filter_impact,booking_number,"['fin_adtype_name', 'financial_year']","The distinct 'Booking Numbers' are filtered to specific 'Financial Ad Type Names' (Content Discovery, Native) and specific 'Financial Years' (2025, 2026).",,Ensures that booking number analysis is restricted to relevant ad types and recent financial periods.,See business_rules_sql for filter coverage validation.,strong,high,6,f65a9149-93b4-4aa9-aef6-d12002853222,2,"fin_adtype_name, financial_year"
filter_impact,adsize_name,"['revenue_transaction_status', 'source_publishing_division', 'fin_adtype_name', 'financial_year']","The values and counts of 'Ad Size Name' are filtered by specific 'Revenue Transaction Status', exclusion of 'Medium Rare Content Agency' from 'Source Publishing Division', a predefined list of 'Financial Ad Type Names', and the 'Financial Year' 2025.",,"Ensures that ad size analysis focuses only on booked/billed revenue, excludes specific content agencies, targets relevant ad types, and is limited to the specified financial year.",See business_rules_sql for filter coverage validation.,strong,high,6,f65a9149-93b4-4aa9-aef6-d12002853222,4,"revenue_transaction_status, source_publishing_division, fin_adtype_name, financial_year"
dependency,revenue_type_derived,"['revenue_type', 'xtend_flag']","The 'Revenue Type Derived' is calculated based on the raw 'Revenue Type' and the 'XTEND Flag'. If 'XTEND Flag' is 'Y', then 'Revenue Type Derived' becomes 'XTEND', otherwise it retains the original 'Revenue Type'.","revenue_type_derived = IF(xtend_flag = 'Y', 'XTEND', revenue_type)","Ensures that XTEND revenue is consistently categorized regardless of its original revenue type, which is crucial for specific reporting needs.",SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE (xtend_flag = 'Y' AND (CASE WHEN (xtend_flag = 'Y') THEN 'XTEND' ELSE revenue_type END) != 'XTEND') OR (xtend_flag != 'Y' AND (CASE WHEN (xtend_flag = 'Y') THEN 'XTEND' ELSE revenue_type END) != revenue_type);,strong,high,7,61f1feb4-fc3e-4bee-b987-84c86cfe6425,2,"revenue_type, xtend_flag"
dependency,revenue_group_type_derived,['revenue_type_derived'],"The 'Revenue Group Type Derived' is a further categorization based on the 'Revenue Type Derived'. It maps 'DIGITAL' to 'DIGITAL (excl.XTEND)', 'PRINT' to 'PRINT', and 'XTEND' to 'XTEND ONLY'.",revenue_group_type_derived = CASE WHEN revenue_type_derived = 'DIGITAL' THEN 'DIGITAL (excl.XTEND)' WHEN revenue_type_derived = 'PRINT' THEN 'PRINT' WHEN revenue_type_derived = 'XTEND' THEN 'XTEND ONLY' ELSE NULL END,"Provides a simplified and business-specific grouping for high-level analysis, separating XTEND revenue and explicitly marking digital revenue that is not XTEND.","SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE (CASE WHEN (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) = 'DIGITAL' THEN 'DIGITAL (excl.XTEND)' WHEN (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) = 'PRINT' THEN 'PRINT' WHEN (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) = 'XTEND' THEN 'XTEND ONLY' ELSE NULL END) IS NULL AND (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) IS NOT NULL AND (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) NOT IN ('DIGITAL', 'PRINT', 'XTEND');",strong,high,7,61f1feb4-fc3e-4bee-b987-84c86cfe6425,1,revenue_type_derived
filter_impact,unified_publication_name,"['financial_year', 'revenue_group_subtype']","The list of 'Unified Publication Name' displayed is filtered by specific 'Financial Year' (2024, 2025) and 'Revenue Group Subtype' ('DIGITAL', 'PROGRAMMATIC EXCHANGE', 'PROGRAMMATIC SOURCE').",N/A,"Ensures that users only see publication names relevant to the current and next financial year, and specific digital/programmatic revenue streams.","SELECT COUNT(DISTINCT unified_publication_name) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE financial_year NOT IN ('2024', '2025') OR revenue_group_subtype NOT IN ('DIGITAL', 'PROGRAMMATIC EXCHANGE', 'PROGRAMMATIC SOURCE');",strong,medium,7,61f1feb4-fc3e-4bee-b987-84c86cfe6425,2,"financial_year, revenue_group_subtype"
filter_impact,revenue_group_subtype,"['financial_year', 'revenue_group_type_derived']","The list of 'Revenue Group Subtype' is filtered by specific 'Financial Year' (2024, 2025) and where the 'Revenue Group Type Derived' is 'DIGITAL (excl.XTEND)' (based on the original query's 'digital' filter).",N/A,Limits the displayed revenue subtypes to those relevant for the specified financial years and digital revenue categories.,"SELECT COUNT(DISTINCT revenue_group_subtype) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0 WHERE financial_year NOT IN ('2024', '2025') OR (CASE WHEN (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) = 'DIGITAL' THEN 'DIGITAL (excl.XTEND)' WHEN (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) = 'PRINT' THEN 'PRINT' WHEN (CASE WHEN (t0.xtend_flag = 'Y') THEN 'XTEND' ELSE t0.revenue_type END) = 'XTEND' THEN 'XTEND ONLY' ELSE NULL END) != 'DIGITAL (excl.XTEND)';",strong,medium,7,61f1feb4-fc3e-4bee-b987-84c86cfe6425,2,"financial_year, revenue_group_type_derived"
filter_impact,product_group,"['advertiser_group', 'fin_adtype_name', 'financial_week']","The 'product_group' dimension acts as a primary filter for the values displayed for 'advertiser_group', 'fin_adtype_name', and 'financial_week'. Different selections of 'product_group' will yield different sets of values for these other dimensions.",N/A (filter relationship),"Ensures that the displayed advertiser groups, ad types, and financial weeks are relevant to the selected product categories, aligning with specific business segments.","-- Example validation for product_group filter impact on advertiser_group
SELECT
  COUNT(DISTINCT t0.advertiser_group) AS total_advertiser_groups,
  COUNT(DISTINCT CASE WHEN t0.product_group IN ('Commercial Content', 'Free News & Lifestyle') THEN t0.advertiser_group END) AS filtered_advertiser_groups
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
WHERE SAFE_CAST(t0.report_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY);",strong,high,8,d3bcf796-2396-4a6f-b0a3-da0b7f299a58,3,"advertiser_group, fin_adtype_name, financial_week"
filter_impact,total_gross_revenue,"['portfolio_parent_group', 'transaction_type', 'financial_period', 'portfolio_child_group', 'is_current_or_past_month_q3ref']","Total Gross Revenue is filtered by various dimensions to show specific segments of revenue. For example, Query 1 filters by 'INDEPENDENT AGENCIES NSW' and excludes 'Guaranteed' transactions. Query 3 filters by 'CONSORTIUM VIC', 'FY2025 - Q4', 'Deal' transactions, and specific child groups, and only includes months up to a hardcoded date.",SUM(RevenueGross) WHERE [dimension_filter_conditions],"Ensures that revenue figures are presented for the intended business segments and timeframes, aligning with specific reporting needs.",SELECT SUM(SAFE_CAST(RevenueGross AS NUMERIC)) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` WHERE PortfolioParentGroup IN ('INDEPENDENT AGENCIES NSW') AND (TransactionType NOT IN ('Guaranteed') OR TransactionType IS NULL) LIMIT 1;,strong,high,9,6f1c8731-02da-464f-b146-bf2947860735,5,"portfolio_parent_group, transaction_type, financial_period, portfolio_child_group, is_current_or_past_month_q3ref"
dependency,month_start_date,"['financial_year', 'financial_month_number', 'adjusted_financial_month_number']",The 'Month Start Date' is directly calculated from 'Financial Year' and 'Adjusted Financial Month Number'. The 'Adjusted Financial Month Number' itself is a transformation of 'Financial Month Number' based on a hardcoded fiscal calendar logic.,"MonthStartDate = DATETIME_TRUNC(DATE(FinancialYear, AdjustedFinancialMonthNumber, 1), MONTH)","Ensures that time-based analysis aligns with the company's specific fiscal calendar, which is critical for accurate financial reporting.","SELECT FinancialYear, FinancialMonthNumber, (CASE WHEN FinancialMonthNumber = 1 THEN 7 WHEN FinancialMonthNumber = 2 THEN 8 WHEN FinancialMonthNumber = 3 THEN 9 WHEN FinancialMonthNumber = 4 THEN 10 WHEN FinancialMonthNumber = 5 THEN 11 WHEN FinancialMonthNumber = 6 THEN 12 WHEN FinancialMonthNumber = 7 THEN 1 WHEN FinancialMonthNumber = 8 THEN 2 WHEN FinancialMonthNumber = 9 THEN 3 WHEN FinancialMonthNumber = 10 THEN 4 WHEN FinancialMonthNumber = 11 THEN 5 WHEN FinancialMonthNumber = 12 THEN 6 ELSE NULL END) AS AdjustedMonth, SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(FinancialYear, (CASE WHEN FinancialMonthNumber = 1 THEN 7 WHEN FinancialMonthNumber = 2 THEN 8 WHEN FinancialMonthNumber = 3 THEN 9 WHEN FinancialMonthNumber = 4 THEN 10 WHEN FinancialMonthNumber = 5 THEN 11 WHEN FinancialMonthNumber = 6 THEN 12 WHEN FinancialMonthNumber = 7 THEN 1 WHEN FinancialMonthNumber = 8 THEN 2 WHEN FinancialMonthNumber = 9 THEN 3 WHEN FinancialMonthNumber = 10 THEN 4 WHEN FinancialMonthNumber = 11 THEN 5 WHEN FinancialMonthNumber = 12 THEN 6 ELSE NULL END), 1) AS DATETIME), MONTH) AS DATE) AS CalculatedMonthStartDate FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_fin_month` WHERE FinancialYear = 2025 AND FinancialQuarter = 4 LIMIT 10;",strong,high,9,6f1c8731-02da-464f-b146-bf2947860735,3,"financial_year, financial_month_number, adjusted_financial_month_number"
filter_impact,adpoint_account,"['genera_booking_account', 'medium_rare_debtor_account', 'national_debtor_account']","Filtering by 'Adpoint Account' (e.g., '56694') directly impacts the displayed values of Genera Booking, Medium Rare Debtor, and National Debtor Accounts, showing only mappings related to the selected Adpoint Account.",N/A,Ensures that users can drill down into specific account mappings based on a primary identifier.,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_advertising.v_asl_gbaba_act_xref` WHERE SAFE_CAST(Adpoint_Account AS STRING) = '56694';,strong,high,10,258a722d-9b6e-45df-ba00-1b9954ec36b2,3,"genera_booking_account, medium_rare_debtor_account, national_debtor_account"
mathematical_relationship,total_records,['records_by_scenario'],The total number of records is the sum of records across all individual scenarios.,total_records = SUM(records_by_scenario),"Ensures that the sum of parts equals the whole, validating data aggregation.","SELECT
  'Total Records Sum Validation' AS validation_test,
  (SELECT COUNT(1) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`) AS actual_total_records,
  (SELECT SUM(records_by_scenario) FROM (SELECT COUNT(1) AS records_by_scenario FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` GROUP BY scenario)) AS sum_of_scenario_records,
  CASE
    WHEN (SELECT COUNT(1) FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions`) = (SELECT SUM(records_by_scenario) FROM (SELECT COUNT(1) AS records_by_scenario FROM `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` GROUP BY scenario)) THEN 'PASS'
    ELSE 'FAIL'
  END AS validation_result;",strong,high,11,52dd1ac1-19b5-4695-a7e6-632ef7a9dba3,1,records_by_scenario
filter_impact,total_revenue_net,"['advertiser', 'source', 'transaction_type_upper', 'fiscal_period_string', 'reporting_month']","The calculation of Total Revenue Net is directly impacted by filters applied to Advertiser, Source, Transaction Type, Fiscal Period, and Reporting Month. Changes in these filters will alter the aggregated revenue.",SUM(revenuenet) WHERE [filters],"Ensures that revenue figures are contextualized to specific business segments, periods, and deal types. Incorrect filters lead to misleading revenue reports.","SELECT SUM(SAFE_CAST(revenuenet AS NUMERIC)) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` WHERE advertiser = 'The Smith Family *' AND SAFE_CAST(DATETIME_TRUNC(DATETIME_SUB(SAFE_CAST(DATE(financialyear, financialmonthnumber, 1) AS DATETIME), INTERVAL 6 MONTH), MONTH) AS DATE) = DATE '2024-11-01';",strong,high,12,783f341c-8660-4e90-bab8-9bc860119cf5,5,"advertiser, source, transaction_type_upper, fiscal_period_string, reporting_month"
dependency,reporting_month,"['financialyear', 'financialmonthnumber']",The 'Reporting Month' dimension is derived directly from 'financialyear' and 'financialmonthnumber' with a 6-month offset and truncation. Any issues or changes in the base financial date columns will directly affect 'Reporting Month'.,"reporting_month = TRUNC(DATE_SUB(DATE(financialyear, financialmonthnumber, 1), INTERVAL 6 MONTH), MONTH)",Critical for ensuring time-based reporting aligns with the company's specific fiscal calendar. Incorrect derivation would lead to misaligned time-series data.,"SELECT
  DATE(t0.financialyear, t0.financialmonthnumber, 1) AS original_financial_date,
  DATE_SUB(DATE(t0.financialyear, t0.financialmonthnumber, 1), INTERVAL 6 MONTH) AS six_month_offset_date,
  DATE_TRUNC(DATE_SUB(DATE(t0.financialyear, t0.financialmonthnumber, 1), INTERVAL 6 MONTH), MONTH) AS derived_reporting_month
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE t0.financialyear = 2025 AND t0.financialmonthnumber = 1
LIMIT 10;",strong,high,12,783f341c-8660-4e90-bab8-9bc860119cf5,2,"financialyear, financialmonthnumber"
dependency,fiscal_period_string,"['financialyear', 'financialquarter']",The 'Fiscal Period String' dimension is derived directly from 'financialyear' and 'financialquarter'.,"fiscal_period_string = CONCAT('FY', SUBSTR(financialyear, 3, 2), ' ', financialquarter)",Ensures consistent labeling of fiscal periods across reports. Any changes in the base financial year/quarter or the concatenation logic will affect this dimension.,"SELECT
  t0.financialyear,
  t0.financialquarter,
  CONCAT('FY',SUBSTR(SAFE_CAST(t0.financialyear AS STRING), 3, 2),' ',SAFE_CAST(t0.financialquarter AS STRING)) AS derived_fiscal_period_string
FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_weekly_master` AS t0
WHERE t0.financialyear = 2025 AND t0.financialquarter = 'Q2'
LIMIT 10;",strong,medium,12,783f341c-8660-4e90-bab8-9bc860119cf5,2,"financialyear, financialquarter"
filter_impact,total_adsales_revenue,"['financial_year', 'financial_week', 'revenue_group_subtype']","The 'Total AdSales Revenue' is directly impacted by filters applied to 'Financial Year', 'Financial Week', and 'Revenue Group Subtype'. Specific financial years (2024, 2025) and an exclusion of certain financial weeks (47-52) are applied, along with filtering by specific revenue subtypes (e.g., 'SUNDRY ADSALES OVERLAY').",SUM(revenue_amount) WHERE financial_year IN (...) AND financial_week NOT IN (...) AND revenue_group_subtype IN (...),"This interaction ensures that the reported revenue aligns with specific reporting periods and business segments, crucial for accurate pacing and performance analysis.","SELECT
  financial_year,
  financial_week_int AS financial_week,
  revenue_group_subtype,
  SUM(revenue_amount) AS filtered_revenue
FROM (
  SELECT
    t0.financial_year,
    SAFE_CAST(t0.financial_week AS INT64) AS financial_week_int,
    t0.revenue_group_subtype,
    SAFE_CAST(t0.revenue_amount AS NUMERIC) AS revenue_amount
  FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
  WHERE
    t0.financial_year IN ('2024', '2025')
    AND (SAFE_CAST(t0.financial_week AS INT64) NOT IN (47, 48, 49, 50, 51, 52) OR SAFE_CAST(t0.financial_week AS INT64) IS NULL)
    AND t0.revenue_group_subtype = 'SUNDRY ADSALES OVERLAY'
) AS filtered_data
GROUP BY 1, 2, 3
LIMIT 100;",strong,high,14,3ee20092-1897-49b7-8bcd-4157d5f816eb,3,"financial_year, financial_week, revenue_group_subtype"
filter_impact,total_gross_revenue_amount,"['current_portfolio_owner_full', 'grouped_advertiser_name']","The filters applied to `current_portfolio_owner_full` (e.g., 'Contra' industry pillar, 'Renee Sycamore' sales segment) and the grouping logic of `grouped_advertiser_name` directly constrain and define the `total_gross_revenue_amount` being reported. These filters are likely applied at a dashboard level, affecting all related metrics.",N/A,"Ensures that the reported revenue is specific to the 'Contra' segment and relevant sales personnel, and can be viewed at a consolidated advertiser level.","-- Validate that revenue is only reported for 'Contra' pillar and specific sales segment
SELECT
  SUM(CASE WHEN t0.nca_industry_pillar = 'Contra' AND t0.sales_segment_gm_name IN ('Renee Sycamore') THEN t0.gross_revenue_amount ELSE 0 END) AS contra_revenue_filtered,
  SUM(t0.gross_revenue_amount) AS total_revenue_unfiltered
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0
WHERE
  SAFE_CAST(t0.calendar_year_month || '-01' AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 12 MONTH)
LIMIT 1;",strong,high,15,b9dfd2f4-92fa-4f81-a5b1-17de880470f9,2,"current_portfolio_owner_full, grouped_advertiser_name"
dependency,total_gross_revenue_amount,['grouped_advertiser_name'],The `total_gross_revenue_amount` is aggregated and presented using the `grouped_advertiser_name` dimension. This means the revenue figures are rolled up according to the custom grouping logic defined in `grouped_advertiser_name`.,SUM(total_gross_revenue_amount) GROUP BY grouped_advertiser_name,"Allows business users to see consolidated revenue for key contra accounts, rather than individual advertiser accounts, simplifying high-level analysis.","-- Validate that grouped revenue sums correctly
WITH GroupedRevenue AS (
  SELECT
    CASE
      WHEN adpoint_account_number IN ('13019', '52246', '18387') THEN 'CTR_2023_AFL Sports CTR_2023_Sydney Swans CTR_2023_GWS Giants'
      ELSE advertiser_name
    END AS grouped_advertiser_name,
    SUM(gross_revenue_amount) AS sum_gross_revenue
  FROM
    `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_daily`
  WHERE
    LOWER(LEFT(advertiser_name, 3)) = 'ctr'
    AND SAFE_CAST(calendar_year_month || '-01' AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH)
  GROUP BY
    grouped_advertiser_name
)
SELECT
  grouped_advertiser_name,
  sum_gross_revenue
FROM
  GroupedRevenue
WHERE
  grouped_advertiser_name = 'CTR_2023_AFL Sports CTR_2023_Sydney Swans CTR_2023_GWS Giants'
LIMIT 10;",strong,medium,15,b9dfd2f4-92fa-4f81-a5b1-17de880470f9,1,grouped_advertiser_name
mathematical_relationship,spend_current_period,['spend_previous_year'],Year-over-year comparison of total spend. Often used to calculate percentage change (YoY Growth = (Current - Previous) / Previous).,YoY Growth = (spend_current_period - spend_previous_year) / spend_previous_year,Ensures that the growth or decline in advertising spend is accurately measured against the prior year's performance for the same period.,"SELECT (SUM(spend_current_period) - SUM(spend_previous_year)) / NULLIF(SUM(spend_previous_year), 0) AS yoy_growth FROM ({{primary_analysis_sql}}) WHERE spend_previous_year IS NOT NULL AND spend_previous_year != 0;",strong,high,16,e9d8a216-4950-4d30-b344-5011776edbdf,1,spend_previous_year
filter_impact,spend_current_period,"['spend_news_corp_current_period', 'spend_retail_current_period']",Specific category/network spend metrics are subsets of the overall current period spend.,spend_news_corp_current_period <= spend_current_period AND spend_retail_current_period <= spend_current_period,"Confirms that segment-specific spend does not exceed the total spend for the same period, ensuring data integrity for breakdowns.","SELECT SUM(spend_news_corp_current_period) <= SUM(spend_current_period) AS news_corp_subset_valid, SUM(spend_retail_current_period) <= SUM(spend_current_period) AS retail_subset_valid FROM ({{primary_analysis_sql}});",strong,medium,16,e9d8a216-4950-4d30-b344-5011776edbdf,2,"spend_news_corp_current_period, spend_retail_current_period"
filter_impact,total_gross_revenue_amount,[],"The 'Total Gross Revenue Amount' is directly impacted by filters on 'Financial Year', 'Revenue Transaction Status', 'Source Publishing Division', 'Invoice Number', and 'Source System Code'. Changes to these filters will alter the aggregated revenue.",N/A,"Ensures that revenue figures reflect specific business criteria and periods, aligning with ad sales operational definitions.",N/A,strong,high,17,77c68c35-20ce-477a-b216-0c781d43a8ca,0,
filter_impact,finance_record_count,[],The 'Finance Record Count' is directly impacted by the 'Fiscal Week ID' filter. Only records within the specified fiscal weeks are counted.,N/A,Ensures that the record count is specific to the intended financial reporting periods.,N/A,strong,medium,17,77c68c35-20ce-477a-b216-0c781d43a8ca,0,
filter_impact,data_load_datetime_truncated,[],The displayed 'Data Load Datetime (Truncated to Second)' is filtered by 'Unified Publication GL Code'. Only load times for specific GL codes are shown.,N/A,Allows auditing of data freshness for specific financial publication categories.,N/A,strong,low,17,77c68c35-20ce-477a-b216-0c781d43a8ca,0,
mathematical_relationship,sum_gross_revenue_current_fy_display,"['gross_revenue_current_fy', 'gross_revenue_current_fy_thousands']","The final displayed current FY revenue is conditionally derived from either the raw current FY revenue or its thousands-scaled version, based on a dashboard parameter.",SUM(IF parameter = '$' THEN gross_revenue_current_fy ELSE gross_revenue_current_fy_thousands END),Ensures revenue is presented in the desired scale (raw or thousands) for user readability.,"SELECT SUM(CASE WHEN ('$\'000' = '$') THEN gross_revenue_current_fy ELSE SAFE_DIVIDE(gross_revenue_current_fy, 1000) END) FROM (SELECT CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END AS gross_revenue_current_fy FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`)",strong,high,19,4bd7795c-5a94-4fb6-92e1-ed152b1cf7b3,2,"gross_revenue_current_fy, gross_revenue_current_fy_thousands"
mathematical_relationship,sum_gross_revenue_previous_fy_display,"['gross_revenue_previous_fy', 'gross_revenue_previous_fy_thousands']","The final displayed previous FY revenue is conditionally derived from either the raw previous FY revenue or its thousands-scaled version, based on a dashboard parameter.",SUM(IF parameter = '$' THEN gross_revenue_previous_fy ELSE gross_revenue_previous_fy_thousands END),Ensures previous FY revenue is presented in the desired scale for year-over-year comparison.,"SELECT SUM(CASE WHEN ('$\'000' = '$') THEN gross_revenue_previous_fy ELSE SAFE_DIVIDE(gross_revenue_previous_fy, 1000) END) FROM (SELECT CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END AS gross_revenue_previous_fy FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`)",strong,high,19,4bd7795c-5a94-4fb6-92e1-ed152b1cf7b3,2,"gross_revenue_previous_fy, gross_revenue_previous_fy_thousands"
dependency,gross_revenue_current_fy,"['gross_revenue_amount', 'relative_fy_year_offset']",Gross revenue for the current fiscal year is directly dependent on the base gross revenue amount and the fiscal year offset being 0.,gross_revenue_current_fy = CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END,Ensures correct attribution of revenue to the current reporting period.,SELECT SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`,strong,high,19,4bd7795c-5a94-4fb6-92e1-ed152b1cf7b3,2,"gross_revenue_amount, relative_fy_year_offset"
dependency,gross_revenue_previous_fy,"['gross_revenue_amount', 'relative_fy_year_offset']",Gross revenue for the previous fiscal year is directly dependent on the base gross revenue amount and the fiscal year offset being 1.,gross_revenue_previous_fy = CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END,Ensures correct attribution of revenue to the previous reporting period for comparative analysis.,SELECT SUM(CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance`,strong,high,19,4bd7795c-5a94-4fb6-92e1-ed152b1cf7b3,2,"gross_revenue_amount, relative_fy_year_offset"
filter_impact,sum_gross_revenue_current_fy_display,['product_group'],The calculation of current FY revenue is filtered by a specific product group ('The Australian & Prestige'). This limits the scope of the displayed metric.,N/A,"Ensures the dashboard focuses on a specific, critical product segment.",SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE product_group = 'The Australian & Prestige',strong,medium,19,4bd7795c-5a94-4fb6-92e1-ed152b1cf7b3,1,product_group
filter_impact,publication_category,"['product_group', 'revenue_type', 'unified_publication_name']","The publication category dimension is calculated within a specific filtered context (product_group='The Australian & Prestige', revenue_type='PRINT', unified_publication_name='GQ Mag'). This implies the category is relevant only for this specific slice of data.",N/A,Ensures the categorization is applied within the intended reporting context.,SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` WHERE product_group = 'The Australian & Prestige' AND revenue_type = 'PRINT' AND unified_publication_name = 'GQ Mag',strong,medium,19,4bd7795c-5a94-4fb6-92e1-ed152b1cf7b3,3,"product_group, revenue_type, unified_publication_name"
mathematical_relationship,total_gross_amount_diff,"['sum_digital_gross_amount_diff', 'sum_print_gross_amount_diff']","The total gross amount difference is the sum of digital and print gross amount differences, plus any other revenue types not explicitly categorized as digital or print.",total_gross_amount_diff = sum_digital_gross_amount_diff + sum_print_gross_amount_diff + SUM(other_revenue_types),"Ensures that the sum of segmented revenue (digital, print) reconciles with the overall total revenue, allowing for detailed breakdown while maintaining overall accuracy.","SELECT
  SUM(gross_amount_diff) AS total_revenue,
  SUM(CASE WHEN revenue_type = 'DIGITAL' THEN gross_amount_diff ELSE 0 END) AS digital_revenue,
  SUM(CASE WHEN revenue_type = 'PRINT' THEN gross_amount_diff ELSE 0 END) AS print_revenue,
  SUM(CASE WHEN revenue_type NOT IN ('DIGITAL', 'PRINT') THEN gross_amount_diff ELSE 0 END) AS other_revenue,
  (SUM(CASE WHEN revenue_type = 'DIGITAL' THEN gross_amount_diff ELSE 0 END) + SUM(CASE WHEN revenue_type = 'PRINT' THEN gross_amount_diff ELSE 0 END) + SUM(CASE WHEN revenue_type NOT IN ('DIGITAL', 'PRINT') THEN gross_amount_diff ELSE 0 END)) AS sum_of_parts
FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement`
WHERE SAFE_CAST(movement_date AS DATE) >= DATE_TRUNC(CURRENT_DATE(), YEAR)
HAVING total_revenue = sum_of_parts;",strong,high,20,a1b901e6-c4fb-44bc-955a-3a7070c15829,2,"sum_digital_gross_amount_diff, sum_print_gross_amount_diff"
dependency,derived_revenue_category,"['xtend_flag', 'revenue_sub_type', 'portfolio_parent_group_name_sync']","The 'Derived Revenue Category' is a complex dimension calculated based on multiple underlying flags and revenue attributes, following a specific hierarchical logic.",N/A (conditional logic),"This relationship defines how raw data attributes are transformed into a business-friendly categorization, critical for high-level reporting and strategic decision-making.","SELECT
  revenue_sub_type,
  xtend_flag,
  portfolio_parent_group_name_sync,
  CASE
    WHEN (xtend_flag = 'Y') THEN 'XTEND'
    WHEN ((SAFE.LEFT(revenue_sub_type, 3) = 'PRO') OR ((portfolio_parent_group_name_sync = 'DIGITAL OTHER') AND (revenue_sub_type = 'DIGITAL'))) THEN 'PROGRAMMATIC'
    WHEN (revenue_sub_type = 'DIGITAL') THEN 'ADPT DIGITAL'
    WHEN (SAFE.LEFT(revenue_sub_type, 6) = 'SUNDRY') THEN 'SUNDRY'
    ELSE revenue_sub_type
  END AS calculated_category,
  COUNT(*) as record_count
FROM `ncau-data-newsquery-prd.asl_finance_derived.revenue_movement`
WHERE SAFE_CAST(movement_date AS DATE) >= DATE_TRUNC(CURRENT_DATE(), YEAR)
GROUP BY 1,2,3,4
ORDER BY record_count DESC
LIMIT 100;",strong,high,20,a1b901e6-c4fb-44bc-955a-3a7070c15829,3,"xtend_flag, revenue_sub_type, portfolio_parent_group_name_sync"
dependency,prior_period_comparison_revenue,"['previous_fy_gross_revenue', 'previous_fy_yoy_gross_revenue']",Prior Period Comparison Revenue dynamically selects between full previous FY revenue and YoY adjusted previous FY revenue based on the relative financial month offset.,"IF (relative_fy_month_offset < -12, previous_fy_gross_revenue, previous_fy_yoy_gross_revenue)",Ensures the most appropriate prior period comparison is used depending on the historical depth of the analysis.,"SELECT SUM(CASE WHEN relative_fy_month_offset < -12 THEN previous_fy_gross_revenue ELSE previous_fy_yoy_gross_revenue END) AS calculated_prior_period_revenue FROM (SELECT *, SUM(CASE WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount ELSE 0 END) OVER() AS previous_fy_gross_revenue, SUM(CASE WHEN relative_fy_year_offset = -1 AND SAFE_CAST(booking_line_created_date AS DATE) <= DATE_SUB(CURRENT_DATE(), INTERVAL 365 DAY) THEN gross_revenue_amount ELSE 0 END) OVER() AS previous_fy_yoy_gross_revenue FROM `ncau-data-newsquery-prd.sbx_dcp.ia` WHERE revenue_group_subtype != 'PROGRAMMATIC EXCHANGE') WHERE relative_fy_month_offset IS NOT NULL LIMIT 1",strong,high,21,fed70b12-c274-4cde-9920-592ca4c4dab0,2,"previous_fy_gross_revenue, previous_fy_yoy_gross_revenue"
mathematical_relationship,current_fy_gross_revenue,['previous_fy_gross_revenue'],These metrics are used together to calculate Year-over-Year (YoY) growth or decline in gross revenue.,((current_fy_gross_revenue - previous_fy_gross_revenue) / previous_fy_gross_revenue) * 100,YoY growth is a critical indicator of business performance and trend.,"SELECT (SUM(current_fy_gross_revenue) - SUM(previous_fy_gross_revenue)) / NULLIF(SUM(previous_fy_gross_revenue), 0) * 100 AS yoy_growth_percentage FROM (SELECT CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END AS current_fy_gross_revenue, CASE WHEN relative_fy_year_offset = -1 THEN gross_revenue_amount ELSE 0 END AS previous_fy_gross_revenue FROM `ncau-data-newsquery-prd.sbx_dcp.ia` WHERE revenue_group_subtype != 'PROGRAMMATIC EXCHANGE') LIMIT 1",strong,high,21,fed70b12-c274-4cde-9920-592ca4c4dab0,1,previous_fy_gross_revenue
filter_impact,total_digital_subscriptions,"['recognition_type', 'masthead_category', 'fiscal_period_label', 'report_type_fct_label', 'report_type_cancellations_label', 'report_type_acquisitions_label']","The quantitative metrics (Total Digital Subscriptions, Total Digital Revenue) are directly filtered and segmented by the 'Recognition Type' and 'Masthead Category' dimensions. The 'Fiscal Period Label' and 'Report Type Labels' likely serve as interactive filters or display labels within the dashboard, allowing users to slice the quantitative metrics.",N/A (filtering relationship),"Ensures that subscription and revenue data is analyzed within the correct digital context and across relevant masthead groupings, as defined by business rules.","SELECT
  (SUM(CASE WHEN (CASE WHEN t0.delivery_medium_type = 'Print' THEN 'Print Recognition' WHEN (CASE WHEN t0.subscriber_has_email_flag = 'subsnapfact' THEN 'Y' WHEN (t0.classification_level_1_description = 'Standard Paid' AND t0.delivery_medium_type = 'Bundle') THEN t0.subscriber_has_email_flag ELSE 'Y' END) = 'N' THEN 'Print Recognition' ELSE 'Digital Recognition' END) = 'Digital Recognition' THEN 1 ELSE 0 END) = COUNT(*)) AS digital_recognition_filter_works,
  (SUM(CASE WHEN (CASE WHEN t0.masthead_code = 'The Australian' THEN 'The Australian' WHEN (t0.masthead_code IN ('Daily Telegraph', 'The Advertiser', 'Herald Sun', 'Courier Mail')) THEN 'Metros' ELSE 'Discontinued' END) != 'Discontinued' THEN 1 ELSE 0 END) = COUNT(*)) AS masthead_category_filter_works
FROM
  `ncau-data-newsquery-prd.asl_finance_derived.digital_subscriptions` AS t0
WHERE SAFE_CAST(t0.subscription_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
LIMIT 1;",strong,high,22,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26,6,"recognition_type, masthead_category, fiscal_period_label, report_type_fct_label, report_type_cancellations_label, report_type_acquisitions_label"
filter_impact,total_digital_revenue,"['recognition_type', 'masthead_category', 'fiscal_period_label', 'report_type_fct_label', 'report_type_cancellations_label', 'report_type_acquisitions_label']","Similar to Total Digital Subscriptions, Total Digital Revenue is filtered and segmented by 'Recognition Type' and 'Masthead Category'. The labels serve as interactive controls.",N/A (filtering relationship),Ensures that revenue data is analyzed within the correct digital context and across relevant masthead groupings.,"See validation_sql for total_digital_subscriptions, as the filters are identical.",strong,high,22,5dae02f0-dc48-418c-bdf9-5e5d2b1d6e26,6,"recognition_type, masthead_category, fiscal_period_label, report_type_fct_label, report_type_cancellations_label, report_type_acquisitions_label"
mathematical_relationship,actual_amount,"['budget_amount', 'forecast_amount']",Actual Amount is compared against Budget Amount and Forecast Amount to determine variances.,Actual vs. Budget Variance = actual_amount - budget_amount; Actual vs. Forecast Variance = actual_amount - forecast_amount,"These variances are critical for financial performance analysis, identifying deviations from plan and forecast.","SELECT SUM(SAFE_CAST(Actual_Amount AS NUMERIC)) - SUM(SAFE_CAST(Budget_Amount AS NUMERIC)) AS actual_vs_budget_variance, SUM(SAFE_CAST(Actual_Amount AS NUMERIC)) - SUM(SAFE_CAST(Forecast_Amount AS NUMERIC)) AS actual_vs_forecast_variance FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE SAFE_CAST(gl_hierarchy_code AS STRING) = 'FY2025' AND SAFE_CAST(fiscal_week_id AS INT64) = 40 LIMIT 1;",strong,high,23,b1c5901f-a535-42eb-870d-05cc025f7c27,2,"budget_amount, forecast_amount"
filter_impact,actual_amount,"['dim_gl_hierarchy_code', 'dim_fy_week_of_year', 'dim_os_level_4', 'dim_l03_publication_code', 'dim_os_level_6']","All financial metrics (Actual, Budget, Forecast) are heavily filtered by specific fiscal year, week, OS levels, and publication codes.",N/A,"The dashboard focuses on a very specific slice of financial data, likely for month-end reconciliation for a particular period and business segment.","SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON os.fiscal_week_id = calendar.fy_year_week_number WHERE SAFE_CAST(os.gl_hierarchy_code AS STRING) = 'FY2025' AND SAFE_CAST(calendar.fy_week_of_year AS INT64) = 40 AND SAFE_CAST(os.os_level_4 AS STRING) IN ('Total Revenue', 'Total Expenses') AND SAFE_CAST(os.l03_publication_code AS STRING) = 'News Media Publishing' AND SAFE_CAST(os.os_level_6 AS STRING) IN ('Circulation', 'Subscription', 'Content Licensing') LIMIT 1;",strong,high,23,b1c5901f-a535-42eb-870d-05cc025f7c27,5,"dim_gl_hierarchy_code, dim_fy_week_of_year, dim_os_level_4, dim_l03_publication_code, dim_os_level_6"
filter_impact,gross_revenue_amount,"['financial_year', 'calendar_year', 'calendar_month', 'publication_name', 'advertiser_name', 'revenue_group_subtype', 'revenue_transaction_status', 'source_publishing_division', 'advertiser_group', 'booking_number', 'revenue_type', 'source_unified_publication_name']",All listed dimensions act as filters or grouping keys for the 'Gross Revenue Amount' metric. Specific hardcoded values in these dimensions' filters directly impact the calculated revenue.,SUM(gross_revenue_amount) WHERE [dimension_filter_conditions],"Ensuring that the filters applied to these dimensions align with the desired business scope for revenue reporting (e.g., only billed/booked revenue, specific years, specific advertisers).",See `business_rules_sql` for validation of key filter conditions.,strong,high,24,c560ed20-040d-4c6a-9c3f-ec8bce27d132,12,"financial_year, calendar_year, calendar_month, publication_name, advertiser_name, revenue_group_subtype, revenue_transaction_status, source_publishing_division, advertiser_group, booking_number, revenue_type, source_unified_publication_name"
mathematical_relationship,ly_gross_revenue_thousands,['ly_gross_revenue'],Last Year Gross Revenue (Thousands) is derived by dividing Last Year Gross Revenue by 1000.,ly_gross_revenue_thousands = ly_gross_revenue / 1000,Ensures consistency in reporting units across different dashboard components.,SELECT SUM(ly_gross_revenue_thousands * 1000) = SUM(ly_gross_revenue) FROM ( /* primary_analysis_sql CTEs */ ),strong,high,25,1a5f7b4e-ea3a-46e4-8b77-b428f4178510,1,ly_gross_revenue
mathematical_relationship,cy_gross_revenue_thousands,['cy_gross_revenue'],Current Year Gross Revenue (Thousands) is derived by dividing Current Year Gross Revenue by 1000.,cy_gross_revenue_thousands = cy_gross_revenue / 1000,Ensures consistency in reporting units across different dashboard components.,SELECT SUM(cy_gross_revenue_thousands * 1000) = SUM(cy_gross_revenue) FROM ( /* primary_analysis_sql CTEs */ ),strong,high,25,1a5f7b4e-ea3a-46e4-8b77-b428f4178510,1,cy_gross_revenue
filter_impact,ly_gross_revenue_conditional_date,"['ly_gross_revenue', 'fix_date_lod']","LY Gross Revenue (Conditional Date) is a subset of LY Gross Revenue, further filtered by specific conditions related to advertiser_parent, revenue types, sales segments, and a hardcoded date reference. It depends on the `fix_date_lod` calculation.",ly_gross_revenue_conditional_date <= ly_gross_revenue,"This metric provides a more granular view of LY revenue for specific business cases, highlighting the impact of the complex date and segment filters.",SELECT SUM(ly_gross_revenue_conditional_date) <= SUM(ly_gross_revenue) FROM ( /* primary_analysis_sql CTEs */ ),strong,medium,25,1a5f7b4e-ea3a-46e4-8b77-b428f4178510,2,"ly_gross_revenue, fix_date_lod"
hierarchical,sales_group,"['ly_gross_revenue', 'cy_gross_revenue', 'pipeline', 'target']",Sales Group ('MRCA' or 'Client') is a primary dimension by which all revenue and sales-related metrics are aggregated and analyzed.,N/A,Allows for performance comparison between different sales segments.,"SELECT Sales_Group, SUM(ly_gross_revenue), SUM(cy_gross_revenue) FROM ( /* primary_analysis_sql CTEs */ ) GROUP BY Sales_Group",strong,high,25,1a5f7b4e-ea3a-46e4-8b77-b428f4178510,4,"ly_gross_revenue, cy_gross_revenue, pipeline, target"
hierarchical,advertiser_parent,"['ly_gross_revenue', 'cy_gross_revenue']",Advertiser Parent is another key dimension used for aggregating and analyzing gross revenue metrics.,N/A,Enables analysis of revenue contribution by major advertiser groups.,"SELECT advertiser_parent, SUM(ly_gross_revenue), SUM(cy_gross_revenue) FROM ( /* primary_analysis_sql CTEs */ ) GROUP BY advertiser_parent",strong,medium,25,1a5f7b4e-ea3a-46e4-8b77-b428f4178510,2,"ly_gross_revenue, cy_gross_revenue"
dependency,customer_status_full,"['last_year_lgr', 'this_year_lgr']","Customer Status Full is derived directly from Last Year's Gross Revenue (LGR) and This Year's Gross Revenue (LGR) for each advertiser group, based on predefined thresholds.","IF (@customer_retention_type = '1', 'All', CASE WHEN LY_LGR <= 1 AND TY_LGR > 1 THEN 'NEW BUSINESS' ... END)","This relationship is critical for segmenting customers based on their revenue performance over time, enabling targeted retention and acquisition strategies.",See `dataset_analysis.business_rules_sql` for validation of this logic.,strong,high,26,155c4518-72bf-4309-a0e9-240dd564f421,2,"last_year_lgr, this_year_lgr"
filter_impact,blank_portfolio_flag,"['gross_revenue_amount_base', 'target_base']","The Blank Portfolio Flag is calculated based on the summed gross revenue and target for a portfolio. It is then used as a filter to 'include' or 'exclude' portfolios from the dashboard, effectively removing those with negligible activity.","IF (SUM(gross_revenue_amount / 1000) > 0.01 OR SUM(gross_revenue_amount / 1000) < -0.01 OR SUM(IF(relative_fy_year_offset = 0, target, null)) != 0, 'include', 'exclude')","Ensures that the dashboard focuses on relevant portfolios, improving data signal-to-noise ratio for analysis.","SELECT blank_portfolio_flag, COUNT(*) FROM (/* primary_analysis_sql CTEs up to CalculatedFields */) GROUP BY blank_portfolio_flag;",strong,medium,26,155c4518-72bf-4309-a0e9-240dd564f421,2,"gross_revenue_amount_base, target_base"
mathematical_relationship,current_year_q1_revenue_k,['gross_revenue_amount_base'],"Current Year Q1 Revenue (K) is a filtered sum of the base gross revenue amount, divided by 1000, specifically for the current fiscal year's first quarter.",SUM(gross_revenue_amount_base / 1000) WHERE relative_fy_year_offset = 0 AND relative_fy_quarter_offset = 0,"Provides a standardized view of revenue in thousands for a specific period, facilitating comparisons.","SELECT SUM(CASE WHEN relative_fy_year_offset = 0 AND relative_fy_quarter_offset = 0 THEN SAFE_DIVIDE(gross_revenue_amount, 1000) ELSE NULL END) FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance WHERE SAFE_CAST(financial_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR);",strong,high,26,155c4518-72bf-4309-a0e9-240dd564f421,1,gross_revenue_amount_base
mathematical_relationship,previous_year_q4_revenue_k,['gross_revenue_amount_base'],"Previous Year Q4 Revenue (K) is a filtered sum of the base gross revenue amount, divided by 1000, specifically for the previous fiscal year's fourth quarter.",SUM(gross_revenue_amount_base / 1000) WHERE relative_fy_year_offset = -1 AND relative_fy_quarter_offset = -4,Enables direct comparison of revenue performance against the prior year's closing quarter.,"SELECT SUM(CASE WHEN relative_fy_year_offset = -1 AND relative_fy_quarter_offset = -4 THEN SAFE_DIVIDE(gross_revenue_amount, 1000) ELSE NULL END) FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance WHERE SAFE_CAST(financial_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 YEAR);",strong,high,26,155c4518-72bf-4309-a0e9-240dd564f421,1,gross_revenue_amount_base
mathematical_relationship,current_year_target_k,['target_base'],"Current Year Target (K) is a filtered sum of the base target amount, divided by 1000, specifically for the current fiscal year's first quarter.",SUM(target_base / 1000) WHERE relative_fy_quarter_offset = 0,"Provides a standardized view of target in thousands for the current period, facilitating attainment analysis.","SELECT SUM(CASE WHEN relative_fy_quarter_offset = 0 THEN SAFE_DIVIDE(target, 1000) ELSE NULL END) FROM `ncau-data-newsquery-prd`.asl_finance_derived.adsales_performance WHERE SAFE_CAST(financial_date AS DATE) >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR);",strong,high,26,155c4518-72bf-4309-a0e9-240dd564f421,1,target_base
filter_impact,unique_subscribers,"['total_unique_acquisitions', 'unique_acquisitions_by_source_masthead']","The 'Unique Subscribers' dimension acts as a filter for the acquisition metrics, allowing the dashboard user to narrow down the analysis to specific subscribers. The original query for 'unique_acquisitions_by_source_masthead' shows a hardcoded subscriber ID, indicating this filtering capability.",N/A (filter),"Ensures that acquisition metrics can be analyzed for specific customer segments or individual customers, which is crucial for targeted marketing or customer service insights.","SELECT COUNT(DISTINCT subscription_id_src) FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` WHERE subscriber_id_src = 2452260 AND masthead = 'SC' AND subscription_movement_count_type = 'acquisition' AND movement_datetime >= DATE '2024-07-01' AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY);",strong,high,27,6e8b534b-485a-48dd-842d-13dc6bebb01a,2,"total_unique_acquisitions, unique_acquisitions_by_source_masthead"
hierarchical,total_unique_acquisitions,['unique_acquisitions_by_source_masthead'],"The 'Unique Subscriptions Acquired by Source Masthead' metric represents a breakdown of the 'Total Unique Subscriptions Acquired' by a specific dimension (source masthead code) and with additional, more granular filters (rate plan, specific subscriber). It's a subset analysis.",SUM(unique_acquisitions_by_source_masthead) <= total_unique_acquisitions (equality holds if all filters are removed from the breakdown metric),Allows for understanding the contribution of different acquisition channels/sources to the overall acquisition numbers. The specific filters in the original query suggest a deep dive into particular campaigns or customer segments.,"WITH all_acq AS (SELECT COUNT(DISTINCT subscription_id_src) AS total FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` WHERE masthead = 'SC' AND subscription_movement_count_type = 'acquisition' AND movement_datetime >= DATE '2024-07-01' AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY)), specific_acq AS (SELECT COUNT(DISTINCT subscription_id_src) AS specific FROM `ncau-data-newsquery-prd.prstn_consumer_views.v_subscription_movement` WHERE masthead = 'SC' AND subscription_movement_count_type = 'acquisition' AND movement_datetime >= DATE '2024-07-01' AND movement_datetime < DATETIME_ADD(DATE '2024-08-19', INTERVAL 1 DAY) AND sold_in_rate_plan_code IN ('SC_SDO_AP24AM12', 'SC_SDO_AP20AM12') AND subscriber_id_src = 2452260 AND SUBSTR(sold_in_source_code, 1, 2) IN ('CS')) SELECT (SELECT total FROM all_acq) AS overall_acquisitions, (SELECT specific FROM specific_acq) AS specific_filtered_acquisitions;",strong,high,27,6e8b534b-485a-48dd-842d-13dc6bebb01a,1,unique_acquisitions_by_source_masthead
filter_impact,paid_impressions_sum,"['revenue_gross_sum', 'advertiser_dimension', 'transaction_type_dimension', 'calendar_month_truncated_dimension']","Paid Impressions and Gross Revenue are filtered by specific Advertiser, Transaction Type, and Calendar Month. This defines the scope of the reported metrics.",,Ensures that the reported impressions and revenue pertain only to 'Guaranteed' transactions for 'Chemist Warehouse *' in June 2025.,"SELECT COUNT(*) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` WHERE TransactionType = 'Guaranteed' AND Advertiser = 'Chemist Warehouse *' AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) = DATE '2025-06-01' LIMIT 1;",strong,high,28,87651b69-c43e-471f-9c4b-98df1208a844,4,"revenue_gross_sum, advertiser_dimension, transaction_type_dimension, calendar_month_truncated_dimension"
mathematical_relationship,revenue_gross_sum,['paid_impressions_sum'],Gross Revenue and Paid Impressions are often used together to calculate efficiency metrics like eCPM (effective Cost Per Mille/Thousand Impressions).,eCPM = (RevenueGross_Sum / PaidImpressions_Sum) * 1000,"eCPM provides insight into the revenue generated per thousand impressions, indicating campaign efficiency.","SELECT SAFE_DIVIDE(SUM(SAFE_CAST(RevenueGross AS NUMERIC)), SUM(SAFE_CAST(PaidImpressions AS NUMERIC))) * 1000 AS eCPM FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_cal_month` WHERE TransactionType = 'Guaranteed' AND Advertiser = 'Chemist Warehouse *' AND SAFE_CAST(DATETIME_TRUNC(SAFE_CAST(DATE(CalendarYear, CalendarMonth, 1) AS DATETIME), MONTH) AS DATE) = DATE '2025-06-01' LIMIT 1;",strong,high,28,87651b69-c43e-471f-9c4b-98df1208a844,1,paid_impressions_sum
mathematical_relationship,net_volume_actual_vs_budget_past_weeks,"['actual_volume', 'budget_volume_past_weeks']",Net Volume is calculated as Actual Volume minus Budget Volume for past weeks.,net_volume_actual_vs_budget_past_weeks = actual_volume - budget_volume_past_weeks,"This relationship quantifies the variance from the budget, indicating over or under performance.",SELECT SUM(volume - (CASE WHEN (relative_fisc_week_number < 0) THEN Budget_Volume ELSE NULL END)) = SUM(volume) - SUM(CASE WHEN (relative_fisc_week_number < 0) THEN Budget_Volume ELSE NULL END) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE upper(os_level_6) = 'CIRCULATION' AND gl_hierarchy_code = 'FY2025' AND SAFE_CAST(fiscal_week_id AS STRING) LIKE '2025%',strong,high,29,6a26c78f-0070-4fb3-88b8-691ee4a4485a,2,"actual_volume, budget_volume_past_weeks"
filter_impact,actual_amount,"['channel_group', 'standardized_publication_name_v3_q2']",Actual Amount (and other Query 2 metrics) are filtered specifically for 'Retail' channel group and non-null standardized publication names.,N/A,"This ensures that the reported financial metrics are specific to the retail channel, which is a critical business segment.","SELECT COUNT(*) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os LEFT JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_os_publication_hierachy` AS pub ON os.gl_publication_code = pub.publication_code WHERE (CASE WHEN (os.os_level_10 IN ('Airlines', 'Hotels', 'Other Alternate', 'Other Alternate Channels')) THEN 'Alternative Channels' WHEN (os.os_level_10 IN ('Petrol and Convenience')) THEN 'Convenience Stores / Service Stations' WHEN (os.os_level_10 IN ('Agent & Dist')) THEN 'Newsagencies' WHEN (os.os_level_10 IN ('Home Delivery', 'Roadside Delivery', 'Unspecified Print Sub')) THEN 'Subscriptions' WHEN (os.os_level_10 IN ('Supermarkets')) THEN 'Supermarkets' ELSE 'Unspec Channel' END) = 'Retail' AND (CASE WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('Advertiser', 'Sunday Mail (SA)')) THEN 'The Advertiser' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('Weekly Times')) THEN 'Weekly Times' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('Herald Sun', 'Sunday Herald Sun')) THEN 'The Herald Sun' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('The Daily Telegraph', 'The Sunday Telegraph')) THEN 'The Daily Telegraph' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Toowoomba') THEN 'The Chronicle' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Townsville Bulletin') THEN 'Townsville Bulletin' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Gold Coast Bulletin') THEN 'GCB' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Geelong Advertiser') THEN 'Geelong Advertiser' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Cairns Post') THEN 'Cairns Post' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Sunshine Coast') THEN 'Sunshine Coast' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('Courier Mail', 'Sunday Mail (QLD)')) THEN 'Courier Mail' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('Mercury', 'Sunday Tasmanian')) THEN 'Mercury' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END IN ('Sunday Territorian', 'NT News')) THEN 'Northern Territory News' WHEN (CASE WHEN (os.gl_publication_code = 'Post Courier') THEN 'PNG' ELSE pub.publication_name END = 'Mackay') THEN 'Daily Mercury' ELSE NULL END) IS NOT NULL LIMIT 100",strong,high,29,6a26c78f-0070-4fb3-88b8-691ee4a4485a,2,"channel_group, standardized_publication_name_v3_q2"
hierarchical,publication_state_group,['standardized_publication_name'],Standardized Publication Name rolls up into Publication State Group.,N/A,This hierarchy allows for analysis from individual publication level up to state/regional level.,"SELECT DISTINCT standardized_publication_name_q1, publication_state_group_q1 FROM Derived_Columns WHERE standardized_publication_name_q1 IS NOT NULL AND publication_state_group_q1 IS NOT NULL LIMIT 100",strong,medium,29,6a26c78f-0070-4fb3-88b8-691ee4a4485a,1,standardized_publication_name
dependency,final_volume_metric_1,"['selected_volume_metric', 'publication_group_q2', 'weeks_26_or_40_flag_q2', 'is_aus_or_cm_flag_q2', 'day_of_week_group_q2', 'standardized_publication_name_v2_q2']","Final Volume Metric 1 is a complex calculation that depends on multiple flags, publication types, and day-of-week groupings, applying different division factors (6 or 7) and multipliers (5) based on these conditions.","Complex conditional logic involving SAFE_DIVIDE and multiplication, as detailed in the metric's SQL logic.","This metric provides a highly tailored view of volume, likely reflecting specific business rules for different publication categories and reporting periods (e.g., 6-day vs 7-day publications, special calculations for Sportsman/Weekly Times).",SELECT SUM(final_volume_metric_1) FROM Final_Metrics WHERE final_volume_metric_1 IS NOT NULL LIMIT 1,strong,high,29,6a26c78f-0070-4fb3-88b8-691ee4a4485a,6,"selected_volume_metric, publication_group_q2, weeks_26_or_40_flag_q2, is_aus_or_cm_flag_q2, day_of_week_group_q2, standardized_publication_name_v2_q2"
dependency,final_volume_metric_2,"['selected_volume_metric', 'publication_group_q2', 'is_australian_q2', 'is_courier_mail_q2', 'day_of_week_group_q2', 'standardized_publication_name_v2_q2', 'adjusted_week_diff_final_q2']","Final Volume Metric 2 is another complex calculation, similar to Final Volume Metric 1 but with variations in its conditional logic and division factors, also depending on publication types, day-of-week, and an adjusted week difference.","Complex conditional logic involving SAFE_DIVIDE and multiplication, as detailed in the metric's SQL logic.","This metric likely serves a similar purpose to Final Volume Metric 1 but for a slightly different set of business rules or reporting requirements, providing another tailored view of volume.",SELECT SUM(final_volume_metric_2) FROM Final_Metrics WHERE final_volume_metric_2 IS NOT NULL LIMIT 1,strong,high,29,6a26c78f-0070-4fb3-88b8-691ee4a4485a,7,"selected_volume_metric, publication_group_q2, is_australian_q2, is_courier_mail_q2, day_of_week_group_q2, standardized_publication_name_v2_q2, adjusted_week_diff_final_q2"
filter_impact,advertiser_name,['portfolio_conformed_name_sync'],"The list of `advertiser_name` values displayed in a filter/dropdown is constrained by the selected `portfolio_conformed_name_sync` values. Specifically, only advertisers belonging to the hardcoded list of portfolios are shown.",N/A,"This interaction ensures that users can narrow down the list of advertisers to those relevant to specific, pre-defined portfolios.","SELECT
  COUNT(DISTINCT t0.advertiser_name) AS filtered_advertiser_count
FROM `ncau-data-newsquery-prd.asl_finance_derived.adsales_performance` AS t0
WHERE t0.portfolio_conformed_name_sync IN ('GAD RAM A1', 'HBT RAM A1', 'VIC DIRECT A7', 'VIC DIRECT A8', 'VIC DIRECT A9');",strong,high,30,80ca81f3-0671-40ef-a0a9-825a1580ca1b,1,portfolio_conformed_name_sync
dependency,current_fy_gross_revenue,"['gross_revenue_amount', 'relative_fy_year_offset']","Current FY Gross Revenue is a conditional sum of gross_revenue_amount, filtered by relative_fy_year_offset being 0 (current financial year).","Current_FY_Gross_Revenue = SUM(IF(relative_fy_year_offset = 0, gross_revenue_amount, 0))","Ensures that only revenue from the current financial year contributes to this metric, allowing for accurate year-to-date performance tracking.","SELECT 
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN SAFE_CAST(gross_revenue_amount AS NUMERIC) ELSE 0 END) AS current_fy_gross_revenue_check,
  SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) AS total_gross_revenue_for_fy0_check
FROM 
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly`
WHERE 
  relative_fy_year_offset = 0 
  AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
LIMIT 1;",strong,high,31,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5,2,"gross_revenue_amount, relative_fy_year_offset"
dependency,current_fy_pipeline,"['pipeline', 'relative_fy_year_offset']","Current FY Pipeline is a conditional sum of pipeline, filtered by relative_fy_year_offset being 0 (current financial year).","Current_FY_Pipeline = SUM(IF(relative_fy_year_offset = 0, pipeline, 0))","Ensures that only pipeline from the current financial year contributes to this metric, allowing for accurate current year forecasting.","SELECT 
  SUM(CASE WHEN relative_fy_year_offset = 0 THEN SAFE_CAST(pipeline AS NUMERIC) ELSE 0 END) AS current_fy_pipeline_check,
  SUM(SAFE_CAST(pipeline AS NUMERIC)) AS total_pipeline_for_fy0_check
FROM 
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly`
WHERE 
  relative_fy_year_offset = 0 
  AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED', 'BOOKED')
LIMIT 1;",strong,high,31,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5,2,"pipeline, relative_fy_year_offset"
filter_impact,total_gross_revenue_amount,"['total_pipeline_amount', 'current_fy_gross_revenue', 'current_fy_pipeline']","All primary revenue and pipeline metrics are subject to a common set of filters on financial year offset, transaction status, style name, publishing division, and specific publication rules.",N/A (filter application),"These filters define the scope of 'valid' revenue and pipeline data for reporting, ensuring consistency across all related metrics.","SELECT 
  COUNT(*) as total_records_filtered,
  SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) as filtered_gross_revenue,
  SUM(SAFE_CAST(pipeline AS NUMERIC)) as filtered_pipeline
FROM 
  `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client_weekly`
WHERE
  relative_fy_year_offset IN (-1, 0, 1) AND UPPER(IFNULL(revenue_transaction_status, 'XXX')) IN ('BILLED',
    'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division,
      'XXX')) <> 'MEDIUM RARE CONTENT AGENCY' AND (UPPER(IFNULL(publication_name, 'XXX')) NOT LIKE 'SUDDENLY%' OR
  (UPPER(publication_name) LIKE 'SUDDENLY%' AND account_number IN ('17114', '29172', '52809')))
LIMIT 1;",strong,high,31,8956e94b-f6d1-46a3-9c7f-87a91fbe98b5,3,"total_pipeline_amount, current_fy_gross_revenue, current_fy_pipeline"
dependency,ty_spend_k,"['spend_k', 'ty_ly_embed']",TY Spend ('000) is calculated by summing Spend ('000) only for records identified as 'This Year' by the `ty_ly_embed` logic.,TY_Spend_K = SUM(Spend_K WHERE ty_ly_embed = 'ty'),Ensures that current period performance is accurately aggregated based on the chosen time comparison method.,SELECT SUM(CASE WHEN ty_ly_embed = 'ty' THEN Spend_K ELSE 0 END) AS calculated_ty_spend_k FROM primary_analysis_sql_cte_output;,strong,high,32,601ed0d2-e944-4189-8170-d593c8e72026,2,"spend_k, ty_ly_embed"
dependency,ly_spend_k,"['spend_k', 'ty_ly_embed']",LY Spend ('000) is calculated by summing Spend ('000) only for records identified as 'Last Year' by the `ty_ly_embed` logic.,LY_Spend_K = SUM(Spend_K WHERE ty_ly_embed = 'ly'),Ensures that historical period performance is accurately aggregated for comparison.,SELECT SUM(CASE WHEN ty_ly_embed = 'ly' THEN Spend_K ELSE 0 END) AS calculated_ly_spend_k FROM primary_analysis_sql_cte_output;,strong,high,32,601ed0d2-e944-4189-8170-d593c8e72026,2,"spend_k, ty_ly_embed"
filter_impact,ty_spend_k,"['portfolio_parent_group_name', 'calendar_quarter', 'advertiser']","The `TY_Spend_K` (and other spend metrics) are filtered by specific values of `portfolio_parent_group_name`, `Calendar_Quarter`, and a long list of `Advertiser` names. These filters significantly narrow down the dataset for analysis.",N/A (filtering),"These filters define the specific segments of advertising spend being analyzed (e.g., 'KEY ACCOUNTS TRAVEL' in Q2, or specific government advertisers).",SELECT COUNT(*) FROM primary_analysis_sql_cte_output WHERE portfolio_parent_group_name = 'KEY ACCOUNTS TRAVEL' AND Calendar_Quarter = 'Q2';,strong,high,32,601ed0d2-e944-4189-8170-d593c8e72026,3,"portfolio_parent_group_name, calendar_quarter, advertiser"
hierarchical,total_advertiser_ty_spend_k,"['news_corp_ty_spend_k', 'youtube_ty_spend_k', 'facebook_ty_spend_k']","The `Total_Advertiser_TY_Spend_K` represents the sum of all `TY_Spend_K` for a given Advertiser, which includes contributions from specific media networks like 'NEWS CORP', 'youtube', and 'facebook'. These are calculated using window functions partitioned by Advertiser.",Total_Advertiser_TY_Spend_K = SUM(NEWS_CORP_TY_Spend_K + Youtube_TY_Spend_K + Facebook_TY_Spend_K + Other_Media_Networks_TY_Spend_K) OVER (PARTITION BY Advertiser),"Allows for a breakdown of an advertiser's total spend by media network, providing insights into channel allocation.","SELECT Advertiser, SUM(NEWS_CORP_TY_Spend_K + Youtube_TY_Spend_K + Facebook_TY_Spend_K) AS sum_specific_networks, Total_Advertiser_TY_Spend_K FROM primary_analysis_sql_cte_output GROUP BY Advertiser, Total_Advertiser_TY_Spend_K HAVING sum_specific_networks <= Total_Advertiser_TY_Spend_K;",strong,medium,32,601ed0d2-e944-4189-8170-d593c8e72026,3,"news_corp_ty_spend_k, youtube_ty_spend_k, facebook_ty_spend_k"
inconsistency,ty_ly_embed,['max_fin_year'],The definition of 'ty' and 'ly' for 'Financial Year' differs between Query 1 and Queries 2/3. Query 1 defines 'ty' as the current financial year and 'ly' as the previous financial year. Queries 2/3 define 'ty' as the previous financial year and 'ly' as the financial year before that.,N/A (logic inconsistency),"This inconsistency can lead to different results for 'This Year' and 'Last Year' spend when comparing different dashboard components, causing confusion and distrust in data.",See `business_rules_sql` for validation.,strong,high,32,601ed0d2-e944-4189-8170-d593c8e72026,1,max_fin_year
dependency,total_revenue_net_by_product_type,"['revenue_net', 'product_type']","Total Revenue Net by Product Type is an aggregation of Revenue Net, grouped by Product Type.",SUM(revenue_net) GROUP BY product_type,Ensures that revenue is correctly attributed to specific product lines.,"SELECT ProductType, SUM(RevenueNet) FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` GROUP BY ProductType LIMIT 10;",strong,high,33,b15d856f-e3ce-4991-bf2a-92395390524f,2,"revenue_net, product_type"
dependency,transaction_type_category,['transaction_type'],"Transaction Type Category is a derived dimension based on the raw Transaction Type, applying specific business rules.","CASE WHEN (TransactionType IN ('AG', 'PG - CPM', 'PG - CPD')) THEN 'Guaranteed' ... ELSE TransactionType END",Validates that raw transaction types are correctly mapped to their higher-level business categories.,"SELECT TransactionType, CASE WHEN (SAFE_CAST(TransactionType AS STRING) = 'AG' OR SAFE_CAST(TransactionType AS STRING) = 'PG - CPM' OR SAFE_CAST(TransactionType AS STRING) = 'PG - CPD') THEN 'Guaranteed' WHEN (SAFE_CAST(TransactionType AS STRING) = 'Deal' OR SAFE_CAST(TransactionType AS STRING) = 'pmp' OR SAFE_CAST(TransactionType AS STRING) = 'PMP_DEAL' OR SAFE_CAST(TransactionType AS STRING) = 'UFR') THEN 'Deal' WHEN (SAFE_CAST(TransactionType AS STRING) = 'Open Auction' OR SAFE_CAST(TransactionType AS STRING) = 'RTB' OR SAFE_CAST(TransactionType AS STRING) = 'Unknown') THEN 'Open Auction' ELSE SAFE_CAST(TransactionType AS STRING) END AS TransactionTypeCategory FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view` LIMIT 100;",strong,medium,33,b15d856f-e3ce-4991-bf2a-92395390524f,1,transaction_type
dependency,total_revenue_net_by_transaction_type_category,"['revenue_net', 'transaction_type_category']","Total Revenue Net by Transaction Type Category is an aggregation of Revenue Net, grouped by the derived Transaction Type Category.",SUM(revenue_net) GROUP BY transaction_type_category,"Ensures that revenue is correctly attributed to different programmatic deal types (e.g., Guaranteed, Deal, Open Auction).","WITH categorized_data AS (SELECT SAFE_CAST(RevenueNet AS NUMERIC) AS RevenueNet, CASE WHEN (SAFE_CAST(TransactionType AS STRING) = 'AG' OR SAFE_CAST(TransactionType AS STRING) = 'PG - CPM' OR SAFE_CAST(TransactionType AS STRING) = 'PG - CPD') THEN 'Guaranteed' WHEN (SAFE_CAST(TransactionType AS STRING) = 'Deal' OR SAFE_CAST(TransactionType AS STRING) = 'pmp' OR SAFE_CAST(TransactionType AS STRING) = 'PMP_DEAL' OR SAFE_CAST(TransactionType AS STRING) = 'UFR') THEN 'Deal' WHEN (SAFE_CAST(TransactionType AS STRING) = 'Open Auction' OR SAFE_CAST(TransactionType AS STRING) = 'RTB' OR SAFE_CAST(TransactionType AS STRING) = 'Unknown') THEN 'Open Auction' ELSE SAFE_CAST(TransactionType AS STRING) END AS TransactionTypeCategory FROM `ncau-data-newsquery-prd.prstn_advertising.programmatic_60_day_view`) SELECT TransactionTypeCategory, SUM(RevenueNet) FROM categorized_data GROUP BY TransactionTypeCategory LIMIT 10;",strong,high,33,b15d856f-e3ce-4991-bf2a-92395390524f,2,"revenue_net, transaction_type_category"
dependency,gross_revenue_performance_or_programmatic,"['gross_revenue_amount', 'channel_type', 'is_programmatic_source']",This metric is a conditional selection of `gross_revenue_amount` based on whether the `channel_type` is 'PERFORMANCE' or if it's identified as a 'PROGRAMMATIC SOURCE'.,IF channel_type = 'PERFORMANCE' THEN gross_revenue_amount ELSE (IF is_programmatic_source THEN gross_revenue_amount ELSE NULL),Ensures that only relevant revenue streams are included for programmatic and performance reporting.,"SELECT SUM(CASE WHEN channel_type = 'PERFORMANCE' THEN gross_revenue_amount ELSE (CASE WHEN is_programmatic_source THEN gross_revenue_amount ELSE NULL END) END) FROM base_data WHERE reporting_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)",strong,high,34,5491badf-5ec0-4b4f-a427-b12a3a3395dd,3,"gross_revenue_amount, channel_type, is_programmatic_source"
dependency,gross_revenue_tubi_performance_or_programmatic,"['gross_revenue_amount', 'channel_type', 'is_programmatic_source']",This metric is a conditional selection of `gross_revenue_amount` based on whether the `channel_type` is 'TUBI' or 'PERFORMANCE' or if it's identified as a 'PROGRAMMATIC SOURCE'.,"IF channel_type IN ('TUBI', 'PERFORMANCE') THEN gross_revenue_amount ELSE (IF is_programmatic_source THEN gross_revenue_amount ELSE NULL)","Ensures that revenue from Tubi, Performance, and Programmatic sources are grouped for specific reporting needs.","SELECT SUM(CASE WHEN channel_type IN ('TUBI', 'PERFORMANCE') THEN gross_revenue_amount ELSE (CASE WHEN is_programmatic_source THEN gross_revenue_amount ELSE NULL END) END) FROM base_data WHERE reporting_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)",strong,high,34,5491badf-5ec0-4b4f-a427-b12a3a3395dd,3,"gross_revenue_amount, channel_type, is_programmatic_source"
filter_impact,current_fy_tubi_performance_programmatic_revenue_before_hardcoded_date,['current_fy_tubi_performance_programmatic_revenue'],"This metric is a subset of `current_fy_tubi_performance_programmatic_revenue`, further filtered by a hardcoded date (`reporting_date < '2025-06-18'`). This suggests a specific reporting cut-off or a comparison against a fixed target date.",SUM(gross_revenue_tubi_performance_or_programmatic) WHERE relative_fy_year_offset = 0 AND reporting_date < '2025-06-18',Highlights the importance of the hardcoded date for specific period analysis. This relationship should be dynamic (parameterized date) for future use.,SELECT SUM(current_fy_tubi_performance_programmatic_revenue_before_hardcoded_date) <= SUM(current_fy_tubi_performance_programmatic_revenue) FROM primary_analysis_sql_output,strong,high,34,5491badf-5ec0-4b4f-a427-b12a3a3395dd,1,current_fy_tubi_performance_programmatic_revenue
hierarchical,total_gross_revenue,"['current_fy_total_revenue', 'prev_fy_total_revenue', 'current_fy_tubi_revenue', 'current_fy_performance_revenue', 'current_fy_pmp_revenue', 'current_fy_pg_revenue', 'current_fy_omp_revenue']","Total Gross Revenue is the highest-level aggregation. Other revenue metrics represent subsets or specific segments (e.g., current/previous FY, specific channels) of this total.",total_gross_revenue = SUM(all segments),"Ensures that segmented revenue figures roll up correctly to the overall total, providing a consistent view of financial performance.",SELECT SUM(total_gross_revenue) FROM primary_analysis_sql_output,strong,high,34,5491badf-5ec0-4b4f-a427-b12a3a3395dd,7,"current_fy_total_revenue, prev_fy_total_revenue, current_fy_tubi_revenue, current_fy_performance_revenue, current_fy_pmp_revenue, current_fy_pg_revenue, current_fy_omp_revenue"
mathematical_relationship,current_fy_gross_revenue_k,['current_fy_gross_revenue_raw'],Current FY Gross Revenue ('000) is derived by dividing Current FY Gross Revenue (Raw) by 1000 for display purposes.,current_fy_gross_revenue_k = current_fy_gross_revenue_raw / 1000,Ensures large revenue figures are presented in a more readable format for high-level analysis.,SELECT SUM(current_fy_gross_revenue_k * 1000) - SUM(current_fy_gross_revenue_raw) AS difference FROM your_unified_data_source WHERE financial_year = (SELECT MAX(financial_year) FROM your_unified_data_source WHERE relative_fy_year_offset = 0),strong,medium,35,52c11c9c-052a-4e45-9cda-8fecd87d7964,1,current_fy_gross_revenue_raw
mathematical_relationship,previous_fy_gross_revenue_k,['previous_fy_gross_revenue_raw'],Previous FY Gross Revenue ('000) is derived by dividing Previous FY Gross Revenue (Raw) by 1000 for display purposes.,previous_fy_gross_revenue_k = previous_fy_gross_revenue_raw / 1000,Ensures large revenue figures are presented in a more readable format for year-over-year comparisons.,SELECT SUM(previous_fy_gross_revenue_k * 1000) - SUM(previous_fy_gross_revenue_raw) AS difference FROM your_unified_data_source WHERE financial_year = (SELECT MAX(financial_year) FROM your_unified_data_source WHERE relative_fy_year_offset = 1),strong,medium,35,52c11c9c-052a-4e45-9cda-8fecd87d7964,1,previous_fy_gross_revenue_raw
filter_impact,current_fy_gross_revenue_raw,['gross_revenue_amount_base'],"Current FY Gross Revenue (Raw) is a subset of the base gross revenue, specifically filtered for the current financial year.",SUM(current_fy_gross_revenue_raw) = SUM(gross_revenue_amount_base WHERE relative_fy_year_offset = 0),Ensures that current period performance is accurately isolated for analysis.,"SELECT SUM(CASE WHEN relative_fy_year_offset = 0 THEN gross_revenue_amount ELSE 0 END) AS current_fy_sum, SUM(gross_revenue_amount) AS total_sum FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` WHERE relative_fy_year_offset = 0",strong,high,35,52c11c9c-052a-4e45-9cda-8fecd87d7964,1,gross_revenue_amount_base
filter_impact,previous_fy_gross_revenue_raw,['gross_revenue_amount_base'],"Previous FY Gross Revenue (Raw) is a subset of the base gross revenue, specifically filtered for the previous financial year.",SUM(previous_fy_gross_revenue_raw) = SUM(gross_revenue_amount_base WHERE relative_fy_year_offset = 1),Ensures that prior period performance is accurately isolated for historical comparison.,"SELECT SUM(CASE WHEN relative_fy_year_offset = 1 THEN gross_revenue_amount ELSE 0 END) AS previous_fy_sum, SUM(gross_revenue_amount) AS total_sum FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` WHERE relative_fy_year_offset = 1",strong,high,35,52c11c9c-052a-4e45-9cda-8fecd87d7964,1,gross_revenue_amount_base
conditional_logic,conditional_gross_revenue_k,"['gross_revenue_amount_base', 'unified_publication_name', 'advertiser_parent', 'booking_line_created_date', 'relative_fy_year_offset']","This metric applies complex conditional logic to the base gross revenue, filtering by current FY, specific publication names, or a combination of advertiser parent ('DOUBLECLICK') and a specific date condition.","conditional_gross_revenue_k = SUM(gross_revenue_amount_base WHERE (relative_fy_year_offset = 0 AND unified_publication_name IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE')) OR (relative_fy_year_offset = 0 AND SAFE_CAST(booking_line_created_date AS DATETIME) <= DATETIME_ADD(CURRENT_DATE('Australia/Sydney'), INTERVAL -365 DAY) AND advertiser_parent = 'DOUBLECLICK')) / 1000","Identifies a specific segment of revenue that requires detailed tracking, potentially for programmatic or specific digital channels.","SELECT SUM(conditional_gross_revenue_k * 1000) AS calculated_conditional_revenue, SUM(CASE WHEN (relative_fy_year_offset = 0 AND UPPER(unified_publication_name) IN ('OUTSTREAM', 'XTEND', 'EDMEDIA', 'ECOMMERCE')) OR (relative_fy_year_offset = 0 AND SAFE_CAST(booking_line_created_date AS DATETIME) <= DATETIME_ADD(CURRENT_DATE('Australia/Sydney'), INTERVAL -365 DAY) AND UPPER(advertiser_parent) = 'DOUBLECLICK') THEN gross_revenue_amount ELSE 0 END) AS direct_conditional_revenue FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` WHERE (relative_fy_year_offset IN (-1, 0, 1) OR relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED') AND UPPER(IFNULL(style_name, 'XXX')) <> 'ROP COMPOSITE' AND UPPER(IFNULL(source_publishing_division_name, 'XXX')) <> 'MEDIUM RARE CONTENT AGENCY'",strong,high,35,52c11c9c-052a-4e45-9cda-8fecd87d7964,5,"gross_revenue_amount_base, unified_publication_name, advertiser_parent, booking_line_created_date, relative_fy_year_offset"
hierarchical,ad_type_grouping_dimension,"['adtype_l1', 'fin_adtype_name', 'revenue_group_subtype', 'revenue_type']","The 'Ad Type Grouping Dimension' is a derived, higher-level classification of ad types, built upon more granular ad type fields from the source data. It consolidates different classification logics found in the original queries.",N/A (categorical derivation),"Provides a consistent and simplified view of ad types for reporting, abstracting away complex underlying logic.","SELECT ad_type_grouping_dimension, COUNT(*) FROM (SELECT CASE WHEN ASL.fin_adtype_name = 'XTEND' THEN 'XTEND' WHEN ASL.sync_portfolio_parent_group_name = 'DIGITAL OTHER' AND ASL.revenue_group_subtype = 'DIGITAL' THEN 'PROGRAMMATIC - DIGITAL OTHER' WHEN ASL.revenue_group_subtype = 'PROGRAMMATIC SOURCE' AND SAFE.LEFT(UPPER(ASL.cost_model_type_code), 3) = 'GUA' THEN 'PROGRAMMATIC - GUARANTEED' WHEN ASL.revenue_group_subtype = 'PROGRAMMATIC SOURCE' AND SAFE.LEFT(UPPER(ASL.cost_model_type_code), 3) = 'NON' THEN 'PROGRAMMATIC - OPEN EXCHANGE' WHEN ASL.revenue_group_subtype = 'PROGRAMMATIC SOURCE' AND SAFE.LEFT(UPPER(ASL.cost_model_type_code), 3) = 'PMP' THEN 'PROGRAMMATIC - PMP' WHEN ASL.revenue_group_subtype = 'DIGITAL' THEN 'ADPT DIGITAL' WHEN SAFE.LEFT(ASL.revenue_group_subtype, 6) = 'SUNDRY' THEN 'SUNDRY' ELSE ASL.revenue_group_subtype END AS ad_type_grouping_dimension FROM `ncau-data-newsquery-prd.asl_advertising.adsales_revenue_performance_daily` AS ASL WHERE (ASL.relative_fy_year_offset IN (-1, 0, 1) OR ASL.relative_cal_year_offset IN (-1, 0)) AND UPPER(IFNULL(ASL.revenue_transaction_status_code, 'XXX')) IN ('BILLED', 'BOOKED')) GROUP BY ad_type_grouping_dimension",strong,medium,35,52c11c9c-052a-4e45-9cda-8fecd87d7964,4,"adtype_l1, fin_adtype_name, revenue_group_subtype, revenue_type"
mathematical_relationship,closing_base,"['opening_base', 'add_volume', 'red_volume', 'transfer_in', 'transfer_out']","The closing base is typically calculated from the opening base, adjusted by additions, reductions, and transfers.",closing_base = opening_base + add_volume - red_volume + transfer_in - transfer_out,This formula represents the fundamental flow of subscriptions and is critical for base reconciliation and forecasting.,"SELECT
  fiscal_week_id,
  gl_publication_code,
  category_name,
  SUM(opening_base) + SUM(add_volume) - SUM(red_volume) + SUM(transfer_in) - SUM(transfer_out) AS calculated_closing_base,
  SUM(closing_base) AS actual_closing_base,
  ABS(SUM(closing_base) - (SUM(opening_base) + SUM(add_volume) - SUM(red_volume) + SUM(transfer_in) - SUM(transfer_out))) AS difference
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`
WHERE SAFE_CAST(fiscal_week_id AS INT64) = (SELECT MAX(SAFE_CAST(fiscal_week_id AS INT64)) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`)
GROUP BY fiscal_week_id, gl_publication_code, category_name
HAVING ABS(SUM(closing_base) - (SUM(opening_base) + SUM(add_volume) - SUM(red_volume) + SUM(transfer_in) - SUM(transfer_out))) > 0.01 -- Check for small discrepancies
LIMIT 10;",strong,high,36,23c8b213-a9f0-4158-b8fa-bff14425abb5,5,"opening_base, add_volume, red_volume, transfer_in, transfer_out"
filter_impact,fiscal_week_id,"['add_volume', 'earned_amount', 'closing_base', 'opening_base', 'red_volume', 'transfer_in', 'transfer_out']","The 'fiscal_week_id' acts as a primary filter, constraining all subscription-related metrics to a specific reporting period.",N/A,"Ensures that all reported subscription metrics are consistent for the selected fiscal week, crucial for period-over-period analysis.","SELECT
  'Filter Impact Check' as test_type,
  COUNT(*) as records_for_hardcoded_week,
  SUM(SAFE_CAST(earned_amount AS NUMERIC)) as earned_amount_for_hardcoded_week
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_subscriptions`
WHERE SAFE_CAST(fiscal_week_id AS INT64) = 202535
LIMIT 1;",strong,high,36,23c8b213-a9f0-4158-b8fa-bff14425abb5,7,"add_volume, earned_amount, closing_base, opening_base, red_volume, transfer_in, transfer_out"
mathematical_relationship,net_circulation_revenue,"['home_del_charge', 'returns_credit_amount', 'rev_adjust']","Net circulation revenue is derived from home delivery charges, adjusted by returns credits and other revenue adjustments.",net_circulation_revenue = home_del_charge - returns_credit_amount + rev_adjust,This calculation provides the true revenue from circulation after accounting for all deductions and adjustments.,"SELECT
  channel,
  state,
  SUM(SAFE_CAST(home_del_charge AS NUMERIC)) - SUM(SAFE_CAST(returns_credit_amount AS NUMERIC)) + SUM(SAFE_CAST(rev_adjust AS NUMERIC)) AS calculated_net_rev,
  SUM(SAFE_CAST(home_del_charge AS NUMERIC)) AS total_home_del_charge
FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_tm1_pbf_circulation_actuals`
GROUP BY channel, state
LIMIT 10;",strong,high,36,23c8b213-a9f0-4158-b8fa-bff14425abb5,3,"home_del_charge, returns_credit_amount, rev_adjust"
mathematical_relationship,total_gross_revenue_amount,"['total_gross_revenue_ex_adj_amount', 'total_adjustment_amount']","Gross Revenue Amount is likely related to Gross Revenue Excl. Adjustment Amount and Adjustment Amount. It's common for Gross Revenue to be (Gross Revenue Excl. Adjustment) + Adjustment, or similar.",total_gross_revenue_amount = total_gross_revenue_ex_adj_amount + total_adjustment_amount (Hypothesized),This relationship defines how adjustments impact the overall gross revenue. Validating this ensures the financial calculations are consistent.,"SELECT
  SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) AS total_gross_revenue,
  SUM(SAFE_CAST(gross_revenue_ex_adj_amount AS NUMERIC)) AS total_gross_revenue_ex_adj,
  SUM(SAFE_CAST(adjustment_amount AS NUMERIC)) AS total_adjustment,
  CASE
    WHEN SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) = SUM(SAFE_CAST(gross_revenue_ex_adj_amount AS NUMERIC)) + SUM(SAFE_CAST(adjustment_amount AS NUMERIC))
    THEN 'PASS'
    ELSE 'FAIL'
  END AS validation_status
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  revenue_transaction_status IN ('Booked', 'Billed')
  AND financial_year = '2025'
LIMIT 1;",strong,high,37,a17622e2-ad43-49cc-b3c5-19c95036fd14,2,"total_gross_revenue_ex_adj_amount, total_adjustment_amount"
filter_impact,total_rebate_3_amount,"['total_gross_revenue_ex_adj_amount', 'total_gross_revenue_amount']","The filter `rebate_3_amount != 0.000000` directly impacts the data included for all metrics in queries where it's applied, not just the rebate amount itself.",N/A,Understanding that filtering on a specific metric (rebate amount) can affect the totals of other metrics (gross revenue) is crucial for accurate interpretation of the dashboard.,"SELECT
  SUM(CASE WHEN rebate_3_amount != 0.000000 THEN SAFE_CAST(gross_revenue_amount AS NUMERIC) ELSE 0 END) AS gross_revenue_with_rebate_filter,
  SUM(SAFE_CAST(gross_revenue_amount AS NUMERIC)) AS total_gross_revenue_without_rebate_filter
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client`
WHERE
  revenue_transaction_status IN ('Booked', 'Billed')
  AND financial_year = '2025'
LIMIT 1;",strong,medium,37,a17622e2-ad43-49cc-b3c5-19c95036fd14,2,"total_gross_revenue_ex_adj_amount, total_gross_revenue_amount"
dependency,fiscal_year_2025_product_revenue_sum,"['product_revenue_sum', 'fiscal_year']",This metric is a specific slice of 'Product Revenue Sum' filtered for the hardcoded Fiscal Year 2025.,SUM(Product_Revenue) WHERE Fiscal_Year = 2025,Ensures that the 2025 revenue target/forecast is correctly isolated from the overall product revenue.,SELECT SUM(SAFE_CAST(Product_Revenue AS NUMERIC)) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_pacman_running_expense` WHERE SAFE_CAST(Fiscal_Year AS INT64) = 2025;,strong,high,38,6de90f2a-b3f3-46fe-a4fe-13474b2d6618,2,"product_revenue_sum, fiscal_year"
hierarchical,dynamic_product_category,"['product_l3', 'product_l4', 'product_l1', 'product_l2', 'product_name', 'category']","The 'Dynamic Product Category' dimension allows users to switch between different levels of product hierarchy (L1, L2, L3, L4, Product Name, or a general Category) for analysis.",CASE WHEN parameter = 'Product_L3' THEN Product_L3 ... END,Provides flexible reporting on product performance at various aggregation levels.,SELECT DISTINCT SAFE_CAST(Product_L3 AS STRING) FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` LIMIT 10;,strong,high,38,6de90f2a-b3f3-46fe-a4fe-13474b2d6618,6,"product_l3, product_l4, product_l1, product_l2, product_name, category"
comparison,product_revenue_sum,['product_revenue_merged_one_row_sum'],"These two metrics represent product revenue, but 'Merged One Row' suggests a specific aggregation or de-duplication logic applied upstream. Comparing them can reveal the impact of this merging process.",N/A (comparison),Understanding the difference between raw and merged revenue is crucial for data accuracy and consistency in reporting.,"SELECT SUM(SAFE_CAST(Product_Revenue AS NUMERIC)) AS raw_revenue, SUM(SAFE_CAST(Product_Revenue_Merged_OneRow AS NUMERIC)) AS merged_revenue FROM `ncau-data-newsquery-prd.sbx_fda_corefin.dv_exclude_product_l3_and_l4` WHERE SAFE_CAST(Fiscal_Year AS INT64) = EXTRACT(YEAR FROM CURRENT_DATE()) - 1;",medium,medium,38,6de90f2a-b3f3-46fe-a4fe-13474b2d6618,1,product_revenue_merged_one_row_sum
dependency,total_actual_amount,['actual_amount'],Total Actual Amount is the sum of individual Actual Amounts.,SUM(Actual_Amount),Ensures that the aggregated actuals accurately reflect the sum of underlying transactions.,SELECT SUM(SAFE_CAST(Actual_Amount AS NUMERIC)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE SAFE_CAST(fiscal_week_id AS INT64) = (SELECT MAX(SAFE_CAST(fiscal_week_id AS INT64)) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` LIMIT 1);,strong,high,39,d7412673-0af1-4efe-8374-ca475b001fb6,1,actual_amount
filter_impact,total_actual_amount,"['fy_year', 'source_system_name']",Total Actual Amount is calculated after filtering by period control and grouped by Fiscal Year and Source System Name.,"SUM(Actual_Amount) GROUP BY fy_year, source_system_name",Ensures that financial totals are presented within the correct fiscal periods and organizational segments.,"SELECT COUNT(DISTINCT SAFE_CAST(calendar.fy_year AS INT64)), COUNT(DISTINCT os.source_system_name) FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` AS os JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_calendar` AS calendar ON SAFE_CAST(os.fiscal_week_id AS INT64) = SAFE_CAST(calendar.fy_year_week_number AS INT64) JOIN `ncau-data-newsquery-prd.asl_finance.v_asl_DIM_period_control` AS control ON SAFE_CAST(control.source_week_number AS INT64) = SAFE_CAST(calendar.fy_year_week_number AS INT64) WHERE control.period_name IN ('CP', 'PY') LIMIT 1;",strong,high,39,d7412673-0af1-4efe-8374-ca475b001fb6,2,"fy_year, source_system_name"
comparison,actual_amount,"['budget_amount', 'forecast_amount', 'last_year_actual_amount']","Actual Amount is frequently compared against Budget, Forecast, and Last Year's Actuals to assess performance.","Actual vs. Budget (Actual - Budget), Actual vs. Forecast (Actual - Forecast), YoY Growth ((Actual - Last_Year_Actual) / Last_Year_Actual)","These comparisons are fundamental for financial performance analysis, variance reporting, and strategic planning.",SELECT SAFE_CAST(Actual_Amount AS NUMERIC) - SAFE_CAST(Budget_Amount AS NUMERIC) AS actual_vs_budget_variance FROM `ncau-data-newsquery-prd.asl_finance.v_asl_FCT_finance_os_aggregated` WHERE Actual_Amount IS NOT NULL AND Budget_Amount IS NOT NULL LIMIT 10;,strong,high,39,d7412673-0af1-4efe-8374-ca475b001fb6,3,"budget_amount, forecast_amount, last_year_actual_amount"
mathematical_relationship,total_revenue_v,"['revenue_3rd_party_v', 'revenue_campus_v', 'revenue_consumer_v', 'revenue_corp_v', 'revenue_other_v']",Total Revenue (Current Period) is the sum of various revenue streams for the current period.,Total_Revenue_V = Revenue_3rd_Party_V + Revenue_Campus_V + Revenue_Consumer_V + Revenue_Corp_V + Revenue_Other_V,Ensures all revenue sources are accounted for in the overall total.,SELECT SUM(Total_Revenue_V) - SUM(Revenue_3rd_Party_V + Revenue_Campus_V + Revenue_Consumer_V + Revenue_Corp_V + Revenue_Other_V) AS revenue_variance FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025),strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,5,"revenue_3rd_party_v, revenue_campus_v, revenue_consumer_v, revenue_corp_v, revenue_other_v"
mathematical_relationship,total_revenue,"['revenue_3rd_party', 'revenue_campus', 'revenue_consumer', 'revenue_corp', 'revenue_other']",Total Revenue (Base) is the sum of various revenue streams.,Total_Revenue = Revenue_3rd_Party + Revenue_Campus + Revenue_Consumer + Revenue_Corp + Revenue_Other,Ensures all revenue sources are accounted for in the overall total.,SELECT SUM(Total_Revenue) - SUM(Revenue_3rd_Party + Revenue_Campus + Revenue_Consumer + Revenue_Corp + Revenue_Other) AS revenue_variance FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025),strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,5,"revenue_3rd_party, revenue_campus, revenue_consumer, revenue_corp, revenue_other"
mathematical_relationship,total_revenue_6w,"['revenue_3rd_party_6w', 'revenue_campus_6w', 'revenue_consumer_6w', 'revenue_corp_6w', 'revenue_other_6w']",Total Revenue (6-Week Rolling) is the sum of various revenue streams over the 6-week period.,Total_Revenue_6W = Revenue_3rd_Party_6W + Revenue_Campus_6W + Revenue_Consumer_6W + Revenue_Corp_6W + Revenue_Other_6W,Ensures all revenue sources are accounted for in the overall 6-week total.,SELECT SUM(Total_Revenue_6W) - SUM(Revenue_3rd_Party_6W + Revenue_Campus_6W + Revenue_Consumer_6W + Revenue_Corp_6W + Revenue_Other_6W) AS revenue_variance FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year BETWEEN (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025) - 5 AND (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025),strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,5,"revenue_3rd_party_6w, revenue_campus_6w, revenue_consumer_6w, revenue_corp_6w, revenue_other_6w"
dependency,net_growth_incl_3rd_party_v,"['net_growth_consumer_v', 'net_growth_3rd_party_v']",Net Growth (incl. 3rd Party) is expected to be the sum of Net Growth Consumer and Net Growth 3rd Party.,Net_Growth_incl_3rd_Party_V = Net_Growth_Consumer_V + Net_Growth_3rd_Party_V,Confirms the overall growth metric correctly aggregates its components.,SELECT SUM(Net_Growth_incl_3rd_Party_V) - SUM(Net_Growth_Consumer_V + Net_Growth_3rd_Party_V) AS growth_variance FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025),strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,2,"net_growth_consumer_v, net_growth_3rd_party_v"
dependency,net_growth_incl_3rd_party,"['net_growth_consumer', 'net_growth_3rd_party']",Net Growth (incl. 3rd Party) is expected to be the sum of Net Growth Consumer and Net Growth 3rd Party (base metrics).,Net_Growth_incl_3rd_Party = Net_Growth_Consumer + Net_Growth_3rd_Party,Confirms the overall growth metric correctly aggregates its components.,SELECT SUM(Net_Growth_incl_3rd_Party) - SUM(Net_Growth_Consumer + Net_Growth_3rd_Party) AS growth_variance FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025),strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,2,"net_growth_consumer, net_growth_3rd_party"
dependency,net_growth_incl_3rd_party_6w,"['net_growth_consumer_6w', 'net_growth_3rd_party_6w']",Net Growth (incl. 3rd Party) (6-Week Rolling) is expected to be the sum of Net Growth Consumer and Net Growth 3rd Party over the 6-week period.,Net_Growth_incl_3rd_party_6W = Net_Growth_Consumer_6W + Net_Growth_3rd_Party_6W,Confirms the overall 6-week growth metric correctly aggregates its components.,SELECT SUM(Net_Growth_incl_3rd_party_6W) - SUM(Net_Growth_Consumer_6W + Net_Growth_3rd_Party_6W) AS growth_variance FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year BETWEEN (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025) - 5 AND (SELECT MAX(fy_week_of_year) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025),strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,2,"net_growth_consumer_6w, net_growth_3rd_party_6w"
hierarchical,masthead,"['masthead_name', 'masthead_group_states_community', 'masthead_group_metro_regionals']","Masthead codes are grouped into human-readable names and broader categories (States/Community, Metro/Regionals).",N/A,Ensures consistent and accurate categorization of mastheads for reporting.,"SELECT masthead, masthead_name, masthead_group_states_community, masthead_group_metro_regionals FROM (
    SELECT
      t0.masthead,
      CASE WHEN t0.masthead = 'TA' THEN 'The Australian' ELSE NULL END AS masthead_name,
      CASE WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA') THEN 'Metro' ELSE NULL END AS masthead_group_metro_regionals,
      CASE WHEN t0.masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT') THEN 'States and Community' ELSE NULL END AS masthead_group_states_community
    FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` AS t0
) GROUP BY 1,2,3,4 LIMIT 100",strong,medium,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,3,"masthead_name, masthead_group_states_community, masthead_group_metro_regionals"
filter_impact,fy_year,['fy_week_of_year'],"Metrics are filtered by specific fiscal year and week combinations, often hardcoded to a 'current' fiscal year (2025) and a calculated week based on a fixed date.",N/A,"Ensures the dashboard displays data for the intended reporting period, but hardcoding limits flexibility.","SELECT fy_year, fy_week_of_year, SUM(Total_Revenue) FROM `ncau-data-newsquery-prd.asl_finance_derived.consumer_masthead_scorecard` WHERE fy_year = 2025 AND fy_week_of_year = (SELECT DATETIME_DIFF(SAFE_CAST(DATE('2025-03-30') AS DATETIME), SAFE_CAST(DATE('2024-07-03') AS DATETIME), WEEK) - 1) GROUP BY 1,2",strong,high,40,57d87efe-c112-4d42-be1b-045f0c8ca73e,1,fy_week_of_year
dependency,amount_rev_type_03,['total_amount'],"Amount for Revenue Type '03' is a conditional subset of Total Amount, representing the portion of total financial value attributed to a specific revenue type ('03').","amount_rev_type_03 = SUM(CASE WHEN LEFT(revenue_type, 2) = '03' THEN amount ELSE 0 END)",Ensures that the specific revenue type amount is correctly calculated as a component of the overall total. The sum of all such segmented amounts should ideally reconcile to the total amount.,"SELECT SUM(CASE WHEN SAFE.LEFT(SAFE_CAST(revenue_type AS STRING), 2) = '03' THEN SAFE_CAST(amount AS NUMERIC) ELSE 0 END) AS amount_03, SUM(SAFE_CAST(amount AS NUMERIC)) AS total_amount FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` WHERE SAFE_CAST(fy_year_week_number AS STRING) >= FORMAT_DATE('%Y%W', DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY))",strong,high,41,f7a9efeb-df3c-45c9-899d-0bcada701572,1,total_amount
dependency,volume_rev_type_03,['total_volume'],"Volume for Revenue Type '03' is a conditional subset of Total Volume, representing the portion of total units/quantity attributed to a specific revenue type ('03').","volume_rev_type_03 = SUM(CASE WHEN LEFT(revenue_type, 2) = '03' THEN volume ELSE 0 END)",Ensures that the specific revenue type volume is correctly calculated as a component of the overall total volume.,"SELECT SUM(CASE WHEN SAFE.LEFT(SAFE_CAST(revenue_type AS STRING), 2) = '03' THEN SAFE_CAST(volume AS NUMERIC) ELSE 0 END) AS volume_03, SUM(SAFE_CAST(volume AS NUMERIC)) AS total_volume FROM `ncau-data-newsquery-prd.asl_finance.v_asl_circulation_dq_check` WHERE SAFE_CAST(fy_year_week_number AS STRING) >= FORMAT_DATE('%Y%W', DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY))",strong,medium,41,f7a9efeb-df3c-45c9-899d-0bcada701572,1,total_volume
dependency,acquisitions_count,"['fy_year', 'fy_week_of_year', 'masthead', 'offer_category_group_name', 'offer_category_name', 'delivery_type', 'masthead_group', 'masthead_category', 'subscription_type', 'customer_type_b2c_b2b', 'acquisition_channel']","The 'Acquisitions Count' is an aggregation (COUNT(1)) of records, grouped by and filtered on all the listed dimensions. Changes to the definition or filters of any of these dimensions will directly impact the 'Acquisitions Count'.",COUNT(records) GROUP BY [dimensions] WHERE [filters],"This relationship ensures that the acquisition count is always presented within the context of its defining attributes (time, masthead, channel, customer type, etc.), allowing for segmented analysis of acquisition performance.","SELECT
  'Metric Interaction Validation' as test_type,
  COUNT(*) as total_records_after_filters,
  SUM(CASE WHEN acquisition_channel IS NOT NULL THEN 1 ELSE 0 END) as records_with_channel_for_count,
  SUM(CASE WHEN subscription_type = 'Digital Subscriptions' THEN 1 ELSE 0 END) as records_digital_subs_for_count
FROM (
  -- Re-use the final CTE from primary_analysis_sql to ensure consistent filtering
  WITH base_data AS (
    SELECT
      t0.delivery_medium_type,
      t0.fy_year,
      t0.fy_week_of_year,
      t0.masthead,
      t0.sold_in_source_code,
      t0.subscriber_has_email_flag,
      t0.table_nm,
      t0.classification_level_2,
      t0.offer_category_group_name,
      t0.offer_category_name
    FROM `ncau-data-newsquery-prd.asl_finance_derived.acquisitions_cancellations_movements` AS t0
    WHERE t0.fy_year = 2025
    LIMIT 1000000
  ),
  derived_dimensions_step1 AS (
    SELECT
      fy_year,
      fy_week_of_year,
      masthead,
      sold_in_source_code,
      subscriber_has_email_flag,
      table_nm,
      classification_level_2,
      offer_category_group_name,
      offer_category_name,
      CASE WHEN (delivery_medium_type = 'Not Available') THEN 'Digital' ELSE delivery_medium_type END AS delivery_type,
      CASE
        WHEN (masthead = 'TA') THEN 'The Australian'
        WHEN (masthead IN ('CM', 'DT', 'HS', 'AA')) THEN 'Metro'
        WHEN (masthead IN ('CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC')) THEN 'Regionals'
        WHEN (masthead = 'WT') THEN 'Other Publications'
        WHEN (masthead IN ('SC', 'CS', 'TS', 'AP', 'RN', 'PU')) THEN 'Deep Niche Publications'
        WHEN (masthead IS NULL) THEN 'check'
        ELSE 'Exclude'
      END AS masthead_group,
      CASE
        WHEN (masthead IN ('CM', 'DT', 'HS', 'AA', 'CP', 'GA', 'GC', 'NT', 'TM', 'TB', 'TC', 'WT', 'CS', 'AP', 'SC')) THEN 'States and Community'
        WHEN (masthead = 'TA') THEN 'The Australian and Prestige'
        WHEN (masthead IN ('PU', 'RN')) THEN 'Commercial Content'
        WHEN (masthead IN ('TS')) THEN 'Free & Lifestyle'
        ELSE 'Exclude'
      END AS masthead_category,
      LTRIM(RTRIM(SAFE_CAST(sold_in_source_code AS STRING))) AS sold_in_source_code_cleaned,
      SAFE.RIGHT(LTRIM(RTRIM(SAFE_CAST(sold_in_source_code AS STRING))), 3) AS source_code_suffix_3char,
      SAFE.RIGHT(SAFE_CAST(sold_in_source_code AS STRING), 4) AS source_code_suffix_4char,
      CONCAT(SAFE_CAST(delivery_medium_type AS STRING),' ',SAFE_CAST(subscriber_has_email_flag AS STRING)) AS delivery_email_flag_combo,
      CASE
        WHEN (classification_level_2 IN ('App Subscribers', 'Bundles', 'Digital', 'DPE only', 'Essentials', 'Gift Bundles Activation', 'Gift Digital Activation', 'Mind Games', 'Press Reader', 'Print-only', 'Wine Club')) THEN 'Consumer'
        WHEN (classification_level_2 IN ('Campus Activation', 'Campus Sub')) THEN 'Campus'
        WHEN (classification_level_2 IN ('Corp Volume Print', 'Corporate Activation', 'Corporate Enterprise Sub', 'Corporate Enterprise Activation', 'Corporate Enterprise Activation - Amex', 'Corporate Enterprise Activation - Qantas', 'Corporate Sub', 'Corporate Volume Activation', 'Corporate Volume Sub', 'SMB Activation', 'SMB Digital')) THEN 'Corporate excluding IP'
        WHEN (classification_level_2 = 'Free Staff') THEN 'Staff'
        WHEN (classification_level_2 = 'IP Access') THEN 'Corporate IP'
        WHEN (classification_level_2 IN ('Teachers Bundle', 'Teachers Digital', 'Teachers Print', 'University Bundle', 'University Digital')) THEN 'Education'
        ELSE NULL
      END AS classification_level_2_group
    FROM base_data
  ),
  final_dims AS (
    SELECT
      *,
      CASE
        WHEN (delivery_email_flag_combo IN ('Digital Y', 'Digital N', 'Bundle Y', 'Not Available Y')) THEN 'Digital Subscriptions'
        ELSE 'Print Subscriptions'
      END AS subscription_type,
      CASE
        WHEN (classification_level_2_group IN ('Consumer', 'Gift Receiver')) THEN 'B2C'
        WHEN (classification_level_2_group IN ('Campus', 'Corporate', 'Corporate excluding IP', 'Corporate IP', 'IP Access', 'SMB')) THEN 'B2B'
        ELSE 'Others'
      END AS customer_type_b2c_b2b,
      CASE
        WHEN (STRPOS(source_code_suffix_3char, '_AB') > 0) THEN 'Above the Fold'
        WHEN (STRPOS(source_code_suffix_3char, '_BB') > 0) THEN 'Blackbook'
        WHEN (STRPOS(source_code_suffix_3char, '_CF') > 0) THEN 'Community Form'
        WHEN (STRPOS(source_code_suffix_3char, '_CS') > 0) THEN 'Closing Speed'
        WHEN (STRPOS(source_code_suffix_3char, '_FA') > 0) THEN 'Free Articles'
        WHEN (STRPOS(source_code_suffix_3char, '_FF') > 0) THEN 'Form Finder'
        WHEN (STRPOS(source_code_suffix_3char, '_NA') > 0) THEN 'News Articles'
        WHEN (STRPOS(source_code_suffix_3char, '_PC') > 0) THEN 'True Crime Aus'
        WHEN (STRPOS(source_code_suffix_3char, '_PE') > 0) THEN 'Punters Edge'
        WHEN (STRPOS(source_code_suffix_3char, '_SL') > 0) THEN 'Shortlist'
        WHEN (STRPOS(source_code_suffix_3char, '_SS') > 0) THEN 'Setting Speed'
        WHEN (STRPOS(source_code_suffix_3char, '_TE') > 0) THEN 'Tippers Edge'
        WHEN (STRPOS(source_code_suffix_3char, '_TH') > 0) THEN 'Todays Headlines'
        WHEN (STRPOS(source_code_suffix_3char, '_TO') > 0) THEN 'The Oz'
        WHEN (STRPOS(source_code_suffix_3char, '_WS') > 0) THEN 'Why Subscribe'
        WHEN (STRPOS(source_code_suffix_4char, 'PRED') > 0) THEN 'Predictor'
        WHEN (STRPOS(source_code_suffix_3char, 'AMP') > 0) THEN 'Google AMP'
        WHEN (STRPOS(source_code_suffix_3char, 'FBK') > 0) THEN 'Facebook'
        WHEN (STRPOS(source_code_suffix_3char, 'FMB') > 0) THEN 'Facebook Messenger Bot'
        WHEN (STRPOS(source_code_suffix_3char, 'GGL') > 0) THEN 'Google'
        WHEN (STRPOS(source_code_suffix_3char, 'GGN') > 0) THEN 'Google News'
        WHEN (STRPOS(source_code_suffix_3char, 'INS') > 0) THEN 'Instagram'
        WHEN (STRPOS(source_code_suffix_3char, 'LIN') > 0) THEN 'Linked In'
        WHEN (STRPOS(source_code_suffix_3char, 'NEW') > 0) THEN 'news.com.au'
        WHEN (STRPOS(source_code_suffix_3char, 'NWL') > 0) THEN 'Newsletter'
        WHEN (STRPOS(source_code_suffix_3char, 'POD') > 0) THEN 'Podcasts'
        WHEN (STRPOS(source_code_suffix_3char, 'POR') > 0) THEN 'Newsletter Sports'
        WHEN (STRPOS(source_code_suffix_3char, 'RED') > 0) THEN 'Reddit'
        WHEN (STRPOS(source_code_suffix_3char, 'SCP') > 0) THEN 'Supercoach Plus'
        WHEN (STRPOS(source_code_suffix_3char, 'SEC') > 0) THEN 'Sectionals'
        WHEN (STRPOS(source_code_suffix_3char, 'TCA') > 0) THEN 'True Crime Aus'
        WHEN (STRPOS(source_code_suffix_3char, 'TMP') > 0) THEN 'Tips Mrket Place'
        WHEN (STRPOS(source_code_suffix_3char, 'TWA') > 0) THEN 'The Weekend Aus'
        WHEN (STRPOS(source_code_suffix_3char, 'TWT') > 0) THEN 'Twitter'
        WHEN (STRPOS(source_code_suffix_3char, 'WID') > 0) THEN 'Widget'
        WHEN (STRPOS(sold_in_source_code, '_FBK') > 0) THEN 'Facebook'
        WHEN (STRPOS(sold_in_source_code, '_GGL') > 0) THEN 'Google'
        WHEN (STRPOS(source_code_suffix_3char, 'INS') > 0) THEN 'Instagram'
        WHEN (STRPOS(sold_in_source_code, '_LIN') > 0) THEN 'Linked In'
        WHEN (STRPOS(sold_in_source_code, '_RED') > 0) THEN 'Reddit'
        WHEN (STRPOS(sold_in_source_code, '_TWT') > 0) THEN 'Twitter'
        ELSE NULL
      END AS acquisition_channel
    FROM derived_dimensions_step1
  )
  SELECT *
  FROM final_dims
  WHERE
    masthead_group != 'Exclude'
    AND subscription_type = 'Digital Subscriptions'
    AND table_nm != 'op'
    AND acquisition_channel IS NOT NULL
    AND masthead_category = 'The Australian and Prestige'
    AND fy_year = 2025
    AND customer_type_b2c_b2b IN ('B2C', '')
) AS filtered_data
LIMIT 1;",strong,high,42,4d22b4c2-4bb3-49db-a0c1-4d46d4fba101,11,"fy_year, fy_week_of_year, masthead, offer_category_group_name, offer_category_name, delivery_type, masthead_group, masthead_category, subscription_type, customer_type_b2c_b2b, acquisition_channel"
filter_impact,total_gross_revenue_amount,"['financial_year', 'financial_short_month', 'revenue_transaction_status', 'source_publishing_division', 'revenue_type_level2', 'revenue_group_subtype', 'advertiser_name', 'source_system_code']","The 'Total Gross Revenue Amount' is heavily filtered by specific values of various dimensions, indicating a highly specific scope for this dashboard's reporting. Changes to these filter values will directly impact the reported revenue.",SUM(gross_revenue_amount) WHERE [dimension_filters_apply],"Ensures that only revenue meeting specific criteria (e.g., billed/booked, programmatic, for a specific client/system) is included in the total, aligning with the 'Programmatic Impact Reporting' focus.","SELECT
  SUM(CASE WHEN t0.revenue_type_level2 = 'Programmatic' AND t0.revenue_group_subtype IN ('Programmatic Source', 'Digital') AND t0.advertiser_name = 'Foxtel Management Pty Ltd' AND t0.source_system_code = 'PLUTO' THEN SAFE_CAST(t0.gross_revenue_amount AS NUMERIC) ELSE 0 END) AS programmatic_foxtel_pluto_revenue,
  SUM(SAFE_CAST(t0.gross_revenue_amount AS NUMERIC)) AS total_revenue_billed_booked
FROM `ncau-data-newsquery-prd.asl_advertising.v_adsales_revenue_client` AS t0
WHERE
  SAFE_CAST(t0.financial_year AS STRING) = '2025'
  AND t0.source_publishing_division != 'Medium Rare Content Agency'
  AND t0.revenue_transaction_status IN ('Billed', 'Booked')
LIMIT 1;",strong,high,43,705edcb5-737a-4600-b1a7-11870177f97a,8,"financial_year, financial_short_month, revenue_transaction_status, source_publishing_division, revenue_type_level2, revenue_group_subtype, advertiser_name, source_system_code"
filter_impact,publication_date,"['advertiser_name', 'employee_name', 'selected_financial_period_month', 'selected_financial_period_year', 'selected_portfolio_name', 'agency_group', 'unified_publication_name']","Filters applied to various dimensions (e.g., specific years, months, advertisers, employees, portfolios, publications) directly impact the set of 'publication_date' values retrieved, and vice-versa.",,"Ensures that the displayed publication dates correspond to the selected dimensional filters, providing context for the ad sales data.",SELECT COUNT(DISTINCT SAFE_CAST(t0.publication_date AS DATE)) FROM `ncau-data-newsquery-prd.asl_finance_derived.details_dashboard` AS t0 WHERE SAFE_CAST(t0.financial_year AS STRING) = '2025' AND SAFE_CAST(t0.portfolio_conformed_name_current AS STRING) = 'NSW IA C3';,strong,high,45,d4d68a71-2b12-4caf-bc6b-96fc2d18a025,7,"advertiser_name, employee_name, selected_financial_period_month, selected_financial_period_year, selected_portfolio_name, agency_group, unified_publication_name"
